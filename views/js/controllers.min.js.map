{"version":3,"sources":["routes.js","creator/templates/testpart!tpl","creator/templates/section!tpl","creator/templates/rubricblock!tpl","creator/templates/itemref!tpl","creator/templates/item!tpl","tpl!taoQtiTest/controller/creator/templates/test-props","tpl!taoQtiTest/controller/creator/templates/testpart-props","tpl!taoQtiTest/controller/creator/templates/section-props","tpl!taoQtiTest/controller/creator/templates/itemref-props","tpl!taoQtiTest/controller/creator/templates/itemref-props-weight","tpl!taoQtiTest/controller/creator/templates/rubricblock-props","creator/templates/index.js","creator/views/item.js","creator/views/property.js","creator/views/actions.js","creator/helpers/sectionCategory.js","creator/helpers/qtiTest.js","creator/views/itemref.js","creator/helpers/ckConfigurator.js","creator/views/rubricblock.js","creator/helpers/sectionBlueprints.js","creator/views/section.js","creator/views/testpart.js","creator/views/test.js","creator/encoders/dom2qti.js","creator/helpers/baseType.js","creator/helpers/cardinality.js","creator/helpers/outcome.js","creator/helpers/processingRule.js","creator/helpers/category.js","creator/helpers/scoring.js","creator/creator.js","../testRunner/actionBarHook.js","../testRunner/actionBarTools.js","../testRunner/tpl/navigator!tpl","../testRunner/tpl/navigatorTree!tpl","../testRunner/testReview.js","../testRunner/progressUpdater.js","../testRunner/testMetaData.js","../../serviceApi/ServiceApi.js","../../serviceApi/UserInfoService.js","../../serviceApi/StateStorage.js","runtime/testRunner.js"],"names":["define","Creator","css","actions","index","hb","template","Handlebars","depth0","helpers","partials","data","this","compilerInfo","merge","stack1","helper","buffer","functionType","escapeExpression","identifier","call","hash","options","helperMissing","title","__","href","label","program1","uri","categories","parent","inverse","self","noop","fn","program","program2","each","modes","program5","key","selected","program3","description","scoring","hasBlueprint","value","testPart","section","rubricBlock","itemRef","item","testProps","testPartProps","sectionProps","itemRefProps","itemRefPropsWeight","rubricBlockProps","testpart","itemref","rubricblock","properties","test","itemrefweight","$","_","templates","itemTemplate","itemView","loadItems","getCategories","setUpLiveSearch","timeout","liveSearch","pattern","$search","val","length","clearTimeout","setTimeout","getItems","keyup","siblings","click","update","items","disableSelection","$itemBox","empty","append","enableSelection","$panel","selectable","filter","event","ui","addClass","unselected","removeClass","stop","trigger","then","pluck","map","isArray","DataBinder","propView","tmplName","model","propValidation","$view","on","e","isValid","namespace","$togglers","groupValidator","$container","open","databinder","binderOptions","children","hide","appendTo","startDomComponent","bind","getView","isOpen","onOpen","cb","stopPropagation","onClose","destroy","remove","toggle","not","show","propertyView","find","preventDefault","$elt","hasClass","disabledClass","blur","activeClass","btnOnClass","move","$actionContainer","containerClass","elementClass","$element","parents","$elements","is","fadeOut","insertBefore","fadeIn","insertAfter","movable","actionContainerElt","$moveUp","$moveDown","removable","$delete","disable","enable","errorHandler","isValidSectionModel","isObject","sectionParts","setCategories","oldCategories","removed","difference","all","propagated","addCategories","removeCategories","compact","arrays","values","union","apply","intersection","partial","sort","throw","_ns","getTaoOptionCategories","name","qtiTestHelper","extractIdentifiers","obj","identifiers","has","concat","toLowerCase","flatten","forEach","getIdentifier","qtiType","lockedIdentifiers","suggestion","glue","contains","push","idFormatValidator","qtiIdPattern","message","validate","callback","testidFormatValidator","qtiTestIdPattern","idAvailableValidator","original","filterQtiType","type","addMissingQtiType","collection","parentType","isNumber","replace","consolidateModel","testParts","assessmentSections","assessmentSection","ordering","undefined","shuffle","part","rubricBlocks","content","views","sectionCategory","weightTpl","resize","throttle","$refs","first","$actions","width","innerWidth","outerWidth","setUp","$itemRef","propHandler","removePropHandler","categoriesProperty","weightsProperty","initCategories","$select","select2","tags","multiple","tokenSeparators","formatNoMatches","maximumInputLength","$weightList","defaultData","weights","listenActionState","document","$parent","$target","target","ckConfigurator","mathJax","getConfig","editor","toolbarType","underline","ckeditor","ckConfig","filterPlugin","plugin","plugins","reject","split","join","extraPlugins","$rubricBlock","rbViews","$propContainer","setUpEditor","$rubricBlockBinding","$rubricBlockContent","syncRubricBlockContent","html","inline","setBlueprint","blueprint","getBlueprint","getUrl","ajax","url","dataType","fail","itemRefView","rubricBlockView","sectionBlueprint","$section","$title","$selectionSwitcher","$selectionSelect","$selectionWithRep","switchSelection","prop","incrementer","selection","text","blueprintProperty","itemRefs","labels","encode","acceptItemRefs","$selected","$items","Array","prototype","slice","arguments","$placeholder","$placeholders","off","defaultItemData","itemSessionControl","isUndefined","maxAttempts","clone","$item","itemCategories","itemData","defaults","decode","trim","end","qti-type","isEmpty","addItemRef","attr","$refList","eq","addRubricBlock","adder","templateData","$li","indexOf","initBlueprint","routes","blueprintByTestSection","success","id","blueprintsById","delay","method","params","results","minimumInputLength","$sections","sectionView","$testPart","$identifier","sections","addSection","sectionIndex","$testParts","hider","testPartView","testView","changeScoring","$cutScoreLine","outcomeProcessing","$weightIdentifierLine","$descriptions","addTestPart","testPartIndex","navigationMode","submissionMode","added","getAttributes","object","omit","attrToStr","attributes","reduce","acc","isString","Dom2QtiEncoder","modelValue","result","startTag","nodeValue","$nodeValue","elt","nodeType","xmlBase","nodeName","class","lang","transform","childNodes","baseTypeEnum","IDENTIFIER","BOOLEAN","INTEGER","FLOAT","STRING","POINT","PAIR","DIRECTED_PAIR","DURATION","FILE","URI","INT_OR_IDENTIFIER","COORDS","baseTypeHelper","asArray","getValid","defaultType","isFinite","getNameByConstant","getConstantByName","String","constant","assign","cardinalityEnum","SINGLE","MULTIPLE","ORDERED","RECORD","cardinalityHelper","cardinality","defaultCardinality","validateIdentifier","identifierValidator","outcomeHelper","findQtiType","expression","checkType","qti","found","getProcessingRuleExpression","outcomeRule","path","steps","len","i","expressions","getProcessingRuleProperty","property","pop","getOutcomeIdentifier","outcome","getOutcomeDeclarations","testModel","outcomeDeclarations","getOutcomeProcessingRules","outcomeRules","eachOutcomeDeclarations","eachOutcomeProcessingRules","eachOutcomeProcessingRuleExpressions","browseExpressions","processingRule","listOutcomes","outcomes","isFunction","removeOutcomes","declarations","rules","indexBy","outcomeDeclaration","createOutcome","TypeError","interpretation","longInterpretation","normalMaximum","normalMinimum","masteryValue","baseType","addOutcomeProcessing","addOutcome","binaryOperator","left","right","processingRuleHelper","create","minOperands","maxOperands","acceptedCardinalities","acceptedBaseTypes","forceArray","setExpression","addExpression","setOutcomeValue","gte","lte","divide","sum","terms","testVariables","weight","includeCategories","excludeCategories","variableIdentifier","weightIdentifier","sectionIdentifier","numberPresented","baseValue","parseFloat","isCategoryOption","category","eachCategories","listCategories","keys","listOptions","categoryHelper","getScoringMode","mode","processingModes","processingMode","prefix","isScoringOutcome","listScoringModes","getCutScore","uniq","defaultCutScore","Math","max","getWeightIdentifier","detectScoring","processing","diff","count","size","scoreIdentifier","cutScore","removeScoring","scoringOutcomes","setScoring","processingModeWriter","processingModeWriters","Error","none","custom","total","cut","toUpperCase","read","write","module","history","feedback","DataBindController","itemrefView","scoringHelper","validators","Promise","search","resolve","getJSON","notempty","done","xhr","status","statusText","uris","Controller","start","binder","$saver","config","back","filters","isItemRef","isSection","encoders","dom2qti","beforeSave","takeControl","get","register","window","save","isValidConfig","toolconfig","hook","triggerItemLoaded","tool","itemLoaded","initQtiTool","$toolsContainer","testContext","testRunner","itemIsLoaded","tools","require","$button","$existingBtn","isValidHook","init","clear","isVisible","render","_appendInOrder","$after","$before","order","prepend","parseInt","isNaN","$btn","_order","after","before","$doc","eventifier","actionBarHook","registeredQtiTools","qtiTools","actionBarTools","registerTools","getRegisteredTools","getRegistered","isRegistered","list","container","promises","forIn","getId","region","hidden","active","program4","program29","program6","program7","answered","program8","program9","flagged","program11","program13","viewed","program17","program15","position","program21","program19","program24","program22","program27","program25","itemId","parts","navigatorTpl","navigatorTreeTpl","capitalize","_cssCls","collapsed","collapsible","disabled","unseen","icon","scope","testSection","_selectors","component","filterBar","tree","collapseHandle","linearState","infoAnswered","infoViewed","infoUnanswered","infoFlagged","infoPanel","infoPanelLabels","partLabels","sectionLabels","itemLabels","itemIcons","icons","linearStart","counters","actives","collapsiblePanels","notFlagged","notAnswered","_filterMap","unanswered","filtered","_optionsMap","reviewScope","reviewPreventsUnseen","canCollapse","_reviewScopes","testReview","element","initOptions","putOnRight","insertMethod","currentFilter","$component","_loadDOM","_initEvents","_updateDisplayOptions","$infoAnswered","$infoViewed","$infoUnanswered","$infoFlagged","$filterBar","$filters","$tree","$linearState","toggleClass","_openSelected","closest","_togglePanel","_openOnly","_mark","_select","_jump","_filter","criteria","_updateSectionCounters","jquery","hierarchy","parentsUntil","add","opened","root","panel","collapseSelector","_setItemIcon","_adjustItemIcon","defaultIcon","iconCls","cls","_toggleFlag","flag","itemPosition","$filtered","nb","_writeCount","scopeClass","$root","_updateOptions","optionKey","contextKey","_updateInfos","progression","Number","$place","_getProgressionOfTest","numberItems","numberCompleted","numberFlagged","_getProgressionOfTestPart","numberItemsPart","numberCompletedPart","numberPresentedPart","numberFlaggedPart","_getProgressionOfTestSection","numberItemsSection","numberCompletedSection","numberPresentedSection","numberFlaggedSection","_updateTree","navigatorMap","reviewScopePart","reviewScopeSection","_partsFilter","preventsUnseen","setItemFlag","updateNumberFlagged","fields","currentPosition","currentFound","currentSection","currentPart","itemFound","itemSection","itemPart","field","getProgression","progressInfoMethod","eventName","dom","extraParameters","testReviewFactory","progressUpdaters","progressBar","progressLabel","progressbar","ratio","progressIndicator","progressIndicatorMethod","percentageProgression","floor","positionProgression","progressScope","progressIndicatorScope","progressScopeCounter","counter","progressUpdaterFactory","updater","testMetaDataFactory","_testServiceCallId","testServiceCallId","testMetaData","setData","getLocalStorageData","setLocalStorageData","currentKey","getLocalStorageKey","localStorage","setItem","domException","removeItem","getItem","JSON","parse","_storageKeyPrefix","_data","SECTION_EXIT_CODE","COMPLETED_NORMALLY","QUIT","COMPLETE_TIMEOUT","TIMEOUT","FORCE_QUIT","IN_PROGRESS","ERROR","TEST_EXIT_CODE","COMPLETE","TERMINATED","INCOMPLETE","INCOMPLETE_QUIT","INACTIVE","CANDIDATE_DISAGREED_WITH_NDA","getTestServiceCallId","setTestServiceCallId","stringify","addData","overwrite","getData","clearData","UrlParser","ServiceApi","baseUrl","parameters","serviceCallId","stateStorage","userService","paused","connected","state","hasBeenPaused","SIG_SUCCESS","SIG_ERROR","loadInto","frame","$frame","callUrl","getCallUrl","isCORSAllowed","checkCORS","connect","contentWindow","__knownParent__","onServiceApiReady","param","getUserPropertyValues","getServiceCallId","getState","setState","set","getHasBeenPaused","setHasBeenPaused","getParameter","onFinish","onFinishCallback","onKill","onKillCallback","onExit","onExitCallback","kill","exit","finish","valueArray","UserInfoService","requestUrl","hasOwnProperty","service","r","StateStorage","submitUrl","progressUpdater","iframeNotifier","MathJax","deleter","moment","modal","timerIds","currentTimes","lastDates","timeDiffs","waitingTime","$timers","$controls","timerIndex","sessionStateService","optionNextSection","optionNextSectionWarning","optionReviewScreen","optionEndTestWarning","optionNoExitTimedSectionWarning","TestRunner","TEST_STATE_INITIAL","TEST_STATE_INTERACTING","TEST_STATE_MODAL_FEEDBACK","TEST_STATE_SUSPENDED","TEST_STATE_CLOSED","TEST_NAVIGATION_LINEAR","TEST_NAVIGATION_NONLINEAR","TEST_ITEM_STATE_INTERACTING","beforeTransition","disableGui","$itemFrame","$rubricBlocks","$timerWrapper","afterTransition","enableGui","ITEM","ITEM_START_TIME_CLIENT","Date","now","jump","action","isJumpOutOfSection","isCurrentItemActive","isTimedSection","exitTimedSection","killItemSession","actionCall","keepItemTimed","duration","markForReview","markForReviewUrl","cache","async","itemFlagged","updateTools","moveForward","doExitSection","isTimeout","exitSection","itemPositionSection","shouldDisplayEndTestWarning","displayEndTestWarning","isLast","hasOption","nextAction","confirmLabel","cancelLabel","showItemCount","displayExitMessage","moveBackward","jumpPosition","getCurrentSectionItems","isJumpToOtherSection","isValidPosition","exitCode","SECTION","qtiRunner","getQtiRunner","doExitTimedSection","updateItemApi","keepTimerUpToTimeout","nextSection","doNextSection","scopeSuffixMap","scopeSuffix","$confirmBox","unansweredCount","flaggedCount","isCurrentItemAnswered","toString","ITEM_END_TIME_CLIENT","ITEM_TIMEZONE","utcOffset","format","itemServiceApi","itemSessionState","getCurrentItemState","response","base","option","itemFrame","getElementById","itemWindow","itemContainerFrame","itemContainerWindow","timeConstraints","qtiClassName","sectionItems","partId","testPartId","navMap","partIndex","skip","doSkip","updateTimer","confirmBox","confirmBtn","setTestContext","eval","itemServiceApiCall","initMetadata","getSessionStateService","accuracy","$runner","restart","updateContext","updateProgress","updateNavigation","updateTestReview","updateInformation","updateRubrics","updateExitButton","resetCurrentItemState","$contentBox","adjustFrame","visibility","error","itemIdentifier","showSkip","showSkipEnd","showNextSection","allowSkipping","$skip","$skipEnd","$nextSection","createTimer","cst","$timer","$label","$time","formatTime","seconds","hasTimers","$topActionBar","allowLateSubmission","timerWarning","warnings","showed","point","closestPreviousWarning","setInterval","getTime","round","clearInterval","warning","findLast","timeWarning","remaining","humanize","rubrics","prependTo","Hub","Queue","$exit","$moveForward","$moveEnd","$moveBackward","canMoveBackward","considerProgress","$progressBox","testTitle","sectionText","isDeepestSectionVisible","sectionTitle","$position","$titleGroup","$logout","logoutButton","exitButton","frameContentHeight","rubricHeight","outerHeight","finalHeight","innerHeight","$bottomActionBar","height","$sideBars","$sideBar","contents","$naviButtons","hideGui","showGui","totalSeconds","sec_num","hours","minutes","time","processError","serviceApi","extraParams","metaData","TEST","setCurrentItemState","currentItemState","$skipButtons","$forwardButtons","$progressBar","$progressLabel","$contentPanel","ajaxError","jqxhr","getDuration","reviewScreen","reviewRegion","reviewCanCollapse","animate","opacity","responseId"],"mappings":"AAqBAA,OAAA,kCAAA,WACA,YAEA,QACAC,SACAC,IAAA,UACAC,SACAC,MAAA,kCC3BAJ,OAAA,wDAAA,cAAA,SAAAK,IACA,MAAAA,IAAAC,SAAA,SAAAC,WAAAC,OAAAC,QAAAC,SAAAC,MACAC,KAAAC,cAAA,EAAA,YACAJ,QAAAG,KAAAE,MAAAL,QAAAF,WAAAE,SAAAE,KAAAA,QACA,IAAAI,QAAAC,OAAAC,OAAA,GAAAC,aAAA,WAAAC,iBAAAP,KAAAO,gBAwBA,OArBAF,SAAA,aACAD,OAAAP,QAAAW,YAAAL,OAAAC,OAAAK,KAAAb,QAAAc,QAAAX,KAAAA,QACAK,OAAAR,QAAAA,OAAAY,WAAAL,aAAAC,UAAAE,aAAAF,OAAAK,KAAAb;AAAAc,QAAAX,KAAAA,OAAAK,QACAC,QAAAE,iBAAAJ,QACA,wEACAC,OAAAP,QAAAW,YAAAL,OAAAC,OAAAK,KAAAb,QAAAc,QAAAX,KAAAA,QACAK,OAAAR,QAAAA,OAAAY,WAAAL,aAAAC,UAAAE,aAAAF,OAAAK,KAAAb,QAAAc,QAAAX,KAAAA,OAAAK,QACAC,QAAAE,iBAAAJ,QACA;CACAC,OAAAP,QAAAW,YAAAL,OAAAC,OAAAK,KAAAb,QAAAc,QAAAX,KAAAA,QACAK,OAAAR,QAAAA,OAAAY,WAAAL,aAAAC,UAAAE,aAAAF,OAAAK,KAAAb,QAAAc,QAAAX,KAAAA,OAAAK,QACAC,QAAAE,iBAAAJ,QACA;CACAC,OAAAP,QAAAW,YAAAL,OAAAC,OAAAK,KAAAb,QAAAc,QAAAX,KAAAA,QACAK,OAAAR,QAAAA,OAAAY,WAAAL,aAAAC,UAAAE,aAAAF,OAAAK,KAAAb,QAAAc,QAAAX,KAAAA,OAAAK,QACAC,QAAAE,iBAAAJ,QACA,qDACAC,OAAAP,QAAAW,YAAAL,OAAAC,OAAAK,KAAAb,QAAAc,QAAAX,KAAAA,QACAK,OAAAR,QAAAA,OAAAY,WAAAL,aAAAC,UAAAE,aAAAF,OAAAK,KAAAb,QAAAc,QAAAX,KAAAA,OAAAK,QACAC,QAAAE,iBAAAJ,QACA;KC3BAf,OAAA,uDAAA,cAAA,SAAAK,IACA,MAAAA,IAAAC,SAAA,SAAAC,WAAAC,OAAAC,QAAAC,SAAAC,MACAC,KAAAC,cAAA,EAAA,YACAJ,QAAAG,KAAAE,MAAAL,QAAAF,WAAAE,SAAAE,KAAAA,QACA,IAAAI,QAAAC,OAAAO,QAAAN,OAAA,GAAAC,aAAA,WAAAC,iBAAAP,KAAAO,iBAAAK,cAAAf,QAAAe,aAwCA,OArCAP,SAAA,aACAD,OAAAP,QAAAW,YAAAL,OAAAC,OAAAK,KAAAb,QAAAc,QAAAX,KAAAA,QACAK,OAAAR,QAAAA,OAAAY,WAAAL,aAAAC,UAAAE,aAAAF,OAAAK,KAAAb,QAAAc,QAAAX,KAAAA,OAAAK,QACAC,QAAAE,iBAAAJ,QACA;CACAC,OAAAP,QAAAgB,OAAAV,OAAAC,OAAAK,KAAAb,QAAAc,QAAAX,KAAAA,QACAK,OAAAR,QAAAA,OAAAiB,MAAAV,aAAAC,UAAAE,aAAAF,OAAAK,KAAAb,QAAAc,QAAAX,KAAAA,OAAAK,QACAC,QAAAE,iBAAAJ,QACA,sZACAI,kBAAAH,OAAAP,QAAAiB,IAAAlB,QAAAA,OAAAkB;AAAAH,SAAAD,QAAAX,KAAAA,MAAAK,OAAAA,OAAAK,KAAAb,OAAA,uBAAAe,SAAAC,cAAAH,KAAAb,OAAA,KAAA,uBAAAe,WACA,6BACAP,OAAAP,QAAAW,YAAAL,OAAAC,OAAAK,KAAAb,QAAAc,QAAAX,KAAAA,QACAK,OAAAR,QAAAA,OAAAY,WAAAL,aAAAC,UAAAE,aAAAF,OAAAK,KAAAb,QAAAc,QAAAX,KAAAA,OAAAK,QACAC,QAAAE,iBAAAJ,QACA,6MACAI,kBAAAH,OAAAP,QAAAiB,IAAAlB,QAAAA,OAAAkB,GAAAH;AAAAD,QAAAX,KAAAA,MAAAK,OAAAA,OAAAK,KAAAb,OAAA,qBAAAe,SAAAC,cAAAH,KAAAb,OAAA,KAAA,qBAAAe,WACA,8MACAJ,kBAAAH,OAAAP,QAAAiB,IAAAlB,QAAAA,OAAAkB,GAAAH,SAAAD,QAAAX,KAAAA,MAAAK,OAAAA,OAAAK,KAAAb,OAAA,UAAAe,SAAAC,cAAAH,KAAAb,OAAA,KAAA,UAAAe,WACA,qIACAJ,kBAAAH,OAAAP,QAAAiB,IAAAlB,QAAAA,OAAAkB;AAAAH,SAAAD,QAAAX,KAAAA,MAAAK,OAAAA,OAAAK,KAAAb,OAAA,YAAAe,SAAAC,cAAAH,KAAAb,OAAA,KAAA,YAAAe,WACA,kMACAJ,kBAAAH,OAAAP,QAAAiB,IAAAlB,QAAAA,OAAAkB,GAAAH,SAAAD,QAAAX,KAAAA,MAAAK,OAAAA,OAAAK,KAAAb,OAAA,iBAAAe,SAAAC,cAAAH,KAAAb,OAAA,KAAA,iBAAAe,WACA;CACAP,OAAAP,QAAAW,YAAAL,OAAAC,OAAAK,KAAAb,QAAAc,QAAAX,KAAAA,QACAK,OAAAR,QAAAA,OAAAY,WAAAL,aAAAC,UAAAE,aAAAF,OAAAK,KAAAb,QAAAc,QAAAX,KAAAA,OAAAK,QACAC,QAAAE,iBAAAJ,QACA,uFACAI,kBAAAH,OAAAP,QAAAiB,IAAAlB,QAAAA,OAAAkB,GAAAH,SAAAD,QAAAX,KAAAA,MAAAK,OAAAA,OAAAK,KAAAb,OAAA,gBAAAe,SAAAC,cAAAH,KAAAb,OAAA,KAAA,gBAAAe,WACA,uOACAJ,kBAAAH,OAAAP,QAAAiB,IAAAlB,QAAAA,OAAAkB;AAAAH,SAAAD,QAAAX,KAAAA,MAAAK,OAAAA,OAAAK,KAAAb,OAAA,mBAAAe,SAAAC,cAAAH,KAAAb,OAAA,KAAA,mBAAAe,WACA,sHACAJ,kBAAAH,OAAAP,QAAAiB,IAAAlB,QAAAA,OAAAkB,GAAAH,SAAAD,QAAAX,KAAAA,MAAAK,OAAAA,OAAAK,KAAAb,OAAA,QAAAe,SAAAC,cAAAH,KAAAb,OAAA,KAAA,QAAAe,WACA,uKACAJ,kBAAAH,OAAAP,QAAAiB,IAAAlB,QAAAA,OAAAkB,GAAAH;AAAAD,QAAAX,KAAAA,MAAAK,OAAAA,OAAAK,KAAAb,OAAA,6BAAAe,SAAAC,cAAAH,KAAAb,OAAA,KAAA,6BAAAe,WACA,mEACAJ,kBAAAH,OAAAP,QAAAiB,IAAAlB,QAAAA,OAAAkB,GAAAH,SAAAD,QAAAX,KAAAA,MAAAK,OAAAA,OAAAK,KAAAb,OAAA,6BAAAe,SAAAC,cAAAH,KAAAb,OAAA,KAAA,6BAAAe,WACA,6CC3CAvB,OAAA,2DAAA,cAAA,SAAAK,IACA,MAAAA,IAAAC,SAAA,SAAAC,WAAAC,OAAAC,QAAAC,SAAAC,MACAC,KAAAC,cAAA,EAAA;AACAJ,QAAAG,KAAAE,MAAAL,QAAAF,WAAAE,SAAAE,KAAAA,QACA,IAAAK,QAAAO,QAAAN,OAAA,GAAAO,cAAAf,QAAAe,cAAAL,iBAAAP,KAAAO,gBAQA,OALAF,SAAA,+YACAE,kBAAAH,OAAAP,QAAAiB,IAAAlB,QAAAA,OAAAkB,GAAAH,SAAAD,QAAAX,KAAAA,MAAAK,OAAAA,OAAAK,KAAAb,OAAA,0BAAAe,SAAAC,cAAAH,KAAAb,OAAA,KAAA,0BAAAe,WACA,gMACAJ,kBAAAH,OAAAP,QAAAiB,IAAAlB,QAAAA,OAAAkB;AAAAH,SAAAD,QAAAX,KAAAA,MAAAK,OAAAA,OAAAK,KAAAb,OAAA,sBAAAe,SAAAC,cAAAH,KAAAb,OAAA,KAAA,sBAAAe,WACA,qcCXAvB,OAAA,uDAAA,cAAA,SAAAK;AACA,MAAAA,IAAAC,SAAA,SAAAC,WAAAC,OAAAC,QAAAC,SAAAC,MACAC,KAAAC,cAAA,EAAA,YACAJ,QAAAG,KAAAE,MAAAL,QAAAF,WAAAE,SAAAE,KAAAA,QACA,IAAAI,QAAAC,OAAAO,QAAAN,OAAA,GAAAC,aAAA,WAAAC,iBAAAP,KAAAO,iBAAAK,cAAAf,QAAAe,aAwBA,OArBAP,SAAA,YACAD,OAAAP,QAAAW,YAAAL,OAAAC,OAAAK,KAAAb,QAAAc,QAAAX,KAAAA,QACAK,OAAAR,QAAAA,OAAAY,WAAAL,aAAAC,UAAAE,aAAAF,OAAAK,KAAAb,QAAAc,QAAAX,KAAAA,OAAAK,QACAC,QAAAE,iBAAAJ,QACA,gBACAC,OAAAP,QAAAkB,MAAAZ,OAAAC,OAAAK,KAAAb,QAAAc,QAAAX,KAAAA,QACAK,OAAAR,QAAAA,OAAAmB,KAAAZ,aAAAC,UAAAE,aAAAF,OAAAK,KAAAb;AAAAc,QAAAX,KAAAA,OAAAK,QACAC,QAAAE,iBAAAJ,QACA,yDACAC,OAAAP,QAAAmB,OAAAb,OAAAC,OAAAK,KAAAb,QAAAc,QAAAX,KAAAA,QACAK,OAAAR,QAAAA,OAAAoB,MAAAb,aAAAC,UAAAE,aAAAF,OAAAK,KAAAb,QAAAc,QAAAX,KAAAA,OAAAK,QACAC,QAAAE,iBAAAJ,QACA,4XACAI,kBAAAH,OAAAP,QAAAiB,IAAAlB,QAAAA,OAAAkB;AAAAH,SAAAD,QAAAX,KAAAA,MAAAK,OAAAA,OAAAK,KAAAb,OAAA,4BAAAe,SAAAC,cAAAH,KAAAb,OAAA,KAAA,4BAAAe,WACA,6LACAJ,kBAAAH,OAAAP,QAAAiB,IAAAlB,QAAAA,OAAAkB,GAAAH,SAAAD,QAAAX,KAAAA,MAAAK,OAAAA,OAAAK,KAAAb,OAAA,UAAAe,SAAAC,cAAAH,KAAAb,OAAA,KAAA,UAAAe,WACA,wHACAJ,kBAAAH,OAAAP,QAAAiB,IAAAlB,QAAAA,OAAAkB;AAAAH,SAAAD,QAAAX,KAAAA,MAAAK,OAAAA,OAAAK,KAAAb,OAAA,YAAAe,SAAAC,cAAAH,KAAAb,OAAA,KAAA,YAAAe,WACA,kLACAJ,kBAAAH,OAAAP,QAAAiB,IAAAlB,QAAAA,OAAAkB,GAAAH,SAAAD,QAAAX,KAAAA,MAAAK,OAAAA,OAAAK,KAAAb,OAAA,wBAAAe,SAAAC,cAAAH,KAAAb,OAAA,KAAA,wBAAAe,WACA;KC3BAvB,OAAA,oDAAA,cAAA,SAAAK,IACA,MAAAA,IAAAC,SAAA,SAAAC,WAAAC,OAAAC,QAAAC,SAAAC,MAKA,QAAAkB,UAAArB,OAAAG,MAEA,GAAAI,QAAAC,OAAAC,OAAA,EAiBA,OAhBAA,SAAA,yBACAD,OAAAP,QAAAqB,KAAAf,OAAAC,OAAAK,KAAAb,QAAAc,QAAAX,KAAAA,QACAK,OAAAR,QAAAA,OAAAsB,IAAAf,aAAAC,UAAAE,aAAAF,OAAAK,KAAAb,QAAAc,QAAAX,KAAAA,OAAAK,QACAC,QAAAE,iBAAAJ,QACA,uBACAC,OAAAP,QAAAsB,YAAAhB,OAAAC,OAAAK,KAAAb,QAAAc,QAAAX,KAAAA,QACAK,OAAAR,QAAAA,OAAAuB,WAAAhB,aAAAC,UAAAE,aAAAF,OAAAK,KAAAb,QAAAc,QAAAX,KAAAA;GAAAK,QACAC,QAAAE,iBAAAJ,QACA,iCACAC,OAAAP,QAAAmB,OAAAb,OAAAC,OAAAK,KAAAb,QAAAc,QAAAX,KAAAA,QACAK,OAAAR,QAAAA,OAAAoB,MAAAb,aAAAC,UAAAE,aAAAF,OAAAK,KAAAb,QAAAc,QAAAX,KAAAA,OAAAK,QACAC,QAAAE,iBAAAJ,QACA,aACAA,OAAAN,QAAA,GAAAY,KAAAb,OAAAA,QAAAA,OAAAwB,QAAAV,QAAAW,QAAAC,KAAAC,KAAAC,GAAAF,KAAAG,QAAA,EAAAC,SAAA3B,MAAAA,KAAAA,QACAI,QAAA,IAAAA,UAAAE,QAAAF,QACAE,QAAA,iBAGA,QAAAqB,UAAA9B,OAAAG,MAEA,GAAAI,QAAAC,OAAAC,OAAA,EAUA,OATAA,SAAA,wCACAD,OAAAP,QAAAuB,QAAAjB,OAAAC,OAAAK,KAAAb,QAAAc,QAAAX,KAAAA;IACAK,OAAAR,QAAAA,OAAAwB,OAAAjB,aAAAC,UAAAE,aAAAF,OAAAK,KAAAb,QAAAc,QAAAX,KAAAA,OAAAK,QACAC,QAAAE,iBAAAJ,QACA,MACAC,OAAAP,QAAAuB,QAAAjB,OAAAC,OAAAK,KAAAb,QAAAc,QAAAX,KAAAA,QACAK,OAAAR,QAAAA,OAAAwB,OAAAjB,aAAAC,UAAAE,aAAAF,OAAAK,KAAAb,QAAAc,QAAAX,KAAAA,OAAAK,QACAC,QAAAE,iBAAAJ,QACA,UApCAH,KAAAC,cAAA,EAAA,YACAJ,QAAAG,KAAAE,MAAAL,QAAAF,WAAAE,SAAAE,KAAAA,QACA,IAAAI,QAAAE,OAAA,GAAAC,aAAA,WAAAC,iBAAAP,KAAAO,iBAAAe,KAAAtB,IAyCA,OAHAG,QAAAN,QAAA8B,KAAAlB,KAAAb,OAAAA,QAAAc,QAAAW,QAAAC,KAAAC,KAAAC,GAAAF,KAAAG,QAAA,EAAAR,SAAAlB;AAAAA,KAAAA,QACAI,QAAA,IAAAA,UAAAE,QAAAF,QACAE,QAAA,SC5CAjB,OAAA,0DAAA,cAAA,SAAAK,IACA,MAAAA,IAAAC,SAAA,SAAAC,WAAAC,OAAAC,QAAAC,SAAAC,MAKA,QAAAkB,UAAArB,OAAAG,MAEA,GAAAI,QAAAC,OAAAO,QAAAN,OAAA,EAoBA,OAnBAA,SAAA,wNACAE,kBAAAH,OAAAP,QAAAiB,IAAAlB,QAAAA,OAAAkB,GAAAH,SAAAD,QAAAX,KAAAA,MAAAK,OAAAA,OAAAK,KAAAb,OAAA,qBAAAe,SAAAC,cAAAH,KAAAb,OAAA,KAAA,qBAAAe,WACA;AACAR,OAAAN,QAAA8B,KAAAlB,KAAAb,OAAAA,QAAAA,OAAAgC,OAAAlB,QAAAW,QAAAC,KAAAC,KAAAC,GAAAF,KAAAG,QAAA,EAAAC,SAAA3B,MAAAA,KAAAA,QACAI,QAAA,IAAAA,UAAAE,QAAAF,QACAE,QAAA,0QACAE,kBAAAH,OAAAP,QAAAiB,IAAAlB,QAAAA,OAAAkB,GAAAH,SAAAD,QAAAX,KAAAA,MAAAK,OAAAA,OAAAK,KAAAb,OAAA,gEAAAe,SAAAC,cAAAH,KAAAb,OAAA,KAAA,gEAAAe,WACA,yOACAJ,kBAAAH,OAAAP,QAAAiB,IAAAlB,QAAAA,OAAAkB;AAAAH,SAAAD,QAAAX,KAAAA,MAAAK,OAAAA,OAAAK,KAAAb,OAAA,YAAAe,SAAAC,cAAAH,KAAAb,OAAA,KAAA,YAAAe,WACA,ocACAJ,kBAAAH,OAAAP,QAAAiB,IAAAlB,QAAAA,OAAAkB,GAAAH,SAAAD,QAAAX,KAAAA,MAAAK,OAAAA,OAAAK,KAAAb,OAAA,2CAAAe,SAAAC,cAAAH,KAAAb,OAAA,KAAA,2CAAAe,WACA,iQACAJ,kBAAAH,OAAAP,QAAAiB,IAAAlB,QAAAA,OAAAkB;AAAAH,SAAAD,QAAAX,KAAAA,MAAAK,OAAAA,OAAAK,KAAAb,OAAA,SAAAe,SAAAC,cAAAH,KAAAb,OAAA,KAAA,SAAAe,WACA,ydACAJ,kBAAAH,OAAAP,QAAAiB,IAAAlB,QAAAA,OAAAkB,GAAAH,SAAAD;AAAAX,KAAAA,MAAAK,OAAAA,OAAAK,KAAAb,OAAA,sDAAAe,SAAAC,cAAAH,KAAAb,OAAA,KAAA,sDAAAe,WACA,kMACAR,OAAAN,QAAA8B,KAAAlB,KAAAb,OAAAA,QAAAA,OAAAgC,OAAAlB,QAAAW,QAAAC,KAAAC,KAAAC,GAAAF,KAAAG,QAAA,EAAAI,SAAA9B,MAAAA,KAAAA,QACAI,QAAA,IAAAA,UAAAE,QAAAF,QACAE,QAAA,qDAGA,QAAAqB,UAAA9B,OAAAG,MAEA,GAAAI,QAAAC,OAAAC,OAAA;AAaA,MAZAA,SAAA,yCACAD,OAAAP,QAAAiC,KAAA3B,OAAAC,OAAAK,KAAAb,QAAAc,QAAAX,KAAAA,QACAK,OAAAR,QAAAA,OAAAkC,IAAA3B,aAAAC,UAAAE,aAAAF,OAAAK,KAAAb,QAAAc,QAAAX,KAAAA,OAAAK,QACAC,QAAAE,iBAAAJ,QACA,KACAA,OAAAN,QAAA,GAAAY,KAAAb,OAAAA,QAAAA,OAAAmC,UAAArB,QAAAW,QAAAC,KAAAC,KAAAC,GAAAF,KAAAG,QAAA,EAAAO,SAAAjC,MAAAA,KAAAA,QACAI,QAAA,IAAAA,UAAAE,QAAAF,QACAE,QAAA,KACAD,OAAAP,QAAAmB,OAAAb,OAAAC,OAAAK,KAAAb,QAAAc,QAAAX,KAAAA,QACAK,OAAAR,QAAAA,OAAAoB,MAAAb,aAAAC,UAAAE,aAAAF,OAAAK,KAAAb,QAAAc,QAAAX,KAAAA,OAAAK,QACAC,QAAAE,iBAAAJ,QACA;CAGA,QAAA6B,UAAApC,OAAAG,MAGA,MAAA,sBAGA,QAAA8B,UAAAjC,OAAAG,MAEA,GAAAI,QAAAC,OAAAC,OAAA,EAUA,OATAA,SAAA,+FACAD,OAAAP,QAAAiC,KAAA3B,OAAAC,OAAAK,KAAAb,QAAAc,QAAAX,KAAAA,QACAK,OAAAR,QAAAA,OAAAkC,IAAA3B,aAAAC,UAAAE,aAAAF,OAAAK,KAAAb,QAAAc,QAAAX,KAAAA,OAAAK,QACAC,QAAAE,iBAAAJ,QACA,iFACAC,OAAAP,QAAAoC,aAAA9B,OAAAC,OAAAK,KAAAb,QAAAc,QAAAX,KAAAA,QACAK,OAAAR,QAAAA,OAAAqC,YAAA9B,aAAAC,UAAAE,aAAAF,OAAAK,KAAAb;AAAAc,QAAAX,KAAAA,OAAAK,QACAC,QAAAE,iBAAAJ,QACA,6CA9DAH,KAAAC,cAAA,EAAA,YACAJ,QAAAG,KAAAE,MAAAL,QAAAF,WAAAE,SAAAE,KAAAA,QACA,IAAAI,QAAAC,OAAAO,QAAAN,OAAA,GAAAC,aAAA,WAAAC,iBAAAP,KAAAO,iBAAAe,KAAAtB,KAAAY,cAAAf,QAAAe,aAgGA,OAhCAP,SAAA,qPACAE,kBAAAH,OAAAP,QAAAiB,IAAAlB,QAAAA,OAAAkB,GAAAH;AAAAD,QAAAX,KAAAA,MAAAK,OAAAA,OAAAK,KAAAb,OAAA,aAAAe,SAAAC,cAAAH,KAAAb,OAAA,KAAA,aAAAe,WACA,iBACAJ,kBAAAH,OAAAP,QAAAiB,IAAAlB,QAAAA,OAAAkB,GAAAH,SAAAD,QAAAX,KAAAA,MAAAK,OAAAA,OAAAK,KAAAb,OAAA,iBAAAe,SAAAC,cAAAH,KAAAb,OAAA,KAAA,iBAAAe,WACA,qNACAP,OAAAP,QAAAW,YAAAL,OAAAC,OAAAK,KAAAb,QAAAc,QAAAX,KAAAA,QACAK,OAAAR,QAAAA,OAAAY,WAAAL,aAAAC,UAAAE,aAAAF,OAAAK,KAAAb;AAAAc,QAAAX,KAAAA,OAAAK,QACAC,QAAAE,iBAAAJ,QACA,6NACAI,kBAAAH,OAAAP,QAAAiB,IAAAlB,QAAAA,OAAAkB,GAAAH,SAAAD,QAAAX,KAAAA,MAAAK,OAAAA,OAAAK,KAAAb,OAAA,wCAAAe,SAAAC,cAAAH,KAAAb,OAAA,KAAA,wCAAAe,WACA,mLACAJ,kBAAAH,OAAAP,QAAAiB,IAAAlB,QAAAA,OAAAkB;AAAAH,SAAAD,QAAAX,KAAAA,MAAAK,OAAAA,OAAAK,KAAAb,OAAA,QAAAe,SAAAC,cAAAH,KAAAb,OAAA,KAAA,QAAAe,WACA,iBACAJ,kBAAAH,OAAAP,QAAAiB,IAAAlB,QAAAA,OAAAkB,GAAAH,SAAAD,QAAAX,KAAAA,MAAAK,OAAAA,OAAAK,KAAAb,OAAA,iBAAAe,SAAAC,cAAAH,KAAAb,OAAA,KAAA,iBAAAe,WACA,uXACAJ,kBAAAH,OAAAP,QAAAiB,IAAAlB,QAAAA,OAAAkB;AAAAH,SAAAD,QAAAX,KAAAA,MAAAK,OAAAA,OAAAK,KAAAb,OAAA,kBAAAe,SAAAC,cAAAH,KAAAb,OAAA,KAAA,kBAAAe,WACA,wHACAJ,kBAAAH,OAAAP,QAAAiB,IAAAlB,QAAAA,OAAAkB,GAAAH,SAAAD,QAAAX,KAAAA,MAAAK,OAAAA,OAAAK,KAAAb,OAAA,cAAAe,SAAAC,cAAAH,KAAAb,OAAA,KAAA,cAAAe,WACA,0PACAJ,kBAAAH,OAAAP,QAAAiB,IAAAlB,QAAAA,OAAAkB;AAAAH,SAAAD,QAAAX,KAAAA,MAAAK,OAAAA,OAAAK,KAAAb,OAAA,mBAAAe,SAAAC,cAAAH,KAAAb,OAAA,KAAA,mBAAAe,WACA,icACAJ,kBAAAH,OAAAP,QAAAiB,IAAAlB,QAAAA,OAAAkB,GAAAH,SAAAD,QAAAX,KAAAA;EAAAK,OAAAA,OAAAK,KAAAb,OAAA,qCAAAe,SAAAC,cAAAH,KAAAb,OAAA,KAAA,qCAAAe,WACA,6NACAJ,kBAAAH,OAAAP,QAAAiB,IAAAlB,QAAAA,OAAAkB,GAAAH,SAAAD,QAAAX,KAAAA,MAAAK,OAAAA,OAAAK,KAAAb,OAAA,0BAAAe,SAAAC,cAAAH,KAAAb,OAAA,KAAA,0BAAAe,WACA,ijBACAJ,kBAAAH,OAAAP,QAAAiB,IAAAlB,QAAAA,OAAAkB;AAAAH,SAAAD,QAAAX,KAAAA,MAAAK,OAAAA,OAAAK,KAAAb,OAAA,+FAAAe,SAAAC,cAAAH,KAAAb,OAAA,KAAA,+FAAAe,WACA,4IACAJ,kBAAAH,OAAAP,QAAAiB,IAAAlB,QAAAA,OAAAkB,GAAAH,SAAAD,QAAAX,KAAAA,MAAAK,OAAAA,OAAAK,KAAAb,OAAA,UAAAe,SAAAC,cAAAH,KAAAb,OAAA,KAAA,UAAAe,WACA,6CACAR,OAAAN,QAAA,KAAAY,KAAAb,OAAAA,QAAAA,OAAAsC;AAAAxB,QAAAW,QAAAC,KAAAC,KAAAC,GAAAF,KAAAG,QAAA,EAAAR,SAAAlB,MAAAA,KAAAA,QACAI,QAAA,IAAAA,UAAAE,QAAAF,QACAE,QAAA,iBCnGAjB,OAAA,8DAAA,cAAA,SAAAK,IACA,MAAAA,IAAAC,SAAA,SAAAC,WAAAC,OAAAC,QAAAC,SAAAC,MACAC,KAAAC,cAAA,EAAA,YACAJ,QAAAG,KAAAE,MAAAL,QAAAF,WAAAE,SAAAE,KAAAA,QACA,IAAAI,QAAAC,OAAAO,QAAAN,OAAA,GAAAC,aAAA,WAAAC,iBAAAP,KAAAO,iBAAAK,cAAAf,QAAAe,aAsEA,OAnEAP,SAAA,4BACAD,OAAAP,QAAAW,YAAAL,OAAAC,OAAAK,KAAAb,QAAAc,QAAAX,KAAAA,QACAK,OAAAR,QAAAA,OAAAY;AAAAL,aAAAC,UAAAE,aAAAF,OAAAK,KAAAb,QAAAc,QAAAX,KAAAA,OAAAK,QACAC,QAAAE,iBAAAJ,QACA,sDACAC,OAAAP,QAAAW,YAAAL,OAAAC,OAAAK,KAAAb,QAAAc,QAAAX,KAAAA,QACAK,OAAAR,QAAAA,OAAAY,WAAAL,aAAAC,UAAAE,aAAAF,OAAAK,KAAAb,QAAAc,QAAAX,KAAAA,OAAAK,QACAC,QAAAE,iBAAAJ,QACA,4MACAI,kBAAAH,OAAAP,QAAAiB,IAAAlB,QAAAA,OAAAkB,GAAAH,SAAAD;AAAAX,KAAAA,MAAAK,OAAAA,OAAAK,KAAAb,OAAA,aAAAe,SAAAC,cAAAH,KAAAb,OAAA,KAAA,aAAAe,WACA,iBACAJ,kBAAAH,OAAAP,QAAAiB,IAAAlB,QAAAA,OAAAkB,GAAAH,SAAAD,QAAAX,KAAAA,MAAAK,OAAAA,OAAAK,KAAAb,OAAA,iBAAAe,SAAAC,cAAAH,KAAAb,OAAA,KAAA,iBAAAe,WACA,iOACAP,OAAAP,QAAAW,YAAAL,OAAAC,OAAAK,KAAAb,QAAAc,QAAAX,KAAAA,QACAK,OAAAR,QAAAA,OAAAY,WAAAL,aAAAC,UAAAE,aAAAF,OAAAK,KAAAb;AAAAc,QAAAX,KAAAA,OAAAK,QACAC,QAAAE,iBAAAJ,QACA,iPACAI,kBAAAH,OAAAP,QAAAiB,IAAAlB,QAAAA,OAAAkB,GAAAH,SAAAD,QAAAX,KAAAA,MAAAK,OAAAA,OAAAK,KAAAb,OAAA,4BAAAe,SAAAC,cAAAH,KAAAb,OAAA,KAAA,4BAAAe,WACA,qNACAJ,kBAAAH,OAAAP,QAAAiB,IAAAlB,QAAAA,OAAAkB;AAAAH,SAAAD,QAAAX,KAAAA,MAAAK,OAAAA,OAAAK,KAAAb,OAAA,aAAAe,SAAAC,cAAAH,KAAAb,OAAA,KAAA,aAAAe,WACA,iBACAJ,kBAAAH,OAAAP,QAAAiB,IAAAlB,QAAAA,OAAAkB,GAAAH,SAAAD,QAAAX,KAAAA,MAAAK,OAAAA,OAAAK,KAAAb,OAAA,iBAAAe,SAAAC,cAAAH,KAAAb,OAAA,KAAA,iBAAAe,WACA,qUACAJ,kBAAAH,OAAAP,QAAAiB,IAAAlB,QAAAA,OAAAkB;AAAAH,SAAAD,QAAAX,KAAAA,MAAAK,OAAAA,OAAAK,KAAAb,OAAA,SAAAe,SAAAC,cAAAH,KAAAb,OAAA,KAAA,SAAAe,WACA,yNACAJ,kBAAAH,OAAAP,QAAAiB,IAAAlB,QAAAA,OAAAkB,GAAAH,SAAAD,QAAAX,KAAAA,MAAAK,OAAAA,OAAAK,KAAAb,OAAA,aAAAe,SAAAC,cAAAH,KAAAb,OAAA,KAAA,aAAAe,WACA,qQACAJ,kBAAAH,OAAAP,QAAAiB,IAAAlB,QAAAA,OAAAkB;AAAAH,SAAAD,QAAAX,KAAAA,MAAAK,OAAAA,OAAAK,KAAAb,OAAA,yLAAAe,SAAAC,cAAAH,KAAAb,OAAA,KAAA,yLAAAe,WACA,sNACAJ,kBAAAH,OAAAP,QAAAiB,IAAAlB,QAAAA,OAAAkB;AAAAH,SAAAD,QAAAX,KAAAA,MAAAK,OAAAA,OAAAK,KAAAb,OAAA,aAAAe,SAAAC,cAAAH,KAAAb,OAAA,KAAA,aAAAe,WACA,iBACAJ,kBAAAH,OAAAP,QAAAiB,IAAAlB,QAAAA,OAAAkB,GAAAH,SAAAD,QAAAX,KAAAA,MAAAK,OAAAA,OAAAK,KAAAb,OAAA,iBAAAe,SAAAC,cAAAH,KAAAb,OAAA,KAAA,iBAAAe,WACA,qUACAJ,kBAAAH,OAAAP,QAAAiB,IAAAlB,QAAAA,OAAAkB;AAAAH,SAAAD,QAAAX,KAAAA,MAAAK,OAAAA,OAAAK,KAAAb,OAAA,aAAAe,SAAAC,cAAAH,KAAAb,OAAA,KAAA,aAAAe,WACA,yNACAJ,kBAAAH,OAAAP,QAAAiB,IAAAlB,QAAAA,OAAAkB,GAAAH,SAAAD,QAAAX,KAAAA,MAAAK,OAAAA,OAAAK,KAAAb,OAAA,eAAAe,SAAAC,cAAAH,KAAAb,OAAA,KAAA,eAAAe,WACA,qQACAJ,kBAAAH,OAAAP,QAAAiB,IAAAlB,QAAAA,OAAAkB;AAAAH,SAAAD,QAAAX,KAAAA,MAAAK,OAAAA,OAAAK,KAAAb,OAAA,sTAAAe,SAAAC,cAAAH,KAAAb,OAAA,KAAA,sTAAAe,WACA,qJACAJ,kBAAAH,OAAAP,QAAAiB,IAAAlB,QAAAA,OAAAkB;AAAAH,SAAAD,QAAAX,KAAAA,MAAAK,OAAAA,OAAAK,KAAAb,OAAA,uBAAAe,SAAAC,cAAAH,KAAAb,OAAA,KAAA,uBAAAe,WACA,mUACAJ,kBAAAH,OAAAP,QAAAiB,IAAAlB,QAAAA,OAAAkB,GAAAH,SAAAD,QAAAX,KAAAA,MAAAK,OAAAA,OAAAK,KAAAb,OAAA,eAAAe,SAAAC,cAAAH,KAAAb,OAAA,KAAA,eAAAe,WACA,4fACAJ,kBAAAH,OAAAP,QAAAiB,IAAAlB,QAAAA,OAAAkB;AAAAH,SAAAD,QAAAX,KAAAA,MAAAK,OAAAA,OAAAK,KAAAb,OAAA,sEAAAe,SAAAC,cAAAH,KAAAb,OAAA,KAAA,sEAAAe,WACA,mSACAJ,kBAAAH,OAAAP,QAAAiB,IAAAlB,QAAAA,OAAAkB,GAAAH,SAAAD,QAAAX,KAAAA,MAAAK,OAAAA,OAAAK,KAAAb,OAAA,gBAAAe,SAAAC,cAAAH,KAAAb,OAAA,KAAA,gBAAAe,WACA,6lBACAJ,kBAAAH,OAAAP,QAAAiB,IAAAlB,QAAAA,OAAAkB;AAAAH,SAAAD,QAAAX,KAAAA,MAAAK,OAAAA,OAAAK,KAAAb,OAAA,wFAAAe,SAAAC,cAAAH,KAAAb,OAAA,KAAA,wFAAAe,WACA,2SACAJ,kBAAAH,OAAAP,QAAAiB,IAAAlB,QAAAA,OAAAkB,GAAAH,SAAAD,QAAAX,KAAAA,MAAAK,OAAAA,OAAAK,KAAAb,OAAA,gBAAAe,SAAAC,cAAAH,KAAAb,OAAA,KAAA,gBAAAe,WACA,6lBACAJ,kBAAAH,OAAAP,QAAAiB,IAAAlB,QAAAA,OAAAkB;AAAAH,SAAAD,QAAAX,KAAAA,MAAAK,OAAAA,OAAAK,KAAAb,OAAA,yKAAAe,SAAAC,cAAAH,KAAAb,OAAA,KAAA,yKAAAe,WACA,qSACAJ,kBAAAH,OAAAP,QAAAiB,IAAAlB,QAAAA,OAAAkB;AAAAH,SAAAD,QAAAX,KAAAA,MAAAK,OAAAA,OAAAK,KAAAb,OAAA,iBAAAe,SAAAC,cAAAH,KAAAb,OAAA,KAAA,iBAAAe,WACA,onBACAJ,kBAAAH,OAAAP,QAAAiB,IAAAlB,QAAAA,OAAAkB;AAAAH,SAAAD,QAAAX,KAAAA,MAAAK,OAAAA,OAAAK,KAAAb,OAAA,qEAAAe,SAAAC,cAAAH,KAAAb,OAAA,KAAA,qEAAAe,WACA,4KACAJ,kBAAAH,OAAAP,QAAAiB,IAAAlB,QAAAA,OAAAkB,GAAAH,SAAAD,QAAAX,KAAAA,MAAAK,OAAAA,OAAAK,KAAAb,OAAA,cAAAe,SAAAC,cAAAH,KAAAb,OAAA,KAAA,cAAAe,WACA,4SACAJ,kBAAAH,OAAAP,QAAAiB,IAAAlB,QAAAA,OAAAkB;AAAAH,SAAAD,QAAAX,KAAAA,MAAAK,OAAAA,OAAAK,KAAAb,OAAA,mBAAAe,SAAAC,cAAAH,KAAAb,OAAA,KAAA,mBAAAe,WACA,ieACAJ,kBAAAH,OAAAP,QAAAiB,IAAAlB,QAAAA,OAAAkB;AAAAH,SAAAD,QAAAX,KAAAA,MAAAK,OAAAA,OAAAK,KAAAb,OAAA,uCAAAe,SAAAC,cAAAH,KAAAb,OAAA,KAAA,uCAAAe,WACA,0SACAJ,kBAAAH,OAAAP,QAAAiB,IAAAlB,QAAAA,OAAAkB,GAAAH,SAAAD,QAAAX,KAAAA,MAAAK,OAAAA,OAAAK,KAAAb,OAAA,0BAAAe,SAAAC,cAAAH,KAAAb,OAAA,KAAA,0BAAAe,WACA,mmBACAJ,kBAAAH,OAAAP,QAAAiB,IAAAlB,QAAAA,OAAAkB;AAAAH,SAAAD,QAAAX,KAAAA,MAAAK,OAAAA,OAAAK,KAAAb,OAAA,gHAAAe,SAAAC,cAAAH,KAAAb,OAAA,KAAA,gHAAAe,WACA,sHCzEAvB,OAAA,6DAAA,cAAA,SAAAK,IACA,MAAAA,IAAAC,SAAA,SAAAC,WAAAC,OAAAC,QAAAC,SAAAC,MAKA,QAAAkB,UAAArB,OAAAG,MAEA,GAAAK,QAAAO,QAAAN,OAAA;AAMA,MALAA,SAAA,0HACAE,kBAAAH,OAAAP,QAAAiB,IAAAlB,QAAAA,OAAAkB,GAAAH,SAAAD,QAAAX,KAAAA,MAAAK,OAAAA,OAAAK,KAAAb,OAAA,sBAAAe,SAAAC,cAAAH,KAAAb,OAAA,KAAA,sBAAAe,WACA,8UACAJ,kBAAAH,OAAAP,QAAAiB,IAAAlB,QAAAA,OAAAkB;AAAAH,SAAAD,QAAAX,KAAAA,MAAAK,OAAAA,OAAAK,KAAAb,OAAA,yGAAAe,SAAAC,cAAAH,KAAAb,OAAA,KAAA,yGAAAe,WACA,yDAXAX,KAAAC,cAAA,EAAA,YACAJ,QAAAG,KAAAE,MAAAL,QAAAF,WAAAE,SAAAE,KAAAA,QACA,IAAAI,QAAAC,OAAAO,QAAAN,OAAA,GAAAO,cAAAf,QAAAe,cAAAL,iBAAAP,KAAAO,iBAAAD,aAAA,WAAAgB,KAAAtB,IAuGA,OA1FAK,SAAA,2BACAD,OAAAP,QAAAW,YAAAL,OAAAC,OAAAK,KAAAb;AAAAc,QAAAX,KAAAA,QACAK,OAAAR,QAAAA,OAAAY,WAAAL,aAAAC,UAAAE,aAAAF,OAAAK,KAAAb,QAAAc,QAAAX,KAAAA,OAAAK,QACAC,QAAAE,iBAAAJ,QACA,qDACAC,OAAAP,QAAAgB,OAAAV,OAAAC,OAAAK,KAAAb,QAAAc,QAAAX,KAAAA,QACAK,OAAAR,QAAAA,OAAAiB,MAAAV,aAAAC,UAAAE,aAAAF,OAAAK,KAAAb,QAAAc,QAAAX,KAAAA,OAAAK,QACAC,QAAAE,iBAAAJ,QACA,gLACAI,kBAAAH,OAAAP,QAAAiB,IAAAlB,QAAAA,OAAAkB;AAAAH,SAAAD,QAAAX,KAAAA,MAAAK,OAAAA,OAAAK,KAAAb,OAAA,aAAAe,SAAAC,cAAAH,KAAAb,OAAA,KAAA,aAAAe,WACA,iBACAJ,kBAAAH,OAAAP,QAAAiB,IAAAlB,QAAAA,OAAAkB,GAAAH,SAAAD,QAAAX,KAAAA,MAAAK,OAAAA,OAAAK,KAAAb,OAAA,iBAAAe,SAAAC,cAAAH,KAAAb,OAAA,KAAA,iBAAAe,WACA,oNACAP,OAAAP,QAAAW,YAAAL,OAAAC,OAAAK,KAAAb,QAAAc,QAAAX,KAAAA,QACAK,OAAAR,QAAAA,OAAAY,WAAAL,aAAAC,UAAAE,aAAAF,OAAAK,KAAAb;AAAAc,QAAAX,KAAAA,OAAAK,QACAC,QAAAE,iBAAAJ,QACA,6NACAI,kBAAAH,OAAAP,QAAAiB,IAAAlB,QAAAA,OAAAkB,GAAAH,SAAAD,QAAAX,KAAAA,MAAAK,OAAAA,OAAAK,KAAAb,OAAA,iCAAAe,SAAAC,cAAAH,KAAAb,OAAA,KAAA,iCAAAe,WACA,iNACAJ,kBAAAH,OAAAP,QAAAiB,IAAAlB,QAAAA,OAAAkB;AAAAH,SAAAD,QAAAX,KAAAA,MAAAK,OAAAA,OAAAK,KAAAb,OAAA,QAAAe,SAAAC,cAAAH,KAAAb,OAAA,KAAA,QAAAe,WACA,iBACAJ,kBAAAH,OAAAP,QAAAiB,IAAAlB,QAAAA,OAAAkB,GAAAH,SAAAD,QAAAX,KAAAA,MAAAK,OAAAA,OAAAK,KAAAb,OAAA,iBAAAe,SAAAC,cAAAH,KAAAb,OAAA,KAAA,iBAAAe,WACA,0XACAJ,kBAAAH,OAAAP,QAAAiB,IAAAlB,QAAAA,OAAAkB;AAAAH,SAAAD,QAAAX,KAAAA,MAAAK,OAAAA,OAAAK,KAAAb,OAAA,qBAAAe,SAAAC,cAAAH,KAAAb,OAAA,KAAA,qBAAAe,WACA,8OACAJ,kBAAAH,OAAAP,QAAAiB,IAAAlB,QAAAA,OAAAkB,GAAAH,SAAAD,QAAAX,KAAAA,MAAAK,OAAAA,OAAAK,KAAAb,OAAA,UAAAe,SAAAC,cAAAH,KAAAb,OAAA,KAAA,UAAAe,WACA,iBACAJ,kBAAAH,OAAAP,QAAAiB,IAAAlB,QAAAA,OAAAkB,GAAAH,SAAAD,QAAAX,KAAAA,MAAAK,OAAAA,OAAAK,KAAAb,OAAA,iBAAAe,SAAAC,cAAAH,KAAAb,OAAA,KAAA,iBAAAe,WACA,wgBACAJ,kBAAAH,OAAAP,QAAAiB,IAAAlB,QAAAA,OAAAkB;AAAAH,SAAAD,QAAAX,KAAAA,MAAAK,OAAAA,OAAAK,KAAAb,OAAA,kEAAAe,SAAAC,cAAAH,KAAAb,OAAA,KAAA,kEAAAe,WACA,iPACAJ,kBAAAH,OAAAP,QAAAiB,IAAAlB,QAAAA,OAAAkB,GAAAH,SAAAD,QAAAX,KAAAA,MAAAK,OAAAA,OAAAK,KAAAb,OAAA,gBAAAe,SAAAC,cAAAH,KAAAb,OAAA,KAAA,gBAAAe,WACA,2gBACAJ,kBAAAH,OAAAP,QAAAiB,IAAAlB,QAAAA,OAAAkB;AAAAH,SAAAD,QAAAX,KAAAA,MAAAK,OAAAA,OAAAK,KAAAb,OAAA,qQAAAe,SAAAC,cAAAH,KAAAb,OAAA,KAAA,qQAAAe,WACA;AACAR,OAAAN,QAAA,GAAAY,KAAAb,OAAAA,QAAAA,OAAAuC,cAAAzB,QAAAW,QAAAC,KAAAC,KAAAC,GAAAF,KAAAG,QAAA,EAAAR,SAAAlB,MAAAA,KAAAA,QACAI,QAAA,IAAAA,UAAAE,QAAAF,QACAE,QAAA,uLACAE,kBAAAH,OAAAP,QAAAiB,IAAAlB,QAAAA,OAAAkB,GAAAH,SAAAD,QAAAX,KAAAA,MAAAK,OAAAA,OAAAK,KAAAb,OAAA,aAAAe,SAAAC,cAAAH,KAAAb,OAAA,KAAA,aAAAe,WACA,uUACAJ,kBAAAH,OAAAP,QAAAiB,IAAAlB,QAAAA,OAAAkB;AAAAH,SAAAD,QAAAX,KAAAA,MAAAK,OAAAA,OAAAK,KAAAb,OAAA,gOAAAe,SAAAC,cAAAH,KAAAb,OAAA,KAAA,gOAAAe,WACA,yHACAJ,kBAAAH,OAAAP,QAAAiB,IAAAlB,QAAAA,OAAAkB;AAAAH,SAAAD,QAAAX,KAAAA,MAAAK,OAAAA,OAAAK,KAAAb,OAAA,YAAAe,SAAAC,cAAAH,KAAAb,OAAA,KAAA,YAAAe,WACA,iQACAJ,kBAAAH,OAAAP,QAAAiB,IAAAlB,QAAAA,OAAAkB,GAAAH,SAAAD,QAAAX,KAAAA,MAAAK,OAAAA,OAAAK,KAAAb,OAAA,mBAAAe,SAAAC,cAAAH,KAAAb,OAAA,KAAA,mBAAAe,WACA,wdACAJ,kBAAAH,OAAAP,QAAAiB,IAAAlB,QAAAA,OAAAkB;AAAAH,SAAAD,QAAAX,KAAAA,MAAAK,OAAAA,OAAAK,KAAAb,OAAA,SAAAe,SAAAC,cAAAH,KAAAb,OAAA,KAAA,SAAAe,WACA,iBACAJ,kBAAAH,OAAAP,QAAAiB,IAAAlB,QAAAA,OAAAkB,GAAAH,SAAAD,QAAAX,KAAAA,MAAAK,OAAAA,OAAAK,KAAAb,OAAA,iBAAAe,SAAAC,cAAAH,KAAAb,OAAA,KAAA,iBAAAe,WACA,kdACAJ,kBAAAH,OAAAP,QAAAiB,IAAAlB,QAAAA,OAAAkB;AAAAH,SAAAD,QAAAX,KAAAA,MAAAK,OAAAA,OAAAK,KAAAb,OAAA,+CAAAe,SAAAC,cAAAH,KAAAb,OAAA,KAAA,+CAAAe,WACA,yRACAJ,kBAAAH,OAAAP,QAAAiB,IAAAlB,QAAAA,OAAAkB,GAAAH,SAAAD,QAAAX,KAAAA,MAAAK,OAAAA,OAAAK,KAAAb,OAAA,mBAAAe,SAAAC,cAAAH,KAAAb,OAAA,KAAA,mBAAAe,WACA,qjBACAJ,kBAAAH,OAAAP,QAAAiB,IAAAlB,QAAAA,OAAAkB;AAAAH,SAAAD,QAAAX,KAAAA,MAAAK,OAAAA,OAAAK,KAAAb,OAAA,2FAAAe,SAAAC,cAAAH,KAAAb,OAAA,KAAA,2FAAAe,WACA,gJACAJ,kBAAAH,OAAAP,QAAAiB,IAAAlB,QAAAA,OAAAkB,GAAAH,SAAAD,QAAAX,KAAAA,MAAAK,OAAAA,OAAAK,KAAAb,OAAA,WAAAe,SAAAC,cAAAH,KAAAb,OAAA,KAAA,WAAAe,WACA,yTACAJ,kBAAAH,OAAAP,QAAAiB,IAAAlB,QAAAA,OAAAkB;AAAAH,SAAAD,QAAAX,KAAAA,MAAAK,OAAAA,OAAAK,KAAAb,OAAA,UAAAe,SAAAC,cAAAH,KAAAb,OAAA,KAAA,UAAAe,WACA,oiBACAJ,kBAAAH,OAAAP,QAAAiB,IAAAlB,QAAAA,OAAAkB;AAAAH,SAAAD,QAAAX,KAAAA,MAAAK,OAAAA,OAAAK,KAAAb,OAAA,2IAAAe,SAAAC,cAAAH,KAAAb,OAAA,KAAA,2IAAAe,WACA,4JACAJ,kBAAAH,OAAAP,QAAAiB,IAAAlB,QAAAA,OAAAkB,GAAAH,SAAAD,QAAAX,KAAAA,MAAAK,OAAAA,OAAAK,KAAAb,OAAA,uBAAAe,SAAAC,cAAAH,KAAAb,OAAA,KAAA,uBAAAe,WACA,iVACAJ,kBAAAH,OAAAP,QAAAiB,IAAAlB,QAAAA,OAAAkB;AAAAH,SAAAD,QAAAX,KAAAA,MAAAK,OAAAA,OAAAK,KAAAb,OAAA,eAAAe,SAAAC,cAAAH,KAAAb,OAAA,KAAA,eAAAe,WACA,2dACAJ,kBAAAH,OAAAP,QAAAiB,IAAAlB,QAAAA,OAAAkB,GAAAH;AAAAD,QAAAX,KAAAA,MAAAK,OAAAA,OAAAK,KAAAb,OAAA,sEAAAe,SAAAC,cAAAH,KAAAb,OAAA,KAAA,sEAAAe,WACA,4RACAJ,kBAAAH,OAAAP,QAAAiB,IAAAlB,QAAAA,OAAAkB,GAAAH,SAAAD,QAAAX,KAAAA,MAAAK,OAAAA,OAAAK,KAAAb,OAAA,gBAAAe,SAAAC,cAAAH,KAAAb,OAAA,KAAA,gBAAAe,WACA,qjBACAJ,kBAAAH,OAAAP,QAAAiB,IAAAlB,QAAAA,OAAAkB;AAAAH,SAAAD,QAAAX,KAAAA,MAAAK,OAAAA,OAAAK,KAAAb,OAAA,wFAAAe,SAAAC,cAAAH,KAAAb,OAAA,KAAA,wFAAAe,WACA,oSACAJ,kBAAAH,OAAAP,QAAAiB,IAAAlB,QAAAA,OAAAkB,GAAAH,SAAAD,QAAAX,KAAAA,MAAAK,OAAAA,OAAAK,KAAAb,OAAA,gBAAAe,SAAAC,cAAAH,KAAAb,OAAA,KAAA,gBAAAe,WACA,sjBACAJ,kBAAAH,OAAAP,QAAAiB,IAAAlB,QAAAA,OAAAkB;AAAAH,SAAAD,QAAAX,KAAAA,MAAAK,OAAAA,OAAAK,KAAAb,OAAA,yKAAAe,SAAAC,cAAAH,KAAAb,OAAA,KAAA,yKAAAe,WACA,8RACAJ,kBAAAH,OAAAP,QAAAiB,IAAAlB,QAAAA,OAAAkB;AAAAH,SAAAD,QAAAX,KAAAA,MAAAK,OAAAA,OAAAK,KAAAb,OAAA,iBAAAe,SAAAC,cAAAH,KAAAb,OAAA,KAAA,iBAAAe,WACA,ykBACAJ,kBAAAH,OAAAP,QAAAiB,IAAAlB,QAAAA,OAAAkB;AAAAH,SAAAD,QAAAX,KAAAA,MAAAK,OAAAA,OAAAK,KAAAb,OAAA,qEAAAe,SAAAC,cAAAH,KAAAb,OAAA,KAAA,qEAAAe,WACA,uJACAJ,kBAAAH,OAAAP,QAAAiB,IAAAlB,QAAAA,OAAAkB,GAAAH,SAAAD,QAAAX,KAAAA,MAAAK,OAAAA,OAAAK,KAAAb,OAAA,cAAAe,SAAAC,cAAAH,KAAAb,OAAA,KAAA,cAAAe,WACA,6RACAJ,kBAAAH,OAAAP,QAAAiB,IAAAlB,QAAAA,OAAAkB;AAAAH,SAAAD,QAAAX,KAAAA,MAAAK,OAAAA,OAAAK,KAAAb,OAAA,mBAAAe,SAAAC,cAAAH,KAAAb,OAAA,KAAA,mBAAAe,WACA,icACAJ,kBAAAH,OAAAP,QAAAiB,IAAAlB,QAAAA,OAAAkB,GAAAH,SAAAD,QAAAX,KAAAA;EAAAK,OAAAA,OAAAK,KAAAb,OAAA,qCAAAe,SAAAC,cAAAH,KAAAb,OAAA,KAAA,qCAAAe,WACA,mSACAJ,kBAAAH,OAAAP,QAAAiB,IAAAlB,QAAAA,OAAAkB,GAAAH,SAAAD,QAAAX,KAAAA,MAAAK,OAAAA,OAAAK,KAAAb,OAAA,0BAAAe,SAAAC,cAAAH,KAAAb,OAAA,KAAA,0BAAAe,WACA,4jBACAJ,kBAAAH,OAAAP,QAAAiB,IAAAlB,QAAAA,OAAAkB;AAAAH,SAAAD,QAAAX,KAAAA,MAAAK,OAAAA,OAAAK,KAAAb,OAAA,8GAAAe,SAAAC,cAAAH,KAAAb,OAAA,KAAA,8GAAAe,WACA,yFC1GAvB,OAAA,6DAAA,cAAA,SAAAK,IACA,MAAAA,IAAAC,SAAA,SAAAC,WAAAC,OAAAC,QAAAC,SAAAC,MACAC,KAAAC,cAAA,EAAA,YACAJ,QAAAG,KAAAE,MAAAL,QAAAF,WAAAE,SAAAE,KAAAA;AACA,GAAAI,QAAAC,OAAAO,QAAAN,OAAA,GAAAC,aAAA,WAAAC,iBAAAP,KAAAO,iBAAAK,cAAAf,QAAAe,aA8EA,OA3EAP,SAAA,2BACAD,OAAAP,QAAAW,YAAAL,OAAAC,OAAAK,KAAAb,QAAAc,QAAAX,KAAAA,QACAK,OAAAR,QAAAA,OAAAY,WAAAL,aAAAC,UAAAE,aAAAF,OAAAK,KAAAb,QAAAc,QAAAX,KAAAA,OAAAK,QACAC,QAAAE,iBAAAJ,QACA,uDACAC,OAAAP,QAAAmB,OAAAb,OAAAC,OAAAK,KAAAb,QAAAc,QAAAX,KAAAA,QACAK,OAAAR,QAAAA,OAAAoB,MAAAb,aAAAC,UAAAE,aAAAF,OAAAK,KAAAb,QAAAc,QAAAX,KAAAA,OAAAK,QACAC,QAAAE,iBAAAJ,QACA,4LACAI,kBAAAH,OAAAP,QAAAiB,IAAAlB,QAAAA,OAAAkB;AAAAH,SAAAD,QAAAX,KAAAA,MAAAK,OAAAA,OAAAK,KAAAb,OAAA,aAAAe,SAAAC,cAAAH,KAAAb,OAAA,KAAA,aAAAe,WACA,iBACAJ,kBAAAH,OAAAP,QAAAiB,IAAAlB,QAAAA,OAAAkB,GAAAH,SAAAD,QAAAX,KAAAA,MAAAK,OAAAA,OAAAK,KAAAb,OAAA,iBAAAe,SAAAC,cAAAH,KAAAb,OAAA,KAAA,iBAAAe,WACA,wNACAP,OAAAP,QAAAW,YAAAL,OAAAC,OAAAK,KAAAb,QAAAc,QAAAX,KAAAA,QACAK,OAAAR,QAAAA,OAAAY,WAAAL,aAAAC,UAAAE,aAAAF,OAAAK,KAAAb;AAAAc,QAAAX,KAAAA,OAAAK,QACAC,QAAAE,iBAAAJ,QACA,6NACAI,kBAAAH,OAAAP,QAAAiB,IAAAlB,QAAAA,OAAAkB,GAAAH,SAAAD,QAAAX,KAAAA,MAAAK,OAAAA,OAAAK,KAAAb,OAAA,wCAAAe,SAAAC,cAAAH,KAAAb,OAAA,KAAA,wCAAAe,WACA,2NACAJ,kBAAAH,OAAAP,QAAAiB,IAAAlB,QAAAA,OAAAkB;AAAAH,SAAAD,QAAAX,KAAAA,MAAAK,OAAAA,OAAAK,KAAAb,OAAA,YAAAe,SAAAC,cAAAH,KAAAb,OAAA,KAAA,YAAAe,WACA,iBACAJ,kBAAAH,OAAAP,QAAAiB,IAAAlB,QAAAA,OAAAkB,GAAAH,SAAAD,QAAAX,KAAAA,MAAAK,OAAAA,OAAAK,KAAAb,OAAA,iBAAAe,SAAAC,cAAAH,KAAAb,OAAA,KAAA,iBAAAe,WACA,kXACAJ,kBAAAH,OAAAP,QAAAiB,IAAAlB,QAAAA,OAAAkB;AAAAH,SAAAD,QAAAX,KAAAA,MAAAK,OAAAA,OAAAK,KAAAb,OAAA,iBAAAe,SAAAC,cAAAH,KAAAb,OAAA,KAAA,iBAAAe,WACA,mOACAJ,kBAAAH,OAAAP,QAAAiB,IAAAlB,QAAAA,OAAAkB,GAAAH,SAAAD,QAAAX,KAAAA,MAAAK,OAAAA,OAAAK,KAAAb,OAAA,aAAAe,SAAAC,cAAAH,KAAAb,OAAA,KAAA,aAAAe,WACA,4XACAJ,kBAAAH,OAAAP,QAAAiB,IAAAlB,QAAAA,OAAAkB;AAAAH,SAAAD,QAAAX,KAAAA,MAAAK,OAAAA,OAAAK,KAAAb,OAAA,8DAAAe,SAAAC,cAAAH,KAAAb,OAAA,KAAA,8DAAAe,WACA,oPACAJ,kBAAAH,OAAAP,QAAAiB,IAAAlB,QAAAA,OAAAkB,GAAAH,SAAAD,QAAAX,KAAAA,MAAAK,OAAAA,OAAAK,KAAAb,OAAA,WAAAe,SAAAC,cAAAH,KAAAb,OAAA,KAAA,WAAAe,WACA,6eACAJ,kBAAAH,OAAAP,QAAAiB,IAAAlB,QAAAA,OAAAkB;AAAAH,SAAAD,QAAAX,KAAAA,MAAAK,OAAAA,OAAAK,KAAAb,OAAA,+DAAAe,SAAAC,cAAAH,KAAAb,OAAA,KAAA,+DAAAe,WACA,8OACAJ,kBAAAH,OAAAP,QAAAiB,IAAAlB,QAAAA,OAAAkB,GAAAH,SAAAD,QAAAX,KAAAA,MAAAK,OAAAA,OAAAK,KAAAb,OAAA,QAAAe,SAAAC,cAAAH,KAAAb,OAAA,KAAA,QAAAe,WACA,ueACAJ,kBAAAH,OAAAP,QAAAiB,IAAAlB,QAAAA,OAAAkB;AAAAH,SAAAD,QAAAX,KAAAA,MAAAK,OAAAA,OAAAK,KAAAb,OAAA,4CAAAe,SAAAC,cAAAH,KAAAb,OAAA,KAAA,4CAAAe,WACA,uHACAJ,kBAAAH,OAAAP,QAAAiB,IAAAlB,QAAAA,OAAAkB,GAAAH,SAAAD,QAAAX,KAAAA,MAAAK,OAAAA,OAAAK,KAAAb,OAAA,UAAAe,SAAAC,cAAAH,KAAAb,OAAA,KAAA,UAAAe,WACA,iJACAJ,kBAAAH,OAAAP,QAAAiB,IAAAlB,QAAAA,OAAAkB;AAAAH,SAAAD,QAAAX,KAAAA,MAAAK,OAAAA,OAAAK,KAAAb,OAAA,aAAAe,SAAAC,cAAAH,KAAAb,OAAA,KAAA,aAAAe,WACA,2FACAJ,kBAAAH,OAAAP,QAAAiB,IAAAlB,QAAAA,OAAAkB,GAAAH,SAAAD,QAAAX,KAAAA,MAAAK,OAAAA,OAAAK,KAAAb,OAAA,QAAAe,SAAAC,cAAAH,KAAAb,OAAA,KAAA,QAAAe,WACA,wPACAJ,kBAAAH,OAAAP,QAAAiB,IAAAlB,QAAAA,OAAAkB;AAAAH,SAAAD,QAAAX,KAAAA,MAAAK,OAAAA,OAAAK,KAAAb,OAAA,mFAAAe,SAAAC,cAAAH,KAAAb,OAAA,KAAA,mFAAAe,WACA,qWACAJ,kBAAAH,OAAAP,QAAAiB,IAAAlB,QAAAA,OAAAkB;AAAAH,SAAAD,QAAAX,KAAAA,MAAAK,OAAAA,OAAAK,KAAAb,OAAA,mBAAAe,SAAAC,cAAAH,KAAAb,OAAA,KAAA,mBAAAe,WACA,0IACAJ,kBAAAH,OAAAP,QAAAiB,IAAAlB,QAAAA,OAAAkB,GAAAH,SAAAD,QAAAX,KAAAA,MAAAK,OAAAA,OAAAK,KAAAb,OAAA,uBAAAe,SAAAC,cAAAH,KAAAb,OAAA,KAAA,uBAAAe,WACA,yWACAJ,kBAAAH,OAAAP,QAAAiB,IAAAlB,QAAAA,OAAAkB;AAAAH,SAAAD,QAAAX,KAAAA,MAAAK,OAAAA,OAAAK,KAAAb,OAAA,eAAAe,SAAAC,cAAAH,KAAAb,OAAA,KAAA,eAAAe,WACA,2dACAJ,kBAAAH,OAAAP,QAAAiB,IAAAlB,QAAAA,OAAAkB,GAAAH;AAAAD,QAAAX,KAAAA,MAAAK,OAAAA,OAAAK,KAAAb,OAAA,sEAAAe,SAAAC,cAAAH,KAAAb,OAAA,KAAA,sEAAAe,WACA,wSACAJ,kBAAAH,OAAAP,QAAAiB,IAAAlB,QAAAA,OAAAkB,GAAAH,SAAAD,QAAAX,KAAAA,MAAAK,OAAAA,OAAAK,KAAAb,OAAA,gBAAAe,SAAAC,cAAAH,KAAAb,OAAA,KAAA,gBAAAe,WACA,qjBACAJ,kBAAAH,OAAAP,QAAAiB,IAAAlB,QAAAA,OAAAkB;AAAAH,SAAAD,QAAAX,KAAAA,MAAAK,OAAAA,OAAAK,KAAAb,OAAA,wFAAAe,SAAAC,cAAAH,KAAAb,OAAA,KAAA,wFAAAe,WACA,gTACAJ,kBAAAH,OAAAP,QAAAiB,IAAAlB,QAAAA,OAAAkB,GAAAH,SAAAD,QAAAX,KAAAA;AAAAK,OAAAA,OAAAK,KAAAb,OAAA,gBAAAe,SAAAC,cAAAH,KAAAb,OAAA,KAAA,gBAAAe,WACA,sjBACAJ,kBAAAH,OAAAP,QAAAiB,IAAAlB,QAAAA,OAAAkB;AAAAH,SAAAD,QAAAX,KAAAA,MAAAK,OAAAA,OAAAK,KAAAb,OAAA,yKAAAe,SAAAC,cAAAH,KAAAb,OAAA,KAAA,yKAAAe,WACA,0SACAJ,kBAAAH,OAAAP,QAAAiB,IAAAlB,QAAAA,OAAAkB;AAAAH,SAAAD,QAAAX,KAAAA,MAAAK,OAAAA,OAAAK,KAAAb,OAAA,iBAAAe,SAAAC,cAAAH,KAAAb,OAAA,KAAA,iBAAAe,WACA,ykBACAJ,kBAAAH,OAAAP,QAAAiB,IAAAlB,QAAAA,OAAAkB;AAAAH,SAAAD,QAAAX,KAAAA,MAAAK,OAAAA,OAAAK,KAAAb,OAAA,qEAAAe,SAAAC,cAAAH,KAAAb,OAAA,KAAA,qEAAAe,WACA,uJACAJ,kBAAAH,OAAAP,QAAAiB,IAAAlB,QAAAA,OAAAkB,GAAAH,SAAAD,QAAAX,KAAAA,MAAAK,OAAAA,OAAAK,KAAAb,OAAA,cAAAe,SAAAC,cAAAH,KAAAb,OAAA,KAAA,cAAAe,WACA,ySACAJ,kBAAAH,OAAAP,QAAAiB,IAAAlB,QAAAA,OAAAkB;AAAAH,SAAAD,QAAAX,KAAAA,MAAAK,OAAAA,OAAAK,KAAAb,OAAA,mBAAAe,SAAAC,cAAAH,KAAAb,OAAA,KAAA,mBAAAe,WACA,icACAJ,kBAAAH,OAAAP,QAAAiB,IAAAlB,QAAAA,OAAAkB,GAAAH,SAAAD,QAAAX,KAAAA;EAAAK,OAAAA,OAAAK,KAAAb,OAAA,kCAAAe,SAAAC,cAAAH,KAAAb,OAAA,KAAA,kCAAAe,WACA,+SACAJ,kBAAAH,OAAAP,QAAAiB,IAAAlB,QAAAA,OAAAkB,GAAAH,SAAAD,QAAAX,KAAAA,MAAAK,OAAAA,OAAAK,KAAAb,OAAA,0BAAAe,SAAAC,cAAAH,KAAAb,OAAA,KAAA,0BAAAe,WACA,4jBACAJ,kBAAAH,OAAAP,QAAAiB,IAAAlB,QAAAA,OAAAkB;AAAAH,SAAAD,QAAAX,KAAAA,MAAAK,OAAAA,OAAAK,KAAAb,OAAA,2GAAAe,SAAAC,cAAAH,KAAAb,OAAA,KAAA,2GAAAe,WACA,yFCjFAvB,OAAA,oEAAA,cAAA,SAAAK,IACA,MAAAA,IAAAC,SAAA,SAAAC,WAAAC,OAAAC,QAAAC,SAAAC,MACAC,KAAAC,cAAA,EAAA,YACAJ,QAAAG,KAAAE,MAAAL,QAAAF,WAAAE,SAAAE,KAAAA;AACA,GAAAI,QAAAC,OAAAC,OAAA,GAAAC,aAAA,WAAAC,iBAAAP,KAAAO,gBAgBA,OAbAF,SAAA,6KACAD,OAAAP,QAAAW,YAAAL,OAAAC,OAAAK,KAAAb,QAAAc,QAAAX,KAAAA,QACAK,OAAAR,QAAAA,OAAAY,WAAAL,aAAAC,UAAAE,aAAAF,OAAAK,KAAAb,QAAAc,QAAAX,KAAAA,OAAAK,QACAC,QAAAE,iBAAAJ,QACA,2BACAC,OAAAP,QAAAW,YAAAL,OAAAC,OAAAK,KAAAb,QAAAc,QAAAX,KAAAA,QACAK,OAAAR,QAAAA,OAAAY,WAAAL,aAAAC,UAAAE,aAAAF,OAAAK,KAAAb;AAAAc,QAAAX,KAAAA,OAAAK,QACAC,QAAAE,iBAAAJ,QACA,wIACAC,OAAAP,QAAAuC,OAAAjC,OAAAC,OAAAK,KAAAb,QAAAc,QAAAX,KAAAA,QACAK,OAAAR,QAAAA,OAAAwC,MAAAjC,aAAAC,UAAAE,aAAAF,OAAAK,KAAAb,QAAAc,QAAAX,KAAAA,OAAAK,QACAC,QAAAE,iBAAAJ,QACA,yOCnBAf,OAAA,iEAAA,cAAA,SAAAK;AACA,MAAAA,IAAAC,SAAA,SAAAC,WAAAC,OAAAC,QAAAC,SAAAC,MACAC,KAAAC,cAAA,EAAA,YACAJ,QAAAG,KAAAE,MAAAL,QAAAF,WAAAE,SAAAE,KAAAA,QACA,IAAAI,QAAAC,OAAAO,QAAAN,OAAA,GAAAO,cAAAf,QAAAe,cAAAL,iBAAAP,KAAAO,iBAAAD,aAAA,UA4BA,OAzBAD,SAAA,6DACAE,kBAAAH,OAAAP,QAAAiB,IAAAlB,QAAAA,OAAAkB,GAAAH,SAAAD,QAAAX,KAAAA,MAAAK,OAAAA,OAAAK,KAAAb,OAAA,eAAAe,SAAAC,cAAAH,KAAAb,OAAA,KAAA,eAAAe,WACA,MACAP,OAAAP,QAAAL,OAAAW,OAAAC,OAAAK,KAAAb,QAAAc,QAAAX,KAAAA,QACAK,OAAAR,QAAAA,OAAAJ;AAAAW,aAAAC,UAAAE,aAAAF,OAAAK,KAAAb,QAAAc,QAAAX,KAAAA,OAAAK,QACAC,QAAAE,iBAAAJ,QACA,oMACAI,kBAAAH,OAAAP,QAAAiB,IAAAlB,QAAAA,OAAAkB,GAAAH,SAAAD,QAAAX,KAAAA,MAAAK,OAAAA,OAAAK,KAAAb,OAAA,QAAAe,SAAAC,cAAAH,KAAAb,OAAA,KAAA,QAAAe,WACA,iBACAJ,kBAAAH,OAAAP,QAAAiB,IAAAlB,QAAAA,OAAAkB,GAAAH,SAAAD,QAAAX,KAAAA,MAAAK,OAAAA,OAAAK,KAAAb,OAAA,iBAAAe,SAAAC,cAAAH,KAAAb,OAAA,KAAA,iBAAAe,WACA,mLACAJ,kBAAAH,OAAAP,QAAAiB,IAAAlB,QAAAA,OAAAkB;AAAAH,SAAAD,QAAAX,KAAAA,MAAAK,OAAAA,OAAAK,KAAAb,OAAA,SAAAe,SAAAC,cAAAH,KAAAb,OAAA,KAAA,SAAAe,WACA,wDACAJ,kBAAAH,OAAAP,QAAAiB,IAAAlB,QAAAA,OAAAkB,GAAAH,SAAAD,QAAAX,KAAAA,MAAAK,OAAAA,OAAAK,KAAAb,OAAA,YAAAe,SAAAC,cAAAH,KAAAb,OAAA,KAAA,YAAAe,WACA,sDACAJ,kBAAAH,OAAAP,QAAAiB,IAAAlB,QAAAA,OAAAkB,GAAAH,SAAAD,QAAAX,KAAAA,MAAAK,OAAAA,OAAAK,KAAAb,OAAA,UAAAe,SAAAC,cAAAH,KAAAb,OAAA,KAAA,UAAAe,WACA,qDACAJ,kBAAAH,OAAAP,QAAAiB,IAAAlB,QAAAA,OAAAkB;AAAAH,SAAAD,QAAAX,KAAAA,MAAAK,OAAAA,OAAAK,KAAAb,OAAA,SAAAe,SAAAC,cAAAH,KAAAb,OAAA,KAAA,SAAAe,WACA,8DACAJ,kBAAAH,OAAAP,QAAAiB,IAAAlB,QAAAA,OAAAkB,GAAAH,SAAAD,QAAAX,KAAAA,MAAAK,OAAAA,OAAAK,KAAAb,OAAA,mBAAAe,SAAAC,cAAAH,KAAAb,OAAA,KAAA,mBAAAe,WACA,oDACAJ,kBAAAH,OAAAP,QAAAiB,IAAAlB,QAAAA,OAAAkB,GAAAH,SAAAD,QAAAX,KAAAA,MAAAK,OAAAA,OAAAK,KAAAb,OAAA,QAAAe,SAAAC,cAAAH,KAAAb,OAAA,KAAA,QAAAe,WACA,wPACAJ,kBAAAH,OAAAP,QAAAiB,IAAAlB,QAAAA,OAAAkB;AAAAH,SAAAD,QAAAX,KAAAA,MAAAK,OAAAA,OAAAK,KAAAb,OAAA,qDAAAe,SAAAC,cAAAH,KAAAb,OAAA,KAAA,qDAAAe,WACA,mEAKAvB,OAAA,iDCpCA,uDACA,sDACA,0DACA,sDACA,mDACA,yDACA,6DACA,4DACA,4DACA,mEACA,iEAEA,SACAiD,SACAC,QACAC,YACAC,QACAC,KACAC,UACAC,cACAC,aACAC,aACAC,mBACAC;AAEA,YAMA,QACAC,SAAAX,SACAC,QAAAA,QACAW,QAAAT,QACAC,KAAAA,KACAS,YAAAX,YACAY,YACAC,KAAAV,UACAM,SAAAL,cACAL,QAAAM,aACAK,QAAAJ,aACAQ,cAAAP,mBACAI,YAAAH,qBCvBA3D,OAAA,4CACA,SACA,SACA,iDACA,SAAAkE,EAAAC,EAAAC,WACA,YAEA,IAAAC,cAAAD,UAAAf,KAUAiB,SAAA,SAAAC,UAAAC,eA2BA,QAAAC,mBACA,GAAAC,SAEAC,WAAA,WACA,GAAAC,SAAAC,QAAAC,OACAF,QAAAG,OAAA,GAAA,IAAAH,QAAAG,UACAC,aAAAN,SACAA,QAAAO,WAAA;AACAC,SAAAN,UACA,MAKAC,SAAAM,MAAAR,YACAS,SAAA,SAAAC,MAAAV,YAQA,QAAAW,QAAAC,OACAC,mBACAC,SAAAC,QAAAC,OAAAtB,aAAAkB,QACAK,kBAQA,QAAAJ,oBACAK,OAAAlF,KAAA,eACAkF,OAAAC,WAAA,WASA,QAAAF,mBAEAC,OAAAlF,KAAA,cACAkF,OAAAC,WAAA,UAEAD,OAAAC,YACAC,OAAA,KACApD,SAAA,SAAAqD,MAAAC,IACA/B,EAAA+B,GAAAtD,UAAAuD,SAAA,aAEAC,WAAA,SAAAH,MAAAC,IACA/B,EAAA+B,GAAAE,YAAAC,YAAA,aAEAC,KAAA,WACAnC,EAAAtD,MAAA0F,QAAA,qBAAApC,EAAA,iBApFA,GAAA2B,QAAA3B,EAAA,uCACAW,QAAAX,EAAA,gBACAuB,SAAAvB,EAAA,YAAA2B,QAEAX,SAAA,SAAAN;AACA,MAAAL,WAAAK,SAAA2B,KAAA,SAAAhB,OACA,MAAAA,QAAAA,MAAAR,OAGAP,cAAAL,EAAAqC,MAAAjB,MAAA,QAAAgB,KAAA,SAAAxE,YACAuD,OAAAnB,EAAAsC,IAAAlB,MAAA,SAAAlC,MAEA,MADAA,MAAAtB,WAAAoC,EAAAuC,QAAA3E,WAAAsB,KAAAvB,MAAAC,WAAAsB,KAAAvB,QACAuB,UALAiC,WAWAJ,YAAAqB,KAAA9B,iBAyEA,OAAAH,YC9GAtE,OAAA,gDACA,SACA,KACA,kBACA,iDAEA,SAAAkE,EAAA+B,GAAAU,WAAAvC,WACA,YAYA,IAAAwC,UAAA,SAAAC,SAAAC,OA0FA,QAAAC,kBACAC,MAAAC,GAAA,kBAAA,SAAAC,EAAAC,SACA,GAAA,UAAAD,EAAAE,UAAA,CACA,GAAAC,WAAAnD,EAAA;AACAiD,WAAA,EACAE,UAAAjB,YAAA,YAEAiB,UAAAnB,SAAA,eAIAc,MAAAM,iBApGA,GAEAN,OAFAO,WAAArD,EAAA,uBACA5D,SAAA8D,UAAAL,WAAA8C,UAMAW,KAAA,WACA,GAAAC,YACAC,eACAtD,UAAAA,UAAAL,WAEAwD,YAAAI,SAAA,UAAAC,OAAAtB,QAAA,sBACAU,MAAA9C,EAAA5D,SAAAwG,QAAAe,SAAAN,YAAAxB,OAAA,UAGAE,GAAA6B,kBAAAd,OAGAS,WAAA,GAAAd,YAAAK,MAAAF,MAAAY,eACAD,WAAAM,OAEAhB,iBAEAC,MAAAV,QAAA,sBAOA0B,QAAA,WACA,MAAAhB,QAOAiB,OAAA,WACA,MAAA,SAAAjB,MAAA9G,IAAA,YAOAgI,OAAA,SAAAC,IACAnB,MAAAC,GAAA,oBAAA,SAAAC;AACAA,EAAAkB,kBACAD,QASAE,QAAA,SAAAF,IACAnB,MAAAC,GAAA,qBAAA,SAAAC,GACAA,EAAAkB,kBACAD,QAOAG,QAAA,WACAtB,MAAAuB,UAMAC,OAAA,WACAjB,WAAAI,SAAA,UAAAc,IAAAzB,OAAAY,OAAAtB,QAAA,sBACA2B,SACAjB,MAAAY,OAAAtB,QAAA,sBAEAU,MAAA0B,OAAApC,QAAA,qBAsBA,QACAkB,KAAAA,KACAQ,QAAAA,QACAC,OAAAA,OACAC,OAAAA,OACAG,QAAAA,QACAC,QAAAA,QACAE,OAAAA,QAIA,OAAA5B,YCtIA5G,OAAA,+CACA,SACA,gDACA,SAAAkE,EAAAyE,cACA,YAaA,SAAA5E,YAAAwD,WAAAjH,SAAAwG,MAAAqB;AACA,GAAAvB,UAAA,IACAW,YAAAqB,KAAA,qBAAA3B,GAAA,QAAA,SAAAC,GACAA,EAAA2B,gBACA,IAAAC,MAAA5E,EAAAtD,KACAsD,GAAAtD,MAAAmI,SAAAC,iBAEAF,KAAAG,OAEA,OAAArC,UAEAW,WAAArB,SAAAgD,aACAJ,KAAA5C,SAAAiD,YAEAvC,SAAA+B,aAAArI,SAAAwG,OACAF,SAAAY,OAEAZ,SAAAsB,OAAA,WACAX,WAAArB,SAAAgD,aACAJ,KAAA5C,SAAAiD,cAEAvC,SAAAyB,QAAA,WACAd,WAAAnB,YAAA8C,aACAJ,KAAA1C,YAAA+C,cAGA,kBAAAhB,KACAA,GAAAvB,WAGAA,SAAA4B,YAaA,QAAAY,MAAAC,iBAAAC,eAAAC,cACA,GAAAC,UAAAH,iBAAAI,QAAA,IAAAF,cACAhC,WAAAiC,SAAAC,QAAA,IAAAH;AAGApF,EAAA,WAAAmF,kBAAAhE,MAAA,SAAA6B,GACA,GAAAwC,WAAAtJ,KAIA,OADA8G,GAAA2B,kBACAW,SAAAG,GAAA,eAKAD,UAAAxF,EAAA,IAAAqF,aAAAhC,YACAnH,MAAAsJ,UAAAtJ,MAAAoJ,eACApJ,MAAA,GACAoJ,SAAAI,QAAA,IAAA,WACAJ,SACAK,aAAA3F,EAAA,IAAAqF,aAAA,SAAAnJ,MAAA,GAAA,IAAAmH,aACAuC,OAAA,IAAA,WACAvC,WAAAjB,QAAA,kBAOApC,EAAA,aAAAmF,kBAAAhE,MAAA,SAAA6B,GACA,GAAAwC,WAAAtJ,KAIA,OADA8G,GAAA2B,kBACAW,SAAAG,GAAA,eAKAD,UAAAxF,EAAA,IAAAqF,aAAAhC,YACAnH,MAAAsJ,UAAAtJ,MAAAoJ,eACApJ,MAAAsJ,UAAA3E,OAAA,GAAA2E,UAAA3E,OAAA,GACAyE,SAAAI,QAAA,IAAA,WACAJ,SACAO,YAAA7F,EAAA,IAAAqF,aAAA,SAAAnJ,MAAA,GAAA,IAAAmH,aACAuC,OAAA,IAAA;AACAvC,WAAAjB,QAAA,kBAaA,QAAA0D,SAAAzC,WAAAgC,aAAAU,oBACA1C,WAAAhF,KAAA,WACA,GAAAuG,MAAA5E,EAAAtD,MACAyI,iBAAAnF,EAAA+F,mBAAAnB,MAEA1I,MAAAmH,WAAAnH,MAAA0I,MACAoB,QAAAhG,EAAA,WAAAmF,kBACAc,UAAAjG,EAAA,aAAAmF,iBAGA,KAAA9B,WAAAxC,QACAmF,QAAAhE,SAAA8C,eACAmB,UAAAjE,SAAA8C,gBAGA,IAAA5I,OACA8J,QAAAhE,SAAA8C,eACAmB,UAAA/D,YAAA4C,gBAGA5I,OAAAmH,WAAAxC,OAAA,GACAoF,UAAAjE,SAAA8C,eACAkB,QAAA9D,YAAA4C,iBAIAkB,QAAA9D,YAAA4C,eACAmB,UAAA/D,YAAA4C,kBAUA,QAAAoB,WAAA7C,WAAA0C;AACA1C,WAAAhF,KAAA,WACA,GAAAuG,MAAA5E,EAAAtD,MACAyI,iBAAAnF,EAAA+F,mBAAAnB,MACAuB,QAAAnG,EAAA,gBAAAmF,iBAEA9B,YAAAxC,QAAA,EACAsF,QAAAnE,SAAA8C,eAEAqB,QAAAjE,YAAA4C,iBAUA,QAAAsB,SAAA/C,WAAA0C,oBACA1C,WAAAqB,KAAAqB,oBAAArB,KAAA,qCAAA1C,SAAA8C,eAQA,QAAAuB,QAAAhD,WAAA0C,oBACA1C,WAAAqB,KAAAqB,oBAAArB,KAAA,qCAAAxC,YAAA4C,eAnLA,GAAAA,eAAA,WACAE,YAAA,SACAC,WAAA,eAyLA,QACApF,WAAAA,WACAqF,KAAAA,KACAgB,UAAAA,UACAJ,QAAAA;AACAM,QAAAA,QACAC,OAAAA,UC3MAvK,OAAA,yDACA,SACA,OACA,qBACA,SAAAmE,EAAAzC,GAAA8I,cAEA,YAUA,SAAAC,qBAAA3D,OACA,MAAA3C,GAAAuG,SAAA5D,QAAA,sBAAAA,MAAA,aAAA3C,EAAAuC,QAAAI,MAAA6D,cAUA,QAAAC,eAAA9D,MAAA/E,YAEA,GAAA8I,eAAArG,cAAAsC,OAGAgE,QAAA3G,EAAA4G,WAAAF,cAAAG,IAAAjJ,YAGAkJ,WAAA9G,EAAA4G,WAAAhJ,WAAA8I,cAAAG,IAGAE,eAAApE,MAAAmE,YACAE,iBAAArE,MAAAgE,SASA,QAAAtG,eAAAsC,OAEA,GAAA2D,oBAAA3D,OAAA,CACA,GAAA/E,YAAAoC,EAAAsC,IAAAK,MAAA6D,aAAA,SAAAvH;AACA,GAAA,sBAAAA,QAAA,aAAAe,EAAAuC,QAAAtD,QAAArB,YACA,MAAAoC,GAAAiH,QAAAhI,QAAArB,cAIAsJ,OAAAlH,EAAAmH,OAAAvJ,YACAwJ,MAAApH,EAAAoH,MAAAC,MAAA,KAAAH,QAGAJ,WAAA9G,EAAAsH,aAAAD,MAAA,KAAAH,QAGAK,QAAAvH,EAAA4G,WAAAQ,MAAAN,WAEA,QACAD,IAAAO,MAAAI,OACAV,WAAAA,WAAAU,OACAD,QAAAA,QAAAC,QAGAnB,aAAAoB,MAAAC,IAAA,8BAWA,QAAAX,eAAApE,MAAA/E,YACA0I,oBAAA3D,OACA3C,EAAA5B,KAAAuE,MAAA6D,aAAA,SAAAvH,SACA,sBAAAA,QAAA,cACAe,EAAAuC,QAAAtD,QAAArB,cACAqB,QAAArB,eAEAqB,QAAArB,WAAAoC,EAAAoH,MAAAnI,QAAArB,WAAAA,eAIAyI,aAAAoB,MAAAC,IAAA;CAWA,QAAAV,kBAAArE,MAAA/E,YACA0I,oBAAA3D,OACA3C,EAAA5B,KAAAuE,MAAA6D,aAAA,SAAAvH,SACA,sBAAAA,QAAA,aAAAe,EAAAuC,QAAAtD,QAAArB,cACAqB,QAAArB,WAAAoC,EAAA4G,WAAA3H,QAAArB,WAAAA,eAIAyI,aAAAoB,MAAAC,IAAA,8BAUA,QAAAC,0BACA,QAEAC,KAAA,8BACAlJ,YAAAnB,GAAA,0DAGAqK,KAAA,iCACAlJ,YAAAnB,GAAA,gHAGAqK,KAAA,kCACAlJ,YAAAnB,GAAA;GAGAqK,KAAA,2BACAlJ,YAAAnB,GAAA,oCAGAqK,KAAA,yCACAlJ,YAAAnB,GAAA,8EAGAqK,KAAA,oBACAlJ,YAAAnB,GAAA,6BAGAqK,KAAA,0BACAlJ,YAAAnB,GAAA,2GAGAqK,KAAA,4BACAlJ,YAAAnB,GAAA,4CAGAqK,KAAA,0BACAlJ,YAAAnB,GAAA,uBAGAqK,KAAA,gCACAlJ,YAAAnB,GAAA;GA3JA,GAAAmK,KAAA,kBAgKA,QACApB,oBAAAA,oBACAG,cAAAA,cACApG,cAAAA,cACA0G,cAAAA,cACAC,iBAAAA,iBACAW,uBAAAA,0BC1KA9L,OAAA,iDAAA,SAAA,QAAA,SAAAmE,EAAAzC,IACA,YAMA,IAAAsK,gBAOAC,mBAAA,SAAAC,KACA,GAAAhK,MAAAtB,KACAuL,cAOA,OANAhI,GAAAiI,IAAAF,IAAA,gBACAC,YAAAA,YAAAE,OAAAH,IAAA9K,WAAAkL,gBAEAnI,EAAAoI,QAAApI,EAAAqI,QAAAN,IAAA,SAAAlJ,OACAmJ,YAAAA,YAAAE,OAAA,gBAAArJ,OAAAd,KAAA+J,mBAAAjJ,cACA,GACAmJ;EASAM,cAAA,SAAAC,QAAAC,mBACA,GACAC,YADAxM,MAAA,EAEAyM,KAAA,GAEA,GACAD,YAAAF,QAAAG,KAAAzM,cACA+D,EAAA2I,SAAAH,kBAAAC,WAAAN,eAIA,OAFAK,mBAAAI,KAAAH,WAAAN,eAEAM,YAOAI,kBAAA,WACA,GAAAC,cAAA,sCACA,QACAlB,KAAA,WACAmB,QAAAxL,GAAA,mEACAyL,SAAA,SAAAnK,MAAAoK,UACA,kBAAAA,WACAA,SAAAH,aAAAjJ,KAAAhB,WAUAqK,sBAAA,WACA,GAAAC,kBAAA,OACA,QACAvB,KAAA,eACAmB,QAAAxL,GAAA;AACAyL,SAAA,SAAAnK,MAAAoK,UACA,kBAAAA,WACAA,SAAAE,iBAAAtJ,KAAAhB,WAWAuK,qBAAA,SAAAZ,mBACA,OACAZ,KAAA,kBACAmB,QAAAxL,GAAA,gCACAyL,SAAA,SAAAnK,MAAAoK,SAAA7L,SACA,kBAAA6L,WACAA,UAAAjJ,EAAA2I,SAAA3I,EAAAmH,OAAAqB,mBAAA3J,MAAAsJ,gBAAA/K,QAAAiM,UAAAxK,QAAAzB,QAAAiM,aAYAC,cAAA,SAAAzK,MAAA0K,MACA,MAAA1K,OAAA,aAAAA,MAAA,cAAA0K,MAQAC,kBAAA,SAAAC,WAAAC,YACA,GAAA3L,MAAAtB,IACAuD,GAAAqI,QAAAoB,WAAA,SAAA5K,MAAAN,MACAyB,EAAAuG,SAAA1H,QAAAmB,EAAAuC,QAAA1D,QAAAmB,EAAAiI,IAAApJ,MAAA,cACAmB,EAAA2J,SAAApL,KACAmL,aACA7K,MAAA,YAAA6K,YAGA7K,MAAA,YAAAN;AAGAyB,EAAAuC,QAAA1D,OACAd,KAAAyL,kBAAA3K,MAAAN,IAAAqL,QAAA,KAAA,KACA5J,EAAAuG,SAAA1H,QACAd,KAAAyL,kBAAA3K,UAUAgL,iBAAA,SAAAlH,OA+CA,MA9CAA,QAAAA,MAAAmH,WAAA9J,EAAAuC,QAAAI,MAAAmH,YAEA9J,EAAAqI,QAAA1F,MAAAmH,UAAA,SAAAhL,UAEAA,SAAAiL,oBAAA/J,EAAAuC,QAAAzD,SAAAiL,qBAEA/J,EAAAqI,QAAAvJ,SAAAiL,mBAAA,SAAAC,mBAGAA,kBAAAC,UACAC,SAAAF,kBAAAC,SAAAE,SAAAH,kBAAAC,SAAAE,WAAA,SACAH,mBAAAC,SAIAD,kBAAAxD,cAAAxG,EAAAuC,QAAAyH,kBAAAxD,eACAxG,EAAAqI,QAAA2B,kBAAAxD,aAAA,SAAA4D;AACAA,KAAAxM,YAAAoC,EAAAuC,QAAA6H,KAAAxM,cAAA,IAAAwM,KAAAxM,WAAAgD,QAAA,IAAAwJ,KAAAxM,WAAA,GAAAgD,UACAwJ,KAAAxM,iBAKAoM,kBAAAK,cAAArK,EAAAuC,QAAAyH,kBAAAK,gBAGA,IAAAL,kBAAAK,aAAAzJ,QACA,IAAAoJ,kBAAAK,aAAAzJ,QAAA,IAAAoJ,kBAAAK,aAAA,GAAAC,QAAA1J,aAEAoJ,mBAAAK,aAGAL,kBAAAK,aAAAzJ,OAAA,GACAZ,EAAAqI,QAAA2B,kBAAAK,aAAA,SAAArL,aACAA,YAAAuL,OAAA,oBAYA5H,OAIA,OAAAkF,iBC5LAhM,OAAA,+CACA,SACA,SACA,OACA,8CACA,wDACA,gDACA,oEAEA,SACAkE,EACAC,EACAzC,GACAvB,QACAwO,gBACA3C,cACA4C;AAEA,YAKA,IAAAC,QAAA1K,EAAA2K,SAAA,WACA,GAAAC,OAAA7K,EAAA,aAAA8K,QACAC,SAAA/K,EAAA,qBAAA8K,QACAE,MAAAH,MAAAI,aAAAF,SAAAG,YACAlL,GAAA,qBAAAgL,MAAAA,QACA,KAQAG,MAAA,SAAAC,SAAAxI,OAcA,QAAAyI,aAAA3I,UASA,QAAA4I,qBACA,OAAA5I,UACAA,SAAA0B,UATAmH,mBAAA7I,SAAAoB,WACA0H,gBAAA9I,UAEA0I,SAAA7F,QAAA,aAAAxC,GAAA,SAAAuI,mBACAF,SAAA7F,QAAA,YAAAxC,GAAA,SAAAuI,mBACAF,SAAArI,GAAA,SAAAuI,mBAcA,QAAAC,oBAAAzI,OAsBA,QAAA2I,kBACAC,QAAAC,QAAA,MAAA/I,MAAA/E,YAtBA,GAAA6N,SAAA5I,MAAA4B,KAAA;AACAgH,QAAAC,SACAX,MAAA,OACAY,KAAA3L,EAAAqC,MAAAmI,gBAAA7C,yBAAA,QACAiE,UAAA,EACAC,iBAAA,IAAA,IAAA,KACAC,gBAAA,WACA,MAAAvO,IAAA,qBAEAwO,mBAAA,KAGAP,iBACA3I,MAAAC,GAAA,oBAAA,WACA0I,mBAgBA,QAAAD,iBAAA9I,UACA,GAAAI,OAAAJ,SAAAoB,UACAmI,YAAAnJ,MAAA4B,KAAA,6BAEA5B,OAAA4B,KAAA,uBAAA3B,GAAA,QAAA,SAAAC,GACA,GAAAkJ,cACApN,MAAA,EACA5B,WAAA,IAAA0F,MAAAuJ,QAAAtL,OACA,SACAiH,cAAAS,cAAA,SAAAT,cAAAC,mBAAAnF,QAEAI,GAAA2B,iBAEAsH,YAAAxK,OAAAiJ,UAAAwB;AACAD,YAAA7J,QAAA,sBAEAU,MAAAM,mBAhFA,GAAA+B,kBAAAnF,EAAA,WAAAoL,SAEAnP,SAAA4D,WAAAsF,iBAAA,UAAAvC,MAAAyI,aACApP,QAAAiJ,KAAAC,iBAAA,WAAA,WAEAwF,UAmFAyB,kBAAA,WAEApM,EAAA,aAAA3B,KAAA,WACApC,QAAA6J,QAAA9F,EAAA,WAAAA,EAAAtD,OAAA,UAAA,cAGAsD,EAAAqM,UACAtJ,GAAA,SAAA,SAAAC,GACA,GAAAsJ,SACAC,QAAAvM,EAAAgD,EAAAwJ,OACAD,SAAA1H,SAAA,aACAyH,QAAAC,QAAAhH,QAAA,aACAtJ,QAAAmK,QAAAkG,QAAA5H,KAAA,YAAA,eAGA3B,GAAA,0CAAA,YAAA,SAAAC,GACA,GAAAsJ,SACAC,QAAAvM,EAAAgD,EAAAwJ,SACAD,QAAA1H,SAAA,YAAA0H,QAAA1H,SAAA,eACAyH,QAAAtM,EAAA,WAAAuM,QAAA1H,SAAA,YAAA0H,QAAAA,QAAAhH,QAAA;AACAtJ,QAAAoK,OAAAiG,QAAA,YACArQ,QAAA6J,QAAAwG,QAAA,UAAA,eAUA,QACAnB,MAAAA,MACAiB,kBAAAA,kBACAzB,OAAAA,UCjKA7O,OAAA,wDAAA,6BAAA,WAAA,SAAA2Q,eAAAC,SACA,YAmBA,IAAAC,WAAA,SAAAC,OAAAC,YAAAxP,SAKA,MAJAA,SAAAA,YAEAA,QAAAyP,WAAA,EAEAL,eAAAE,UAAAC,OAAAC,YAAAxP,SAGA,QACAsP,UAAAA,aC5BA7Q,OAAA,mDACA,SACA,SACA,8CACA,UACA,WACA,wDACA,SAAAkE,EAAAC,EAAAhE,QAAAM,QAAAwQ,SAAAN;AACA,YAGA,IAAAO,UAAAP,eAAAE,UAAAI,SAAA,YAEAE,aAAA,SAAAC,QACA,MAAAjN,GAAA2I,UAAA,cAAA,cAAA,cAAA,iBAAAsE,QAEAF,UAAAG,QAAAlN,EAAAmN,OAAAJ,SAAAG,QAAAE,MAAA,KAAAJ,cAAAK,KAAA,KACAN,SAAAO,aAAAtN,EAAAmN,OAAAJ,SAAAO,aAAAF,MAAA,KAAAJ,cAAAK,KAAA,IAOA,IAAAnC,OAAA,SAAAqC,aAAA5K,MAAAnG,MAUA,QAAA4O,aAAA3I,UAQA,QAAA4I,mBAAAtI,GACA,OAAAN,UACAA,SAAA0B,UARAqJ,QAAA/K,SAAAoB,WAEA0J,aAAAjI,QAAA,aAAAxC,GAAA,SAAAuI,mBACAkC,aAAAjI,QAAA,YAAAxC,GAAA,SAAAuI,mBACAkC,aAAAzK,GAAA,SAAAuI;CAcA,QAAAmC,SAAAC,gBACA,GAAAhC,SAAA1L,EAAA,SAAA0N,eAEAhC,SAAAC,SACAX,MAAA,SACAjI,GAAA,kBAAA,SAAAC,GACA,IAAA0I,QAAAC,QAAA,OAAA9K,QACA6K,QAAAC,QAAA,OAAA,MAIA,IAAAD,QAAAC,QAAA,OAAA9K,QACA6K,QAAAC,QAAA,OAAA,IAQA,QAAAgC,eACA,GAAAf,QAGAgB,oBAAA5N,EAAA,uBAAAwN,cACAK,oBAAA7N,EAAA,uBAAAwN,cACAM,uBAAA7N,EAAA2K,SAAA,WACAgD,oBACAG,KAAAF,oBAAAE,QACA3L,QAAA,WACA,IAEAyL,qBAAArM,QAAAuM,KAAAH,oBAAAG,QAEAnB,OAAAG,SAAAiB,OAAAH,oBAAA,GAAAb,UACAJ,OAAA7J,GAAA,SAAA,SAAAC;AACA8K,2BAhEA7R,QAAA4D,WAAA2N,aAAA,cAAA5K,MAAAyI,aACAsC,cAyEA,QACAxC,MAAAA,SCzGArP,OAAA,2DACA,SACA,OACA,qBACA,SAAAmE,EAAAzC,GAAA8I,cAEA,YAYA,SAAA2H,cAAArL,MAAAsL,WACAtL,MAAAsL,UAAAA,UAUA,QAAAC,cAAAC,OAAAxL,OAEA,MAAA5C,GAAAqO,MACAC,IAAAF,OACA5E,KAAA,MACA/M,MACAuC,QAAA4D,MAAA1F,YAEAqR,SAAA,SAGAC,KAAA,WACAlI,aAAAoB,MAAAC,IAAA,gCAjCA,GAAAA,KAAA,mBAsCA,QACAsG,aAAAA,aACAE,aAAAA,gBC5CArS,OAAA,+CACA,SACA,SACA,MACA,OACA,8CACA,8CACA,kDACA,gDACA,gDACA,wDACA,2DAEA,SAAAkE,EAAAC,EAAArC,IAAAJ,GAAAvB,QAAAwS,YAAAC,gBAAAxO,UAAA4H,cAAA2C,gBAAAkE;AACA,YAUA,IAAAxD,OAAA,SAAAyD,SAAAhM,MAAAnG,MAqBA,QAAA4O,aAAA3I,UAgDA,QAAA4I,qBACA,OAAA5I,UACAA,SAAA0B,UAhDA,GAAAyK,QACA/L,MAAAJ,SAAAoB,UAGAgL,mBAAA9O,EAAA,kCAAA8C,OACAiM,iBAAA/O,EAAA,wBAAA8C,OACAkM,kBAAAhP,EAAA,kCAAA8C,OAEAmM,gBAAA,WACAH,mBAAAI,KAAA,cAAA,GACAH,iBAAAI,YAAA,UACAH,kBAAA9M,YAAA,cAEA6M,iBAAAI,YAAA,WACAH,kBAAAhN,SAAA,aAGA8M,oBAAA/L,GAAA,SAAAkM,iBACAH,mBAAA/L,GAAA,SAAA;AACA+L,mBAAAI,KAAA,aACAH,iBAAAnO,IAAA,GACAoO,kBAAAE,KAAA,WAAA,SACAtM,OAAAwM,aAIAN,mBAAAI,KAAA,YAAAtM,MAAAwM,WAAAhN,QAAA,UAGAyM,OAAA7O,EAAA,oBAAA4O,UACA9L,MAAAC,GAAA,gBAAA,SAAAC,GACA,WAAAA,EAAAE,WAAA,sBAAAN,MAAA,aACAiM,OAAAQ,KAAAzM,MAAArF,SAIAqR,SAAArJ,QAAA,aAAAxC,GAAA,kBAAAuI,mBACAsD,SAAA7L,GAAA,kBAAAuI,mBAGAC,mBAAAzI,OAEAqH,SAAAvH,MAAA/D,cACAyQ,kBAAAxM,OAcA,QAAAyM,YAEA3M,MAAA6D,eACA7D,MAAA6D,iBAEAzG,EAAA,WAAA4O,UAAAvQ,KAAA,WACA,GAAA+M,UAAApL,EAAAtD,MACAR,MAAAkP,SAAA3O,KAAA;AACAmG,MAAA6D,aAAAvK,SACA0G,MAAA6D,aAAAvK,WAGAuS,YAAAtD,MAAAC,SAAAxI,MAAA6D,aAAAvK,QACAkP,SAAA1G,KAAA,UAAA2K,KACA5S,KAAA+S,OAAA5R,IAAA6R,OAAArE,SAAA3O,KAAA,YASA,QAAAiT,kBACA,GAAAC,WACAC,OAAA5P,EAAA,sBAGA4P,QAAA7M,GAAA,qBAAA,WACA,GAAAqM,WAAAS,MAAAC,UAAAC,MAAA5S,KAAA6S,UAAA,GACAC,aAAAjQ,EAAA,uBAAA4O,UACAsB,cAAAlQ,EAAA,uBAEAoP,WAAAvO,OAAA,EACAoP,aAAAzL,OAAA2L,IAAA,SAAApN,GAAA,QAAA,WAGA,GAAAlF,YACAuS,kBAEAxN,OAAAyN,qBAAApQ,EAAAqQ,YAAA1N,MAAAyN,mBAAAE,eAGAH,gBAAAC,mBAAApQ,EAAAuQ,MAAA5N,MAAAyN;AAIAxS,WAAA4M,gBAAAnK,cAAAsC,OACAwN,gBAAAvS,WAAAoC,EAAAuQ,MAAA3S,WAAAkJ,YAEA9G,EAAAqI,QAAA8G,UAAA,SAAAjQ,MACA,GAAAsR,OAAAzQ,EAAAb,MACAuR,eAAAD,MAAAhU,KAAA,cACAkU,SAAA1Q,EAAA2Q,UACAnT,KAAAG,IAAAiT,OAAAJ,MAAAhU,KAAA,QACAiB,MAAAsC,EAAA8Q,KAAAL,MAAAD,QAAA/M,WAAAY,SAAA0M,MAAA1B,QACA2B,WAAA,qBACAZ,gBACAnQ,GAAAgR,QAAAP,kBACAC,SAAA9S,WAAAoC,EAAArD,MAAA+T,SAAA9S,WAAA6S,eAAAI,OAAAzD,MAAA,OAGA6D,WAAAlR,EAAA,YAAA4O,UAAAzE,OAAAwG,YAIA3Q,EAAA,eAAA4P,QAAA1N,YAAA,eAAAA,YAAA,YACAgO,cAAAxM,OAAAyM,IAAA,WAGAD,cAAAxM,OAAAyM,IAAA;GAMAnQ,EAAAqM,UACA8D,IAAA,aAAA,IAAAvB,SAAAuC,KAAA,MAAA,cACApO,GAAA,aAAA,IAAA6L,SAAAuC,KAAA,MAAA,aAAA,SAAAnO,EAAAoI,UACA,GAAAlP,MACA,YAAA8G,EAAAE,WAAAkI,SAAAvG,SAAA,aACA3I,MAAAkP,SAAA3O,KAAA,cAGAgS,YAAAtD,MAAAC,SAAAxI,MAAA6D,aAAAvK,WAKAyT,UAAA3P,EAAA,YAAA4P,QACAD,UAAA9O,OAAA,GACA+O,OAAAxN,QAAA,qBAAAuN,WAWA,QAAAuB,YAAAE,SAAAlV,MAAAyU,UACA,GAAAvF,UACAwE,OAAAwB,SAAA3N,SAAA,KACAvH,OAAAA,OAAA0T,OAAA/O,OACA8P,SAAAzT,WAAA4K,cAAAS,cAAA,OAAA9L,KAAAwL,aACA0I,SAAAzU,MAAAA,MAAA,EACAkP,SAAApL,EAAAE,UAAAP,QAAAgR,WACAzU,MAAA,EACAkP,SAAAvF,YAAA+J,OAAAyB,GAAAnV,MAAA,IAEAkP,SAAAzH,SAAAyN;AAEAA,SAAAhP,QAAA,OAAAgJ,SAAAuF,WAQA,QAAArG,gBACA1H,MAAA0H,eACA1H,MAAA0H,iBAEAtK,EAAA,eAAA4O,UAAAvQ,KAAA,WACA,GAAAmP,cAAAxN,EAAAtD,MACAR,MAAAsR,aAAA/Q,KAAA,aACAmG,OAAA0H,aAAApO,SACA0G,MAAA0H,aAAApO,WAGAwS,gBAAAvD,MAAAqC,aAAA5K,MAAA0H,aAAApO,OAAAO,QAIAmG,MAAA0H,aAAAzJ,OAAA,GACAb,EAAA,eAAA4O,UAAAxM,QAAA,SAQA,QAAAkP,kBAEAtR,EAAA,iBAAA4O,UAAA2C,OACA/E,OAAAxM,EAAA,gBAAA4O,UACArE,QAAArK,UAAAN,YACA4R,aAAA,SAAAvN,IACAA,IACA+M,WAAA,cACA9U,MAAA8D,EAAA,eAAA4O,UAAA/N,OACA0J,WACAC,OAAA,QAMAxK,EAAAqM,UAAAtJ,GAAA,aAAA,IAAA6L,SAAAuC,KAAA,MAAA,iBAAA,SAAAnO,EAAAwK;AACA,GAAAtR,MACA,YAAA8G,EAAAE,WAAAsK,aAAA3I,SAAA,iBACA3I,MAAAsR,aAAA/Q,KAAA,cACAuD,EAAA,uBAAAwN,cAAAO,KAAA,iBACAW,gBAAAvD,MAAAqC,aAAA5K,MAAA0H,aAAApO,OAAAO,SAUA,QAAA8O,oBAAAzI,OAwBA,QAAA2I,kBAEA,GAAA5N,YAAA4M,gBAAAnK,cAAAsC,MAGA8I,SAAAC,QAAA,MAAA9N,WAAAiJ,KAGA4E,QAAAxK,SAAA,sBAAAwD,KAAA,0BAAArG,KAAA,WACA,GAAAoT,KAAAzR,EAAAtD,MACA6N,QAAAkH,IAAA/M,KAAA,OAAA2K,MACApP,GAAAyR,QAAA7T,WAAA2J,QAAA+C,UAAA,GACAkH,IAAAzP,SAAA,aASA,QAAA0E,eAAA7I,YACA4M,gBAAA/D,cAAA9D,MAAA/E;CA7CA,GAAA6N,SAAA1L,EAAA,0BAAA8C,MACA4I,SAAAC,SACAX,MAAA,OACAY,KAAA3L,EAAAqC,MAAAmI,gBAAA7C,yBAAA,QACAiE,UAAA,EACAC,iBAAA,IAAA,IAAA,KACAC,gBAAA,WACA,MAAAvO,IAAA,qBAEAwO,mBAAA,KACAjJ,GAAA,SAAA,SAAAC,GACA0D,cAAA1D,EAAApC,OAGA6K,iBACA3I,MAAAC,GAAA,oBAAA,WACA0I,mBAuCA,QAAA6D,mBAAAxM,OAqCA,QAAA6O,iBAEAxH,SAAAvH,MAAAsL,WACAS,iBACAR,aAAA1R,KAAAmV,OAAAC,uBAAAjP,OACAkP,QAAA,SAAArV,MACAwD,EAAAgR,QAAAxU,OACA,KAAAmG,MAAAsL,YACAtL,MAAAsL,UAAAzR,KAAAmB,IACA8N,QAAAC,QAAA,QAAAoG,GAAAtV,KAAAmB;AAAAyR,KAAA5S,KAAA4S,OACA3D,QAAAtJ,QAAA,aAWA,QAAA6L,cAAAC,WACAS,iBAAAV,aAAArL,MAAAsL,WA1DA,GAAAxC,SAAA1L,EAAA,2BAAA8C,MACA4I,SAAAC,SACA0C,MACAC,IAAA7R,KAAAmV,OAAAI,eACAzD,SAAA,OACA0D,MAAA,IACAC,OAAA,OACAzV,KAAA,SAAA0V,QACA,OACAjV,WAAAiV,SAGAC,QAAA,SAAA3V,MACA,MAAAA,QAGA4V,mBAAA,EACArH,MAAA,OACAa,UAAA,EACAE,gBAAA,WACA,MAAAvO,IAAA,sBAEAwO,mBAAA,KACAjJ,GAAA,SAAA,SAAAC,GACAiL,aAAAjL,EAAApC,OAGA+Q,gBACA7O,MAAAC,GAAA,oBAAA,WACA4O,kBArVA,GAAAxM,kBAAAnF,EAAA,KAAA4O,SAEA3O,GAAAgR,QAAAxU,KAAAmV,OAAAI,kBACApP,MAAA/D,cAAA;AAEA5C,QAAA4D,WAAAsF,iBAAA,UAAAvC,MAAAyI,aACApP,QAAAiJ,KAAAC,iBAAA,WAAA,WACAoK,WACAG,iBACApF,eACAgH,kBAiXAlF,kBAAA,WAEA,GAAAkG,UAEAtS,GAAA,aAAA3B,KAAA,WACAiU,UAAAtS,EAAA,WAAAA,EAAAtD,OAEAT,QAAAiK,UAAAoM,UAAA,MACArW,QAAA6J,QAAAwM,UAAA,UAAA,QAGAtS,EAAAqM,UACAtJ,GAAA,SAAA,SAAAC,GACA,GAAAsJ,SACAC,QAAAvM,EAAAgD,EAAAwJ,OACAD,SAAA1H,SAAA,aACAyH,QAAAC,QAAAhH,QAAA,aACAtJ,QAAAmK,QAAAkG,QAAA5H,KAAA,YAAA,SAGA3B,GAAA,0CAAA,SAAAC,GACA,GAAAuJ,SAAAvM,EAAAgD,EAAAwJ,SACAD,QAAA1H,SAAA,YAAA0H,QAAA1H,SAAA,eACAyN,UAAAtS,EAAA,WAAAuM,QAAA1H,SAAA,YAAA0H,QAAAA,QAAAhH,QAAA;AACAtJ,QAAAiK,UAAAoM,UAAA,MACArW,QAAA6J,QAAAwM,UAAA,UAAA,SAGAvP,GAAA,eAAA,eAAA,SAAAC,GACA,YAAAA,EAAAE,WACAlD,EAAAtD,MAAA6I,QAAA,MAAAvD,SAAA,YAGAe,GAAA,gBAAA,eAAA,SAAAC,GACA,YAAAA,EAAAE,WACAlD,EAAAtD,MAAA6I,QAAA,MAAArD,YAAA,YAWA,QACAiJ,MAAAA,MACAiB,kBAAAA,qBCrcAtQ,OAAA,gDACA,SAAA,SACA,8CACA,8CACA,gDACA,iDACA,SAAAkE,EAAAC,EAAAhE,QAAAsW,YAAArS,UAAA4H;AACA,YAUA,IAAAqD,OAAA,SAAAqH,UAAA5P,MAAAnG,MAeA,QAAA4O,aAAA3I,UAEA,GAAAI,OAAAJ,SAAAoB,UAGA2O,YAAAzS,EAAA,yBAAAwS,UACA1P,OAAAC,GAAA,gBAAA,SAAAC,EAAAJ,OACA,WAAAI,EAAAE,WAAA,aAAAN,MAAA,aACA6P,YAAApD,KAAAzM,MAAA1F,cAKAsV,UAAAzP,GAAA,SAAA,SAAAC,GACA,OAAAN,UACAA,SAAA0B,YASA,QAAAsO,YACA9P,MAAAoH,qBACApH,MAAAoH,uBAEAhK,EAAA,WAAAwS,WAAAnU,KAAA,WACA,GAAAuQ,UAAA5O,EAAAtD,MACAR,MAAA0S,SAAAnS,KAAA,aACAmG,OAAAoH,mBAAA9N,SACA0G,MAAAoH,mBAAA9N,WAGAqW,YAAApH,MAAAyD,SAAAhM,MAAAoH,mBAAA9N,OAAAO;GAQA,QAAAkW,cACA3S,EAAA,iBAAAwS,WAAAjB,OACA/E,OAAAxM,EAAA,YAAAwS,WACAjI,QAAArK,UAAAlB,QACAwS,aAAA,SAAAvN,IAGA,GAAA2O,cAAA5S,EAAA,WAAAwS,WAAA3R,MACAoD,KACA+M,WAAA,oBACA9T,WAAA4K,cAAAS,cAAA,oBAAA9L,KAAAwL,aACA1K,MAAA,YAAAqV,aAAA,GACA1W,MAAA,EACAuK,qBAQAzG,EAAAqM,UACA8D,IAAA,aAAA,IAAAqC,UAAArB,KAAA,MAAA,cACApO,GAAA,aAAA,IAAAyP,UAAArB,KAAA,MAAA,aAAA,SAAAnO,EAAA4L,UACA,GAAA,WAAA5L,EAAAE,WAAA0L,SAAA/J,SAAA,WAAA,CACA,GAAA3I,OAAA0S,SAAAnS,KAAA,aAEA8V,aAAApH,MAAAyD,SAAAhM,MAAAoH,mBAAA9N,OAAAO;IAnFA,GAAA0I,kBAAAnF,EAAA,KAAAwS,UAGAvW,SAAA4D,WAAAsF,iBAAA,WAAAvC,MAAAyI,aACApP,QAAAiJ,KAAAC,iBAAA,YAAA,YACAuN,WACAC,cAuFAvG,kBAAA,WAEA,GAAAyG,YAAA7S,EAAA,YAEA/D,SAAAiK,UAAA2M,WAAA,MACA5W,QAAA6J,QAAA+M,WAAA,WAAA,MAEA7S,EAAA,cACA+C,GAAA,SAAA,SAAAC,GACA,GAAAuJ,SAAAvM,EAAAgD,EAAAwJ,OACAD,SAAA1H,SAAA,aACA5I,QAAAmK,QAAApG,EAAA,aAAA,QAGA+C,GAAA,0CAAA,SAAAC,GACA,GAAAuJ,SAAAvM,EAAAgD,EAAAwJ,SAEAD,QAAA1H,SAAA,aAAA0H,QAAA1H,SAAA,gBAGAgO,WAAA7S,EAAA,aAGA/D,QAAAiK,UAAA2M,WAAA,MACA5W,QAAA6J,QAAA+M,WAAA,WAAA;GAUA,QACA1H,MAAAA,MACAiB,kBAAAA,qBCrJAtQ,OAAA,4CACA,SAAA,SAAA,WACA,8CACA,+CACA,gDACA,iDAEA,SAAAkE,EAAAC,EAAA6S,MAAA7W,QAAA8W,aAAA7S,UAAA4H,eACA,YAUA,IAAAkL,UAAA,SAAApQ,MAAAnG,MAUA,QAAAsN,aACAnH,MAAAmH,YACAnH,MAAAmH,cAEA/J,EAAA,aAAA3B,KAAA,WACA,GAAAmU,WAAAxS,EAAAtD,MACAR,MAAAsW,UAAA/V,KAAA,aACAmG,OAAAmH,UAAA7N,SACA0G,MAAAmH,UAAA7N,WAGA6W,aAAA5H,MAAAqH,UAAA5P,MAAAmH,UAAA7N,OAAAO;GASA,QAAA4O,aAAA3I,UAQA,QAAAuQ,eAAArU,SACAkU,MAAAxO,OAAA4O,gBAAAtU,SAAA,QAAAA,QAAAuU,mBACAL,MAAAxO,OAAA8O,wBAAAxU,UAAA,OAAA,UAAA8S,QAAA9S,QAAAuU,sBAAA,GACAL,MAAApP,KAAA2P,eACAP,MAAAtO,KAAA6O,cAAAxR,OAAA,cAAAjD,QAAAuU,kBAAA,OAVA,GAAArQ,OAAAJ,SAAAoB,UACAoP,cAAAlT,EAAA,kBAAA8C,OACAsQ,sBAAApT,EAAA,0BAAA8C,OACAuQ,cAAArT,EAAA,uCAAA8C,OACA+L,OAAA7O,EAAA,4CASA8C,OAAAC,GAAA,gBAAA,SAAAC,EAAAJ,OACA,WAAAI,EAAAE,WAAA,mBAAAN,MAAA,cACAqQ,cAAArQ,MAAAhE;AAGAiQ,OAAAQ,KAAAzM,MAAArF,UAGA0V,cAAArQ,MAAAhE,SAOA,QAAA0U,eAEAtT,EAAA,mBAAAuR,OACA/E,OAAAxM,EAAA,cACAuK,QAAArK,UAAAR,SACA8R,aAAA,SAAAvN,IAGA,GAAAsP,eAAAvT,EAAA,aAAAa,MACAoD,KACA+M,WAAA,WACA9T,WAAA4K,cAAAS,cAAA,WAAA9L,KAAAwL,aACA/L,MAAAqX,cACAC,eAAA,EACAC,eAAA,EACAzJ,qBACAgH,WAAA,oBACA9T,WAAA4K,cAAAS,cAAA,oBAAA9L,KAAAwL,aACA1K,MAAA,YACArB,MAAA,EACAuK,uBAOAzG,EAAAqM,UACA8D,IAAA,aAAA,cACApN,GAAA,aAAA,aAAA,SAAAC,EAAAwP,UAAAkB,OACA,WAAA1Q,EAAAE,WAAAsP,UAAA3N,SAAA,aAEAkO,aAAA5H,MAAAqH,UAAA5P,MAAAmH,UAAA2J,MAAAxX,OAAAO;GA1FAR,QAAA4D,WAAAG,EAAA,2BAAA,OAAA4C,MAAAyI,aACAtB,YACAuJ,cA8FA,OAAAN,YCnHAlX,OAAA,kDAAA,SAAA,UAAA,SAAAkE,EAAAC,GACA,YAOA,IAAA0T,eAAA,SAAAC,QACA,MAAA3T,GAAA4T,KAAAD,QACA,WACA,UACA,UACA,OACA,WASAE,UAAA,SAAAC,YACA,MAAA9T,GAAA+T,OAAAD,WAAA,SAAAE,IAAAnV,MAAAN,KACA,MAAAyB,GAAA2J,SAAA9K,QAAAmB,EAAAiU,SAAApV,SAAAmB,EAAAgR,QAAAnS,OACAmV,IAAA,IAAAzV,IAAA,KAAAM,MAAA,KAEAmV,KACA,KAQAE,gBAOA1E,OAAA,SAAA2E,YACA,GAAApW,MAAAtB,IAEA,IAAAuD,EAAAuC,QAAA4R,YACA,MAAAnU,GAAA+T,OAAAI,WAAA,SAAAC,OAAAvV,OACA,MAAAuV,QAAArW,KAAAyR,OAAA3Q;EACA,GACA,IAAAmB,EAAAuG,SAAA4N,aAAAA,WAAA,YAAA,CACA,GAAA,YAAAA,WAAA,YACA,MAAAA,YAAA7J,OAEA,IAAA+J,UAAA,IAAAF,WAAA,YAAAN,UAAAH,cAAAS,YACA,OAAAA,YAAA7J,QACA+J,SAAA,IAAAtW,KAAAyR,OAAA2E,WAAA7J,SAAA,KAAA6J,WAAA,YAAA,IAEAE,SAAA,KAGA,MAAAF,aAQAvD,OAAA,SAAA0D,WACA,GAAAvW,MAAAtB,KACA8X,WAAAD,oBAAAvU,GAAAuU,UAAAvU,EAAAuU,WACAF,SAiCA,OA/BApU,GAAAqI,QAAAkM,WAAA,SAAAC,KACA,GAAAb,OACA,KAAAa,IAAAC,SACAzU,EAAAgR,QAAAjR,EAAA8Q,KAAA2D,IAAAF,aACAF,OAAAxL,MACAmI,WAAA,UACAzG,QAAAkK,IAAAF,UACAI,QAAA,KAGA,IAAAF,IAAAC,WACAd,OAAA3T,EAAArD,OACAoU,WAAAyD,IAAAG,SAAAxM;AACA2J,GAAA,GACA8C,MAAA,GACAF,QAAA,GACAG,KAAA,GACApX,MAAA,IAEAuC,EAAA8U,UAAAN,IAAAV,WAAA,SAAAE,IAAAnV,OACAA,MAAA8V,WACAX,IAAAnV,MAAA8V,UAAA9V,MAAAyV,cAIAE,IAAAO,WAAAnU,OAAA,IACA+S,OAAArJ,QAAAvM,KAAA6S,OAAA4D,IAAAO,aAEAX,OAAAxL,KAAA+K,WAGAS,QAIA,OAAAF,kBCnGArY,OAAA,kDACA,UACA,SAAAmE,GACA,YAMA,IAAAgV,eASAC,WAAA,EAUAC,QAAA,EAUAC,QAAA,EAUAC,MAAA,EAUAC,OAAA,EAYAC,MAAA,EAUAC,KAAA,EAWAC,cAAA,EAaAC,SAAA,EAYAC,KAAA,EASAC,IAAA,GAUAC,kBAAA,GAOAC,OAAA,IAGAC,eAAA9V,GAKA+V,QAAA,WACA,MAAAf,eASAgB,SAAA,SAAAzM,KAAA0M,aAiBA,MAhBAjW,GAAAkW,SAAA3M,MACAuM,eAAAK,kBAAA5M,QACAA,MAAA,GAGAA,KAAAuM,eAAAM,kBAAA7M;CAGA,IAAAA,OAIAA,KAHAvJ,EAAAqQ,YAAA4F,cAAAA,eAAA,GAGA,EAFAH,eAAAE,SAAAC,aAAA,IAMA1M,MAuBA6M,kBAAA,SAAAxO,MACA,OAAAyO,OAAAzO,MAAAiJ,OAAA1I,eACA,IAAA,aACA,MAAA6M,cAAAC,UAEA,KAAA,UACA,MAAAD,cAAAE,OAEA,KAAA,UACA,MAAAF,cAAAG,OAEA,KAAA,QACA,MAAAH,cAAAI,KAEA,KAAA,SACA,MAAAJ,cAAAK,MAEA,KAAA,QACA,MAAAL,cAAAM,KAEA,KAAA,OACA,MAAAN,cAAAO,IAEA,KAAA,eACA,MAAAP,cAAAQ,aAEA,KAAA,WACA,MAAAR,cAAAS,QAEA,KAAA,OACA,MAAAT,cAAAU,IAEA,KAAA,MACA,MAAAV,cAAAW,GAEA,KAAA,kBACA,MAAAX,cAAAY;AAEA,IAAA,SACA,MAAAZ,cAAAa,MAEA,SACA,OAAA,IAUAM,kBAAA,SAAAG,UACA,OAAAA,UACA,IAAAtB,cAAAC,WACA,MAAA,YAEA,KAAAD,cAAAE,QACA,MAAA,SAEA,KAAAF,cAAAG,QACA,MAAA,SAEA,KAAAH,cAAAI,MACA,MAAA,OAEA,KAAAJ,cAAAK,OACA,MAAA,QAEA,KAAAL,cAAAM,MACA,MAAA,OAEA,KAAAN,cAAAO,KACA,MAAA,MAEA,KAAAP,cAAAQ,cACA,MAAA,cAEA,KAAAR,cAAAS,SACA,MAAA,UAEA,KAAAT,cAAAU,KACA,MAAA,MAEA,KAAAV,cAAAW,IACA,MAAA,KAEA,KAAAX,cAAAY,kBACA,MAAA,iBAEA,KAAAZ,cAAAa,OACA,MAAA,QAEA;AACA,OAAA,MAGAU,OAAAvB,cAAAnW,OAEA,OAAAiX,kBC9RAja,OAAA,qDACA,UACA,SAAAmE,GACA,YAMA,IAAAwW,kBAMAC,OAAA,EAOAC,SAAA,EAOAC,QAAA,EAOAC,OAAA,GAGAC,kBAAA7W,GAKA+V,QAAA,WACA,MAAAS,kBASAR,SAAA,SAAAc,YAAAC,oBAiBA,MAhBA/W,GAAAkW,SAAAY,aACAD,kBAAAV,kBAAAW,eACAA,aAAA,GAGAA,YAAAD,kBAAAT,kBAAAU,cAGA,IAAAA,cAIAA,YAHA9W,EAAAqQ,YAAA0G,qBAAAA,qBAAAP,gBAAAC,OAGAD,gBAAAC,OAFAI,kBAAAb,SAAAe,mBAAAP,gBAAAC;AAMAK,aASAV,kBAAA,SAAAxO,MACA,OAAAyO,OAAAzO,MAAAiJ,OAAA1I,eACA,IAAA,SACA,MAAAqO,iBAAAC,MAEA,KAAA,WACA,MAAAD,iBAAAE,QAEA,KAAA,UACA,MAAAF,iBAAAG,OAEA,KAAA,SACA,MAAAH,iBAAAI,MAEA,SACA,OAAA,IAUAT,kBAAA,SAAAG,UACA,OAAAA,UACA,IAAAE,iBAAAC,OACA,MAAA,QAEA,KAAAD,iBAAAE,SACA,MAAA,UAEA,KAAAF,iBAAAG,QACA,MAAA,SAEA,KAAAH,iBAAAI,OACA,MAAA,QAEA,SACA,OAAA,MAGAL,OAAAC,iBAAA3X,OAEA,OAAAgY,qBCpJAhb,OAAA,iDACA,SACA,iDACA,qDACA,SAAAmE,EAAA8V,eAAAe;AACA,YA2RA,SAAAG,oBAAA/Z,YACA,MAAAA,aAAA+C,EAAAiU,SAAAhX,aAAAga,oBAAApX,KAAA5C,YA1RA,GAAAia,gBASAC,YAAA,SAAAC,WAAA7N,MAGA,QAAA8N,WAAAC,KACA,GAAAA,IAAA,cAAA/N,KAEA,MADAgO,OAAAD,KACA,EALA,GAAAC,OAAA,IAeA,OANAvX,GAAAuC,QAAA6U,YACApX,EAAAqI,QAAA+O,WAAAC,WACAD,YACAC,UAAAD,YAGAG,OAUAC,4BAAA,SAAAC,YAAAC,MAMA,IALA,GAAAC,OAAA3X,EAAAuC,QAAAmV,MAAAA,KAAAA,KAAAtK,MAAA,KACAwK,IAAAD,MAAA/W,OACAwW,WAAAK,YACAI,EAAA,EAEAT,YAAAS,EAAAD,KACAR,WAAAF,cAAAC,YAAAC,WAAAO,MAAAE,MACAT,YAAAS,EAAAD,MACAR,WAAAA,WAAAA,YAAAA,WAAAU;AAIA,MAAAV,aAAA,MAUAW,0BAAA,SAAAN,YAAAC,MACA,GAAAtD,QAAA,KACAuD,MAAA3X,EAAAuC,QAAAmV,MAAAA,KAAAA,KAAAtK,MAAA,KACA4K,SAAAL,MAAAM,MACAb,WAAAF,cAAAM,4BAAAC,YAAAE,MAMA,OAJAP,aAAAA,WAAAY,YACA5D,OAAAgD,WAAAY,WAGA5D,QAQA8D,qBAAA,SAAAC,SACA,MAAA9B,QAAArW,EAAAuG,SAAA4R,SAAAA,QAAAlb,WAAAkb,UAQAC,uBAAA,SAAAC,WACA,MAAAA,YAAAA,UAAAC,qBAQAC,0BAAA,SAAAF,WACA,MAAAA,YAAAA,UAAAnF,mBAAAmF,UAAAnF,kBAAAsF,cAQAC,wBAAA,SAAAJ,UAAArU;AACAhE,EAAAqI,QAAA6O,cAAAkB,uBAAAC,WAAArU,KAQA0U,2BAAA,SAAAL,UAAArU,IACAhE,EAAAqI,QAAA6O,cAAAqB,0BAAAF,WAAArU,KAQA2U,qCAAA,SAAAN,UAAArU,IACA,QAAA4U,mBAAAC,gBACA7Y,EAAAuC,QAAAsW,gBACA7Y,EAAAqI,QAAAwQ,eAAAD,mBACAC,iBACA7U,GAAA6U,gBAEAA,eAAAzB,WACAwB,kBAAAC,eAAAzB,YACAyB,eAAAf,aACAc,kBAAAC,eAAAf,cAKAc,kBAAA1B,cAAAqB,0BAAAF,aASAS,aAAA,SAAAT,UAAArU,IACA,GAAA+U,YASA,OARA/Y,GAAAgZ,WAAAhV,MACAA,GAAA;AAEAkT,cAAAuB,wBAAAJ,UAAA,SAAAF,SACAnU,KAAAA,GAAAmU,UACAY,SAAAnQ,KAAAsO,cAAAgB,qBAAAC,YAGAY,UAQAE,eAAA,SAAAZ,UAAAU,UACA,GAAAG,cAAAhC,cAAAkB,uBAAAC,WACAc,MAAAjC,cAAAqB,0BAAAF,UAEAU,UAAA/Y,EAAAoZ,QAAApZ,EAAAuC,QAAAwW,UAAAA,UAAAA,UAAA,SAAAZ,SACA,MAAAA,WAGAe,cACAlZ,EAAAoE,OAAA8U,aAAA,SAAAG,oBACA,QAAAN,SAAA7B,cAAAgB,qBAAAmB,uBAIAF,OACAnZ,EAAAoE,OAAA+U,MAAA,SAAA1B,aACA,QAAAsB,SAAA7B,cAAAgB,qBAAAT;AAaA6B,cAAA,SAAArc,WAAAsM,KAAAuN,aAEA,IAAAE,mBAAA/Z,YACA,KAAA,IAAAsc,WAAA,uCAGA,QACAxI,WAAA,qBACAxG,SACAiP,eAAA,GACAC,mBAAA,GACAC,eAAA,EACAC,eAAA,EACAC,cAAA,EACA3c,WAAAA,WACA6Z,YAAAD,kBAAAb,SAAAc,YAAAD,kBAAAJ,QACAoD,SAAA/D,eAAAE,SAAAzM,KAAAuM,eAAAV,SAYA0E,qBAAA,SAAAzB,UAAAQ,gBACA,GAAA3F,mBAAAmF,UAAAnF,iBAEA,KAAA2F,iBAAAA,eAAA,cAAA7Y,EAAAiU,SAAA4E,eAAA,aACA,KAAA,IAAAU,WAAA;AAcA,MAXArG,mBAMAA,kBAAAsF,eACAtF,kBAAAsF,kBANAtF,mBACAnC,WAAA,oBACAyH,iBAEAH,UAAAnF,kBAAAA,mBAKAA,kBAAAsF,aAAA5P,KAAAiQ,gBACAA,gBAWAkB,WAAA,SAAA1B,UAAAF,QAAAU,gBACA,GAAAK,cAAAb,UAAAC,mBAEA,KAAAH,SAAA,uBAAAA,QAAA,cAAAnB,mBAAAmB,QAAAlb,YACA,KAAA,IAAAsc,WAAA,oCAGA,IAAAV,eAAA,CACA,IAAA7B,mBAAA6B,eAAA5b,aAAA4b,eAAA5b,aAAAkb,QAAAlb,WACA,KAAA,IAAAsc,WAAA;AAGArC,cAAA4C,qBAAAzB,UAAAQ,gBASA,MANAK,gBACAA,gBACAb,UAAAC,oBAAAY,cAGAA,aAAAtQ,KAAAuP,SACAA,UAIAlB,oBAAA,6BAWA,OAAAC,iBCpSArb,OAAA,wDACA,SACA,iDACA,qDACA,SAAAmE,EAAA8V,eAAAe,mBACA,YAyNA,SAAAG,oBAAA/Z,YACA,MAAAA,aAAA+C,EAAAiU,SAAAhX,aAAAga,oBAAApX,KAAA5C,YAWA,QAAA+c,gBAAAzQ,KAAA0Q,KAAAC,OACA,GAAArB,gBAAAsB,qBAAAC,OAAA7Q,KAAA,MAAA0Q,KAAAC;AAOA,MALArB,gBAAAwB,YAAA,EACAxB,eAAAyB,YAAA,EACAzB,eAAA0B,uBAAA1D,kBAAAJ,QACAoC,eAAA2B,mBAAA1E,eAAAX,QAAAW,eAAAV,OAEAyD,eAQA,QAAA4B,YAAA5b,OAOA,MANAA,SACAA,UAEAmB,EAAAuC,QAAA1D,SACAA,OAAAA,QAEAA,MA1PA,GAAAsb,uBAUAC,OAAA,SAAA7Q,KAAAtM,WAAAma,YACA,GAAAyB,iBACA9H,WAAAxH,KAGA,KAAAA,OAAAvJ,EAAAiU,SAAA1K,MACA,KAAA,IAAAgQ,WAAA,4CAGA,IAAAtc,WAAA,CACA,IAAA+Z,mBAAA/Z,YACA,KAAA,IAAAsc,WAAA,uCAEAV,gBAAA5b,WAAAA,WAOA,MAJAma,aACA+C,qBAAAO,cAAA7B,eAAAzB;AAGAyB,gBAQA6B,cAAA,SAAA7B,eAAAzB,YACAyB,iBACA7Y,EAAAuC,QAAA6U,aACAyB,eAAAzB,aACAyB,eAAAzB,WAAA,MAEAyB,eAAAf,YAAAV,aAEAyB,eAAAf,cACAe,eAAAf,YAAA,MAEAV,aACAyB,eAAAzB,WAAAA,eAWAuD,cAAA,SAAA9B,eAAAzB,YACAyB,gBAAAzB,aACAyB,eAAAzB,aACAyB,eAAAf,YAAA2C,WAAA5B,eAAAzB,YACAyB,eAAAzB,WAAA,MAGApX,EAAAuC,QAAA6U,YACAyB,eAAAf,YAAA2C,WAAA5B,eAAAf,aAAA5P,OAAAkP,YAEAyB,eAAAf,YACAe,eAAAf,YAAAlP,KAAAwO,YAEAyB,eAAAzB,WAAAA;EAaAwD,gBAAA,SAAA3d,WAAAma,YACA,IAAAJ,mBAAA/Z,YACA,KAAA,IAAAsc,WAAA,uCAEA,OAAAY,sBAAAC,OAAA,kBAAAnd,WAAAma,aASAyD,IAAA,SAAAZ,KAAAC,OACA,MAAAF,gBAAA,MAAAC,KAAAC,QASAY,IAAA,SAAAb,KAAAC,OACA,MAAAF,gBAAA,MAAAC,KAAAC,QASAa,OAAA,SAAAd,KAAAC,OACA,MAAAF,gBAAA,SAAAC,KAAAC,QAQAc,IAAA,SAAAC,OACA,GAAApC,gBAAAsB,qBAAAC,OAAA,MAAA,KAAAK,WAAAQ,OAOA,OALApC,gBAAAwB,YAAA,EACAxB,eAAAyB,aAAA,EACAzB,eAAA0B,uBAAA1D,kBAAAJ,OAAAI,kBAAAH,SAAAG,kBAAAF;AACAkC,eAAA2B,mBAAA1E,eAAAX,QAAAW,eAAAV,OAEAyD,gBAaAqC,cAAA,SAAAje,WAAAsM,KAAA4R,OAAAC,kBAAAC,mBACA,GAAAxC,gBAAAsB,qBAAAC,OAAA,gBAEA,KAAApD,mBAAA/Z,YACA,KAAA,IAAAsc,WAAA,uCAIA,IAFAV,eAAAyC,mBAAAre,WAEAke,OAAA,CACA,IAAAnE,mBAAAmE,QACA,KAAA,IAAA5B,WAAA,8CAEAV,gBAAA0C,iBAAAJ,WAEAtC,gBAAA0C,iBAAA,EAQA,OALA1C,gBAAAgB,SAAA/D,eAAAE,SAAAzM,MACAsP,eAAA2C,kBAAA;AACA3C,eAAAuC,kBAAAX,WAAAW,mBACAvC,eAAAwC,kBAAAZ,WAAAY,mBAEAxC,gBASA4C,gBAAA,SAAAL,kBAAAC,mBACA,GAAAxC,gBAAAsB,qBAAAC,OAAA,kBAMA,OAJAvB,gBAAA2C,kBAAA,GACA3C,eAAAuC,kBAAAX,WAAAW,mBACAvC,eAAAwC,kBAAAZ,WAAAY,mBAEAxC,gBASA6C,UAAA,SAAA7c,MAAA0K,MACA,GAAAsP,gBAAAsB,qBAAAC,OAAA,YAKA,OAHAvB,gBAAAgB,SAAA/D,eAAAE,SAAAzM,KAAAuM,eAAAV,OACAyD,eAAAha,MAAA8c,WAAA9c,QAAA;AAEAga,iBAKA5B,oBAAA,6BA6CA,OAAAkD,wBCpQAte,OAAA,kDACA,UACA,SAAAmE,GACA,YAQA,SAAA4b,kBAAAC,UACA,MAAAA,WAAA,IAAAA,SAAApK,QAAA,UAQA,QAAAqK,gBAAAzD,UAAArU,IACAhE,EAAAqI,QAAAgQ,UAAAvO,UAAA,SAAAhL,UACAkB,EAAAqI,QAAAvJ,SAAAiL,mBAAA,SAAAC,mBACAhK,EAAAqI,QAAA2B,kBAAAxD,aAAA,SAAAvH,SACAe,EAAAqI,QAAApJ,QAAArB,WAAA,SAAAie,UACA7X,GAAA6X,SAAA5c,iBAOA,OAOA6c,eAAAA,eASAC,eAAA,SAAA1D,WACA,GAAAza,cAMA,OALAke,gBAAAzD,UAAA,SAAAwD;AACAD,iBAAAC,YACAje,WAAAie,WAAA,KAGA7b,EAAAgc,KAAApe,aASAqe,YAAA,SAAA5D,WACA,GAAAjb,WAMA,OALA0e,gBAAAzD,UAAA,SAAAwD,UACAD,iBAAAC,YACAze,QAAAye,WAAA,KAGA7b,EAAAgc,KAAA5e,aCvEAvB,OAAA,iDACA,SACA,OACA,iDACA,gDACA,uDACA,kDACA,SAAAmE,EAAAzC,GAAAuY,eAAAoB,cAAAiD,qBAAA+B,gBACA,YAgKA,SAAAC,gBAAAhE,SACA,GAAAlb,YAAAia,cAAAgB,qBAAAC,SACAiE,KAAA;AAOA,MANApc,GAAAqI,QAAAgU,gBAAA,SAAAC,gBACA,GAAAA,eAAAnE,UAAAlb,YAAA,IAAAA,WAAAwU,QAAA6K,eAAAC,QAEA,MADAH,MAAAE,gBACA,IAGAF,KAQA,QAAAI,kBAAArE,SACA,QAAAgE,eAAAhE,SAQA,QAAAsE,kBAAA1D,UACA,GAAA1a,SAOA,OANA2B,GAAAqI,QAAA0Q,SAAA,SAAAM,oBACA,GAAA+C,MAAAD,eAAA9C,mBACA+C,QACA/d,MAAA+d,KAAA7d,MAAA,KAGAyB,EAAAgc,KAAA3d,OAQA,QAAAqe,aAAA/Z,OACA,GAAAwE,QAAAnH,EAAAkX,cAAAqB,0BAAA5V,QAAAL,IAAA,SAAA6V,SACA,MAAAjB,eAAAa,0BAAAI,QAAA,yCACAlR,UAAA0V,OAAA9d;AAIA,MAHAmB,GAAAgR,QAAA7J,UACAA,QAAAyV,kBAEAC,KAAAC,IAAA,EAAA9c,EAAA8c,IAAA3V,SAQA,QAAA4V,qBAAApa,OACA,GAAAwE,UAQA,OAPA+P,eAAAyB,qCAAAhW,MAAA,SAAAkW,gBACA,kBAAAA,eAAA,aAAAA,eAAA0C,kBACApU,OAAAyB,KAAAiQ,eAAA0C,oBAGApU,OAAAnH,EAAAmH,QAAAF,UAAA0V,OAAA9d,QAEAsI,OAAAvG,OAAAuG,OAAA,GAAA,GAOA,QAAA6V,eAAAra,OACA,GAAA2V,qBAAApB,cAAAkB,uBAAAzV,OACA6V,aAAAtB,cAAAqB,0BAAA5V,OAGAuW,aAAAuD,iBAAAnE,qBACA2E,WAAAR,iBAAAjE,cACA0E,KAAAld,EAAA4G,WAAAsS,aAAA+D,YACAE,MAAAnd,EAAAod,KAAAlE,cAGAhG,kBAAA;AAGAiK,QAAAnd,EAAAod,KAAAH,cACAE,MAGA,IAAAA,OAAAnd,EAAAgR,QAAAkM,QAEAhK,kBAAA+J,WAAA,IAHA/J,kBAAA,QAOAvQ,MAAAhE,SACAN,MAAAge,gBACAgB,gBAAA,QACA9B,iBAAAwB,oBAAApa,OACA2a,SAAAZ,YAAA/Z,OACAuQ,kBAAAA,mBAQA,QAAAqK,eAAA5a,OACA,GAAA6a,iBAAAtG,cAAA4B,aAAAnW,MAAA6Z,iBACAtF,eAAA+B,eAAAtW,MAAA6a,iBAOA,QAAAC,YAAA9a,OACA,GAAA+a,sBACA/e,QAAAgE,MAAAhE,OAGA,IAAAA,QAAA,CAGA,GAFA+e,qBAAAC,sBAAAhf,QAAAuU,oBAEAwK,qBAGA,KAAA,IAAAE,OAAA,kCAAAjf,QAAAuU;AAFAwK,qBAAA/a,QAzRA,GAAAia,iBAAA,GAMAP,iBACAwB,MACAtf,IAAA,OACAd,MAAAF,GAAA,QACAmB,YAAAnB,GAAA,6DAEAugB,QACAvf,IAAA,SACAd,MAAAF,GAAA,UACAmB,YAAAnB,GAAA,8EAEAwgB,OACAxf,IAAA,QACAd,MAAAF,GAAA,eACA4a,QAAA,cACA5O,KAAAuM,eAAAV,MACA1W,YAAAnB,GAAA,0JAEAse,UACAtd,IAAA,WACAd,MAAAF,GAAA,kBACAgf,OAAA,SACAhT,KAAAuM,eAAAV,MACA1W,YAAAnB,GAAA;EAEAygB,KACAzf,IAAA,MACAd,MAAAF,GAAA,aACAgf,OAAA,QACAhT,KAAAuM,eAAAZ,QACAxW,YAAAnB,GAAA,wQAUAogB,uBAKAE,KAAA,SAAAlb,OAEA4a,cAAA5a,QAOAmb,OAAA,aAQAC,MAAA,SAAApb,OACA,GACAwV,SAAAU,eADAyD,eAAAD,gBAAA0B,KAIAR,eAAA5a,OAGAwV,QAAAjB,cAAAoC,cAAAgD,eAAAnE,QAAAmE,eAAA/S,MACAsP,eAAAsB,qBAAAS,gBAAA0B,eAAAnE,QACAgC,qBAAAa,IACAb,qBAAAe,cAAAvY,MAAAhE,QAAA0e,iBAAA,EAAA1a,MAAAhE,QAAA4c;AAIArE,cAAA6C,WAAApX,MAAAwV,QAAAU,iBAOAgD,SAAA,SAAAlZ,OACA,GAAA2Z,gBAAAD,gBAAAR,QAGA0B,eAAA5a,OAGA3C,EAAAqI,QAAA6T,eAAAH,eAAApZ,OAAA,SAAAkZ,UACA,GAAA1D,SAAAU,eACA5b,WAAAqf,eAAAC,OAAAV,SAAAoC,aAGA9F,SAAAjB,cAAAoC,cAAArc,WAAAqf,eAAA/S,MACAsP,eAAAsB,qBAAAS,gBAAA3d,WACAkd,qBAAAa,IACAb,qBAAAe,cAAAvY,MAAAhE,QAAA0e,iBAAA,EAAA1a,MAAAhE,QAAA4c,iBAAAM,YAIA3E,cAAA6C,WAAApX,MAAAwV,QAAAU,mBAQAmF,IAAA,SAAArb,OACA,GAAA2Z,gBAAAD,gBAAA2B;AAGAT,cAAA5a,OAGA3C,EAAAqI,QAAA6T,eAAAH,eAAApZ,OAAA,SAAAkZ,UACA,GAAA1D,SAAAU,eACA5b,WAAAqf,eAAAC,OAAAV,SAAAoC,aAGA9F,SAAAjB,cAAAoC,cAAArc,WAAAqf,eAAA/S,MACAsP,eAAAsB,qBAAAS,gBAAA3d,WACAkd,qBAAAU,IACAV,qBAAAY,OACAZ,qBAAAa,IACAb,qBAAAe,cAAAvY,MAAAhE,QAAA0e,iBAAA,EAAA1a,MAAAhE,QAAA4c,iBAAAM,WAEA1B,qBAAAsB,gBAAAI,WAEA1B,qBAAAuB,UAAA/Y,MAAAhE,QAAA2e,SAAAxH,eAAAV,SAIA8B,cAAA6C,WAAApX,MAAAwV,QAAAU;IAkJA,QAOAqF,KAAA,SAAAvb,OAEAqa,cAAAra,QAQAwb,MAAA,SAAAxb,OAEA8a,WAAA9a,WCpUA9G,OAAA,yCACA,SACA,SACA,SACA,UACA,OACA,oBACA,cACA,0BACA,2CACA,2CACA,+CACA,8CACA,8CACA,iDACA,gDACA,gDACA,gDACA,4BACA,gBACA,SACAuiB,OACAre,EACAC,EACA1D,QACAiB,GACA8gB,QACAC,SACAC,mBACApe,SAAA4S,SACAD,aACAR,YACAkM,YACAtK,eACAjU,UACA4H,cACA4W,cACAC,WACAC;AAGA,YAQA,IAAAve,WAAA,SAAAiO,IAAAuQ,QACA,MAAA,IAAAD,SAAA,SAAAE,QAAA1R,QACApN,EAAA+e,QAAAzQ,KAAA5N,QAAAme,OAAAG,SAAA,SACAC,KAAAH,SACAtQ,KAAA,SAAA0Q,KACA,MAAA9R,QAAA,GAAAyQ,OAAAqB,IAAAC,OAAA,MAAAD,IAAAE,kBAWA9e,cAAA,SAAAgO,IAAAjN,OACA,MAAA,IAAAud,SAAA,SAAAE,QAAA1R,QACA/L,OAAAA,MAAAR,QACAb,EAAA+e,QAAAzQ,KAAA+Q,KAAAhe,QACA4d,KAAAH,SACAtQ,KAAA,SAAA0Q,KACA,MAAA9R,QAAA,GAAAyQ,OAAAqB,IAAAC,OAAA,MAAAD,IAAAE,kBAWAE,YAEA1N,UAEA3J,eASAsX,MAAA,SAAAliB,SACA,GAGAmiB,QAAAhc,cAHAxF,KAAAtB,KACA2G,WAAArD,EAAA,iBACAyf,OAAAzf,EAAA,SAGAhC,MAAAiK,eAEA5K,QAAA4C,EAAArD,MAAAyhB,OAAAqB,SAAAriB;AACAA,QAAAuU,OAAAvU,QAAAuU,WACAvU,QAAAmS,OAAAnS,QAAAmS,WAIAxP,EAAA,kBAAA+C,GAAA,QAAA,SAAAC,GACAA,EAAA2B,iBAEA2Z,SACAA,QAAAqB,SAKAvf,SACAH,EAAAuH,QAAAnH,UAAAhD,QAAAuU,OAAAvQ,OACApB,EAAAuH,QAAAlH,cAAAjD,QAAAuU,OAAA/T,aAWA2F,cAAAvD,EAAArD,MAAAS,QAAAuU,QACAgO,SACAC,UAAA,SAAA/gB,OACA,MAAAgJ,eAAAyB,cAAAzK,MAAA,sBAEAghB,UAAA,SAAAhhB,OACA,MAAAgJ,eAAAyB,cAAAzK,MAAA,uBAGAihB,UACAC,QAAA7L,gBAEAjU,UAAAA,UACA+f,WAAA,SAAArd,OASA,MAPA8b,eAAAN,MAAAxb,OAGAkF,cAAA2B,kBAAA7G,OAGAkF,cAAAgC,iBAAAlH;CACA,KAKA4c,OAAAhB,mBACA0B,YAAA7c,WAAAG,eACA2c,IAAA,SAAAvd,OAEA8b,cAAAP,KAAAvb,OAGA5E,KAAAiK,YAAAH,cAAAC,mBAAAnF,OAGA+b,WAAAyB,SAAA,WAAAtY,cAAAgB,qBACA6V,WAAAyB,SAAA,eAAAtY,cAAAqB,yBACAwV,WAAAyB,SAAA,kBAAAtY,cAAAuB,qBAAArL,KAAAiK,cAAA,GAGA+K,SAAApQ,OACAhF,IAAAP,QAAAO,IACAqK,YAAAjK,KAAAiK,YACAuH,OAAAnS,QAAAmS,OACAoC,OAAAvU,QAAAuU,SAIAmB,aAAA3G,oBACAmG,YAAAnG,oBACAqS,YAAArS,oBACAqS,YAAA9T,SAEA3K,EAAAqgB,QACAlQ,IAAA,2BACApN,GAAA,0BAAA;AACA0b,YAAA9T,aAKA8U,OAAA1c,GAAA,QAAA,SAAAjB,OACAA,MAAA6C,iBAEA8a,OAAA5a,SAAA,cACA4a,OAAAtO,KAAA,YAAA,GAAAnP,SAAA,YACAwd,OAAAc,KAAA,WAEAb,OAAAtO,KAAA,YAAA,GAAAjP,YAAA,YAEAqc,WAAAzM,QAAAtU,GAAA,gBAEA,WAEAiiB,OAAAtO,KAAA,YAAA,GAAAjP,YAAA,kBAOA,OAAAod,cCnNAxjB,OAAA,uCACA,SACA,SACA,oBACA,gBACA,SAAAkE,EAAAC,EAAAqG,aAAAsY,SAEA,YAiDA,SAAA2B,eAAAC,YACA,SAAAvgB,EAAAuG,SAAAga,cAAAA,WAAAC,MAOA,QAAAC,mBAAAC,MACAA,MAAAA,KAAAC,YACAD,KAAAC;CAmBA,QAAAC,aAAAC,gBAAA/O,GAAAyO,WAAAO,YAAAC,YAYA,MATAC,eAAA,EACAC,MAAAnP,IAAA,KAEA9R,EAAAiU,SAAAsM,cACAA,YACAC,KAAAD,aAIA,GAAA5B,SAAA,SAAAE,SACAyB,cAAAC,YAEAW,SAAAX,WAAAC,MAAA,SAAAA,MAEA,GAAAW,SACAC,YAEAC,aAAAb,OAEAA,KAAAc,KAAAxP,GAAAyO,WAAAO,YAAAC,YAGAK,aAAAP,gBAAArd,SAAA,kBAAAsO,GAAA,MACAsP,aAAAxgB,SACA4f,KAAAe,MAAAH,cACAA,aAAAhd,UAIAoc,KAAAgB,cAEAP,MAAAnP,IAAA0O,KAGAW,QAAAX,KAAAiB,SAGAC,eAAAb,gBAAAM,SAGAA,QAAAhf,QAAA,QAAAuF,KAAA8Y,OAGAQ,cACAP,kBAAAD,OAIA3B,QAAA2B,QAEAna,aAAAoB,MAAAC,IAAA;AACAmX,QAAA,QAGA,SAAA9b,GACAsD,aAAAoB,MAAAC,IAAA,uCACAmX,QAAA,SAIAxY,aAAAoB,MAAAC,IAAA,8BACAmX,QAAA,SAYA,QAAA6C,gBAAAte,WAAA+d,SAEA,GAAAQ,QAAAC,QACAC,MAAAV,QAAA3kB,KAAA,QAEA,UAAAqlB,MAEAze,WAAA5B,OAAA2f,SAEA,UAAAU,MAEAze,WAAA0e,QAAAX,UAIAU,MAAA7hB,EAAA+hB,SAAAF,OACA7hB,EAAAgiB,MAAAH,OA+CAze,WAAA5B,OAAA2f,UA7CA/d,WAAAI,SAAA,WAAApF,KAAA,WAEA,GAAA6jB,MAAAliB,EAAAtD,MACAylB,OAAAD,KAAAzlB,KAAA,QAEA,IAAA,SAAA0lB,OAEAN,QAAAK,KACAN,OAAA,SAEA,IAAA,UAAAO,OAEAN,QAAA,KACAD,OAAAM,SAEA,CAIA,GAFAC,OAAAliB,EAAA+hB,SAAAG,QAEAliB,EAAAgiB,MAAAE,SAAAA,OAAAL,MAIA,MAHAD,SAAAK;AACAN,OAAA,MAEA,CACAO,UAAAL,MACAF,OAAAM,KACAC,OAAAL,QACAF,OAAAM,KACAL,QAAA,SAOAD,OACAA,OAAAQ,MAAAhB,SACAS,QACAA,QAAAQ,OAAAjB,SAEA/d,WAAA5B,OAAA2f,WAmBA,QAAAE,aAAAb,MACA,MAAAxgB,GAAAuG,SAAAia,OAAAxgB,GAAA,OAAA,SAAA,QAAA,cAAA+T,OAAA,SAAAK,OAAAnC,QACA,MAAAmC,SAAApU,EAAAgZ,WAAAwH,KAAAvO,WACA,GAnOA,GAAAvK,KAAA,iBAOA2a,KAAAtiB,EAAAqM,UAOA6U,SAOAD,cAAA,CAiNA,OA9MAqB,MAAAnS,IAAAxI,KAAA5E,GAAA,gBAAA4E,IAAA,WACAsZ,cAAA,EACAhhB,EAAAqI,QAAA4Y,MAAA,SAAAP,MACAD,kBAAAC,WA4MA1d,QAAAsd,cACAM,YAAAA,eCzPA/kB,OAAA,wCACA,SACA,SACA,kBACA,eACA,uCACA,SAAAkE,EAAAC,EAAAsiB,WAAA3D,QAAA4D;AACA,YAMA,IAAAC,oBAMAC,SAMAC,gBAKAvC,SAAA,SAAAc,OACA,GAAA0B,eAAA1B,SAOAxkB,MAAA0F,QAAA,iBAAAwgB,cAAAlmB,MAEA+lB,mBAAAG,cAOAlmB,KAAA0F,QAAA,gBAAAwgB,cAAAlmB,OAOAmmB,mBAAA,WACA,MAAAJ,yBAQAK,cAAA,SAAA/Q,IACA,MAAA0Q,qBAAAA,mBAAA1Q,KAQAgR,aAAA,SAAAhR,IACA,SAAA0Q,qBAAAA,mBAAA1Q,MAQAoO,IAAA,SAAApO,IACA,MAAA2Q,WAAAA,SAAA3Q,KAOAiR,KAAA,WACA,MAAA/iB,GAAAmH,OAAAsb,eAUAhB,OAAA,SAAAuB,UAAAlC,YAAAC,WAAA9X,UACA,GAAAlL,MAAAtB,KACA2G,WAAArD,EAAAijB,WACAC;AASAxmB,KAAA0F,QAAA,eAAAiB,WAAA0d,YAAAC,WAAAtkB,MAEAuD,EAAAkjB,MAAAzmB,KAAAmmB,qBAAA,SAAArC,WAAAzO,IACAmR,SAAAra,KAAA2Z,cAAA3B,YAAAxd,WAAA0O,GAAAyO,WAAAO,YAAAC,eAGApC,QAAA9X,IAAAoc,UAAA7gB,KAAA,SAAA+E,QACA,GAAA8Z,SACAwB,aAEAziB,EAAAqI,QAAAlB,OAAA,SAAAuZ,MACAA,OACAO,MAAArY,KAAA8X,MACA+B,SAAA/B,KAAAyC,SAAAzC,QAIA1gB,EAAAgZ,WAAA/P,WACAA,SAAA/L,KAAAa,KAAAkjB,MAAA7d,WAAA0d,YAAAC,WAAAhjB,MAWAA,KAAAoE,QAAA,cAAA8e,MAAA7d,WAAA0d,YAAAC,WAAAhjB,SAKA,OAAAukB,YAAAI,kBCrKA7mB,OAAA,2CAAA,cAAA,SAAAK,IACA,MAAAA,IAAAC,SAAA,SAAAC,WAAAC,OAAAC,QAAAC,SAAAC;AAKA,QAAAkB,UAAArB,OAAAG,MAGA,MAAA,UAPAC,KAAAC,cAAA,EAAA,YACAJ,QAAAG,KAAAE,MAAAL,QAAAF,WAAAE,SAAAE,KAAAA,QACA,IAAAI,QAAAC,OAAAO,QAAAN,OAAA,GAAAC,aAAA,WAAAC,iBAAAP,KAAAO,iBAAAe,KAAAtB,KAAAY,cAAAf,QAAAe,aAkDA,OA1CAP,SAAA,oDACAD,OAAAP,QAAA8mB,QAAAxmB,OAAAC,OAAAK,KAAAb,QAAAc,QAAAX,KAAAA,QACAK,OAAAR,QAAAA,OAAA+mB,OAAAxmB,aAAAC,UAAAE,aAAAF,OAAAK,KAAAb,QAAAc,QAAAX,KAAAA,OAAAK,QACAC,QAAAE,iBAAAJ,QACA,qCACAA,OAAAN,QAAA,GAAAY,KAAAb,OAAAA,QAAAA,OAAAgnB,QAAAlmB;AAAAW,QAAAC,KAAAC,KAAAC,GAAAF,KAAAG,QAAA,EAAAR,SAAAlB,MAAAA,KAAAA,QACAI,QAAA,IAAAA,UAAAE,QAAAF,QACAE,QAAA,uIACAE,kBAAAH,OAAAP,QAAAiB,IAAAlB,QAAAA,OAAAkB,GAAAH,SAAAD,QAAAX,KAAAA,MAAAK,OAAAA,OAAAK,KAAAb,OAAA,4BAAAe,SAAAC,cAAAH,KAAAb,OAAA,KAAA,4BAAAe,WACA,wFACAJ,kBAAAH,OAAAP,QAAAiB,IAAAlB,QAAAA,OAAAkB,GAAAH,SAAAD,QAAAX,KAAAA,MAAAK,OAAAA,OAAAK,KAAAb,OAAA,0BAAAe,SAAAC,cAAAH,KAAAb,OAAA,KAAA,0BAAAe,WACA,uMACAJ,kBAAAH,OAAAP,QAAAiB,IAAAlB,QAAAA,OAAAkB;AAAAH,SAAAD,QAAAX,KAAAA,MAAAK,OAAAA,OAAAK,KAAAb,OAAA,cAAAe,SAAAC,cAAAH,KAAAb,OAAA,KAAA,cAAAe,WACA,+PACAJ,kBAAAH,OAAAP,QAAAiB,IAAAlB,QAAAA,OAAAkB,GAAAH,SAAAD,QAAAX,KAAAA,MAAAK,OAAAA,OAAAK,KAAAb,OAAA,eAAAe,SAAAC,cAAAH,KAAAb,OAAA,KAAA,eAAAe,WACA,kNACAJ,kBAAAH,OAAAP,QAAAiB,IAAAlB,QAAAA,OAAAkB;AAAAH,SAAAD,QAAAX,KAAAA,MAAAK,OAAAA,OAAAK,KAAAb,OAAA,SAAAe,SAAAC,cAAAH,KAAAb,OAAA,KAAA,SAAAe,WACA,kNACAJ,kBAAAH,OAAAP,QAAAiB,IAAAlB,QAAAA,OAAAkB,GAAAH,SAAAD,QAAAX,KAAAA,MAAAK,OAAAA,OAAAK,KAAAb,OAAA,kBAAAe,SAAAC,cAAAH,KAAAb,OAAA,KAAA,kBAAAe,WACA,oNACAJ,kBAAAH,OAAAP,QAAAiB,IAAAlB,QAAAA,OAAAkB;AAAAH,SAAAD,QAAAX,KAAAA,MAAAK,OAAAA,OAAAK,KAAAb,OAAA,WAAAe,SAAAC,cAAAH,KAAAb,OAAA,KAAA,WAAAe,WACA,oNACAJ,kBAAAH,OAAAP,QAAAiB,IAAAlB,QAAAA,OAAAkB,GAAAH,SAAAD,QAAAX,KAAAA,MAAAK,OAAAA,OAAAK,KAAAb,OAAA,mBAAAe,SAAAC,cAAAH,KAAAb,OAAA,KAAA,mBAAAe,WACA,sNACAJ,kBAAAH,OAAAP,QAAAiB,IAAAlB,QAAAA,OAAAkB;AAAAH,SAAAD,QAAAX,KAAAA,MAAAK,OAAAA,OAAAK,KAAAb,OAAA,aAAAe,SAAAC,cAAAH,KAAAb,OAAA,KAAA,aAAAe,WACA,iNACAJ,kBAAAH,OAAAP,QAAAiB,IAAAlB,QAAAA,OAAAkB,GAAAH,SAAAD,QAAAX,KAAAA,MAAAK,OAAAA,OAAAK,KAAAb,OAAA,gCAAAe,SAAAC,cAAAH,KAAAb,OAAA,KAAA,gCAAAe,WACA,mNACAJ,kBAAAH,OAAAP,QAAAiB,IAAAlB,QAAAA,OAAAkB;AAAAH,SAAAD,QAAAX,KAAAA,MAAAK,OAAAA,OAAAK,KAAAb,OAAA,UAAAe,SAAAC,cAAAH,KAAAb,OAAA,KAAA,UAAAe,WACA,kZACAJ,kBAAAH,OAAAP,QAAAiB,IAAAlB,QAAAA,OAAAkB,GAAAH,SAAAD,QAAAX,KAAAA,MAAAK,OAAAA,OAAAK,KAAAb,OAAA,gBAAAe,SAAAC,cAAAH,KAAAb,OAAA,KAAA,gBAAAe,WACA,+BACAJ,kBAAAH,OAAAP,QAAAiB,IAAAlB,QAAAA,OAAAkB;AAAAH,SAAAD,QAAAX,KAAAA,MAAAK,OAAAA,OAAAK,KAAAb,OAAA,MAAAe,SAAAC,cAAAH,KAAAb,OAAA,KAAA,MAAAe,WACA,oMACAJ,kBAAAH,OAAAP,QAAAiB,IAAAlB,QAAAA,OAAAkB,GAAAH,SAAAD,QAAAX,KAAAA,MAAAK,OAAAA,OAAAK,KAAAb,OAAA,oCAAAe,SAAAC,cAAAH,KAAAb,OAAA,KAAA,oCAAAe,WACA,gMACAJ,kBAAAH,OAAAP,QAAAiB,IAAAlB,QAAAA,OAAAkB;AAAAH,SAAAD,QAAAX,KAAAA,MAAAK,OAAAA,OAAAK,KAAAb,OAAA,2CAAAe,SAAAC,cAAAH,KAAAb,OAAA,KAAA,2CAAAe,WACA,wRACAJ,kBAAAH,OAAAP,QAAAiB,IAAAlB,QAAAA,OAAAkB,GAAAH,SAAAD,QAAAX,KAAAA,MAAAK,OAAAA,OAAAK,KAAAb,OAAA,sDAAAe,SAAAC,cAAAH,KAAAb,OAAA,KAAA,sDAAAe,WACA,qFACAJ,kBAAAH,OAAAP,QAAAiB,IAAAlB,QAAAA,OAAAkB;AAAAH,SAAAD,QAAAX,KAAAA,MAAAK,OAAAA,OAAAK,KAAAb,OAAA,sDAAAe,SAAAC,cAAAH,KAAAb,OAAA,KAAA,sDAAAe,WACA,qECrDAvB,OAAA,+CAAA,cAAA,SAAAK,IACA,MAAAA,IAAAC,SAAA,SAAAC,WAAAC,OAAAC,QAAAC,SAAAC,MAKA,QAAAkB,UAAArB,OAAAG,MAEA,GAAAI,QAAAC,OAAAC,OAAA,EAoBA,OAnBAA,SAAA,mEACAF,OAAAN,QAAA,GAAAY,KAAAb,OAAAA,QAAAA,OAAAinB,QAAAnmB,QAAAW,QAAAC,KAAAG,QAAA,EAAAqlB,SAAA/mB;AAAAyB,GAAAF,KAAAG,QAAA,EAAAC,SAAA3B,MAAAA,KAAAA,QACAI,QAAA,IAAAA,UAAAE,QAAAF,QACAE,QAAA,eACAD,OAAAP,QAAAwV,IAAAlV,OAAAC,OAAAK,KAAAb,QAAAc,QAAAX,KAAAA,QACAK,OAAAR,QAAAA,OAAAyV,GAAAlV,aAAAC,UAAAE,aAAAF,OAAAK,KAAAb,QAAAc,QAAAX,KAAAA,OAAAK,QACAC,QAAAE,iBAAAJ,QACA,yEACAC,OAAAP,QAAAmB,OAAAb,OAAAC,OAAAK,KAAAb,QAAAc,QAAAX,KAAAA,QACAK,OAAAR,QAAAA,OAAAoB,MAAAb,aAAAC,UAAAE,aAAAF,OAAAK,KAAAb,QAAAc,QAAAX,KAAAA,OAAAK,QACAC,QAAAE,iBAAAJ,QACA;CACAC,OAAAP,QAAAmB,OAAAb,OAAAC,OAAAK,KAAAb,QAAAc,QAAAX,KAAAA,QACAK,OAAAR,QAAAA,OAAAoB,MAAAb,aAAAC,UAAAE,aAAAF,OAAAK,KAAAb,QAAAc,QAAAX,KAAAA,OAAAK,QACAC,QAAAE,iBAAAJ,QACA,6LACAA,OAAAN,QAAA,GAAAY,KAAAb,QAAAO,OAAAP,QAAAA,OAAAoW,SAAA,MAAA7V,QAAAA,UAAA,EAAAA,OAAAA,OAAAgE,SAAAzD,QAAAW,QAAAC,KAAAG,QAAA,GAAAslB,UAAAhnB,MAAAyB,GAAAF,KAAAG,QAAA,EAAAulB,SAAAjnB,MAAAA,KAAAA,QACAI,QAAA,IAAAA,UAAAE,QAAAF,QACAE,QAAA;CAGA,QAAAqB,UAAA9B,OAAAG,MAGA,MAAA,SAGA,QAAA+mB,UAAAlnB,OAAAG,MAGA,MAAA,YAGA,QAAAinB,UAAApnB,OAAAG,MAEA,GAAAI,QAAAE,OAAA,EAKA,OAJAA,SAAA,sHACAF,OAAAN,QAAA8B,KAAAlB,KAAAb,OAAAA,QAAAA,OAAAoW,UAAAtV,QAAAW,QAAAC,KAAAC,KAAAC,GAAAF,KAAAG,QAAA,EAAAwlB,SAAAlnB,MAAAA,KAAAA,QACAI,QAAA,IAAAA,UAAAE,QAAAF,QACAE,QAAA,4DAGA,QAAA4mB,UAAArnB,OAAAG,MAEA,GAAAI,QAAAC,OAAAC,OAAA,EA0BA,OAzBAA,SAAA;AACAF,OAAAN,QAAA,GAAAY,KAAAb,OAAAA,QAAAA,OAAAinB,QAAAnmB,QAAAW,QAAAC,KAAAG,QAAA,EAAAqlB,SAAA/mB,MAAAyB,GAAAF,KAAAG,QAAA,EAAAC,SAAA3B,MAAAA,KAAAA,QACAI,QAAA,IAAAA,UAAAE,QAAAF,QACAE,QAAA,eACAD,OAAAP,QAAAwV,IAAAlV,OAAAC,OAAAK,KAAAb,QAAAc,QAAAX,KAAAA,QACAK,OAAAR,QAAAA,OAAAyV,GAAAlV,aAAAC,UAAAE,aAAAF,OAAAK,KAAAb,QAAAc,QAAAX,KAAAA,OAAAK,QACAC,QAAAE,iBAAAJ,QACA,iFACAC,OAAAP,QAAAmB,OAAAb,OAAAC,OAAAK,KAAAb,QAAAc,QAAAX,KAAAA,QACAK,OAAAR,QAAAA,OAAAoB,MAAAb,aAAAC,UAAAE,aAAAF,OAAAK,KAAAb,QAAAc,QAAAX,KAAAA;GAAAK,QACAC,QAAAE,iBAAAJ,QACA,6EACAC,OAAAP,QAAAmB,OAAAb,OAAAC,OAAAK,KAAAb,QAAAc,QAAAX,KAAAA,QACAK,OAAAR,QAAAA,OAAAoB,MAAAb,aAAAC,UAAAE,aAAAF,OAAAK,KAAAb,QAAAc,QAAAX,KAAAA,OAAAK,QACAC,QAAAE,iBAAAJ,QACA,qFACAC,OAAAP,QAAAqnB,UAAA/mB,OAAAC,OAAAK,KAAAb,QAAAc,QAAAX,KAAAA,QACAK,OAAAR,QAAAA,OAAAsnB,SAAA/mB,aAAAC,UAAAE,aAAAF,OAAAK,KAAAb,QAAAc,QAAAX,KAAAA,OAAAK,QACAC,QAAAE,iBAAAJ,QACA,IACAI,kBAAAJ,OAAAP,QAAAA,OAAA+E;AAAAxE,OAAA,MAAAA,QAAAA,UAAA,EAAAA,OAAAA,OAAAgE,aAAAhE,UAAAG,aAAAH,OAAAyK,MAAAhL,QAAAO,SACA,mLACAA,OAAAN,QAAA8B,KAAAlB,KAAAb,OAAAA,QAAAA,OAAA+E,OAAAjE,QAAAW,QAAAC,KAAAC,KAAAC,GAAAF,KAAAG,QAAA,EAAA0lB,SAAApnB,MAAAA,KAAAA,QACAI,QAAA,IAAAA,UAAAE,QAAAF,QACAE,QAAA,2GAGA,QAAA8mB,UAAAvnB,OAAAG,MAEA,GAAAI,QAAAC,OAAAC,OAAA,EAgCA,OA/BAA,SAAA;AACAF,OAAAN,QAAA,GAAAY,KAAAb,OAAAA,QAAAA,OAAAinB,QAAAnmB,QAAAW,QAAAC,KAAAC,KAAAC,GAAAF,KAAAG,QAAA,EAAA2lB,SAAArnB,MAAAA,KAAAA,QACAI,QAAA,IAAAA,UAAAE,QAAAF,QACAA,OAAAN,QAAA,GAAAY,KAAAb,OAAAA,QAAAA,OAAAynB,SAAA3mB,QAAAW,QAAAC,KAAAC,KAAAC,GAAAF,KAAAG,QAAA,GAAA6lB,UAAAvnB,MAAAA,KAAAA,QACAI,QAAA,IAAAA,UAAAE,QAAAF,QACAA,OAAAN,QAAA,GAAAY,KAAAb,OAAAA,QAAAA,OAAAsnB,UAAAxmB,QAAAW,QAAAC,KAAAC,KAAAC,GAAAF,KAAAG,QAAA,GAAA8lB,UAAAxnB,MAAAA,KAAAA,QACAI,QAAA,IAAAA,UAAAE,QAAAF,QACAA,OAAAN,QAAA,GAAAY,KAAAb,OAAAA,QAAAA,OAAA4nB,QAAA9mB,QAAAW,QAAAC,KAAAG,QAAA,GAAAgmB,UAAA1nB,MAAAyB,GAAAF,KAAAG,QAAA,GAAAimB,UAAA3nB,MAAAA,KAAAA,QACAI,QAAA,IAAAA,UAAAE,QAAAF;AACAE,QAAA,eACAD,OAAAP,QAAAwV,IAAAlV,OAAAC,OAAAK,KAAAb,QAAAc,QAAAX,KAAAA,QACAK,OAAAR,QAAAA,OAAAyV,GAAAlV,aAAAC,UAAAE,aAAAF,OAAAK,KAAAb,QAAAc,QAAAX,KAAAA,OAAAK,QACAC,QAAAE,iBAAAJ,QACA,qBACAC,OAAAP,QAAA8nB,UAAAxnB,OAAAC,OAAAK,KAAAb,QAAAc,QAAAX,KAAAA,QACAK,OAAAR,QAAAA,OAAA+nB,SAAAxnB,aAAAC,UAAAE,aAAAF,OAAAK,KAAAb,QAAAc,QAAAX,KAAAA,OAAAK,QACAC,QAAAE,iBAAAJ,QACA,kGACAC,OAAAP,QAAAmB,OAAAb,OAAAC,OAAAK,KAAAb,QAAAc,QAAAX,KAAAA,QACAK,OAAAR,QAAAA,OAAAoB;AAAAb,aAAAC,UAAAE,aAAAF,OAAAK,KAAAb,QAAAc,QAAAX,KAAAA,OAAAK,QACAC,QAAAE,iBAAAJ,QACA,wFACAA,OAAAN,QAAA,GAAAY,KAAAb,OAAAA,QAAAA,OAAAynB,SAAA3mB,QAAAW,QAAAC,KAAAG,QAAA,GAAAmmB,UAAA7nB,MAAAyB,GAAAF,KAAAG,QAAA,GAAAomB,UAAA9nB,MAAAA,KAAAA,QACAI,QAAA,IAAAA,UAAAE,QAAAF,QACAE,QAAA,6FACAE,kBAAAJ,OAAA,MAAAJ,MAAAA,QAAA,EAAAA,KAAAA,KAAAP,YAAAW,UAAAG,aAAAH,OAAAyK,MAAAhL,QAAAO,SACA;CACAC,OAAAP,QAAAmB,OAAAb,OAAAC,OAAAK,KAAAb,QAAAc,QAAAX,KAAAA,QACAK,OAAAR,QAAAA,OAAAoB,MAAAb,aAAAC,UAAAE,aAAAF,OAAAK,KAAAb,QAAAc,QAAAX,KAAAA,OAAAK,QACAC,QAAAE,iBAAAJ,QACA,qIAGA,QAAAinB,UAAAxnB,OAAAG,MAGA,MAAA,UAGA,QAAAunB,WAAA1nB,OAAAG,MAGA,MAAA,WAGA,QAAAwnB,WAAA3nB,OAAAG,MAGA,MAAA,YAGA,QAAA2nB,WAAA9nB,OAAAG,MAGA,MAAA,UAGA,QAAA0nB,WAAA7nB,OAAAG,MAGA,MAAA,UAGA,QAAA8nB,WAAAjoB,OAAAG,MAGA,MAAA,UAGA,QAAA6nB,WAAAhoB,OAAAG;AAEA,GAAAI,OAEA,OADAA,QAAAN,QAAA,GAAAY,KAAAb,OAAAA,QAAAA,OAAAsnB,UAAAxmB,QAAAW,QAAAC,KAAAG,QAAA,GAAAqmB,UAAA/nB,MAAAyB,GAAAF,KAAAG,QAAA,GAAAsmB,UAAAhoB,MAAAA,KAAAA,OACAI,QAAA,IAAAA,OAAAA,OACA,GAEA,QAAA4nB,WAAAnoB,OAAAG,MAGA,MAAA,WAGA,QAAA+nB,WAAAloB,OAAAG,MAEA,GAAAI,OAEA,OADAA,QAAAN,QAAA,GAAAY,KAAAb,OAAAA,QAAAA,OAAA4nB,QAAA9mB,QAAAW,QAAAC,KAAAG,QAAA,GAAAumB,UAAAjoB,MAAAyB,GAAAF,KAAAG,QAAA,GAAAwmB,UAAAloB,MAAAA,KAAAA,OACAI,QAAA,IAAAA,OAAAA,OACA,GAEA,QAAA8nB,WAAAroB,OAAAG,MAGA,MAAA,SAGA,QAAAioB,WAAApoB,OAAAG,MAGA,MAAA,SAGA,QAAAgnB,WAAAnnB,OAAAG,MAEA,GAAAI,QAAAC,OAAAO,QAAAN,OAAA,EAkBA,OAjBAA,SAAA,wJACAE,kBAAAH,OAAAP,QAAAiB,IAAAlB,QAAAA,OAAAkB;AAAAH,SAAAD,QAAAX,KAAAA,MAAAK,OAAAA,OAAAK,KAAAb,OAAA,sDAAAe,SAAAC,cAAAH,KAAAb,OAAA,KAAA,sDAAAe,WACA,6GACAJ,kBAAAH,OAAAP,QAAAiB,IAAAlB,QAAAA,OAAAkB,GAAAH,SAAAD,QAAAX,KAAAA,MAAAK,OAAAA,OAAAK,KAAAb,OAAA,sDAAAe,SAAAC,cAAAH,KAAAb,OAAA,KAAA,sDAAAe,WACA;CACAP,OAAAP,QAAAqoB,QAAA/nB,OAAAC,OAAAK,KAAAb,QAAAc,QAAAX,KAAAA,QACAK,OAAAR,QAAAA,OAAAsoB,OAAA/nB,aAAAC,UAAAE,aAAAF,OAAAK,KAAAb,QAAAc,QAAAX,KAAAA,OAAAK,QACAC,QAAAE,iBAAAJ,QACA,qBACAC,OAAAP,QAAA8nB,UAAAxnB,OAAAC,OAAAK,KAAAb,QAAAc,QAAAX,KAAAA,QACAK,OAAAR,QAAAA,OAAA+nB,SAAAxnB,aAAAC,UAAAE,aAAAF,OAAAK,KAAAb,QAAAc,QAAAX,KAAAA,OAAAK,QACAC,QAAAE,iBAAAJ,QACA,YACAI,kBAAAH,OAAAP,QAAAiB,IAAAlB,QAAAA,OAAAkB,GAAAH,SAAAD,QAAAX,KAAAA,MAAAK,OAAAA,OAAAK,KAAAb,OAAA,kBAAAe,SAAAC,cAAAH,KAAAb,OAAA,KAAA,kBAAAe,WACA,4EACAJ,kBAAAH,OAAAP,QAAAiB,IAAAlB,QAAAA,OAAAkB;AAAAH,SAAAD,QAAAX,KAAAA,MAAAK,OAAAA,OAAAK,KAAAb,OAAA,kBAAAe,SAAAC,cAAAH,KAAAb,OAAA,KAAA,kBAAAe,WACA,wNA1MAX,KAAAC,cAAA,EAAA,YACAJ,QAAAG,KAAAE,MAAAL,QAAAF,WAAAE,SAAAE,KAAAA,QACA,IAAAI,QAAAE,OAAA,GAAAiB,KAAAtB,KAAAM,aAAA,WAAAC,iBAAAP,KAAAO,iBAAAK,cAAAf,QAAAe,aAgNA,OAJAP,SAAA;AACAF,OAAAN,QAAA8B,KAAAlB,KAAAb,OAAAA,QAAAA,OAAAuoB,OAAAznB,QAAAW,QAAAC,KAAAC,KAAAC,GAAAF,KAAAG,QAAA,EAAAR,SAAAlB,MAAAA,KAAAA,QACAI,QAAA,IAAAA,UAAAE,QAAAF,QACAE,QAAA,gCChMAjB,OAAA,oCACA,SACA,SACA,OACA,0CACA,8CACA,mBACA,SAAAkE,EAAAC,EAAAzC,GAAAsnB,aAAAC,iBAAAC,YACA,YAOA,IAAAC,UACA1B,OAAA,SACA2B,UAAA,YACAC,YAAA,cACA7B,OAAA,SACA8B,SAAA,WACArB,QAAA,UACAH,SAAA,WACAM,OAAA,SACAmB,OAAA,SACAC,KAAA,qBACAC,OACAzlB,KAAA;AACAf,SAAA,kBACAymB,YAAA,uBASAC,YACAC,UAAA,iBACAC,UAAA,yBACAC,KAAA,sBACAC,eAAA,6BACAC,YAAA,wBACAC,aAAA,iDACAC,WAAA,+CACAC,eAAA,mDACAC,YAAA,gDACAC,UAAA,sBACAC,gBAAA,6CACAvB,MAAA,sBACAwB,WAAA,6CACA3T,SAAA;AACA4T,cAAA,gDACAjlB,MAAA,sBACAklB,WAAA,6CACAC,UAAA,4CACAC,MAAA,sBACAC,YAAA,oCACAC,SAAA,yBACAC,QAAA,UACAzB,YAAA,eACA0B,kBAAA,qBACAxB,OAAA,UACAzB,SAAA,YACAG,QAAA,WACA+C,WAAA,iBACAC,YAAA,kBACAzD,OAAA,WASA0D,YACAlgB,IAAA,GACAmgB,WAAAxB,WAAA7B,SACAG,QAAA0B,WAAAqB,WACAlD,SAAA6B,WAAAsB,YACAG,SAAAzB,WAAAnC,QAQA6D;AACAC,YAAA,cACAC,qBAAA,iBACAC,YAAA,eAQAC,eACAznB,KAAA,OACAf,SAAA,WACAymB,YAAA,eAOAgC,YAWAjG,KAAA,SAAAkG,QAAApqB,SACA,GAAAqqB,aAAAznB,EAAAuG,SAAAnJ,UAAAA,YACAsqB,WAAA,UAAAD,YAAArE,OACAuE,aAAAD,WAAA,SAAA,SAeA,IAbAjrB,KAAAW,QAAAqqB,YACAhrB,KAAA0oB,UAAA,EACA1oB,KAAA4mB,SAAAoE,YAAApE,OACA5mB,KAAAmrB,cAAA,MAGAnrB,KAAAorB,YACAprB,KAAAorB,WAAAzjB,SAIA3H,KAAA2G,WAAArD,EAAAynB,SACAG,aAAAlrB,KAAA2G,WAAAukB,eACAA,aAMA,KAAA,IAAA/J,OAAA,wDAQA,OAbA+J,cAAAzqB,KAAAT,KAAA2G,WAAAyhB;AACAzB,OAAAsE,WAAA,QAAA,OACArE,OAAA5mB,KAAA4mB,UAOA5mB,KAAAqrB,WACArrB,KAAAsrB,cACAtrB,KAAAurB,wBAEAvrB,MAOAqrB,SAAA,WACArrB,KAAAorB,WAAAprB,KAAA2G,WAAAqB,KAAA+gB,WAAAC,WAGAhpB,KAAAwrB,cAAAxrB,KAAAorB,WAAApjB,KAAA+gB,WAAAM,cACArpB,KAAAyrB,YAAAzrB,KAAAorB,WAAApjB,KAAA+gB,WAAAO,YACAtpB,KAAA0rB,gBAAA1rB,KAAAorB,WAAApjB,KAAA+gB,WAAAQ,gBACAvpB,KAAA2rB,aAAA3rB,KAAAorB,WAAApjB,KAAA+gB,WAAAS,aAGAxpB,KAAA4rB,WAAA5rB,KAAAorB,WAAApjB,KAAA+gB,WAAAE,WACAjpB,KAAA6rB,SAAA7rB,KAAA4rB,WAAA5jB,KAAA,MAGAhI,KAAA8rB,MAAA9rB,KAAAorB,WAAApjB,KAAA+gB,WAAAG,MAGAlpB,KAAA+rB,aAAA/rB,KAAAorB,WAAApjB,KAAA+gB,WAAAK;EAOAkC,YAAA,WACA,GAAAhqB,MAAAtB,IAGAA,MAAAorB,WAAA/kB,GAAA,QAAA0iB,WAAAC,UAAAD,WAAAI,eAAA,WACA7nB,KAAAonB,WAIApnB,KAAA8pB,WAAAY,YAAAzD,QAAAC,WACAlnB,KAAA8pB,WAAAjjB,SAAAogB,QAAAC,YACAlnB,KAAA2qB,mBAKAjsB,KAAAorB,WAAA/kB,GAAA,QAAA0iB,WAAAC,UAAAD,WAAAW,gBAAA,WACA,IAAApoB,KAAAonB,SAAA,CAIA,GAAAzjB,QAAA3B,EAAAtD,MAAAksB,QAAAnD,WAAAU,UACAnoB,MAAA6qB,aAAAlnB,OAAA8jB,WAAAU,cAIAzpB,KAAA8rB,MAAAzlB,GAAA,QAAA0iB,WAAAC,UAAAD,WAAAY,WAAA,WACA,IAAAroB,KAAAonB,SAAA,CAIA,GAAAzjB,QAAA3B,EAAAtD,MAAAksB,QAAAnD,WAAAZ,OACAvhB,KAAAtF,KAAA6qB,aAAAlnB,OAAA8jB,WAAAZ,MAEAvhB,QACA3B,OAAAkD,SAAAogB,QAAA1B,QACAvlB,KAAA2qB,gBAEA3qB,KAAA8qB,UAAAnnB,OAAA+C,KAAA+gB,WAAA/S,UAAA5H,QAAAnJ;IAMAjF,KAAA8rB,MAAAzlB,GAAA,QAAA0iB,WAAAC,UAAAD,WAAAa,cAAA,WACA,IAAAtoB,KAAAonB,SAAA,CAIA,GAAAzjB,QAAA3B,EAAAtD,MAAAksB,QAAAnD,WAAA/S,SAEA1U,MAAA6qB,aAAAlnB,OAAA8jB,WAAA/S,aAIAhW,KAAA8rB,MAAAzlB,GAAA,QAAA0iB,WAAAC,UAAAD,WAAAc,WAAA,SAAAzkB,OACA,IAAA9D,KAAAonB,SAAA,CAIA,GACA7Y,SADAkE,MAAAzQ,EAAAtD,MAAAksB,QAAAnD,WAAApkB,MAGAoP,OAAA5L,SAAAogB,QAAAG,YACA7Y,QAAAvM,EAAA8B,MAAA0K,QACAD,QAAA9G,GAAAggB,WAAAgB,SAAAzoB,KAAA8pB,WAAAjjB,SAAAogB,QAAAC,WACAzU,MAAA5L,SAAAogB,QAAAI,SACArnB,KAAA+qB,MAAAtY,QAGAzS,KAAAgrB,QAAAvY,OACAzS,KAAAirB,MAAAxY,YAMA/T,KAAA8rB,MAAAzlB,GAAA,QAAA0iB,WAAAC,UAAAD,WAAAiB,YAAA,WACA,IAAA1oB,KAAAonB,SAAA;AAIA,GAAAlD,MAAAliB,EAAAtD,KAEAwlB,MAAArd,SAAAogB,QAAAG,YACAlD,KAAAlgB,SAAAijB,QAAAG,UACApnB,KAAAirB,MAAA/G,UAKAxlB,KAAA4rB,WAAAvlB,GAAA,QAAA0iB,WAAAC,UAAA,KAAA,WACA,IAAA1nB,KAAAonB,SAAA,CAIA,GAAAlD,MAAAliB,EAAAtD,MACA2f,KAAA6F,KAAAzlB,KAAA,OAEAuB,MAAAuqB,SAAArmB,YAAA+iB,QAAA1B,QACAvlB,KAAA8pB,WAAA5lB,YAAA+iB,QAAAC,WACAhD,KAAAlgB,SAAAijB,QAAA1B,QAEAvlB,KAAAkrB,QAAA7M,UASA6M,QAAA,SAAAC,UACA,GAAAvZ,QAAAlT,KAAA8rB,MAAA9jB,KAAA+gB,WAAApkB,OAAAa,YAAA+iB,QAAA3B,QACAzhB,OAAAmlB,WAAAmC,SACAtnB,SACA+N,OAAA/N,OAAAA,QAAAG,SAAAijB,QAAA3B,QAEA5mB,KAAA0sB,yBAAAvnB,QACAnF,KAAAmrB,cAAAsB,UAUAH,QAAA,SAAA3E,SAAA/gB,MAEA,GAAA7E,UAAA4lB,UAAAA,SAAAgF,OAAAhF,SAAA3nB,KAAA8rB,MAAA9jB,KAAA,kBAAA2f,SAAA,KACAiF,UAAA7qB,SAAA8qB,aAAA7sB,KAAA8rB;AAUA,MAPAllB,OACA5G,KAAAosB,UAAAQ,WAIA5sB,KAAA8rB,MAAA9jB,KAAA+gB,WAAAmB,SAAA1kB,YAAA+iB,QAAA1B,QACA+F,UAAAE,IAAA/qB,UAAAuD,SAAAijB,QAAA1B,QACA9kB,UAQAkqB,cAAA,WAEA,GAAAlqB,UAAA/B,KAAA8rB,MAAA9jB,KAAA+gB,WAAApkB,MAAAokB,WAAAmB,SACA0C,UAAA7qB,SAAA8qB,aAAA7sB,KAAA8rB,MAKA,OAFA9rB,MAAAosB,UAAAQ,WAEA7qB,UASAqqB,UAAA,SAAAW,OAAAC,OACAA,MAAAhtB,KAAA8rB,OAAA9jB,KAAA+gB,WAAAN,aAAAnjB,SAAAijB,QAAAC,WACAuE,OAAAvnB,YAAA+iB,QAAAC,YASA2D,aAAA,SAAAc,MAAAC,kBACA,GAAA1E,WAAAyE,MAAA9kB,SAAAogB,QAAAC,UAWA,OATA0E,mBACAltB,KAAA8rB,MAAA9jB,KAAAklB,kBAAA5nB,SAAAijB,QAAAC;AAGAA,UACAyE,MAAAznB,YAAA+iB,QAAAC,WAEAyE,MAAA3nB,SAAAijB,QAAAC,WAEAA,WASA2E,aAAA,SAAApZ,MAAA6U,MACA7U,MAAA/L,KAAA+gB,WAAAgB,OAAAtV,KAAA,QAAA8T,QAAAK,KAAA,SAAAA,OAQAwE,gBAAA,SAAArZ,OACA,GAAA6U,MAAA,KACAyE,YAAA9E,QAAAI,OACA2E,SACA/E,QAAAlB,QACAkB,QAAArB,SACAqB,QAAAf,OAGAjkB,GAAAqI,QAAA0hB,QAAA,SAAAC,KACA,GAAAxZ,MAAA5L,SAAAolB,KAEA,MADA3E,MAAA2E,KACA,IAIAvtB,KAAAmtB,aAAApZ,MAAA6U,MAAAyE,cASAG,YAAA,SAAAzZ,MAAA0Z,MACA1Z,MAAAiY,YAAAzD,QAAAlB,QAAAoG,MACAztB,KAAAotB,gBAAArZ,QAQAsY,MAAA,SAAAtY,OACA,GAAAmU,QAAAnU,MAAAhU,KAAA,MACA2tB,aAAA3Z,MAAAhU,KAAA,YACA0tB,MAAA1Z,MAAA5L,SAAAogB,QAAAlB;AAEArnB,KAAAwtB,YAAAzZ,OAUA/T,KAAA0F,QAAA,QAAA+nB,KAAAC,aAAAxF,UAQAqE,MAAA,SAAAxY,OACA,GAAAmU,QAAAnU,MAAAhU,KAAA,MACA2tB,aAAA3Z,MAAAhU,KAAA,WASAC,MAAA0F,QAAA,QAAAgoB,aAAAxF,UAOAwE,uBAAA,SAAAlC,UACA,GAAAlpB,MAAAtB,KACAmF,OAAAmlB,WAAAE,SAAA,WAAA,WACAxqB,MAAA8rB,MAAA9jB,KAAA+gB,WAAA/S,UAAArU,KAAA,WACA,GAAAuQ,UAAA5O,EAAAtD,MACAkT,OAAAhB,SAAAlK,KAAA+gB,WAAApkB,OACAgpB,UAAAza,OAAA/N,OAAAA,QACAmc,MAAApO,OAAA/O,OACAypB,GAAAtM,MAAAqM,UAAAxpB,MACA7C,MAAAusB,YAAA3b,SAAAlK,KAAA+gB,WAAAkB,UAAA2D,GAAAtM,UAQAiK,sBAAA,WACA,GAAAb,aAAAG,cAAA7qB,KAAAW,QAAA+pB,cAAA,OACAoD,WAAAvF,QAAAM,MAAA6B,aACAqD,MAAA/tB,KAAAorB;AACA7nB,EAAAqI,QAAA2c,QAAAM,MAAA,SAAA0E,KACAQ,MAAAvoB,YAAA+nB,OAEAO,YACAC,MAAAzoB,SAAAwoB,YAEAC,MAAA/B,YAAAzD,QAAAE,YAAAzoB,KAAAW,QAAAiqB,cAQAoD,eAAA,SAAA3J,aACA,GAAA1jB,SAAAX,KAAAW,OACA4C,GAAAqI,QAAA6e,YAAA,SAAAwD,UAAAC,YACAzgB,SAAA4W,YAAA6J,cACAvtB,QAAAstB,WAAA5J,YAAA6J,gBAQAC,aAAA,WACA,GAAAC,aAAApuB,KAAAouB,YACA7D,WAAA8D,OAAAD,YAAA9M,OAAA+M,OAAAD,YAAAlH,SAGAlnB,MAAA6tB,YAAA7tB,KAAAwrB,cAAA4C,YAAAlH,SAAAkH,YAAA9M,OACAthB,KAAA6tB,YAAA7tB,KAAA0rB,gBAAAnB,WAAA6D,YAAA9M,OACAthB,KAAA6tB,YAAA7tB,KAAAyrB,YAAA2C,YAAA5G,OAAA4G,YAAA9M;AACAthB,KAAA6tB,YAAA7tB,KAAA2rB,aAAAyC,YAAA/G,QAAA+G,YAAA9M,QAUAuM,YAAA,SAAAS,OAAA5N,MAAAY,OACAgN,OAAA3b,KAAA+N,MAAA,IAAAY,QASAiN,sBAAA,SAAAlK,aACA,OACA/C,MAAA+C,YAAAmK,aAAA,EACAtH,SAAA7C,YAAAoK,iBAAA,EACAjH,OAAAnD,YAAArF,iBAAA,EACAqI,QAAAhD,YAAAqK,eAAA,IAUAC,0BAAA,SAAAtK,aACA,OACA/C,MAAA+C,YAAAuK,iBAAA,EACA1H,SAAA7C,YAAAwK,qBAAA,EACArH,OAAAnD,YAAAyK,qBAAA,EACAzH,QAAAhD,YAAA0K,mBAAA,IAUAC,6BAAA,SAAA3K,aACA,OACA/C,MAAA+C,YAAA4K,oBAAA,EACA/H,SAAA7C,YAAA6K,wBAAA;AACA1H,OAAAnD,YAAA8K,wBAAA,EACA9H,QAAAhD,YAAA+K,sBAAA,IAQAC,YAAA,SAAAhL,aACA,GAAAiL,cAAAjL,YAAAiL,aACA5E,YAAA1qB,KAAAW,QAAA+pB,YACA6E,gBAAA,aAAA7E,YACA8E,mBAAA,gBAAA9E,YACA+E,aAAA,SAAA9hB,MAIA,MAHA6hB,qBAAA7hB,KAAAqI,WACArI,KAAAqI,SAAAzS,EAAA4B,OAAAwI,KAAAqI,SAAAyZ,eAEA9hB,KAAAkZ,OAIAyI,gBACAC,iBAAAC,sBAEAF,aAAA/rB,EAAA4B,OAAAmqB,aAAAG,eAGAzvB,KAAA4rB,WAAA9jB,OACA9H,KAAA+rB,aAAA/kB,OACAhH,KAAA8rB,MAAAza,KAAAgX,kBACAF,MAAAmH,gBAGAtvB,KAAAW,QAAA+uB,gBAEA1vB,KAAA8rB,MAAA9jB,KAAA+gB,WAAAJ,QAAArjB,SAAAijB,QAAAG,YAGA1oB,KAAA4rB,WAAA5kB;AACAhH,KAAA+rB,aAAAjkB,OACA9H,KAAA8rB,MAAAhnB,SAIA9E,KAAAwsB,QAAAxsB,KAAA6rB,SAAA1mB,OAAA4jB,WAAAmB,SAAAnqB,KAAA,UAQA4vB,YAAA,SAAAhI,SAAA8F,MACA,GAAA1Z,OAAA4T,UAAAA,SAAAgF,OAAAhF,SAAA3nB,KAAA8rB,MAAA9jB,KAAA,kBAAA2f,SAAA,KACAyG,YAAApuB,KAAAouB,WAGApuB,MAAAwtB,YAAAzZ,MAAA0Z,MAGAW,YAAA/G,QAAArnB,KAAA8rB,MAAA9jB,KAAA+gB,WAAA1B,SAAAljB,OACAnE,KAAA6tB,YAAA7tB,KAAA2rB,aAAAyC,YAAA/G,QAAA+G,YAAA9M,OACAthB,KAAAwsB,QAAAxsB,KAAAmrB,gBASAyE,oBAAA,SAAAvL,YAAAsD,SAAA8F,MACA,GAAAoC,SAAA,iBACAC,gBAAAzL,YAAAqJ,aACAqC,cAAA,EAAAC,eAAA,KAAAC,YAAA,KACAC,WAAA,EAAAC,YAAA,KAAAC,SAAA;AAEA/L,YAAAiL,cAGA/rB,EAAAqI,QAAAyY,YAAAiL,aAAA,SAAA3hB,MA0BA,GAzBApK,EAAAqI,QAAA+B,MAAAA,KAAAqI,SAAA,SAAA1T,SAoBA,GAnBAiB,EAAAqI,QAAAtJ,SAAAA,QAAAqC,MAAA,SAAAlC,MACA,GAAAA,OACAA,KAAAklB,WAAAA,WACAyI,SAAAziB,KACAwiB,YAAA7tB,QACA4tB,WAAA,GAEAztB,KAAAklB,WAAAmI,kBACAG,YAAAtiB,KACAqiB,eAAA1tB,QACAytB,cAAA,GAGAG,WAAAH,cACA,OAAA,IAKAG,WAAAH,aACA,OAAA,IAIAG,WAAAH,aACA,OAAA,IAKAG,WAAAD,cAAAG,UACAP,OAAA1jB,KAAA,qBAEA+jB,WAAAF,iBAAAG,aACAN,OAAA1jB,KAAA,0BAIA0jB,OAAA1jB,KAAA,qBACA0jB,OAAA1jB,KAAA;AAGA5I,EAAAqI,QAAAikB,OAAA,SAAAQ,OACAA,QAAAhM,eACAA,YAAAgM,QAAA5C,KAAA,GAAA,MAUA6C,eAAA,QAAAA,gBAAAjM,aACA,GAAAqG,aAAAG,cAAA7qB,KAAAW,QAAA+pB,cAAA,OACA6F,mBAAA,oBAAAjI,WAAAoC,aACA4F,eAAAtwB,KAAAuwB,qBAAAvwB,KAAAuuB,sBACAH,YAAAkC,gBAAAA,eAAAjM,gBAEA,OAAA+J,cAQA1pB,OAAA,SAAA2f,aAMA,MALArkB,MAAAouB,YAAApuB,KAAAswB,eAAAjM,aACArkB,KAAAguB,eAAA3J,aACArkB,KAAAmuB,aAAA9J,aACArkB,KAAAqvB,YAAAhL,aACArkB,KAAAurB,sBAAAlH,aACArkB,MAOA0J,QAAA,WAGA,MAFA1J,MAAA0oB,UAAA;AACA1oB,KAAAorB,WAAA9lB,SAAAijB,QAAAG,UACA1oB,MAOA2J,OAAA,WAGA,MAFA3J,MAAA0oB,UAAA,EACA1oB,KAAAorB,WAAA5lB,YAAA+iB,QAAAG,UACA1oB,MAOAgH,KAAA,WAIA,MAHAhH,MAAA0oB,UAAA,EACA1oB,KAAA4mB,QAAA,EACA5mB,KAAAorB,WAAA9lB,SAAAijB,QAAA3B,QACA5mB,MAOA8H,KAAA,WAIA,MAHA9H,MAAA0oB,UAAA,EACA1oB,KAAA4mB,QAAA,EACA5mB,KAAAorB,WAAA5lB,YAAA+iB,QAAA3B,QACA5mB,MAQA4H,OAAA,SAAAE,MAWA,MAVA2F,UAAA3F,OACAA,KAAA9H,KAAA4mB,QAGA9e,KACA9H,KAAA8H,OAEA9H,KAAAgH,OAGAhH,MAQAqG,GAAA,SAAAmqB,WACA,GAAAC,KAAAzwB,KAAAorB,UAKA,OAJAqF,MACAA,IAAApqB,GAAAuE,MAAA6lB,IAAAnd,WAGAtT,MAQAyT,IAAA,SAAA+c,WACA,GAAAC,KAAAzwB,KAAAorB,UAKA,OAJAqF,MACAA,IAAAhd,IAAA7I,MAAA6lB,IAAAnd,WAGAtT,MASA0F,QAAA,SAAA8qB,UAAAE;AACA,GAAAD,KAAAzwB,KAAAorB,UAeA,OAbA3d,UAAAijB,kBACAA,oBAEAntB,EAAAuC,QAAA4qB,mBACAA,iBAAAA,kBAGAA,gBAAAvkB,KAAAnM,MAEAywB,KACAA,IAAA/qB,QAAA8qB,UAAAE,iBAGA1wB,OAcA2wB,kBAAA,SAAA5F,QAAApqB,SACA,GAAAqoB,WAAAzlB,EAAAuQ,MAAAgX,YAAA,EACA,OAAA9B,WAAAnE,KAAAkG,QAAApqB,SAGA,OAAAgwB,qBCp2BAvxB,OAAA,yCACA,SACA,SACA,OACA,kBACA,SAAAkE,EAAAC,EAAAzC,IACA,YAMA,IAAA8vB,mBAQA/L,KAAA,SAAAgM,YAAAC,eAGA,MAFA9wB,MAAA6wB,YAAAvtB,EAAAutB,aAAAE,cACA/wB,KAAA8wB,cAAAxtB,EAAAwtB,eACA9wB,MASA0hB,MAAA,SAAA1gB,MAAAgwB;AAGA,MAFAhxB,MAAA8wB,cAAAne,KAAA3R,OACAhB,KAAA6wB,YAAAE,YAAA,QAAAC,OACAhxB,MAQA0E,OAAA,SAAA2f,aACA,GAAA4M,mBAAA5M,YAAA4M,mBAAA,aACAC,wBAAAD,kBAAA,cACAX,eAAAtwB,KAAAkxB,0BAAAlxB,KAAAmxB,sBACA/C,YAAAkC,gBAAAA,eAAAjM,gBAGA,OADArkB,MAAA0hB,MAAA0M,YAAAptB,MAAAotB,YAAA4C,OACA5C,aAQA+C,sBAAA,SAAA9M,aACA,GAAA/C,OAAAlB,KAAAC,IAAA,EAAAgE,YAAAmK,aACAwC,MAAA5Q,KAAAgR,MAAA/M,YAAAoK,gBAAAnN,MAAA,IACA,QACA0P,MAAAA,MACAhwB,MAAAgwB,MAAA,MASAK,oBAAA,SAAAhN,aACA,GAAAiN,eAAAjN,YAAAkN,uBACAC;AACApuB,MACAke,MAAA,cACAqG,SAAA,gBAEAtlB,UACAif,MAAA,kBACAqG,SAAA,oBAEAmB,aACAxH,MAAA,qBACAqG,SAAA,wBAGA8J,QAAAD,qBAAAF,gBAAAE,qBAAApuB,KACAke,MAAAlB,KAAAC,IAAA,EAAAgE,YAAAoN,QAAAnQ,QACAqG,SAAAtD,YAAAoN,QAAA9J,UAAA,CACA,QACAqJ,MAAA5Q,KAAAgR,MAAAzJ,SAAArG,MAAA,KACAtgB,MAAAF,GAAA,gBAAA6mB,SAAArG,UAWAoQ,uBAAA,SAAAb,YAAAC,eACA,GAAAa,SAAApuB,EAAAuQ,MAAA8c,kBAAA,EACA,OAAAe,SAAA9M,KAAAgM,YAAAC,eAGA,OAAAY,0BCjFAtyB,OAAA,sCACA,UACA,SAAAmE;AACA,YAMA,IAAAquB,qBAAA,SAAAjxB,SAiGA,QAAAkkB,QACAgN,mBAAAlxB,QAAAmxB,kBACAC,aAAAC,QAAAC,uBAOA,QAAAC,qBAAAhuB,KACA,GAAAiuB,YAAAJ,aAAAK,oBACA,KACAzO,OAAA0O,aAAAC,QAAAH,WAAAjuB,KACA,MAAAquB,cACA,GAAA,uBAAAA,aAAApnB,MACA,+BAAAonB,aAAApnB,KAiBA,KAAAonB,aAbA,KAHA,GAEAzwB,KAFAoI,QAAA,EACAkR,EAAAuI,OAAA0O,aAAAluB,OAEAiX,KACAtZ,IAAAuwB,aAAAvwB,IAAAsZ,GACA,mBAAAhY,KAAAtB,MAAAA,MAAAqwB,aACAxO,OAAA0O,aAAAG,WAAA1wB,KACAoI,UAGA,KAAAA,QAGA,KAAAqoB,aAFAL,qBAAAhuB,MAcA,QAAA+tB;AACA,GAAAlyB,MAAA4jB,OAAA0O,aAAAI,QAAAV,aAAAK,sBACAza,OAAA+a,KAAAC,MAAA5yB,SAEA,OAAA4X,QA7IA,GAAAka,oBACAe,kBAAA,gBACAC,QAEA,KAAAlyB,SAAA8M,SAAA9M,QAAAmxB,kBACA,KAAA,IAAAhV,WAAA,uCAGA,IAAAiV,eACAe,mBACAC,mBAAA,IACAC,KAAA,IACAC,iBAAA,IACAC,QAAA,IACAC,WAAA,IACAC,YAAA,IACAC,MAAA,KAEAC,gBACAC,SAAA,IACAC,WAAA,IACAC,WAAA,KACAC,gBAAA,KACAC,SAAA,KACAC,6BAAA,MAMAC,qBAAA,WACA,MAAAhC,qBAOAiC,qBAAA,SAAA1xB,OACAyvB,mBAAAzvB;EAOA4vB,QAAA,SAAAjyB,MACA8yB,MAAA9yB,KACAmyB,oBAAAQ,KAAAqB,UAAAlB,SAQAmB,QAAA,SAAAj0B,KAAAk0B,WACAl0B,KAAAwD,EAAAuQ,MAAA/T,MACA0N,SAAAwmB,YACAA,WAAA,GAGAA,UACA1wB,EAAArD,MAAA2yB,MAAA9yB,MAEA8yB,MAAAtvB,EAAArD,MAAAH,KAAA8yB,OAEAX,oBAAAQ,KAAAqB,UAAAlB,SAQAqB,QAAA,WACA,MAAA3wB,GAAAuQ,MAAA+e,QAOAsB,UAAA,WACAtB,SACAlP,OAAA0O,aAAAG,WAAAT,aAAAK,uBAGAA,mBAAA,WACA,MAAAQ,mBAAAf,oBAyDA,OAFAhN,QAEAkN,aAGA,OAAAH,uBC9LAxyB,OAAA,yBAAA,SAAA,aAAA,SAAAkE,EAAA8wB,WACA,YAKA,SAAAC,YAAAC,QAAAC,WAAAC,cAAAC,aAAAC,YAAAC;AACA30B,KAAAs0B,QAAAA,QACAt0B,KAAAu0B,WAAAA,WACAv0B,KAAA40B,WAAA,EAEA50B,KAAAw0B,cAAAA,cACAx0B,KAAA60B,MAAAJ,aACAz0B,KAAA00B,YAAAA,YACA10B,KAAA80B,cAAAH,OA2JA,MAxJAN,YAAAU,YAAA,EACAV,WAAAW,UAAA,EAEAX,WAAAjhB,UAAA6hB,SAAA,SAAAC,MAAAN,WACA,GAAAtzB,MAAAtB,KACAm1B,OAAA7xB,EAAA4xB,OACAE,QAAAp1B,KAAAq1B,aACAC,cAAA,GAAAlB,WAAAgB,SAAAG,WAEAJ,QAAA9uB,GAAA,OAAA,SAAAC,GAIAhD,EAAAqM,UAAAtJ,GAAA,eAAA,WACA/E,KAAAk0B,QAAAN,MAAA,WACA5xB,EAAAqM,UAAA8D,IAAA,gBACA,kBAAAmhB,YACAA,gBAIAU,iBAAA,IACAJ,MAAAO,cAAAC,iBAAA,KAIAP,OAAA1gB,KAAA,MAAA2gB,UAGAf,WAAAjhB,UAAAoiB,QAAA,SAAAN,MAAAN;AACA50B,KAAA40B,aAAA,GAAAM,MAAAO,eAEA,kBAAAP,OAAAO,cAAA,oBACAP,MAAAO,cAAAE,kBAAA31B,MACAA,KAAA40B,WAAA,EACA,kBAAAA,YACAA,cAUAP,WAAAjhB,UAAAiiB,WAAA,WACA,GAAA5f,QAAAzV,KAAAu0B,cAEA,OADA9e,QAAA+e,cAAAx0B,KAAAw0B,cACAx0B,KAAAs0B,QAAA,IAAAhxB,EAAAsyB,MAAAngB,SAGA4e,WAAAjhB,UAAAyiB,sBAAA,SAAAta,SAAA/O,UACAxM,KAAA00B,YAAAjR,IAAAlI,SAAA/O,WAIA6nB,WAAAjhB,UAAA0iB,iBAAA,WACA,MAAA91B,MAAAw0B,eAIAH,WAAAjhB,UAAA2iB,SAAA,WACA,MAAA/1B,MAAA60B,MAAApR,OAGA4Q,WAAAjhB,UAAA4iB,SAAA,SAAAnB,MAAAroB;AACA,MAAAxM,MAAA60B,MAAAoB,IAAApB,MAAAroB,WAIA6nB,WAAAjhB,UAAA8iB,iBAAA,WACA,MAAAl2B,MAAA80B,eAGAT,WAAAjhB,UAAA+iB,iBAAA,SAAAxB,QACA30B,KAAA80B,cAAAH,QAIAN,WAAAjhB,UAAAgjB,aAAA,SAAA51B,YACA,MAAA,mBAAAR,MAAAu0B,WAAA/zB,YACAR,KAAAu0B,WAAA/zB,YAEA,MASA6zB,WAAAjhB,UAAAijB,SAAA,SAAA7pB,UAEA,MADAxM,MAAAs2B,iBAAA9pB,SACAxM,MAQAq0B,WAAAjhB,UAAAmjB,OAAA,SAAA/pB,UAEA,MADAxM,MAAAw2B,eAAAhqB,SACAxM,MAQAq0B,WAAAjhB,UAAAqjB,OAAA,SAAAjqB,UAEA,MADAxM,MAAA02B,eAAAlqB,SACAxM,MAMAq0B,WAAAjhB,UAAAujB,KAAA,SAAAnqB,UACA,kBAAAxM,MAAAw2B,eACAx2B,KAAAw2B,eAAAhqB,UAEAA,SAAA;EAQA6nB,WAAAjhB,UAAAwjB,KAAA,SAAApqB,UACA,kBAAAxM,MAAA02B,eACA12B,KAAA02B,eAAAlqB,UAEAA,SAAA,IAQA6nB,WAAAjhB,UAAAyjB,OAAA,SAAAC,YAEA,kBAAA92B,MAAAs2B,kBACAt2B,KAAAs2B,iBAAAQ,aAIAzC,aAIAj1B,OAAA,8BAAA,UAAA,SAAAkE,GC5LA,QAAAyzB,iBAAAC,WAAAj3B,MACAC,KAAAD,KAAAA,KACAC,KAAAg3B,WAAAA,WA2CA,MAxCAD,iBAAA3jB,UAAAqQ,IAAA,SAAAlI,SAAA/O,UACAxM,KAAAD,KAAAk3B,eAAA1b,UACA,kBAAA/O,WACAA,SAAAxM,KAAAD,KAAAwb,WAGAjY,EAAAqO,MACAC,IAAA5R,KAAAg3B,WACAj3B,MACAwb,SAAAA,UAEAzO,KAAA,OACA+E,SAAA,OACAuD,QAAA,SAAA8hB,QAAA1qB;AAAA,MAAA,UAAA2qB,GACA,IAAAr1B,MAAAq1B,GAAAp3B,KACAm3B,QAAAn3B,KAAA+B,KAAAq1B,EAAAp3B,KAAA+B,IAEA,mBAAA0K,WACAA,SAAA0qB,QAAAn3B,KAAAwb,aAGAvb,KAAAwM,aAmBAuqB,kBC9BA33B,OAAA,2BAAA,UAAA,SAAAkE,GACA,YAEA,SAAA8zB,cAAAvC,MAAAwC,WACAr3B,KAAA60B,MAAAA,MACA70B,KAAAq3B,UAAAA,UA8BA,MA3BAD,cAAAhkB,UAAAqQ,IAAA,SAAAjX,UAIA,MAHA,kBAAAA,WACAA,SAAAxM,KAAA60B,OAEA70B,KAAA60B,OAGAuC,aAAAhkB,UAAA6iB,IAAA,SAAApB,MAAAroB,UAEAqoB,QAAA70B,KAAA60B,MACA,kBAAAroB,WACAA,YAGAxM,KAAA60B,MAAAA,MACAvxB,EAAAqO,MACAC,IAAA5R,KAAAq3B,UACAt3B,MACA80B,MAAAA,OAEA/nB,KAAA,OACA+E,SAAA,OACAuD,QAAA,kBAAA5I,UAAAA,SAAA;KAKA4qB,eCjCAh4B,OAAA,4CACA,SACA,SACA,OACA,SACA,uCACA,mCACA,wCACA,qCACA,wBACA,6BACA,0BACA,iBACA,UACA,cACA,aACA,SACA,WACA,kBAEA,SACAkE,EACAC,EACAzC,GACA6gB,OACAsE,eACA6E,WACAwM,gBACA1F,oBACAyC,WACA0C,gBACAK,aACAG,eACAC,QACA3V,SACA4V,QACAC,OACAC,OAGA,YAEA,IAAAC,aACAC,gBACAC,aACAC,aACAC,YAAA,EACAC,QACAC,UACAC,WACApG,aACAqG,oBACAxS,KAAAtiB,EAAAqM,UACA0oB,kBAAA,2BACAC,yBAAA,kCACAC,mBAAA,4BACAC,qBAAA,8BACAC,gCAAA,yCACAC;AAEAC,mBAAA,EACAC,uBAAA,EACAC,0BAAA,EACAC,qBAAA,EACAC,kBAAA,EACAC,uBAAA,EACAC,0BAAA,EACAC,4BAAA,EAMAC,iBAAA,SAAA3sB,UAEA+qB,eAAAn2B,OAAA,WAGApB,KAAAo5B,aAEAlB,UAAAmB,WAAAryB,OACAkxB,UAAAoB,cAAAtyB,OACAkxB,UAAAqB,cAAAvyB,OAGA,kBAAAwF,WACAnI,WAAAmI,SAAAwrB,cAOAwB,gBAAA,WACAx5B,KAAAy5B,YAGAlC,eAAAn2B,OAAA,aACA2wB,aAAAiC,SACA0F,MAAAC,uBAAAC,KAAAC,MAAA,QAQAC,KAAA,SAAAnS,UACA,GAAArmB,MAAAtB,KACA+5B,OAAA,OACAtkB,QAAAkS,SAAAA;AACA3nB,KAAAo5B,aAEAp5B,KAAAg6B,mBAAArS,WAAA3nB,KAAAi6B,uBAAAj6B,KAAAk6B,iBACAl6B,KAAAm6B,iBAAAJ,OAAAtkB,QAEAzV,KAAAo6B,gBAAA,WACA94B,KAAA+4B,WAAAN,OAAAtkB,WASA6kB,cAAA,SAAAC,UACA,GAAAA,SAAA,CACA,GAAAj5B,MAAAtB,KACA+5B,OAAA,gBACAtkB,QAAA8kB,SAAAA,SACAj5B,MAAA+4B,WAAAN,OAAAtkB,UASA+kB,cAAA,SAAA/M,KAAA9F,UACA,GAAArmB,MAAAtB,IAGAu3B,gBAAAn2B,OAAA,WAGApB,KAAAo5B,aAEA91B,EAAAqO,MACAC,IAAAtQ,KAAA+iB,YAAAoW,iBACAC,OAAA,EACAC,OAAA,EACA7tB,KAAA,OACA+E,SAAA,OACA9R,MACA0tB,KAAAA,KACA9F,SAAAA,UAEAvS,QAAA,SAAArV,MAEAuB,KAAAwpB,aACAxpB,KAAAwpB,WAAA6E,YAAAhI,SAAA8F,MACAnsB,KAAAwpB,WAAA8E,oBAAAtuB,KAAA+iB,YAAAsD,SAAA8F;AACAnsB,KAAA+iB,YAAAqJ,eAAA/F,WACArmB,KAAA+iB,YAAAuW,YAAAnN,MAEAnsB,KAAAu5B,YAAAv5B,KAAA+iB,cAIA/iB,KAAAm4B,YAGAlC,eAAAn2B,OAAA,iBAQA05B,YAAA,WAIA,QAAAC,iBACAz5B,KAAA44B,mBAAA54B,KAAA+iB,YAAA2W,UACA15B,KAAA64B,iBAAAJ,QAEAz4B,KAAA25B,YAAAlB,QAPA,GAAAz4B,MAAAtB,KACA+5B,OAAA,aAUA/5B,MAAAo5B,aAEAp5B,KAAAqkB,YAAA4K,mBAAAjvB,KAAAqkB,YAAA6W,oBAAA,GAAA,GAAAl7B,KAAAi6B,sBACAj6B,KAAAm7B,+BACAn7B,KAAAo7B,sBAAAL,eACA/6B,KAAAy5B,aAEAsB,gBAIA/6B,KAAAo6B,gBAAA,WACA94B,KAAA+4B,WAAAN,WAQAoB,4BAAA;AACA,MAAAn7B,MAAAqkB,YAAAgX,UAAA,GAAAr7B,KAAAs7B,UAAA9C,uBAMA4C,sBAAA,SAAAG,YACA,GAAA56B,UACA66B,aAAA16B,GAAA,MACA26B,YAAA36B,GAAA,UACA46B,eAAA,EAGA17B,MAAA27B,mBACA76B,GAAA,wIACAy6B,WACA56B,UAOAi7B,aAAA,WACA,GAAAt6B,MAAAtB,KACA+5B,OAAA,cAEA/5B,MAAAo5B,aAEA,GAAAp5B,KAAAqkB,YAAA6W,qBAAAl7B,KAAAi6B,uBAAAj6B,KAAAk6B,iBACAl6B,KAAAm6B,iBAAAJ,QAEA/5B,KAAAo6B,gBAAA,WACA94B,KAAA+4B,WAAAN,WAUAC,mBAAA,SAAA6B;AACA,GAAAl3B,OAAA3E,KAAA87B,yBACAC,sBAAA,EACAC,gBAAAH,cAAA,GAAAA,aAAA77B,KAAAqkB,YAAAmK,WAEA,IAAAwN,iBACA,IAAA,GAAA5gB,KAAAzW,OACA,GAAAA,MAAAsyB,eAAA7b,IAGAzW,MAAAyW,GAAAuM,UAAAkU,aAAA,CACAE,sBAAA,CACA,YAIAA,uBAAA,CAGA,OAAAA,uBASAd,YAAA,SAAAlB,OAAAtkB,OAAAwmB,UACA,GAAA36B,MAAAtB,IAEA+xB,cAAAiC,SAAAkI,SAAApJ,kBAAAmJ,UAAAlK,aAAAe,kBAAAC,sBACAzxB,KAAA84B,gBAAA,WACA94B,KAAA+4B,WAAAN,OAAAtkB,WASA0kB,iBAAA,SAAAJ,OAAAtkB,QACA,GAAAnU,MAAAtB,KACAm8B,UAAAn8B,KAAAo8B,eACAC,mBAAA;AACAF,WACAA,UAAAG,gBAEAh7B,KAAA25B,YAAAlB,OAAAtkB,QAGA,iBAAAskB,QAAA/5B,KAAAm7B,+BACAn7B,KAAAs7B,UAAA7C,kCACAz4B,KAAAqkB,YAAAkY,qBAEAF,qBAEAr8B,KAAA27B,mBACA76B,GAAA,8IACAu7B,oBACAxT,MAAA,gBAIA7oB,KAAAy5B,aAMA+C,YAAA,WACA,GAAAl7B,MAAAtB,KACAm8B,UAAAn8B,KAAAo8B,eACAK,cAAA,WACAn7B,KAAA25B,YAAA,cAAA,KAAAlJ,aAAAe,kBAAAE,MAGAmJ,YACAA,UAAAG;AAGAt8B,KAAAs7B,UAAAhD,0BACAt4B,KAAA27B,mBACA76B,GAAA,8IACA27B,eACA5T,MAAA,gBAGA4T,gBAGAz8B,KAAAy5B,aAQAnJ,eAAA,SAAAzH,OACA,GAAA6T,iBACAt5B,KAAA,GACAf,SAAA,OACAymB,YAAA,WAEA6T,YAAA9T,OAAA6T,eAAA7T,QAAA,EAEA,QACAvH,MAAAthB,KAAAqkB,YAAA,cAAAsY,cAAA,EACAzV,SAAAlnB,KAAAqkB,YAAA,kBAAAsY,cAAA,EACAnV,OAAAxnB,KAAAqkB,YAAA,kBAAAsY,cAAA,EACAtV,QAAArnB,KAAAqkB,YAAA,gBAAAsY,cAAA,IAeAhB,mBAAA,SAAArvB,QAAAytB,OAAAp5B;AACA,GAAAW,MAAAtB,KACAW,QAAAA,YACAkoB,MAAAloB,QAAAkoB,MACA2S,aAAA76B,QAAA66B,cAAA16B,GAAA,OACA26B,YAAA96B,QAAA86B,aAAA36B,GAAA,MACA46B,cAAA,mBAAA/6B,SAAA+6B,eAAA/6B,QAAA+6B,cAEAkB,YAAAt5B,EAAA,wBACA8qB,YAAApuB,KAAAswB,eAAAzH,OACAgU,gBAAAzO,YAAA9M,MAAA8M,YAAAlH,SACA4V,aAAA1O,YAAA/G,OAuCA,OArCAqU,iBACAmB,iBAAA78B,KAAA+8B,yBACAF,kBAGAC,cAAAD,gBACAvwB,QAAAxL,GAAA,4EACA+7B,gBAAAG,WACAF,aAAAE,YACA,IAAA1wB,SAEAwwB,eACAxwB,QAAAxL,GAAA,yCAAAg8B,aAAAE,YAAA,IAAA1wB;AAGAuwB,kBACAvwB,QAAAxL,GAAA,sCAAA+7B,gBAAAG,YAAA,IAAA1wB,WAKAswB,YAAA50B,KAAA,YAAAqJ,KAAA/E,SACAswB,YAAA50B,KAAA,oBAAAqJ,KAAAmqB,cACAoB,YAAA50B,KAAA,mBAAAqJ,KAAAoqB,aACAmB,YAAAjF,OAAArpB,MAAA,MAEAsuB,YAAA50B,KAAA,iCAAAyL,IAAA,SAAApN,GAAA,QAAA,WACAu2B,YAAAjF,MAAA,WAGAiF,YAAA50B,KAAA,oBAAAyL,IAAA,SAAApN,GAAA,QAAA,WACAu2B,YAAAjF,MAAA,SACAp0B,EAAAgZ,WAAAwd,SACAA,OAAAt5B,KAAAa,QAIAs7B,aAQAxC,gBAAA,SAAA5tB,UACAulB,aAAAiC,SACA0F,MACAuD,qBAAArD,KAAAC,MAAA,IACAqD,cAAAxF,SAAAyF,UAAAzF,SAAAyF,aAAAC,OAAA;IAGA,kBAAA5wB,YACAA,SAAAjJ,EAAAhC,MAEAvB,KAAAq9B,eAAA1G,KAAAnqB,WAOAytB,oBAAA,WACA,MAAA,IAAAj6B,KAAAqkB,YAAAiZ,kBASAP,sBAAA,WACA,GAAA7V,WAAA,CAOA,OANA3jB,GAAA5B,KAAA3B,KAAAu9B,sBAAA,SAAA1I,OACA,GAAAA,OAAAtxB,EAAAuG,SAAA+qB,MAAA2I,WAAA,OAAA3I,MAAA2I,SAAAC,KAEA,MADAvW,WAAA,GACA,IAGAA,UAQAoU,UAAA,SAAAoC,QACA,MAAAn6B,GAAAyR,QAAAhV,KAAAqkB,YAAAljB,WAAAu8B,SAAA,GAOAtB,aAAA,WACA,GAAAuB,WAAAhuB,SAAAiuB,eAAA,YACAC,WAAAF,WAAAA,UAAAlI,cACAqI,mBAAAD,YAAAA,WAAAluB,SAAAiuB,eAAA,kBACAG,oBAAAD,oBAAAA,mBAAArI;AACA,MAAAsI,sBAAAA,oBAAA5B,WAOAjC,eAAA,WACA,GAAA8D,iBAAAh+B,KAAAqkB,YAAA2Z,gBACA9D,gBAAA,CACA,KAAA,GAAA16B,SAAAw+B,iBACAA,gBAAA/G,eAAAz3B,QACA,sBAAAw+B,gBAAAx+B,OAAAy+B,eACA/D,gBAAA,EAIA,OAAAA,iBAOA4B,uBAAA,WACA,GAEAoC,cAFAC,OAAAn+B,KAAAqkB,YAAA+Z,WACAC,OAAAr+B,KAAAqkB,YAAAiL,YAGA,KAAA,GAAAgP,aAAAD,QACA,GAAAA,OAAApH,eAAAqH,YAGAD,OAAAC,WAAAjpB,KAAA8oB,OAIA,IAAA,GAAAjoB,gBAAAmoB,QAAAC,WAAAtoB,SACA,GAAAqoB,OAAAC,WAAAtoB,SAAAihB,eAAA/gB,eAGAmoB,OAAAC,WAAAtoB,SAAAE,cAAA2Q,UAAA,EAAA;AACAqX,aAAAG,OAAAC,WAAAtoB,SAAAE,cAAAvR,KACA,OAKA,MAAAu5B,eAMAK,KAAA,WACA,GAAAj9B,MAAAtB,KACAw+B,OAAA,WACAl9B,KAAA83B,aACA93B,KAAA+4B,WAAA,QAGAr6B,MAAAm7B,8BACAn7B,KAAAo7B,sBAAAoD,QAEAA,UAOA16B,QAAA,WACA,GAAAxC,MAAAtB,IACAA,MAAAo5B,aACAp5B,KAAAqkB,YAAA2W,WAAA,EACAh7B,KAAAy+B,cAEAz+B,KAAAo6B,gBAAA,WACA,GAAAsE,YAAAp7B,EAAA,2BACA+gB,YAAA/iB,KAAA+iB,YACAsa,WAAAD,WAAA12B,KAAA,oCAEAqc,aAAA6K,yBAAA7K,YAAA4K,mBACA8C,aAAAiC,SAAAkI,SAAApJ,kBAAAf,aAAAe,kBAAAG;IAEAlB,aAAAiC,SAAAkI,SAAApJ,kBAAAf,aAAAe,kBAAAI,WAGA5xB,KAAAm4B,YACAiF,WAAA/G,OAAArpB,MAAA,MACAqwB,WAAAlrB,IAAA,SAAApN,GAAA,QAAA,WACAq4B,WAAA/G,MAAA,SACAr2B,KAAA+4B,WAAA,gBASAuE,eAAA,SAAAva,aACArkB,KAAAqkB,YAAAA,YACArkB,KAAAq9B,eAAAwB,KAAAxa,YAAAya,oBACA9+B,KAAAq9B,eAAAlH,iBAAA9R,YAAAyQ,gBAOAiK,aAAA,WACAhN,aAAAH,qBACAE,kBAAA9xB,KAAAq9B,eAAA7I,iBAQAwK,uBAAA,WAIA,MAHA5G,uBACAA,oBAAAp4B,KAAAqkB,YAAA+T;AAAA6G,SAAA,OAEA7G,qBAOA1zB,OAAA,SAAA2f,aACA,GAAA/iB,MAAAtB,IACAk4B,WAAAmB,WAAA1xB,QAEA,IAAAu3B,SAAA57B,EAAA,UACA47B,SAAA5/B,IAAA,SAAA,QAEAU,KAAAg/B,yBAAAG,UAEAn/B,KAAA4+B,eAAAva,aACArkB,KAAAo/B,gBACAp/B,KAAAq/B,iBACAr/B,KAAAs/B,mBACAt/B,KAAAu/B,mBACAv/B,KAAAw/B,oBACAx/B,KAAAy/B,gBACAz/B,KAAA66B,YAAAxW,aACArkB,KAAAy+B,cACAz+B,KAAA0/B,mBACA1/B,KAAA2/B,wBACA3/B,KAAA++B,eAEA7G,UAAAmB,WAAA/1B,EAAA,2DACA40B,UAAAmB,WAAApyB,SAAAixB,UAAA0H,aAEA5/B,KAAAqkB,YAAAiZ,mBAAAt9B,KAAAk5B,6BAAA53B,KAAA+iB,YAAA2W,aAAA,GACApV,KAAAnS,IAAA,eAAApN,GAAA,2BAAA;AACA/E,KAAAk4B,kBACAl4B,KAAAu+B,cACA3H,UAAAmB,WAAA/5B,KAAAwgC,WAAA,cAIA9/B,KAAAq9B,eAAApI,SAAAiD,UAAAmB,WAAA,GAAA,eAOA/3B,KAAAk4B,mBAOAgG,kBAAA,WAEAx/B,KAAAqkB,YAAA2W,aAAA,EACAnZ,WAAAke,MAAAj/B,GAAA,oCAAAd,KAAAqkB,YAAA2b,iBAEAhgC,KAAAqkB,YAAAiZ,mBAAAt9B,KAAAk5B,6BACArX,WAAAke,MAAAj/B,GAAA,0CAAAd,KAAAqkB,YAAA2b,kBAQAnF,YAAA,SAAAxW,aACA,GAAA4b,WAAA,EACAC,aAAA,EACAC,kBAAA9b,YAAAmY,cAAAx8B,KAAAs7B,UAAAjD,oBAAAr4B,KAAAs7B,UAAAhD;AAEAt4B,KAAAqkB,YAAA+b,iBAAA,IACApgC,KAAAqkB,YAAAgX,UAAA,EACA4E,UAAA,EAEAC,aAAA,GAIAhI,UAAAmI,MAAAz4B,OAAAq4B,UACA/H,UAAAoI,SAAA14B,OAAAs4B,aACAhI,UAAAqI,aAAA34B,OAAAu4B,iBAEAla,eAAAjB,OAAA,kBAAAX,YAAAqU,aAQA8H,YAAA,SAAAC,KACA,GAAAC,QAAAp9B,EAAA,SAAA6U,MAAA,6BAAAsoB,IAAAxC,eACA0C,OAAAr9B,EAAA,SAAA6U,MAAA,2BAAAxF,KAAA8tB,IAAAz/B,QACA4/B,MAAAt9B,EAAA,SAAA6U,MAAA,iBAAAxF,KAAA3S,KAAA6gC,WAAAJ,IAAAK,UAIA,OAFAJ,QAAA37B,OAAA47B,QACAD,OAAA37B,OAAA67B,OACAF,QAMAjC,YAAA,WACA,GACAsC,WADAz/B,KAAAtB,IAEAk4B,WAAAqB,cAAAz0B,OAEA,KAAA,GAAAsW,GAAA,EAAAA,EAAAwc,SAAAzzB,OAAAiX,IACAhX,aAAAwzB,SAAAxc;AAQA,GALAwc,YACAC,gBACAC,aACAC,aAEAz2B,KAAA+iB,YAAA2W,aAAA,GACA15B,KAAA+iB,YAAAiZ,mBAAAh8B,KAAA43B,8BAEA6H,YAAA/gC,KAAAqkB,YAAA2Z,gBAAA75B,OACA+zB,UAAA8I,cAAAhV,YAAA,aAAA+U,WAEAA,WAAA,CAIA,IAAA3lB,EAAA,EAAAA,EAAApb,KAAAqkB,YAAA2Z,gBAAA75B,OAAAiX,IAAA,CAEA,GAAAqlB,KAAAzgC,KAAAqkB,YAAA2Z,gBAAA5iB,EAEA,IAAAqlB,IAAAQ,uBAAA,EAAA,CAWA,GARA/I,UAAAqB,cAAAx0B,OAAAzD,KAAAk/B,YAAAC,MAGA5I,aAAAzc,GAAAqlB,IAAAK,QACAhJ,UAAA1c,GAAA,GAAAwe,MACA7B,UAAA3c,GAAA,EACA+c,WAAA/c,EAEA9Z,KAAA+iB,YAAA6c,cAAA5/B,KAAA+iB,YAAA6c,aAAAT,IAAAxC,cAAA,CACAwC,IAAAU,YACA59B,EAAAjC,KAAA+iB,YAAA6c,aAAAT,IAAAxC,eAAAryB,QAAA,SAAAxJ,MAAAN;AACAyB,EAAA2I,UAAA,OAAA,UAAA,UAAA9J,SACAq+B,IAAAU,SAAAr/B,MACAgL,KAAA1K,MACAg/B,OAAAX,IAAAK,SAAAh/B,IACAu/B,MAAA/b,SAAAxjB,IAAA,OAIA,IAAAw/B,wBAAA/9B,EAAAyE,KAAAy4B,IAAAU,UAAAC,QAAA,KACA79B,EAAAgR,QAAA+sB,yBAAAA,uBAAAD,QACAZ,IAAAU,SAAAG,uBAAAD,OAAAD,QAAA,IAIA,SAAAjJ,WAAAsI,KACA7I,SAAAO,YAAAoJ,YAAA,WAIA,GAFAxJ,UAAAI,cAAA,GAAAyB,OAAA4H,UAAA1J,UAAAK,YAAAqJ,UAEAzJ,UAAAI,aAAA,IAAA,CACA,GAAA2I,SAAA/I,UAAAI,YAAA,GACAN,cAAAM,aAAA2I,QACA/I,UAAAI,YAAA,EAGAF,QAAAtjB,GAAAwjB,YACA9mB,KAAA/P,KAAAu/B,WAAAzgB,KAAAqhB,MAAA5J,aAAAM,eAEAN,aAAAM,aAAA,GAEAN,aAAAM,YAAA;AACAuJ,cAAA9J,SAAAO,aAGAD,UAAAmB,WAAAryB,OACA1F,KAAAwC,WAEAg0B,UAAAK,YAAA,GAAAyB,KAGA,IAAA+H,SAAAp+B,EAAAq+B,SAAAnB,IAAAU,UAAAC,QAAA,KAEA79B,EAAAgR,QAAAotB,UAAAp+B,EAAAkW,SAAAkoB,QAAAN,QAAAxJ,aAAAM,aAAAwJ,QAAAN,OACA//B,KAAAugC,YAAApB,IAAAkB,UAGA,MACAxJ,WAAAsI,MAIAxI,QAAAC,UAAAqB,cAAAvxB,KAAA,8BACAkwB,UAAAqB,cAAAzxB,SAmBA+5B,YAAA,SAAApB,IAAAkB,SACA,GACAG,WADAx1B,QAAA,GAEAo0B,OAAAxI,UAAAqB,cAAAvxB,KAAA,oBAAAy4B,IAAAxC,cACA2C,MAAAF,OAAA14B,KAAA,kBAMA,QAJA44B,MAAAp7B,YAAA,mCAAAF,SAAA,OAAAq8B,QAAA70B,MAEAg1B,UAAApK,OAAA6C,SAAAoH,QAAAN,MAAA,WAAAU;AAEAtB,IAAAxC,cACA,IAAA,oBACA3xB,QAAAxL,GAAA,yDAAAghC,UACA,MACA,KAAA,oBACAx1B,QAAAxL,GAAA,4DAAAghC,UACA,MACA,KAAA,WACAx1B,QAAAxL,GAAA,8DAAAghC,UACA,MACA,KAAA,iBACAx1B,QAAAxL,GAAA,wDAAAghC,WAIAjgB,WAAA8f,QAAA70B,MAAAR,SAEAm0B,IAAAU,SAAAQ,QAAAN,OAAAD,QAAA,GAMA3B,cAAA,WAGA,GAFAvH,UAAAoB,cAAA3xB,SAEA3H,KAAAqkB,YAAA2d,QAAA79B,OAAA,EAAA,CAEA+zB,UAAAoB,cAAAh2B,EAAA,0BAEA,KAAA,GAAA8X,GAAA,EAAAA,EAAApb,KAAAqkB,YAAA2d,QAAA79B,OAAAiX,IACA8c,UAAAoB,cAAAv0B,OAAA/E,KAAAqkB,YAAA2d,QAAA5mB;AAKA8c,UAAAoB,cAAAtxB,KAAA,KAAAb,KAAA,iBAAA,WAEA,MADAwc,QAAA/c,KAAA5G,KAAAe,OACA,IAGAm3B,UAAAoB,cAAA2I,UAAA/J,UAAA0H,aAEApI,SACAA,QAAA0K,IAAAC,OAAA,UAAA3K,QAAA0K,KAAAhK,UAAAoB,cAAA,MASAgG,iBAAA,WACApH,UAAAkK,MAAAt6B,OAEA9H,KAAAqkB,YAAAgX,UAAA,GACAnD,UAAAmK,aAAAr7B,OACAkxB,UAAAoK,SAAAx6B,SAGAowB,UAAAmK,aAAAv6B,OACAowB,UAAAoK,SAAAt7B,QAEAhH,KAAAqkB,YAAAvN,iBAAA9W,KAAAg5B,uBAEAd,UAAAqK,cAAAv7B,QAIAkxB,UAAAA,UAAApwB,OACA9H,KAAAqkB,YAAAme,mBAAA,EACAtK,UAAAqK,cAAAz6B,OAGAowB,UAAAqK,cAAAv7B,SAQAu4B,iBAAA;AACA,GAAAkD,kBAAAziC,KAAAqkB,YAAAoe,oBAAA,CAEAziC,MAAA8qB,aACA9qB,KAAA8qB,WAAAljB,OAAA66B,kBAAAziC,KAAAs7B,UAAA/C,qBACAv4B,KAAA8qB,WAAApmB,OAAA1E,KAAAqkB,eAOAgb,eAAA,WACA,GAAAoD,kBAAAziC,KAAAqkB,YAAAoe,oBAAA,CAEAvK,WAAAwK,aAAApjC,IAAA,aAAAmjC,iBAAA,UAAA,UAEAA,kBACAziC,KAAAs3B,gBAAA5yB,OAAA1E,KAAAqkB,cAOA+a,cAAA,WAEAlH,UAAA/lB,OAAAQ,KAAA3S,KAAAqkB,YAAAse,UAGA,IAAAC,aAAA5iC,KAAAqkB,YAAAwe,2BAAA,EAAA,MAAA7iC,KAAAqkB,YAAAye,aAAA,EAEA5K,WAAA6K,UAAApwB,KAAAiwB,aACA1K,UAAA8K,YAAAl7B;EAMA43B,iBAAA,WAEAxH,UAAA+K,QAAAjX,YAAA,UAAAhsB,KAAAqkB,YAAA6e,cACAhL,UAAAkK,MAAApW,YAAA,UAAAhsB,KAAAqkB,YAAA8e,aAMAtD,YAAA,WACA,GACAuD,oBADAC,aAAAnL,UAAAoB,cAAAgK,aAAA,IAAA,EAEAC,YAAAjgC,EAAAqgB,QAAA6f,cAAAtL,UAAA8I,cAAAsC,cAAApL,UAAAuL,iBAAAH,cACA3F,UAAAzF,UAAAmB,WAAA5V,IAAA,EACAyU,WAAA0H,YAAA8D,OAAAH,aACArL,UAAAyL,UAAAx/B,QACA+zB,UAAAyL,UAAAhiC,KAAA,WACA,GAAAiiC,UAAAtgC,EAAAtD,KACA4jC,UAAAF,OAAAH,YAAAK,SAAAN,cAAAM,SAAAF,YAIA/F,WAAAA,UAAAlI,gBACA2N,mBAAAlL,UAAAmB,WAAAwK,WAAAP,aAAA;AAEAF,mBAAAG,cAEAH,mBADAC,aACAjjB,KAAAC,IAAA+iB,mBAAAG,YAAAF,cAEAE,aAGA5F,UAAAlI,cAAAnyB,GACAq6B,UAAAlI,cAAAnyB,EAAA,QAAAoC,QAAA,aAAA09B,qBAEAlL,UAAAmB,WAAAqK,OAAAN,sBAOAhK,WAAA,WACAlB,UAAA4L,aAAAx+B,SAAA,YACAtF,KAAA8qB,YACA9qB,KAAA8qB,WAAAphB,WAOA+vB,UAAA,WACAvB,UAAA4L,aAAAt+B,YAAA,YACAxF,KAAA8qB,YACA9qB,KAAA8qB,WAAAnhB,UAOAo6B,QAAA,WACA7L,UAAA4L,aAAAx+B,SAAA,UACAtF,KAAA8qB,YACA9qB,KAAA8qB,WAAA9jB,QAOAg9B,QAAA,WACA9L,UAAA4L,aAAAt+B,YAAA;AACAxF,KAAA8qB,YACA9qB,KAAA8qB,WAAAhjB,QASA+4B,WAAA,SAAAoD,cACA,GAAAC,SAAAD,aACAE,MAAA/jB,KAAAgR,MAAA8S,QAAA,MACAE,QAAAhkB,KAAAgR,OAAA8S,QAAA,KAAAC,OAAA,IACArD,QAAAoD,QAAA,KAAAC,MAAA,GAAAC,OAEAD,OAAA,KACAA,MAAA,IAAAA,OAEAC,QAAA,KACAA,QAAA,IAAAA,SAEAtD,QAAA,KACAA,QAAA,IAAAA,QAGA,IAAAuD,MAAAF,MAAA,IAAAC,QAAA,IAAAtD,OAEA,OAAAuD,OAOAC,aAAA,SAAAvE,OACA,GAAAz+B,MAAAtB,IAGAA,MAAA+jC,UACA/jC,KAAAm5B,mBAGA5B,eAAAn2B,OAAA,gBACAkL,QAAAyzB,MAAAzzB,QACAytB,OAAA,WACAhI,cACAA,aAAAoC,YAEA4L,MAAAlL,QAAAvzB,KAAAy3B,kBAEAz3B,KAAAijC,WAAA1N,SAGAv1B,KAAAijC,WAAA3N,WAaAyD,WAAA,SAAAN,OAAAyK;AACA,GAAAljC,MAAAtB,KACAyV,QAAAgvB,SAAA1S,aAAAA,aAAAmC,aAEAsQ,eACA/uB,OAAAlS,EAAAuW,OAAArE,OAAA+uB,cAEAxkC,KAAAm5B,iBAAA,WACA71B,EAAAqO,MACAC,IAAAtQ,KAAA+iB,YAAA0V,OAAA,OACAW,OAAA,EACA36B,KAAA0V,OACAklB,OAAA,EACA9oB,SAAA,OACAuD,QAAA,SAAAiP,aACA0N,aAAAoC,YAEA9P,YAAAjP,QAGAiP,YAAAwQ,QAAAvzB,KAAAy3B,kBACAz3B,KAAAijC,WAAA1N,SAGAv1B,KAAAoD,OAAA2f,aANA/iB,KAAAgjC,aAAAjgB,mBAkBAuS,KAAA,WACA,GAAAt1B,MAAAtB,IACA+xB,cAAAiC,SACA0Q,MAAApR,eAAAvB,aAAAuB,eAAAG,YACAyI,SAAApJ,kBAAAf,aAAAe,kBAAAE,QAEAhzB,KAAA27B,mBACA76B,GAAA,0CACA;AACAQ,KAAA84B,gBAAA,WACA94B,KAAA+4B,WAAA,kBACAtI,aAAAoC,gBAGAtL,MAAA7oB,KAAA8qB,WAAA9qB,KAAAqkB,YAAAqG,YAAA,QAUAia,oBAAA,SAAAtvB,GAAAwf,OACAxf,KACArV,KAAA4kC,iBAAAvvB,IAAAwf,QAOA8K,sBAAA,WACA3/B,KAAA4kC,qBAOArH,oBAAA,WACA,MAAAv9B,MAAA4kC,mBAIA5hB,OAAArB,OAAAqB,QAKA,OAJAA,SACAiD,eAAAvC,SAAAV,OAAAgD,WAIAnD,MAAA,SAAAwB,aAEA6T,WAEAmK,aAAA/+B,EAAA,iCACAg/B,SAAAh/B,EAAA,6BACAi/B,cAAAj/B,EAAA,kCACAi9B,aAAAj9B,EAAA,iCACA+8B,MAAA/8B,EAAA;AACAg9B,SAAAh9B,EAAA,6BACA8+B,MAAA9+B,EAAAqgB,OAAAviB,OAAAuO,UAAA3H,KAAA,yBACAi7B,QAAA3/B,EAAAqgB,OAAAviB,OAAAuO,UAAA3H,KAAA,2BACA87B,aAAAxgC,EAAA,8BACAuhC,aAAAvhC,EAAA,mBACAwhC,gBAAAxhC,EAAA,sBAGAyhC,aAAAzhC,EAAA,iCACA0hC,eAAA1hC,EAAA,mCACAo/B,aAAAp/B,EAAA,iBAGA6O,OAAA7O,EAAA,mCACAy/B,UAAAz/B,EAAA,sCAGAi2B,cAAAj2B,EAAA,+BAGA2hC,cAAA3hC,EAAA,kBACA40B,UAAA50B,EAAA,iBACA+1B,WAAA/1B,EAAA,aACAg2B,cAAAh2B,EAAA;AACAs8B,YAAAt8B,EAAA,gBACAqgC,UAAArgC,EAAA,iBACA09B,cAAA19B,EAAA,yCACAmgC,iBAAAngC,EAAA,6CAIA40B,UAAA8K,YAAA9K,UAAA/lB,OAAA2a,IAAAoL,UAAA6K,WAEAnd,KAAAsf,UAAA,SAAA9/B,MAAA+/B,OACA,MAAAA,MAAA1iB,QACA8U,eAAAn2B,OAAA,sBAIAuiB,OAAAgS,kBAAA,SAAA4O,YACA7L,WAAA6L,WAAAA,WAEAlgB,YAAAjP,QAMAiP,YAAAwQ,QAAA6D,WAAAK,mBACAwL,WAAA1N,SACA9E,aAAAoC,aAIAuE,WAAAsG,yBAAAoG,eACA1M,WAAAkG,eAAAva,aACAqU,WAAAqG,eAEArG,WAAA4B,cAAA5B,WAAAsG,yBAAAoG;AACA1M,WAAAsG,yBAAAG,WAEAzG,WAAAh0B,OAAA2f,aAlBAqU,WAAA4L,aAAAjgB,cAuBAqU,WAAAS,mBACAT,WAAArU,YAAAA,YAEA6T,UAAA2M,aAAApgC,MAAA,WACAnB,EAAAtD,MAAAmI,SAAA,aACAuwB,WAAA6F,SAIArG,UAAA4M,gBAAArgC,MAAA,WACAnB,EAAAtD,MAAAmI,SAAA,aACAuwB,WAAAoC,gBAIA5C,UAAAqK,cAAA99B,MAAA,WACAnB,EAAAtD,MAAAmI,SAAA,aACAuwB,WAAAkD,iBAIA1D,UAAAqI,aAAA97B,MAAA,WACAnB,EAAAtD,MAAAmI,SAAA,aACAuwB,WAAA8D,gBAIAtE,UAAAkK,MAAA39B,MAAA,SAAA6B,GACAA,EAAA2B,iBACAywB,WAAA9B,SAGAtzB,EAAAqgB,QAAAtd,GAAA,SAAA9C,EAAA2K,SAAA;AACAwqB,WAAAmH,cACA3H,UAAA8K,YAAAl7B,QACA,MAEA8d,KAAAvf,GAAA,UAAA,WACAkxB,eAAAn2B,OAAA,aAIAwkB,KAAAvf,GAAA,YAAA,WACAkxB,eAAAn2B,OAAA,eAGAs3B,WAAApB,gBAAAA,gBAAAY,UAAA6M,aAAA7M,UAAA8M,gBAEA3gB,YAAAghB,eACA3M,WAAA5N,WAAAA,WAAAoN,UAAA+M,eACAte,OAAAtC,YAAAihB,cAAA,OACA1e,QAAA8R,WAAA4C,UAAA/C,oBACA7N,YAAArG,YAAAqG,YACAgF,iBAAArL,YAAAsG,qBACAC,cAAAvG,YAAAkhB,oBACAl/B,GAAA,OAAA,SAAAjB,MAAAuiB,UACA+Q,WAAAoB,KAAAnS,YACAthB,GAAA,OAAA,SAAAjB,MAAAqoB,KAAA9F;AACA+Q,WAAA8B,cAAA/M,KAAA9F,YAEAuQ,UAAAyL,UAAArgC,EAAA,kBAGAo1B,WAAA2G,iBACA3G,WAAA6G,mBAEAhI,eAAAn2B,OAAA,gBAGAs3B,WAAAmH,cAEA3H,UAAA8I,cAAAlU,IAAAoL,UAAAuL,kBAAA+B,SAAAC,QAAA,GAAA,KAEAhO,QAAAn0B,EAAA,kBACAq0B,MAAAr0B,EAAA,SAGAA,EAAAqM,UAAAtJ,GAAA,iBAAA,SAAAC,EAAAo/B,WAAAlI,UACAkI,YAAAlI,UACA9E,WAAAiM,oBAAAe,YAAAlI,SAAAA,aAEAn3B,GAAA,aAAA,SAAAC,EAAA+O,GAAAwf,OACAxf,IAAAwf,OACA6D,WAAAiM,oBAAAtvB,GAAAwf,SAEAxuB,GAAA,eAAA,SAAAC,EAAAo9B,QACAxL,UAAAmB,WAAAqK,OAAAA","file":"routes.js.map","sourcesContent":["/**\n * This program is free software; you can redistribute it and/or\n * modify it under the terms of the GNU General Public License\n * as published by the Free Software Foundation; under version 2\n * of the License (non-upgradable).\n *\n * This program is distributed in the hope that it will be useful,\n * but WITHOUT ANY WARRANTY; without even the implied warranty of\n * MERCHANTABILITY or FITNESS FOR A PARTICULAR PURPOSE.  See the\n * GNU General Public License for more details.\n *\n * You should have received a copy of the GNU General Public License\n * along with this program; if not, write to the Free Software\n * Foundation, Inc., 51 Franklin Street, Fifth Floor, Boston, MA  02110-1301, USA.\n *\n * Copyright (c) 2014 (original work) Open Assessment Technologies SA (under the project TAO-PRODUCT);\n * \n * \n */\n\n//@see http://forge.taotesting.com/projects/tao/wiki/Front_js\ndefine('taoQtiTest/controller/routes',[],function(){\n    'use strict';\n\n    return {\n        'Creator': {\n            'css': 'creator', \n            'actions': {\n                'index' : 'controller/creator/creator'\n            }\n        }\n    };\n});\n\n","\ndefine('tpl!taoQtiTest/controller/creator/templates/testpart', ['handlebars'], function(hb){ \nreturn hb.template(function (Handlebars,depth0,helpers,partials,data) {\n  this.compilerInfo = [4,'>= 1.0.0'];\nhelpers = this.merge(helpers, Handlebars.helpers); data = data || {};\n  var buffer = \"\", stack1, helper, functionType=\"function\", escapeExpression=this.escapeExpression;\n\n\n  buffer += \"<div id=\\\"\";\n  if (helper = helpers.identifier) { stack1 = helper.call(depth0, {hash:{},data:data}); }\n  else { helper = (depth0 && depth0.identifier); stack1 = typeof helper === functionType ? helper.call(depth0, {hash:{},data:data}) : helper; }\n  buffer += escapeExpression(stack1)\n    + \"\\\" class=\\\"testpart clearfix\\\">\\n\\n   <h1><span data-bind=\\\"identifier\\\">\";\n  if (helper = helpers.identifier) { stack1 = helper.call(depth0, {hash:{},data:data}); }\n  else { helper = (depth0 && depth0.identifier); stack1 = typeof helper === functionType ? helper.call(depth0, {hash:{},data:data}) : helper; }\n  buffer += escapeExpression(stack1)\n    + \"</span>\\n        <div class=\\\"actions\\\"> \\n            <div class=\\\"tlb\\\">\\n                <div class=\\\"tlb-top\\\">\\n                    <span class=\\\"tlb-box\\\">\\n                        <span class=\\\"tlb-bar\\\">\\n                            <span class=\\\"tlb-start\\\"></span>\\n                            <span class=\\\"tlb-group\\\">\\n                                <a href=\\\"#\\\" class=\\\"tlb-button-off property-toggler\\\" title=\\\"Test Part Properties\\\"><span class=\\\"icon-settings\\\"></span></a>\\n                                <span class=\\\"tlb-separator\\\"></span>\\n                                <a href=\\\"#\\\" class=\\\"tlb-button-off move-up\\\" title=\\\"Move Up\\\"><span class=\\\"icon-up\\\"></span></a>\\n                                <a href=\\\"#\\\" class=\\\"tlb-button-off move-down\\\" title=\\\"Move Down\\\"><span class=\\\"icon-down\\\"></span></a>\\n                                <span class=\\\"tlb-separator\\\"></span> \\n                                <a href=\\\"#\\\" class=\\\"tlb-button-off\\\" title=\\\"Remove Test Part\\\" data-delete=\\\"#\";\n  if (helper = helpers.identifier) { stack1 = helper.call(depth0, {hash:{},data:data}); }\n  else { helper = (depth0 && depth0.identifier); stack1 = typeof helper === functionType ? helper.call(depth0, {hash:{},data:data}) : helper; }\n  buffer += escapeExpression(stack1)\n    + \"\\\"><span class=\\\"icon-bin\\\"></span></a>\\n                            </span>\\n                            <span class=\\\"tlb-end\\\"></span>\\n                        </span>  \\n                        <!--<span class=\\\"tlb-bar\\\">-->\\n                            <!--<span class=\\\"tlb-start\\\"></span>-->\\n                            <!--<span class=\\\"tlb-text-button-box\\\">-->\\n                                <!--<a class=\\\"tlb-text-button-off section-adder\\\">-->\\n                                    <!--<span class=\\\"icon-add\\\"></span>-->\\n                                    <!--<span class=\\\"tlb-text\\\">New Section</span>-->\\n                                <!--</a>-->\\n                            <!--</span>-->\\n                            <!--<span class=\\\"tlb-end\\\"></span>-->\\n                        <!--</span>-->\\n                    </span>   \\n                </div>\\n            </div>\\n        </div>\\n        <a href=\\\"#\\\" class=\\\"toggler opened\\\" data-toggle=\\\"#testpart-content-\";\n  if (helper = helpers.identifier) { stack1 = helper.call(depth0, {hash:{},data:data}); }\n  else { helper = (depth0 && depth0.identifier); stack1 = typeof helper === functionType ? helper.call(depth0, {hash:{},data:data}) : helper; }\n  buffer += escapeExpression(stack1)\n    + \"\\\"></a>\\n    </h1>\\n    <div id=\\\"testpart-content-\";\n  if (helper = helpers.identifier) { stack1 = helper.call(depth0, {hash:{},data:data}); }\n  else { helper = (depth0 && depth0.identifier); stack1 = typeof helper === functionType ? helper.call(depth0, {hash:{},data:data}) : helper; }\n  buffer += escapeExpression(stack1)\n    + \"\\\" class=\\\"testpart-content\\\">\\n        \\n       <!-- assessmentTest/testPart/assessmentSections -->\\n       <div class=\\\"sections\\\" data-bind-each=\\\"assessmentSections\\\" data-bind-tmpl=\\\"section\\\" data-bind-filter=\\\"isSection\\\"></div>\\n\\n        <button class=\\\"btn-info small section-adder\\\">\\n            <span class=\\\"icon-add\\\"></span>New section\\n        </button>\\n    </div>\\n</div>\\n\";\n  return buffer;\n  });\n});\n\n","\ndefine('tpl!taoQtiTest/controller/creator/templates/section', ['handlebars'], function(hb){ \nreturn hb.template(function (Handlebars,depth0,helpers,partials,data) {\n  this.compilerInfo = [4,'>= 1.0.0'];\nhelpers = this.merge(helpers, Handlebars.helpers); data = data || {};\n  var buffer = \"\", stack1, helper, options, functionType=\"function\", escapeExpression=this.escapeExpression, helperMissing=helpers.helperMissing;\n\n\n  buffer += \"<div id=\\\"\";\n  if (helper = helpers.identifier) { stack1 = helper.call(depth0, {hash:{},data:data}); }\n  else { helper = (depth0 && depth0.identifier); stack1 = typeof helper === functionType ? helper.call(depth0, {hash:{},data:data}) : helper; }\n  buffer += escapeExpression(stack1)\n    + \"\\\" class=\\\"section\\\">\\n\\n<!-- assessmentTest/testPart/assessmentSection/title -->\\n    <h2><span data-bind=\\\"title\\\">\";\n  if (helper = helpers.title) { stack1 = helper.call(depth0, {hash:{},data:data}); }\n  else { helper = (depth0 && depth0.title); stack1 = typeof helper === functionType ? helper.call(depth0, {hash:{},data:data}) : helper; }\n  buffer += escapeExpression(stack1)\n    + \"</span>\\n        <div class=\\\"actions\\\">\\n            <div class=\\\"tlb\\\">\\n                <div class=\\\"tlb-top\\\">\\n                    <span class=\\\"tlb-box\\\">\\n                        <span class=\\\"tlb-bar\\\">\\n                            <span class=\\\"tlb-start\\\"></span>\\n                            <span class=\\\"tlb-group\\\">\\n                                <a href=\\\"#\\\" class=\\\"tlb-button-off rub-toggler\\\" title=\\\"\"\n    + escapeExpression((helper = helpers.__ || (depth0 && depth0.__),options={hash:{},data:data},helper ? helper.call(depth0, \"Manage Rubric Blocks\", options) : helperMissing.call(depth0, \"__\", \"Manage Rubric Blocks\", options)))\n    + \"\\\" data-toggle=\\\"#rublocks-\";\n  if (helper = helpers.identifier) { stack1 = helper.call(depth0, {hash:{},data:data}); }\n  else { helper = (depth0 && depth0.identifier); stack1 = typeof helper === functionType ? helper.call(depth0, {hash:{},data:data}) : helper; }\n  buffer += escapeExpression(stack1)\n    + \"\\\" ><span class=\\\"icon-rubric\\\"></span></a>\\n                                <span class=\\\"tlb-separator\\\"></span>\\n                                <a href=\\\"#\\\" class=\\\"tlb-button-off property-toggler\\\" title=\\\"\"\n    + escapeExpression((helper = helpers.__ || (depth0 && depth0.__),options={hash:{},data:data},helper ? helper.call(depth0, \"Section Properties\", options) : helperMissing.call(depth0, \"__\", \"Section Properties\", options)))\n    + \"\\\"><span class=\\\"icon-settings\\\"></span></a>\\n                                <span class=\\\"tlb-separator\\\"></span>\\n                                <a href=\\\"#\\\" class=\\\"tlb-button-off move-up disabled\\\" title=\\\"\"\n    + escapeExpression((helper = helpers.__ || (depth0 && depth0.__),options={hash:{},data:data},helper ? helper.call(depth0, \"Move Up\", options) : helperMissing.call(depth0, \"__\", \"Move Up\", options)))\n    + \"\\\"><span class=\\\"icon-up\\\"></span></a>\\n                                <a href=\\\"#\\\" class=\\\"tlb-button-off move-down disabled\\\" title=\\\"\"\n    + escapeExpression((helper = helpers.__ || (depth0 && depth0.__),options={hash:{},data:data},helper ? helper.call(depth0, \"Move Down\", options) : helperMissing.call(depth0, \"__\", \"Move Down\", options)))\n    + \"\\\"><span class=\\\"icon-down\\\"></span></a>\\n                                <span class=\\\"tlb-separator\\\"></span>\\n                                <a href=\\\"#\\\" class=\\\"tlb-button-off disabled\\\" title=\\\"\"\n    + escapeExpression((helper = helpers.__ || (depth0 && depth0.__),options={hash:{},data:data},helper ? helper.call(depth0, \"Remove Section\", options) : helperMissing.call(depth0, \"__\", \"Remove Section\", options)))\n    + \"\\\" data-delete=\\\":parent .section\\\"><span class=\\\"icon-bin\\\"></span></a>\\n                            </span>\\n                            <span class=\\\"tlb-end\\\"></span>\\n                        </span>\\n                    </span>\\n                </div>\\n            </div>\\n        </div>\\n    </h2>\\n\\n    <div id=\\\"rublocks-\";\n  if (helper = helpers.identifier) { stack1 = helper.call(depth0, {hash:{},data:data}); }\n  else { helper = (depth0 && depth0.identifier); stack1 = typeof helper === functionType ? helper.call(depth0, {hash:{},data:data}) : helper; }\n  buffer += escapeExpression(stack1)\n    + \"\\\" class=\\\"rublocks clearfix toggled\\\">\\n        <h3>\\n            <span class=\\\"title\\\">\"\n    + escapeExpression((helper = helpers.__ || (depth0 && depth0.__),options={hash:{},data:data},helper ? helper.call(depth0, \"Rubric Blocks\", options) : helperMissing.call(depth0, \"__\", \"Rubric Blocks\", options)))\n    + \"</span>\\n        </h3>\\n        <ol class=\\\"rubricblocks decimal\\\" data-bind-each=\\\"rubricBlocks\\\" data-bind-tmpl=\\\"rubricblock\\\"></ol>\\n        <button class=\\\"btn-info small rublock-adder\\\">\\n            <span class=\\\"icon-add\\\"></span>\"\n    + escapeExpression((helper = helpers.__ || (depth0 && depth0.__),options={hash:{},data:data},helper ? helper.call(depth0, \"New Rubric Block\", options) : helperMissing.call(depth0, \"__\", \"New Rubric Block\", options)))\n    + \"\\n        </button>\\n    </div>\\n    <div class=\\\"itemrefs-wrapper\\\">\\n        <h3>\\n            <span class=\\\"title\\\">\"\n    + escapeExpression((helper = helpers.__ || (depth0 && depth0.__),options={hash:{},data:data},helper ? helper.call(depth0, \"Items\", options) : helperMissing.call(depth0, \"__\", \"Items\", options)))\n    + \"</span>\\n        </h3>\\n        <ol class=\\\"itemrefs decimal clearfix\\\" data-bind-each=\\\"sectionParts\\\" data-bind-tmpl=\\\"itemref\\\" data-bind-filter=\\\"isItemRef\\\" data-msg=\\\"\"\n    + escapeExpression((helper = helpers.__ || (depth0 && depth0.__),options={hash:{},data:data},helper ? helper.call(depth0, \"Add selected item(s) here.\", options) : helperMissing.call(depth0, \"__\", \"Add selected item(s) here.\", options)))\n    + \"\\\"></ol>\\n        <div class=\\\"itemref-placeholder\\\">\\n            \"\n    + escapeExpression((helper = helpers.__ || (depth0 && depth0.__),options={hash:{},data:data},helper ? helper.call(depth0, \"Add selected item(s) here.\", options) : helperMissing.call(depth0, \"__\", \"Add selected item(s) here.\", options)))\n    + \"\\n        </div>\\n    </div>\\n</div>\\n\";\n  return buffer;\n  });\n});\n\n","\ndefine('tpl!taoQtiTest/controller/creator/templates/rubricblock', ['handlebars'], function(hb){ \nreturn hb.template(function (Handlebars,depth0,helpers,partials,data) {\n  this.compilerInfo = [4,'>= 1.0.0'];\nhelpers = this.merge(helpers, Handlebars.helpers); data = data || {};\n  var buffer = \"\", helper, options, helperMissing=helpers.helperMissing, escapeExpression=this.escapeExpression;\n\n\n  buffer += \"<li class=\\\"rubricblock\\\">\\n    <div class=\\\"actions\\\">\\n       <div class=\\\"tlb\\\">\\n            <div class=\\\"tlb-top\\\">\\n                <span class=\\\"tlb-box\\\">\\n                    <span class=\\\"tlb-bar\\\">\\n                        <span class=\\\"tlb-start\\\"></span>\\n                        <span class=\\\"tlb-group\\\">\\n                            <!--<a href=\\\"#\\\" class=\\\"tlb-button-off property-toggler\\\" title=\\\"\"\n    + escapeExpression((helper = helpers.__ || (depth0 && depth0.__),options={hash:{},data:data},helper ? helper.call(depth0, \"Rubric Block Properties\", options) : helperMissing.call(depth0, \"__\", \"Rubric Block Properties\", options)))\n    + \"\\\"><span class=\\\"icon-settings\\\"></span></a>-->\\n                            <!--<span class=\\\"tlb-separator\\\"></span> -->\\n                            <a href=\\\"#\\\" class=\\\"tlb-button-off\\\" title=\\\"\"\n    + escapeExpression((helper = helpers.__ || (depth0 && depth0.__),options={hash:{},data:data},helper ? helper.call(depth0, \"Remove Rubric Block\", options) : helperMissing.call(depth0, \"__\", \"Remove Rubric Block\", options)))\n    + \"\\\" data-delete=\\\":parent .rubricblock\\\"><span class=\\\"icon-bin\\\"></span></a>\\n                        </span>\\n                        <span class=\\\"tlb-end\\\"></span>\\n                    </span>\\n                </span>\\n            </div>\\n        </div>\\n    </div>\\n    <div class=\\\"rubricblock-content\\\" contenteditable></div>\\n    <div class=\\\"rubricblock-binding\\\" data-bind=\\\"content\\\" data-bind-html=\\\"true\\\" data-bind-encoder=\\\"dom2qti\\\"></div>\\n</li>\\n\";\n  return buffer;\n  });\n});\n\n","\ndefine('tpl!taoQtiTest/controller/creator/templates/itemref', ['handlebars'], function(hb){ \nreturn hb.template(function (Handlebars,depth0,helpers,partials,data) {\n  this.compilerInfo = [4,'>= 1.0.0'];\nhelpers = this.merge(helpers, Handlebars.helpers); data = data || {};\n  var buffer = \"\", stack1, helper, options, functionType=\"function\", escapeExpression=this.escapeExpression, helperMissing=helpers.helperMissing;\n\n\n  buffer += \"<li id='\";\n  if (helper = helpers.identifier) { stack1 = helper.call(depth0, {hash:{},data:data}); }\n  else { helper = (depth0 && depth0.identifier); stack1 = typeof helper === functionType ? helper.call(depth0, {hash:{},data:data}) : helper; }\n  buffer += escapeExpression(stack1)\n    + \"' data-uri='\";\n  if (helper = helpers.href) { stack1 = helper.call(depth0, {hash:{},data:data}); }\n  else { helper = (depth0 && depth0.href); stack1 = typeof helper === functionType ? helper.call(depth0, {hash:{},data:data}) : helper; }\n  buffer += escapeExpression(stack1)\n    + \"' class='itemref'>\\n    <span class='title truncate'>\";\n  if (helper = helpers.label) { stack1 = helper.call(depth0, {hash:{},data:data}); }\n  else { helper = (depth0 && depth0.label); stack1 = typeof helper === functionType ? helper.call(depth0, {hash:{},data:data}) : helper; }\n  buffer += escapeExpression(stack1)\n    + \"</span>\\n    <div class=\\\"actions\\\"> \\n        <div class=\\\"tlb\\\">\\n            <div class=\\\"tlb-top\\\">\\n                <span class=\\\"tlb-box\\\">\\n                    <span class=\\\"tlb-bar\\\">\\n                        <span class=\\\"tlb-start\\\"></span>\\n                        <span class=\\\"tlb-group\\\">\\n                            <a href=\\\"#\\\" class=\\\"tlb-button-off property-toggler\\\" title=\\\"\"\n    + escapeExpression((helper = helpers.__ || (depth0 && depth0.__),options={hash:{},data:data},helper ? helper.call(depth0, \"Item Reference Properties\", options) : helperMissing.call(depth0, \"__\", \"Item Reference Properties\", options)))\n    + \"\\\"><span class=\\\"icon-settings\\\"></span></a>\\n                            <span class=\\\"tlb-separator\\\"></span>\\n                            <a href=\\\"#\\\" class=\\\"tlb-button-off move-up\\\" title=\\\"\"\n    + escapeExpression((helper = helpers.__ || (depth0 && depth0.__),options={hash:{},data:data},helper ? helper.call(depth0, \"Move Up\", options) : helperMissing.call(depth0, \"__\", \"Move Up\", options)))\n    + \"\\\"><span class=\\\"icon-up\\\"></span></a>\\n                            <a href=\\\"#\\\" class=\\\"tlb-button-off move-down\\\" title=\\\"\"\n    + escapeExpression((helper = helpers.__ || (depth0 && depth0.__),options={hash:{},data:data},helper ? helper.call(depth0, \"Move Down\", options) : helperMissing.call(depth0, \"__\", \"Move Down\", options)))\n    + \"\\\"><span class=\\\"icon-down\\\"></span></a>\\n                            <span class=\\\"tlb-separator\\\"></span> \\n                            <a href=\\\"#\\\" class=\\\"tlb-button-off\\\" title=\\\"\"\n    + escapeExpression((helper = helpers.__ || (depth0 && depth0.__),options={hash:{},data:data},helper ? helper.call(depth0, \"Remove Item Reference\", options) : helperMissing.call(depth0, \"__\", \"Remove Item Reference\", options)))\n    + \"\\\" data-delete=\\\":parent .itemref\\\"><span class=\\\"icon-bin\\\"></span></a>\\n                        </span>\\n                        <span class=\\\"tlb-end\\\"></span>\\n                    </span>  \\n                </span>   \\n            </div>\\n        </div>\\n    </div>\\n</li>\\n\";\n  return buffer;\n  });\n});\n\n","\ndefine('tpl!taoQtiTest/controller/creator/templates/item', ['handlebars'], function(hb){ \nreturn hb.template(function (Handlebars,depth0,helpers,partials,data) {\n  this.compilerInfo = [4,'>= 1.0.0'];\nhelpers = this.merge(helpers, Handlebars.helpers); data = data || {};\n  var buffer = \"\", stack1, functionType=\"function\", escapeExpression=this.escapeExpression, self=this;\n\nfunction program1(depth0,data) {\n  \n  var buffer = \"\", stack1, helper;\n  buffer += \"\\n     <li data-uri='\";\n  if (helper = helpers.uri) { stack1 = helper.call(depth0, {hash:{},data:data}); }\n  else { helper = (depth0 && depth0.uri); stack1 = typeof helper === functionType ? helper.call(depth0, {hash:{},data:data}) : helper; }\n  buffer += escapeExpression(stack1)\n    + \"' data-categories='\";\n  if (helper = helpers.categories) { stack1 = helper.call(depth0, {hash:{},data:data}); }\n  else { helper = (depth0 && depth0.categories); stack1 = typeof helper === functionType ? helper.call(depth0, {hash:{},data:data}) : helper; }\n  buffer += escapeExpression(stack1)\n    + \"' class='truncate'>\\n        \";\n  if (helper = helpers.label) { stack1 = helper.call(depth0, {hash:{},data:data}); }\n  else { helper = (depth0 && depth0.label); stack1 = typeof helper === functionType ? helper.call(depth0, {hash:{},data:data}) : helper; }\n  buffer += escapeExpression(stack1)\n    + \"\\n        \";\n  stack1 = helpers['if'].call(depth0, (depth0 && depth0.parent), {hash:{},inverse:self.noop,fn:self.program(2, program2, data),data:data});\n  if(stack1 || stack1 === 0) { buffer += stack1; }\n  buffer += \"\\n     </li>\\n\";\n  return buffer;\n  }\nfunction program2(depth0,data) {\n  \n  var buffer = \"\", stack1, helper;\n  buffer += \"<span class='flag truncate' title=\\\"\";\n  if (helper = helpers.parent) { stack1 = helper.call(depth0, {hash:{},data:data}); }\n  else { helper = (depth0 && depth0.parent); stack1 = typeof helper === functionType ? helper.call(depth0, {hash:{},data:data}) : helper; }\n  buffer += escapeExpression(stack1)\n    + \"\\\">\";\n  if (helper = helpers.parent) { stack1 = helper.call(depth0, {hash:{},data:data}); }\n  else { helper = (depth0 && depth0.parent); stack1 = typeof helper === functionType ? helper.call(depth0, {hash:{},data:data}) : helper; }\n  buffer += escapeExpression(stack1)\n    + \"</span>\";\n  return buffer;\n  }\n\n  stack1 = helpers.each.call(depth0, depth0, {hash:{},inverse:self.noop,fn:self.program(1, program1, data),data:data});\n  if(stack1 || stack1 === 0) { buffer += stack1; }\n  buffer += \"\\n\";\n  return buffer;\n  });\n});\n\n","\ndefine('tpl!taoQtiTest/controller/creator/templates/test-props', ['handlebars'], function(hb){ \nreturn hb.template(function (Handlebars,depth0,helpers,partials,data) {\n  this.compilerInfo = [4,'>= 1.0.0'];\nhelpers = this.merge(helpers, Handlebars.helpers); data = data || {};\n  var buffer = \"\", stack1, helper, options, functionType=\"function\", escapeExpression=this.escapeExpression, self=this, helperMissing=helpers.helperMissing;\n\nfunction program1(depth0,data) {\n  \n  var buffer = \"\", stack1, helper, options;\n  buffer += \"\\n    <div class=\\\"test-scoring toggled\\\">\\n\\n<!-- assessmentTest/scoring/outcomeProcessing -->\\n        <div class=\\\"grid-row\\\">\\n            <div class=\\\"col-5\\\">\\n                <label for=\\\"test-outcome-processing\\\">\"\n    + escapeExpression((helper = helpers.__ || (depth0 && depth0.__),options={hash:{},data:data},helper ? helper.call(depth0, \"Outcome processing\", options) : helperMissing.call(depth0, \"__\", \"Outcome processing\", options)))\n    + \"</label>\\n            </div>\\n            <div class=\\\"col-6\\\">\\n                <select name=\\\"test-outcome-processing\\\" class=\\\"select2\\\" data-bind=\\\"scoring.outcomeProcessing\\\" data-bind-encoder=\\\"string\\\" data-has-search=\\\"false\\\">\\n                \";\n  stack1 = helpers.each.call(depth0, (depth0 && depth0.modes), {hash:{},inverse:self.noop,fn:self.program(2, program2, data),data:data});\n  if(stack1 || stack1 === 0) { buffer += stack1; }\n  buffer += \"\\n                </select>\\n            </div>\\n            <div class=\\\"col-1 help\\\">\\n                <span class=\\\"icon-help\\\" data-tooltip=\\\"~ .tooltip-content\\\" data-tooltip-theme=\\\"info\\\"></span>\\n                <div class=\\\"tooltip-content\\\">\\n                    \"\n    + escapeExpression((helper = helpers.__ || (depth0 && depth0.__),options={hash:{},data:data},helper ? helper.call(depth0, \"Select the way the responses of your test should be processed\", options) : helperMissing.call(depth0, \"__\", \"Select the way the responses of your test should be processed\", options)))\n    + \"\\n                </div>\\n            </div>\\n        </div>\\n\\n<!-- assessmentTest/scoring/cutScore -->\\n        <div class=\\\"grid-row test-cut-score\\\">\\n            <div class=\\\"col-5\\\">\\n                <label for=\\\"test-cut-score\\\">\"\n    + escapeExpression((helper = helpers.__ || (depth0 && depth0.__),options={hash:{},data:data},helper ? helper.call(depth0, \"Cut score\", options) : helperMissing.call(depth0, \"__\", \"Cut score\", options)))\n    + \"</label>\\n            </div>\\n            <div class=\\\"col-6\\\">\\n                <input type=\\\"text\\\" name=\\\"test-cut-score\\\" value=\\\"0\\\" data-bind=\\\"scoring.cutScore\\\" data-bind-encoder=\\\"float\\\" data-validate=\\\"$numeric;\\\" />\\n            </div>\\n            <div class=\\\"col-1 help\\\">\\n                <span class=\\\"icon-help\\\" data-tooltip=\\\"~ .tooltip-content\\\" data-tooltip-theme=\\\"info\\\"></span>\\n                <div class=\\\"tooltip-content\\\">\\n                    \"\n    + escapeExpression((helper = helpers.__ || (depth0 && depth0.__),options={hash:{},data:data},helper ? helper.call(depth0, \"Set the cut score associated to the test\", options) : helperMissing.call(depth0, \"__\", \"Set the cut score associated to the test\", options)))\n    + \"\\n                </div>\\n            </div>\\n        </div>\\n\\n<!-- assessmentTest/scoring/weightIdentifier -->\\n        <div class=\\\"grid-row test-weight-identifier\\\">\\n            <div class=\\\"col-5\\\">\\n                <label for=\\\"test-weight-identifier\\\">\"\n    + escapeExpression((helper = helpers.__ || (depth0 && depth0.__),options={hash:{},data:data},helper ? helper.call(depth0, \"Weight\", options) : helperMissing.call(depth0, \"__\", \"Weight\", options)))\n    + \"</label>\\n            </div>\\n            <div class=\\\"col-6\\\">\\n                <input type=\\\"text\\\" name=\\\"test-weight-identifier\\\" data-bind=\\\"scoring.weightIdentifier\\\" data-validate=\\\"$pattern(pattern=^([a-zA-Z_][a-zA-Z0-9_\\\\.-]*)?$);\\\" />\\n            </div>\\n            <div class=\\\"col-1 help\\\">\\n                <span class=\\\"icon-help\\\" data-tooltip=\\\"~ .tooltip-content\\\" data-tooltip-theme=\\\"info\\\"></span>\\n                <div class=\\\"tooltip-content\\\">\\n                    \"\n    + escapeExpression((helper = helpers.__ || (depth0 && depth0.__),options={hash:{},data:data},helper ? helper.call(depth0, \"Set the weight identifier used to process the score\", options) : helperMissing.call(depth0, \"__\", \"Set the weight identifier used to process the score\", options)))\n    + \"\\n                </div>\\n            </div>\\n        </div>\\n\\n<!-- assessmentTest/scoring/description -->\\n        <div class=\\\"grid-row\\\">\\n            <div class=\\\"col-12\\\">\\n                \";\n  stack1 = helpers.each.call(depth0, (depth0 && depth0.modes), {hash:{},inverse:self.noop,fn:self.program(5, program5, data),data:data});\n  if(stack1 || stack1 === 0) { buffer += stack1; }\n  buffer += \"\\n            </div>\\n        </div>\\n    </div>\\n\";\n  return buffer;\n  }\nfunction program2(depth0,data) {\n  \n  var buffer = \"\", stack1, helper;\n  buffer += \"\\n                    <option value=\\\"\";\n  if (helper = helpers.key) { stack1 = helper.call(depth0, {hash:{},data:data}); }\n  else { helper = (depth0 && depth0.key); stack1 = typeof helper === functionType ? helper.call(depth0, {hash:{},data:data}) : helper; }\n  buffer += escapeExpression(stack1)\n    + \"\\\" \";\n  stack1 = helpers['if'].call(depth0, (depth0 && depth0.selected), {hash:{},inverse:self.noop,fn:self.program(3, program3, data),data:data});\n  if(stack1 || stack1 === 0) { buffer += stack1; }\n  buffer += \">\";\n  if (helper = helpers.label) { stack1 = helper.call(depth0, {hash:{},data:data}); }\n  else { helper = (depth0 && depth0.label); stack1 = typeof helper === functionType ? helper.call(depth0, {hash:{},data:data}) : helper; }\n  buffer += escapeExpression(stack1)\n    + \"</option>\\n                \";\n  return buffer;\n  }\nfunction program3(depth0,data) {\n  \n  \n  return \"selected=\\\"selected\\\"\";\n  }\n\nfunction program5(depth0,data) {\n  \n  var buffer = \"\", stack1, helper;\n  buffer += \"\\n                <div class=\\\"feedback-info test-outcome-processing-description\\\" data-key=\\\"\";\n  if (helper = helpers.key) { stack1 = helper.call(depth0, {hash:{},data:data}); }\n  else { helper = (depth0 && depth0.key); stack1 = typeof helper === functionType ? helper.call(depth0, {hash:{},data:data}) : helper; }\n  buffer += escapeExpression(stack1)\n    + \"\\\">\\n                    <span class=\\\"icon-info\\\"></span>\\n                    \";\n  if (helper = helpers.description) { stack1 = helper.call(depth0, {hash:{},data:data}); }\n  else { helper = (depth0 && depth0.description); stack1 = typeof helper === functionType ? helper.call(depth0, {hash:{},data:data}) : helper; }\n  buffer += escapeExpression(stack1)\n    + \"\\n                </div>\\n                \";\n  return buffer;\n  }\n\n  buffer += \"<div class=\\\"test-props props clearfix\\\">\\n\\n    <!-- test properties -->\\n    <h3 data-bind=\\\"title\\\"></h3>\\n\\n<!-- assessmentTest/identifier -->\\n    <div class=\\\"grid-row\\\">\\n        <div class=\\\"col-5\\\">\\n            <label for=\\\"test-identifier\\\">\"\n    + escapeExpression((helper = helpers.__ || (depth0 && depth0.__),options={hash:{},data:data},helper ? helper.call(depth0, \"Identifier\", options) : helperMissing.call(depth0, \"__\", \"Identifier\", options)))\n    + \" <abbr title=\\\"\"\n    + escapeExpression((helper = helpers.__ || (depth0 && depth0.__),options={hash:{},data:data},helper ? helper.call(depth0, \"Required field\", options) : helperMissing.call(depth0, \"__\", \"Required field\", options)))\n    + \"\\\">*</abbr></label>\\n        </div>\\n        <div class=\\\"col-6\\\">\\n            <input type=\\\"text\\\" name=\\\"test-identifier\\\" data-bind=\\\"identifier\\\" data-validate=\\\"$notEmpty; $testIdFormat; $testIdAvailable(original=\";\n  if (helper = helpers.identifier) { stack1 = helper.call(depth0, {hash:{},data:data}); }\n  else { helper = (depth0 && depth0.identifier); stack1 = typeof helper === functionType ? helper.call(depth0, {hash:{},data:data}) : helper; }\n  buffer += escapeExpression(stack1)\n    + \");\\\" />\\n        </div>\\n        <div class=\\\"col-1 help\\\">\\n            <span class=\\\"icon-help\\\" data-tooltip=\\\"~ .tooltip-content\\\" data-tooltip-theme=\\\"info\\\"></span>\\n            <div class=\\\"tooltip-content\\\">\\n            \"\n    + escapeExpression((helper = helpers.__ || (depth0 && depth0.__),options={hash:{},data:data},helper ? helper.call(depth0, \"The principle identifier of the test.\", options) : helperMissing.call(depth0, \"__\", \"The principle identifier of the test.\", options)))\n    + \"\\n            </div>\\n        </div>\\n    </div>\\n\\n<!-- assessmentTest/title -->\\n    <div class=\\\"grid-row\\\">\\n        <div class=\\\"col-5\\\">\\n            <label for=\\\"test-title\\\">\"\n    + escapeExpression((helper = helpers.__ || (depth0 && depth0.__),options={hash:{},data:data},helper ? helper.call(depth0, \"Title\", options) : helperMissing.call(depth0, \"__\", \"Title\", options)))\n    + \" <abbr title=\\\"\"\n    + escapeExpression((helper = helpers.__ || (depth0 && depth0.__),options={hash:{},data:data},helper ? helper.call(depth0, \"Required field\", options) : helperMissing.call(depth0, \"__\", \"Required field\", options)))\n    + \"\\\">*</abbr></label>\\n        </div>\\n        <div class=\\\"col-6\\\">\\n            <input type=\\\"text\\\" name=\\\"test-title\\\" data-bind=\\\"title\\\" data-validate=\\\"$notEmpty\\\" />\\n        </div>\\n        <div class=\\\"col-1 help\\\">\\n            <span class=\\\"icon-help\\\" data-tooltip=\\\"~ .tooltip-content\\\" data-tooltip-theme=\\\"info\\\"></span>\\n            <div class=\\\"tooltip-content\\\">\\n            \"\n    + escapeExpression((helper = helpers.__ || (depth0 && depth0.__),options={hash:{},data:data},helper ? helper.call(depth0, \"The test title.\", options) : helperMissing.call(depth0, \"__\", \"The test title.\", options)))\n    + \"\\n            </div>\\n        </div>\\n    </div>\\n\\n    <h4 class=\\\"toggler closed\\\" data-toggle=\\\"~ .test-time-limits\\\">\"\n    + escapeExpression((helper = helpers.__ || (depth0 && depth0.__),options={hash:{},data:data},helper ? helper.call(depth0, \"Time Limits\", options) : helperMissing.call(depth0, \"__\", \"Time Limits\", options)))\n    + \"</h4>\\n\\n<!-- assessmentTest/timeLimits -->\\n    <div class=\\\"test-time-limits toggled\\\">\\n\\n\\n\\n<!-- assessmentTest/timeLimits/maxTime -->\\n        <div class=\\\"grid-row\\\">\\n            <div class=\\\"col-5\\\">\\n                <label for=\\\"test-max-time\\\">\"\n    + escapeExpression((helper = helpers.__ || (depth0 && depth0.__),options={hash:{},data:data},helper ? helper.call(depth0, \"Maximum Duration\", options) : helperMissing.call(depth0, \"__\", \"Maximum Duration\", options)))\n    + \"</label>\\n            </div>\\n            <div class=\\\"col-6\\\">\\n                <input type=\\\"text\\\" name=\\\"max-time\\\" value=\\\"00:00:00\\\" data-duration=\\\"HH:mm:ss\\\" data-bind=\\\"timeLimits.maxTime\\\" data-bind-encoder=\\\"time\\\" />\\n            </div>\\n            <div class=\\\"col-1 help\\\">\\n                <span class=\\\"icon-help\\\" data-tooltip=\\\"~ .tooltip-content\\\" data-tooltip-theme=\\\"info\\\"></span>\\n                <div class=\\\"tooltip-content\\\">\\n                \"\n    + escapeExpression((helper = helpers.__ || (depth0 && depth0.__),options={hash:{},data:data},helper ? helper.call(depth0, \"Maximum duration for the all test.\", options) : helperMissing.call(depth0, \"__\", \"Maximum duration for the all test.\", options)))\n    + \"\\n                </div>\\n            </div>\\n        </div>\\n\\n<!-- assessmentTest/timeLimits/allowLateSubmission -->\\n        <div class=\\\"grid-row pseudo-label-box\\\">\\n            <div class=\\\"col-5\\\">\\n                \"\n    + escapeExpression((helper = helpers.__ || (depth0 && depth0.__),options={hash:{},data:data},helper ? helper.call(depth0, \"Late submission allowed\", options) : helperMissing.call(depth0, \"__\", \"Late submission allowed\", options)))\n    + \"\\n            </div>\\n            <div class=\\\"col-6\\\">\\n                <label>\\n                    <input type=\\\"checkbox\\\" name=\\\"test-allow-late-submission\\\" value=\\\"true\\\" data-bind=\\\"timeLimits.allowLateSubmission\\\" data-bind-encoder=\\\"boolean\\\" />\\n                    <span class=\\\"icon-checkbox\\\"></span>\\n                </label>\\n            </div>\\n            <div class=\\\"col-1 help\\\">\\n                <span class=\\\"icon-help\\\" data-tooltip=\\\"~ .tooltip-content\\\" data-tooltip-theme=\\\"info\\\"></span>\\n                <div class=\\\"tooltip-content\\\">\\n                \"\n    + escapeExpression((helper = helpers.__ || (depth0 && depth0.__),options={hash:{},data:data},helper ? helper.call(depth0, \"Whether a candidate's response that is beyond the maximum duration should still be accepted.\", options) : helperMissing.call(depth0, \"__\", \"Whether a candidate's response that is beyond the maximum duration should still be accepted.\", options)))\n    + \"\\n                </div>\\n            </div>\\n        </div>\\n    </div>\\n\\n    <h4 class=\\\"toggler closed\\\" data-toggle=\\\"~ .test-scoring\\\">\"\n    + escapeExpression((helper = helpers.__ || (depth0 && depth0.__),options={hash:{},data:data},helper ? helper.call(depth0, \"Scoring\", options) : helperMissing.call(depth0, \"__\", \"Scoring\", options)))\n    + \"</h4>\\n\\n<!-- assessmentTest/scoring -->\\n\";\n  stack1 = helpers['with'].call(depth0, (depth0 && depth0.scoring), {hash:{},inverse:self.noop,fn:self.program(1, program1, data),data:data});\n  if(stack1 || stack1 === 0) { buffer += stack1; }\n  buffer += \"\\n</div>\\n\";\n  return buffer;\n  });\n});\n\n","\ndefine('tpl!taoQtiTest/controller/creator/templates/testpart-props', ['handlebars'], function(hb){ \nreturn hb.template(function (Handlebars,depth0,helpers,partials,data) {\n  this.compilerInfo = [4,'>= 1.0.0'];\nhelpers = this.merge(helpers, Handlebars.helpers); data = data || {};\n  var buffer = \"\", stack1, helper, options, functionType=\"function\", escapeExpression=this.escapeExpression, helperMissing=helpers.helperMissing;\n\n\n  buffer += \"<div id=\\\"testpart-props-\";\n  if (helper = helpers.identifier) { stack1 = helper.call(depth0, {hash:{},data:data}); }\n  else { helper = (depth0 && depth0.identifier); stack1 = typeof helper === functionType ? helper.call(depth0, {hash:{},data:data}) : helper; }\n  buffer += escapeExpression(stack1)\n    + \"\\\" class=\\\"testpart-props props clearfix\\\">\\n    <h3>\";\n  if (helper = helpers.identifier) { stack1 = helper.call(depth0, {hash:{},data:data}); }\n  else { helper = (depth0 && depth0.identifier); stack1 = typeof helper === functionType ? helper.call(depth0, {hash:{},data:data}) : helper; }\n  buffer += escapeExpression(stack1)\n    + \"</h3>\\n\\n    <form autocomplete=\\\"off\\\">\\n\\n<!-- assessmentTest/testPart/identifier -->\\n        <div class=\\\"grid-row\\\">\\n            <div class=\\\"col-5\\\">\\n                <label for=\\\"testpart-identifier\\\">\"\n    + escapeExpression((helper = helpers.__ || (depth0 && depth0.__),options={hash:{},data:data},helper ? helper.call(depth0, \"Identifier\", options) : helperMissing.call(depth0, \"__\", \"Identifier\", options)))\n    + \" <abbr title=\\\"\"\n    + escapeExpression((helper = helpers.__ || (depth0 && depth0.__),options={hash:{},data:data},helper ? helper.call(depth0, \"Required field\", options) : helperMissing.call(depth0, \"__\", \"Required field\", options)))\n    + \"\\\">*</abbr></label>\\n            </div>\\n            <div class=\\\"col-6\\\">\\n                <input type=\\\"text\\\" name=\\\"testpart-identifier\\\" data-bind=\\\"identifier\\\" data-validate=\\\"$notEmpty; $idFormat; $testIdAvailable(original=\";\n  if (helper = helpers.identifier) { stack1 = helper.call(depth0, {hash:{},data:data}); }\n  else { helper = (depth0 && depth0.identifier); stack1 = typeof helper === functionType ? helper.call(depth0, {hash:{},data:data}) : helper; }\n  buffer += escapeExpression(stack1)\n    + \");\\\" />\\n            </div>\\n            <div class=\\\"col-1 help\\\">\\n                <span class=\\\"icon-help\\\" data-tooltip=\\\"~ .tooltip-content\\\" data-tooltip-theme=\\\"info\\\"></span>\\n                <div class=\\\"tooltip-content\\\">\\n                \"\n    + escapeExpression((helper = helpers.__ || (depth0 && depth0.__),options={hash:{},data:data},helper ? helper.call(depth0, \"The test part identifier.\", options) : helperMissing.call(depth0, \"__\", \"The test part identifier.\", options)))\n    + \"\\n                </div>\\n            </div>\\n        </div>\\n\\n<!-- assessmentTest/testPart/navigationMode -->\\n        <div class=\\\"grid-row pseudo-label-box\\\">\\n            <div class=\\\"col-5\\\">\\n               \"\n    + escapeExpression((helper = helpers.__ || (depth0 && depth0.__),options={hash:{},data:data},helper ? helper.call(depth0, \"Navigation\", options) : helperMissing.call(depth0, \"__\", \"Navigation\", options)))\n    + \" <abbr title=\\\"\"\n    + escapeExpression((helper = helpers.__ || (depth0 && depth0.__),options={hash:{},data:data},helper ? helper.call(depth0, \"Required field\", options) : helperMissing.call(depth0, \"__\", \"Required field\", options)))\n    + \"\\\">*</abbr>\\n            </div>\\n            <div class=\\\"col-6\\\">\\n                <label>\\n                    <input type=\\\"radio\\\" name=\\\"testpart-navigation-mode\\\" value=\\\"0\\\" checked=\\\"checked\\\" data-bind=\\\"navigationMode\\\" data-bind-encoder=\\\"number\\\" />\\n                    <span class=\\\"icon-radio\\\"></span>\\n                    \"\n    + escapeExpression((helper = helpers.__ || (depth0 && depth0.__),options={hash:{},data:data},helper ? helper.call(depth0, \"Linear\", options) : helperMissing.call(depth0, \"__\", \"Linear\", options)))\n    + \"\\n                </label>\\n                <label>\\n                    <input type=\\\"radio\\\" name=\\\"testpart-navigation-mode\\\" value=\\\"1\\\"  />\\n                    <span class=\\\"icon-radio\\\"></span>\\n                    \"\n    + escapeExpression((helper = helpers.__ || (depth0 && depth0.__),options={hash:{},data:data},helper ? helper.call(depth0, \"Non Linear\", options) : helperMissing.call(depth0, \"__\", \"Non Linear\", options)))\n    + \"\\n                </label>\\n            </div>\\n            <div class=\\\"col-1 help\\\">\\n                <span class=\\\"icon-help\\\" data-tooltip=\\\"~ .tooltip-content\\\" data-tooltip-theme=\\\"info\\\"></span>\\n                <div class=\\\"tooltip-content\\\">\\n                \"\n    + escapeExpression((helper = helpers.__ || (depth0 && depth0.__),options={hash:{},data:data},helper ? helper.call(depth0, \"The navigation mode determines the general paths that the candidate may take. A linear mode restricts the candidate to attempt each item in turn. Non Linear removes this restriction.\", options) : helperMissing.call(depth0, \"__\", \"The navigation mode determines the general paths that the candidate may take. A linear mode restricts the candidate to attempt each item in turn. Non Linear removes this restriction.\", options)))\n    + \"\\n                </div>\\n            </div>\\n        </div>\\n\\n<!-- assessmentTest/testPart/submissionMode -->\\n        <div class=\\\"grid-row pseudo-label-box\\\">\\n            <div class=\\\"col-5\\\">\\n                \"\n    + escapeExpression((helper = helpers.__ || (depth0 && depth0.__),options={hash:{},data:data},helper ? helper.call(depth0, \"Submission\", options) : helperMissing.call(depth0, \"__\", \"Submission\", options)))\n    + \" <abbr title=\\\"\"\n    + escapeExpression((helper = helpers.__ || (depth0 && depth0.__),options={hash:{},data:data},helper ? helper.call(depth0, \"Required field\", options) : helperMissing.call(depth0, \"__\", \"Required field\", options)))\n    + \"\\\">*</abbr>\\n            </div>\\n            <div class=\\\"col-6\\\">\\n                <label>\\n                    <input type=\\\"radio\\\" name=\\\"testpart-submission-mode\\\" value=\\\"0\\\" checked=\\\"checked\\\" data-bind=\\\"submissionMode\\\" data-bind-encoder=\\\"number\\\" />\\n                    <span class=\\\"icon-radio\\\"></span>\\n                    \"\n    + escapeExpression((helper = helpers.__ || (depth0 && depth0.__),options={hash:{},data:data},helper ? helper.call(depth0, \"Individual\", options) : helperMissing.call(depth0, \"__\", \"Individual\", options)))\n    + \"\\n                </label>\\n                <label>\\n                    <input type=\\\"radio\\\" name=\\\"testpart-submission-mode\\\" value=\\\"1\\\"  />\\n                    <span class=\\\"icon-radio\\\"></span>\\n                    \"\n    + escapeExpression((helper = helpers.__ || (depth0 && depth0.__),options={hash:{},data:data},helper ? helper.call(depth0, \"Simultaneous\", options) : helperMissing.call(depth0, \"__\", \"Simultaneous\", options)))\n    + \"\\n                </label>\\n            </div>\\n            <div class=\\\"col-1 help\\\">\\n                <span class=\\\"icon-help\\\" data-tooltip=\\\"~ .tooltip-content\\\" data-tooltip-theme=\\\"info\\\"></span>\\n                <div class=\\\"tooltip-content\\\">\\n                \"\n    + escapeExpression((helper = helpers.__ || (depth0 && depth0.__),options={hash:{},data:data},helper ? helper.call(depth0, \"The submission mode determines when the candidate's responses are submitted for response processing. A testPart in individual mode requires the candidate to submit their responses on an item-by-item basis. In simultaneous mode the candidate's responses are all submitted together at the end of the testPart.\", options) : helperMissing.call(depth0, \"__\", \"The submission mode determines when the candidate's responses are submitted for response processing. A testPart in individual mode requires the candidate to submit their responses on an item-by-item basis. In simultaneous mode the candidate's responses are all submitted together at the end of the testPart.\", options)))\n    + \"\\n                </div>\\n            </div>\\n        </div>\\n\\n        <h4 class=\\\"toggler closed\\\" data-toggle=\\\"~ .testpart-item-session-control\\\">\"\n    + escapeExpression((helper = helpers.__ || (depth0 && depth0.__),options={hash:{},data:data},helper ? helper.call(depth0, \"Item Session Control\", options) : helperMissing.call(depth0, \"__\", \"Item Session Control\", options)))\n    + \"</h4>\\n\\n\\n<!-- assessmentTest/testPart/itemSessionControl -->\\n        <div class=\\\"testpart-item-session-control toggled\\\">\\n\\n<!-- assessmentTest/testPart/itemSessionControl/maxAttempts -->\\n            <div class=\\\"grid-row\\\">\\n                <div class=\\\"col-5\\\">\\n                    <label for=\\\"testpart-max-attempts\\\">\"\n    + escapeExpression((helper = helpers.__ || (depth0 && depth0.__),options={hash:{},data:data},helper ? helper.call(depth0, \"Max Attempts\", options) : helperMissing.call(depth0, \"__\", \"Max Attempts\", options)))\n    + \"</label>\\n                </div>\\n                <div class=\\\"col-6\\\">\\n                    <input name=\\\"testpart-max-attempts\\\" type=\\\"text\\\" data-increment=\\\"1\\\" data-min=\\\"0\\\" value=\\\"1\\\" data-bind=\\\"itemSessionControl.maxAttempts\\\" data-bind-encoder=\\\"number\\\" />\\n                </div>\\n                <div class=\\\"col-1 help\\\">\\n                    <span class=\\\"icon-help\\\" data-tooltip=\\\"~ .tooltip-content\\\" data-tooltip-theme=\\\"info\\\"></span>\\n                    <div class=\\\"tooltip-content\\\">\\n                    \"\n    + escapeExpression((helper = helpers.__ || (depth0 && depth0.__),options={hash:{},data:data},helper ? helper.call(depth0, \"Controls the maximum number of attempts allowed. 0 means unlimited.\", options) : helperMissing.call(depth0, \"__\", \"Controls the maximum number of attempts allowed. 0 means unlimited.\", options)))\n    + \"\\n                    </div>\\n                </div>\\n            </div>\\n\\n<!-- assessmentTest/testPart/itemSessionControl/showFeedback -->\\n            <div class=\\\"grid-row pseudo-label-box\\\">\\n                <div class=\\\"col-5\\\">\\n                    <label for=\\\"testpart-show-feedback\\\">\"\n    + escapeExpression((helper = helpers.__ || (depth0 && depth0.__),options={hash:{},data:data},helper ? helper.call(depth0, \"Show Feedback\", options) : helperMissing.call(depth0, \"__\", \"Show Feedback\", options)))\n    + \"</label>\\n                </div>\\n                <div class=\\\"col-6\\\">\\n                    <label>\\n                        <input type=\\\"checkbox\\\" name=\\\"testpart-show-feedback\\\" value=\\\"true\\\" data-bind=\\\"itemSessionControl.showFeedback\\\" data-bind-encoder=\\\"boolean\\\" />\\n                        <span class=\\\"icon-checkbox\\\" />\\n                    </label>\\n                </div>\\n                <div class=\\\"col-1 help\\\">\\n                    <span class=\\\"icon-help\\\" data-tooltip=\\\"~ .tooltip-content\\\" data-tooltip-theme=\\\"info\\\"></span>\\n                    <div class=\\\"tooltip-content\\\">\\n                    \"\n    + escapeExpression((helper = helpers.__ || (depth0 && depth0.__),options={hash:{},data:data},helper ? helper.call(depth0, \"This constraint affects the visibility of feedback after the end of the last attempt.\", options) : helperMissing.call(depth0, \"__\", \"This constraint affects the visibility of feedback after the end of the last attempt.\", options)))\n    + \"\\n                    </div>\\n                </div>\\n            </div>\\n\\n\\n\\n\\n\\n<!-- assessmentTest/testPart/itemSessionControl/allowComment -->\\n            <div class=\\\"grid-row pseudo-label-box\\\">\\n                <div class=\\\"col-5\\\">\\n                    <label for=\\\"testpart-allow-comment\\\">\"\n    + escapeExpression((helper = helpers.__ || (depth0 && depth0.__),options={hash:{},data:data},helper ? helper.call(depth0, \"Allow Comment\", options) : helperMissing.call(depth0, \"__\", \"Allow Comment\", options)))\n    + \"</label>\\n                </div>\\n                <div class=\\\"col-6\\\">\\n                    <label>\\n                        <input type=\\\"checkbox\\\" name=\\\"testpart-allow-comment\\\" value=\\\"true\\\" data-bind=\\\"itemSessionControl.allowComment\\\" data-bind-encoder=\\\"boolean\\\" />\\n                        <span class=\\\"icon-checkbox\\\" />\\n                    </label>\\n                </div>\\n                <div class=\\\"col-1 help\\\">\\n                    <span class=\\\"icon-help\\\" data-tooltip=\\\"~ .tooltip-content\\\" data-tooltip-theme=\\\"info\\\"></span>\\n                    <div class=\\\"tooltip-content\\\">\\n                    \"\n    + escapeExpression((helper = helpers.__ || (depth0 && depth0.__),options={hash:{},data:data},helper ? helper.call(depth0, \"This constraint controls whether or not the candidate is allowed to provide a comment on the item during the session. Comments are not part of the assessed responses.\", options) : helperMissing.call(depth0, \"__\", \"This constraint controls whether or not the candidate is allowed to provide a comment on the item during the session. Comments are not part of the assessed responses.\", options)))\n    + \"\\n                    </div>\\n                </div>\\n            </div>\\n\\n<!-- assessmentTest/testPart/itemSessionControl/allowSkipping -->\\n            <div class=\\\"grid-row pseudo-label-box\\\">\\n                <div class=\\\"col-5\\\">\\n                    <label for=\\\"testpart-allow-skipping\\\">\"\n    + escapeExpression((helper = helpers.__ || (depth0 && depth0.__),options={hash:{},data:data},helper ? helper.call(depth0, \"Allow Skipping\", options) : helperMissing.call(depth0, \"__\", \"Allow Skipping\", options)))\n    + \"</label>\\n                </div>\\n                <div class=\\\"col-6\\\">\\n                    <label>\\n                        <input type=\\\"checkbox\\\" name=\\\"testpart-allow-skipping\\\" value=\\\"true\\\" checked=\\\"checked\\\"  data-bind=\\\"itemSessionControl.allowSkipping\\\" data-bind-encoder=\\\"boolean\\\"   />\\n                        <span class=\\\"icon-checkbox\\\" />\\n                    </label>\\n                </div>\\n                <div class=\\\"col-1 help\\\">\\n                    <span class=\\\"icon-help\\\" data-tooltip=\\\"~ .tooltip-content\\\" data-tooltip-theme=\\\"info\\\"></span>\\n                    <div class=\\\"tooltip-content\\\">\\n                    \"\n    + escapeExpression((helper = helpers.__ || (depth0 && depth0.__),options={hash:{},data:data},helper ? helper.call(depth0, \"If the candidate can skip the item, without submitting a response.\", options) : helperMissing.call(depth0, \"__\", \"If the candidate can skip the item, without submitting a response.\", options)))\n    + \"\\n                    </div>\\n                </div>\\n            </div>\\n\\n\\n        </div>\\n\\n        <h4 class=\\\"toggler closed\\\" data-toggle=\\\"~ .testpart-time-limits\\\">\"\n    + escapeExpression((helper = helpers.__ || (depth0 && depth0.__),options={hash:{},data:data},helper ? helper.call(depth0, \"Time Limits\", options) : helperMissing.call(depth0, \"__\", \"Time Limits\", options)))\n    + \"</h4>\\n\\n<!-- assessmentTest/testPart/timeLimits/minTime -->\\n        <div class=\\\"testpart-time-limits toggled\\\">\\n\\n\\n\\n<!-- assessmentTest/testPart/timeLimits/maxTime -->\\n            <div class=\\\"grid-row\\\">\\n                <div class=\\\"col-5\\\">\\n                    <label for=\\\"testpart-max-time\\\">\"\n    + escapeExpression((helper = helpers.__ || (depth0 && depth0.__),options={hash:{},data:data},helper ? helper.call(depth0, \"Maximum Duration\", options) : helperMissing.call(depth0, \"__\", \"Maximum Duration\", options)))\n    + \"</label>\\n                </div>\\n                <div class=\\\"col-6\\\">\\n                    <input type=\\\"text\\\" name=\\\"max-time\\\" value=\\\"00:00:00\\\" data-duration=\\\"HH:mm:ss\\\" data-bind=\\\"timeLimits.maxTime\\\" data-bind-encoder=\\\"time\\\" />\\n                </div>\\n                <div class=\\\"col-1 help\\\">\\n                    <span class=\\\"icon-help\\\" data-tooltip=\\\"~ .tooltip-content\\\" data-tooltip-theme=\\\"info\\\"></span>\\n                    <div class=\\\"tooltip-content\\\">\\n                    \"\n    + escapeExpression((helper = helpers.__ || (depth0 && depth0.__),options={hash:{},data:data},helper ? helper.call(depth0, \"Maximum duration for this test part.\", options) : helperMissing.call(depth0, \"__\", \"Maximum duration for this test part.\", options)))\n    + \"\\n                    </div>\\n                </div>\\n            </div>\\n\\n<!-- assessmentTest/testPart/timeLimits/allowLateSubmission -->\\n            <div class=\\\"grid-row pseudo-label-box\\\">\\n                <div class=\\\"col-5\\\">\\n                    <label for=\\\"testpart-allow-late-submission\\\">\"\n    + escapeExpression((helper = helpers.__ || (depth0 && depth0.__),options={hash:{},data:data},helper ? helper.call(depth0, \"Late submission allowed\", options) : helperMissing.call(depth0, \"__\", \"Late submission allowed\", options)))\n    + \"</label>\\n                </div>\\n                <div class=\\\"col-6\\\">\\n                    <label>\\n                        <input type=\\\"checkbox\\\" name=\\\"section-allow-late-submission\\\" value=\\\"true\\\" data-bind=\\\"timeLimits.allowLateSubmission\\\" data-bind-encoder=\\\"boolean\\\" />\\n                        <span class=\\\"icon-checkbox\\\" />\\n                    </label>\\n                </div>\\n                <div class=\\\"col-1 help\\\">\\n                    <span class=\\\"icon-help\\\" data-tooltip=\\\"~ .tooltip-content\\\" data-tooltip-theme=\\\"info\\\"></span>\\n                    <div class=\\\"tooltip-content\\\">\\n                    \"\n    + escapeExpression((helper = helpers.__ || (depth0 && depth0.__),options={hash:{},data:data},helper ? helper.call(depth0, \"Whether a candidate's response that is beyond the maximum duration of the test part should still be accepted.\", options) : helperMissing.call(depth0, \"__\", \"Whether a candidate's response that is beyond the maximum duration of the test part should still be accepted.\", options)))\n    + \"\\n                    </div>\\n                </div>\\n            </div>\\n        </div>\\n    </form>\\n</div>\\n\";\n  return buffer;\n  });\n});\n\n","\ndefine('tpl!taoQtiTest/controller/creator/templates/section-props', ['handlebars'], function(hb){ \nreturn hb.template(function (Handlebars,depth0,helpers,partials,data) {\n  this.compilerInfo = [4,'>= 1.0.0'];\nhelpers = this.merge(helpers, Handlebars.helpers); data = data || {};\n  var buffer = \"\", stack1, helper, options, helperMissing=helpers.helperMissing, escapeExpression=this.escapeExpression, functionType=\"function\", self=this;\n\nfunction program1(depth0,data) {\n  \n  var buffer = \"\", helper, options;\n  buffer += \"\\n    <div class=\\\"grid-row pseudo-label-box\\\">\\n        <div class=\\\"col-5\\\">\\n            <label for=\\\"section-blueprint\\\">\"\n    + escapeExpression((helper = helpers.__ || (depth0 && depth0.__),options={hash:{},data:data},helper ? helper.call(depth0, \"Associate Blueprint\", options) : helperMissing.call(depth0, \"__\", \"Associate Blueprint\", options)))\n    + \"</label>\\n        </div>\\n\\n        <div class=\\\"col-6\\\">\\n            <input type=\\\"text\\\" name=\\\"section-blueprint\\\" />\\n        </div>\\n        <div class=\\\"col-1 help\\\">\\n            <span class=\\\"icon-help\\\" data-tooltip=\\\"~ .tooltip-content\\\" data-tooltip-theme=\\\"info\\\"></span>\\n            <div class=\\\"tooltip-content\\\">\\n                \"\n    + escapeExpression((helper = helpers.__ || (depth0 && depth0.__),options={hash:{},data:data},helper ? helper.call(depth0, \"Associate a blueprint to a section allow you to validate this section against the specified blueprint.\", options) : helperMissing.call(depth0, \"__\", \"Associate a blueprint to a section allow you to validate this section against the specified blueprint.\", options)))\n    + \"\\n            </div>\\n        </div>\\n    </div>\\n    \";\n  return buffer;\n  }\n\n  buffer += \"<div id=\\\"section-props-\";\n  if (helper = helpers.identifier) { stack1 = helper.call(depth0, {hash:{},data:data}); }\n  else { helper = (depth0 && depth0.identifier); stack1 = typeof helper === functionType ? helper.call(depth0, {hash:{},data:data}) : helper; }\n  buffer += escapeExpression(stack1)\n    + \"\\\" class=\\\"section-props props clearfix\\\">\\n    <h3>\";\n  if (helper = helpers.title) { stack1 = helper.call(depth0, {hash:{},data:data}); }\n  else { helper = (depth0 && depth0.title); stack1 = typeof helper === functionType ? helper.call(depth0, {hash:{},data:data}) : helper; }\n  buffer += escapeExpression(stack1)\n    + \"</h3>\\n\\n<!-- assessmentTest/testPart/assessmentSection/identifier -->\\n    <div class=\\\"grid-row\\\">\\n        <div class=\\\"col-5\\\">\\n            <label for=\\\"section-identifier\\\">\"\n    + escapeExpression((helper = helpers.__ || (depth0 && depth0.__),options={hash:{},data:data},helper ? helper.call(depth0, \"Identifier\", options) : helperMissing.call(depth0, \"__\", \"Identifier\", options)))\n    + \" <abbr title=\\\"\"\n    + escapeExpression((helper = helpers.__ || (depth0 && depth0.__),options={hash:{},data:data},helper ? helper.call(depth0, \"Required field\", options) : helperMissing.call(depth0, \"__\", \"Required field\", options)))\n    + \"\\\">*</abbr></label>\\n        </div>\\n        <div class=\\\"col-6\\\">\\n            <input type=\\\"text\\\" name=\\\"section-identifier\\\" data-bind=\\\"identifier\\\" data-validate=\\\"$notEmpty; $idFormat; $testIdAvailable(original=\";\n  if (helper = helpers.identifier) { stack1 = helper.call(depth0, {hash:{},data:data}); }\n  else { helper = (depth0 && depth0.identifier); stack1 = typeof helper === functionType ? helper.call(depth0, {hash:{},data:data}) : helper; }\n  buffer += escapeExpression(stack1)\n    + \");\\\" />\\n        </div>\\n        <div class=\\\"col-1 help\\\">\\n            <span class=\\\"icon-help\\\" data-tooltip=\\\"~ .tooltip-content\\\" data-tooltip-theme=\\\"info\\\"></span>\\n            <div class=\\\"tooltip-content\\\">\\n            \"\n    + escapeExpression((helper = helpers.__ || (depth0 && depth0.__),options={hash:{},data:data},helper ? helper.call(depth0, \"The identifier of the section.\", options) : helperMissing.call(depth0, \"__\", \"The identifier of the section.\", options)))\n    + \"\\n            </div>\\n        </div>\\n    </div>\\n\\n<!-- assessmentTest/testPart/assessmentSection/title -->\\n    <div class=\\\"grid-row\\\">\\n        <div class=\\\"col-5\\\">\\n            <label for=\\\"section-title\\\">\"\n    + escapeExpression((helper = helpers.__ || (depth0 && depth0.__),options={hash:{},data:data},helper ? helper.call(depth0, \"Title\", options) : helperMissing.call(depth0, \"__\", \"Title\", options)))\n    + \" <abbr title=\\\"\"\n    + escapeExpression((helper = helpers.__ || (depth0 && depth0.__),options={hash:{},data:data},helper ? helper.call(depth0, \"Required field\", options) : helperMissing.call(depth0, \"__\", \"Required field\", options)))\n    + \"\\\">*</abbr></label>\\n        </div>\\n        <div class=\\\"col-6\\\">\\n            <input type=\\\"text\\\" name=\\\"section-title\\\" data-bind=\\\"title\\\" data-validate=\\\"$notEmpty\\\" />\\n        </div>\\n        <div class=\\\"col-1 help\\\">\\n            <span class=\\\"icon-help\\\" data-tooltip=\\\"~ .tooltip-content\\\" data-tooltip-theme=\\\"info\\\"></span>\\n            <div class=\\\"tooltip-content\\\">\\n            \"\n    + escapeExpression((helper = helpers.__ || (depth0 && depth0.__),options={hash:{},data:data},helper ? helper.call(depth0, \"The section title.\", options) : helperMissing.call(depth0, \"__\", \"The section title.\", options)))\n    + \"\\n            </div>\\n        </div>\\n    </div>\\n\\n\\n\\n\\n\\n<!-- assessmentTest/testPart/assessmentSection/visible -->\\n    <div class=\\\"grid-row pseudo-label-box\\\">\\n        <div class=\\\"col-5\\\">\\n            <label for=\\\"section-visible\\\">\"\n    + escapeExpression((helper = helpers.__ || (depth0 && depth0.__),options={hash:{},data:data},helper ? helper.call(depth0, \"Visible\", options) : helperMissing.call(depth0, \"__\", \"Visible\", options)))\n    + \" <abbr title=\\\"\"\n    + escapeExpression((helper = helpers.__ || (depth0 && depth0.__),options={hash:{},data:data},helper ? helper.call(depth0, \"Required field\", options) : helperMissing.call(depth0, \"__\", \"Required field\", options)))\n    + \"\\\">*</abbr></label>\\n        </div>\\n        <div class=\\\"col-6\\\">\\n            <label>\\n                <input type=\\\"checkbox\\\" name=\\\"section-visible\\\" value=\\\"true\\\" checked=\\\"checked\\\"  data-bind=\\\"visible\\\" data-bind-encoder=\\\"boolean\\\" />\\n                <span class=\\\"icon-checkbox\\\"></span>\\n            </label>\\n        </div>\\n        <div class=\\\"col-1 help\\\">\\n            <span class=\\\"icon-help\\\" data-tooltip=\\\"~ .tooltip-content\\\" data-tooltip-theme=\\\"info\\\"></span>\\n            <div class=\\\"tooltip-content\\\">\\n            \"\n    + escapeExpression((helper = helpers.__ || (depth0 && depth0.__),options={hash:{},data:data},helper ? helper.call(depth0, \"A visible section is one that is identifiable by the candidate.\", options) : helperMissing.call(depth0, \"__\", \"A visible section is one that is identifiable by the candidate.\", options)))\n    + \"\\n            </div>\\n        </div>\\n    </div>\\n\\n<!-- assessmentTest/testPart/assessmentSection/keepTogether -->\\n    <div class=\\\"grid-row pseudo-label-box\\\">\\n        <div class=\\\"col-5\\\">\\n            <label for=\\\"section-keep-together\\\">\"\n    + escapeExpression((helper = helpers.__ || (depth0 && depth0.__),options={hash:{},data:data},helper ? helper.call(depth0, \"Keep Together\", options) : helperMissing.call(depth0, \"__\", \"Keep Together\", options)))\n    + \"</label>\\n        </div>\\n\\n        <div class=\\\"col-6\\\">\\n            <label>\\n                <input type=\\\"checkbox\\\" name=\\\"section-keep-together\\\" value=\\\"true\\\" checked=\\\"checked\\\"  data-bind=\\\"keepTogether\\\" data-bind-encoder=\\\"boolean\\\" />\\n                <span class=\\\"icon-checkbox\\\"></span>\\n            </label>\\n        </div>\\n        <div class=\\\"col-1 help\\\">\\n            <span class=\\\"icon-help\\\" data-tooltip=\\\"~ .tooltip-content\\\" data-tooltip-theme=\\\"info\\\"></span>\\n            <div class=\\\"tooltip-content\\\">\\n            \"\n    + escapeExpression((helper = helpers.__ || (depth0 && depth0.__),options={hash:{},data:data},helper ? helper.call(depth0, \"An invisible section with a parent that is subject to shuffling can specify whether or not its children, which will appear to the candidate as if they were part of the parent, are shuffled as a block or mixed up with the other children of the parent section.\", options) : helperMissing.call(depth0, \"__\", \"An invisible section with a parent that is subject to shuffling can specify whether or not its children, which will appear to the candidate as if they were part of the parent, are shuffled as a block or mixed up with the other children of the parent section.\", options)))\n    + \"\\n            </div>\\n        </div>\\n    </div>\\n\\n    \";\n  stack1 = helpers['if'].call(depth0, (depth0 && depth0.hasBlueprint), {hash:{},inverse:self.noop,fn:self.program(1, program1, data),data:data});\n  if(stack1 || stack1 === 0) { buffer += stack1; }\n  buffer += \"\\n\\n    <!-- assessmentTest/testPart/assessmentSection/sectionPart/category -->\\n    <div class=\\\"grid-row\\\">\\n        <div class=\\\"col-5\\\">\\n            <label for=\\\"section-category\\\">\"\n    + escapeExpression((helper = helpers.__ || (depth0 && depth0.__),options={hash:{},data:data},helper ? helper.call(depth0, \"Categories\", options) : helperMissing.call(depth0, \"__\", \"Categories\", options)))\n    + \"</label>\\n        </div>\\n        <div class=\\\"col-6\\\">\\n            <input type=\\\"text\\\" name=\\\"section-category\\\" />\\n        </div>\\n        <div class=\\\"col-1 help\\\">\\n            <span class=\\\"icon-help\\\" data-tooltip=\\\"~ .tooltip-content\\\" data-tooltip-theme=\\\"info\\\"></span>\\n            <div class=\\\"tooltip-content\\\">\\n            \"\n    + escapeExpression((helper = helpers.__ || (depth0 && depth0.__),options={hash:{},data:data},helper ? helper.call(depth0, \"Section level category enables configuring the categories of its composing items all at once. A category in gray means that all items have that category. A category in white means that only a few items have that category.\", options) : helperMissing.call(depth0, \"__\", \"Section level category enables configuring the categories of its composing items all at once. A category in gray means that all items have that category. A category in white means that only a few items have that category.\", options)))\n    + \"\\n            </div>\\n        </div>\\n    </div>\\n\\n    <h4 class=\\\"toggler closed\\\" data-toggle=\\\"~ .section-selection\\\">\"\n    + escapeExpression((helper = helpers.__ || (depth0 && depth0.__),options={hash:{},data:data},helper ? helper.call(depth0, \"Selection\", options) : helperMissing.call(depth0, \"__\", \"Selection\", options)))\n    + \"</h4>\\n\\n<!-- assessmentTest/testPart/assessmentSection/selection -->\\n    <div class=\\\"section-selection toggled\\\">\\n\\n        <div class=\\\"grid-row pseudo-label-box\\\">\\n            <div class=\\\"col-5\\\">\\n                <label for=\\\"section-enable-selection\\\">\"\n    + escapeExpression((helper = helpers.__ || (depth0 && depth0.__),options={hash:{},data:data},helper ? helper.call(depth0, \"Enable selection\", options) : helperMissing.call(depth0, \"__\", \"Enable selection\", options)))\n    + \"</label>\\n            </div>\\n\\n            <div class=\\\"col-6\\\">\\n                <label>\\n                    <input type=\\\"checkbox\\\" name=\\\"section-enable-selection\\\"  />\\n                    <span class=\\\"icon-checkbox\\\"></span>\\n                </label>\\n            </div>\\n        </div>\\n\\n<!-- assessmentTest/testPart/assessmentSection/selection/select -->\\n        <div class=\\\"grid-row\\\">\\n            <div class=\\\"col-5\\\">\\n                <label for=\\\"section-select\\\">\"\n    + escapeExpression((helper = helpers.__ || (depth0 && depth0.__),options={hash:{},data:data},helper ? helper.call(depth0, \"Select\", options) : helperMissing.call(depth0, \"__\", \"Select\", options)))\n    + \" <abbr title=\\\"\"\n    + escapeExpression((helper = helpers.__ || (depth0 && depth0.__),options={hash:{},data:data},helper ? helper.call(depth0, \"Required field\", options) : helperMissing.call(depth0, \"__\", \"Required field\", options)))\n    + \"\\\">*</abbr></label>\\n            </div>\\n            <div class=\\\"col-6\\\">\\n                <input name=\\\"section-select\\\" type=\\\"text\\\" data-increment=\\\"1\\\" data-min=\\\"0\\\" value=\\\"0\\\" data-bind=\\\"selection.select\\\"  data-bind-encoder=\\\"number\\\" />\\n            </div>\\n            <div class=\\\"col-1 help\\\">\\n                <span class=\\\"icon-help\\\" data-tooltip=\\\"~ .tooltip-content\\\" data-tooltip-theme=\\\"info\\\"></span>\\n                <div class=\\\"tooltip-content\\\">\\n                \"\n    + escapeExpression((helper = helpers.__ || (depth0 && depth0.__),options={hash:{},data:data},helper ? helper.call(depth0, \"The number of child elements to be selected.\", options) : helperMissing.call(depth0, \"__\", \"The number of child elements to be selected.\", options)))\n    + \"\\n                </div>\\n            </div>\\n        </div>\\n\\n<!-- assessmentTest/testPart/assessmentSection/selection/withReplacement -->\\n        <div class=\\\"grid-row pseudo-label-box\\\">\\n            <div class=\\\"col-5\\\">\\n                <label for=\\\"section-with-replacement\\\">\"\n    + escapeExpression((helper = helpers.__ || (depth0 && depth0.__),options={hash:{},data:data},helper ? helper.call(depth0, \"With Replacement\", options) : helperMissing.call(depth0, \"__\", \"With Replacement\", options)))\n    + \"</label>\\n            </div>\\n\\n            <div class=\\\"col-6\\\">\\n                <label>\\n                    <input type=\\\"checkbox\\\" name=\\\"section-with-replacement\\\" value=\\\"true\\\" data-bind=\\\"selection.withReplacement\\\"  data-bind-encoder=\\\"boolean\\\" />\\n                    <span class=\\\"icon-checkbox\\\"></span>\\n                </label>\\n            </div>\\n            <div class=\\\"col-1 help\\\">\\n                <span class=\\\"icon-help\\\" data-tooltip=\\\"~ .tooltip-content\\\" data-tooltip-theme=\\\"info\\\"></span>\\n                <div class=\\\"tooltip-content\\\">\\n                \"\n    + escapeExpression((helper = helpers.__ || (depth0 && depth0.__),options={hash:{},data:data},helper ? helper.call(depth0, \"When selecting child elements each element is normally eligible for selection once only.\", options) : helperMissing.call(depth0, \"__\", \"When selecting child elements each element is normally eligible for selection once only.\", options)))\n    + \"\\n                </div>\\n            </div>\\n        </div>\\n    </div>\\n\\n    <h4 class=\\\"toggler closed\\\" data-toggle=\\\"~ .section-ordering\\\">\"\n    + escapeExpression((helper = helpers.__ || (depth0 && depth0.__),options={hash:{},data:data},helper ? helper.call(depth0, \"Ordering\", options) : helperMissing.call(depth0, \"__\", \"Ordering\", options)))\n    + \"</h4>\\n\\n<!-- assessmentTest/testPart/assessmentSection/ordering -->\\n    <div class=\\\"section-ordering toggled\\\">\\n<!-- assessmentTest/testPart/assessmentSection/ordering/shuffle -->\\n        <div class=\\\"grid-row pseudo-label-box\\\">\\n            <div class=\\\"col-5\\\">\\n                <label for=\\\"section-shuffle\\\">\"\n    + escapeExpression((helper = helpers.__ || (depth0 && depth0.__),options={hash:{},data:data},helper ? helper.call(depth0, \"Shuffle\", options) : helperMissing.call(depth0, \"__\", \"Shuffle\", options)))\n    + \"</label>\\n            </div>\\n\\n            <div class=\\\"col-6\\\">\\n                <label>\\n                    <input type=\\\"checkbox\\\" name=\\\"section-shuffle\\\" value=\\\"true\\\" data-bind=\\\"ordering.shuffle\\\"  data-bind-encoder=\\\"boolean\\\"  />\\n                    <span class=\\\"icon-checkbox\\\"></span>\\n                </label>\\n            </div>\\n            <div class=\\\"col-1 help\\\">\\n                <span class=\\\"icon-help\\\" data-tooltip=\\\"~ .tooltip-content\\\" data-tooltip-theme=\\\"info\\\"></span>\\n                <div class=\\\"tooltip-content\\\">\\n                \"\n    + escapeExpression((helper = helpers.__ || (depth0 && depth0.__),options={hash:{},data:data},helper ? helper.call(depth0, \"If set, it causes the order of the child elements to be randomized, otherwise it uses the order in which the child elements are defined.\", options) : helperMissing.call(depth0, \"__\", \"If set, it causes the order of the child elements to be randomized, otherwise it uses the order in which the child elements are defined.\", options)))\n    + \"\\n                </div>\\n            </div>\\n        </div>\\n    </div>\\n\\n    <h4 class=\\\"toggler closed\\\" data-toggle=\\\"~ .section-item-session-control\\\">\"\n    + escapeExpression((helper = helpers.__ || (depth0 && depth0.__),options={hash:{},data:data},helper ? helper.call(depth0, \"Item Session Control\", options) : helperMissing.call(depth0, \"__\", \"Item Session Control\", options)))\n    + \"</h4>\\n\\n<!-- assessmentTest/testPart/assessmentSection/itemSessionControl -->\\n    <div class=\\\"section-item-session-control toggled\\\">\\n<!-- assessmentTest/testPart/assessmentSection/itemSessionControl/maxAttempts -->\\n        <div class=\\\"grid-row\\\">\\n            <div class=\\\"col-5\\\">\\n                <label for=\\\"section-max-attempts\\\">\"\n    + escapeExpression((helper = helpers.__ || (depth0 && depth0.__),options={hash:{},data:data},helper ? helper.call(depth0, \"Max Attempts\", options) : helperMissing.call(depth0, \"__\", \"Max Attempts\", options)))\n    + \"</label>\\n            </div>\\n            <div class=\\\"col-6\\\">\\n                <input name=\\\"section-max-attempts\\\" type=\\\"text\\\" data-increment=\\\"1\\\" data-min=\\\"0\\\" value=\\\"1\\\" data-bind=\\\"itemSessionControl.maxAttempts\\\" data-bind-encoder=\\\"number\\\" />\\n            </div>\\n            <div class=\\\"col-1 help\\\">\\n                <span class=\\\"icon-help\\\" data-tooltip=\\\"~ .tooltip-content\\\" data-tooltip-theme=\\\"info\\\"></span>\\n                <div class=\\\"tooltip-content\\\">\\n                \"\n    + escapeExpression((helper = helpers.__ || (depth0 && depth0.__),options={hash:{},data:data},helper ? helper.call(depth0, \"Controls the maximum number of attempts allowed. 0 means unlimited.\", options) : helperMissing.call(depth0, \"__\", \"Controls the maximum number of attempts allowed. 0 means unlimited.\", options)))\n    + \"\\n                </div>\\n            </div>\\n        </div>\\n\\n<!-- assessmentTest/testPart/assessmentSection/itemSessionControl/showFeedback -->\\n        <div class=\\\"grid-row pseudo-label-box\\\">\\n            <div class=\\\"col-5\\\">\\n                <label for=\\\"section-show-feedback\\\">\"\n    + escapeExpression((helper = helpers.__ || (depth0 && depth0.__),options={hash:{},data:data},helper ? helper.call(depth0, \"Show Feedback\", options) : helperMissing.call(depth0, \"__\", \"Show Feedback\", options)))\n    + \"</label>\\n            </div>\\n            <div class=\\\"col-6\\\">\\n                <label>\\n                    <input type=\\\"checkbox\\\" name=\\\"section-show-feedback\\\" value=\\\"true\\\" data-bind=\\\"itemSessionControl.showFeedback\\\" data-bind-encoder=\\\"boolean\\\" />\\n                    <span class=\\\"icon-checkbox\\\"></span>\\n                </label>\\n            </div>\\n            <div class=\\\"col-1 help\\\">\\n                <span class=\\\"icon-help\\\" data-tooltip=\\\"~ .tooltip-content\\\" data-tooltip-theme=\\\"info\\\"></span>\\n                <div class=\\\"tooltip-content\\\">\\n                \"\n    + escapeExpression((helper = helpers.__ || (depth0 && depth0.__),options={hash:{},data:data},helper ? helper.call(depth0, \"This constraint affects the visibility of feedback after the end of the last attempt.\", options) : helperMissing.call(depth0, \"__\", \"This constraint affects the visibility of feedback after the end of the last attempt.\", options)))\n    + \"\\n                </div>\\n            </div>\\n        </div>\\n\\n\\n\\n\\n\\n<!-- assessmentTest/testPart/assessmentSection/itemSessionControl/allowComment -->\\n        <div class=\\\"grid-row pseudo-label-box\\\">\\n            <div class=\\\"col-5\\\">\\n                <label for=\\\"section-allow-comment\\\">\"\n    + escapeExpression((helper = helpers.__ || (depth0 && depth0.__),options={hash:{},data:data},helper ? helper.call(depth0, \"Allow Comment\", options) : helperMissing.call(depth0, \"__\", \"Allow Comment\", options)))\n    + \"</label>\\n            </div>\\n            <div class=\\\"col-6\\\">\\n                <label>\\n                    <input type=\\\"checkbox\\\" name=\\\"section-allow-comment\\\" value=\\\"true\\\"  data-bind=\\\"itemSessionControl.allowComment\\\" data-bind-encoder=\\\"boolean\\\" />\\n                    <span class=\\\"icon-checkbox\\\"></span>\\n                </label>\\n            </div>\\n            <div class=\\\"col-1 help\\\">\\n                <span class=\\\"icon-help\\\" data-tooltip=\\\"~ .tooltip-content\\\" data-tooltip-theme=\\\"info\\\"></span>\\n                <div class=\\\"tooltip-content\\\">\\n                \"\n    + escapeExpression((helper = helpers.__ || (depth0 && depth0.__),options={hash:{},data:data},helper ? helper.call(depth0, \"This constraint controls whether or not the candidate is allowed to provide a comment on the item during the session. Comments are not part of the assessed responses.\", options) : helperMissing.call(depth0, \"__\", \"This constraint controls whether or not the candidate is allowed to provide a comment on the item during the session. Comments are not part of the assessed responses.\", options)))\n    + \"\\n                </div>\\n            </div>\\n        </div>\\n\\n<!-- assessmentTest/testPart/assessmentSection/itemSessionControl/allowSkipping -->\\n        <div class=\\\"grid-row pseudo-label-box\\\">\\n            <div class=\\\"col-5\\\">\\n                <label for=\\\"section-allow-skipping\\\">\"\n    + escapeExpression((helper = helpers.__ || (depth0 && depth0.__),options={hash:{},data:data},helper ? helper.call(depth0, \"Allow Skipping\", options) : helperMissing.call(depth0, \"__\", \"Allow Skipping\", options)))\n    + \"</label>\\n            </div>\\n            <div class=\\\"col-6\\\">\\n                <label>\\n                    <input type=\\\"checkbox\\\" name=\\\"section-allow-skipping\\\" value=\\\"true\\\" checked=\\\"checked\\\" data-bind=\\\"itemSessionControl.allowSkipping\\\" data-bind-encoder=\\\"boolean\\\" />\\n                    <span class=\\\"icon-checkbox\\\"></span>\\n                </label>\\n            </div>\\n            <div class=\\\"col-1 help\\\">\\n                <span class=\\\"icon-help\\\" data-tooltip=\\\"~ .tooltip-content\\\" data-tooltip-theme=\\\"info\\\"></span>\\n                <div class=\\\"tooltip-content\\\">\\n                \"\n    + escapeExpression((helper = helpers.__ || (depth0 && depth0.__),options={hash:{},data:data},helper ? helper.call(depth0, \"If the candidate can skip the item, without submitting a response.\", options) : helperMissing.call(depth0, \"__\", \"If the candidate can skip the item, without submitting a response.\", options)))\n    + \"\\n                </div>\\n            </div>\\n        </div>\\n\\n\\n    </div>\\n\\n    <h4 class=\\\"toggler closed\\\" data-toggle=\\\"~ .section-time-limits\\\">\"\n    + escapeExpression((helper = helpers.__ || (depth0 && depth0.__),options={hash:{},data:data},helper ? helper.call(depth0, \"Time Limits\", options) : helperMissing.call(depth0, \"__\", \"Time Limits\", options)))\n    + \"</h4>\\n\\n<!-- assessmentTest/timeLimits -->\\n    <div class=\\\"section-time-limits toggled\\\">\\n\\n\\n\\n\\n<!-- assessmentTest/testPart/assessmentSection/timeLimits/maxTime -->\\n        <div class=\\\"grid-row\\\">\\n            <div class=\\\"col-5\\\">\\n                <label for=\\\"section-max-time\\\">\"\n    + escapeExpression((helper = helpers.__ || (depth0 && depth0.__),options={hash:{},data:data},helper ? helper.call(depth0, \"Maximum Duration\", options) : helperMissing.call(depth0, \"__\", \"Maximum Duration\", options)))\n    + \"</label>\\n            </div>\\n            <div class=\\\"col-6\\\">\\n                <input type=\\\"text\\\" name=\\\"max-time\\\" value=\\\"00:00:00\\\" data-duration=\\\"HH:mm:ss\\\" data-bind=\\\"timeLimits.maxTime\\\" data-bind-encoder=\\\"time\\\" />\\n            </div>\\n            <div class=\\\"col-1 help\\\">\\n                <span class=\\\"icon-help\\\" data-tooltip=\\\"~ .tooltip-content\\\" data-tooltip-theme=\\\"info\\\"></span>\\n                <div class=\\\"tooltip-content\\\">\\n                \"\n    + escapeExpression((helper = helpers.__ || (depth0 && depth0.__),options={hash:{},data:data},helper ? helper.call(depth0, \"Maximum duration for this section.\", options) : helperMissing.call(depth0, \"__\", \"Maximum duration for this section.\", options)))\n    + \"\\n                </div>\\n            </div>\\n        </div>\\n\\n<!-- assessmentTest/testPart/assessmentSection/timeLimits/allowLateSubmission -->\\n        <div class=\\\"grid-row pseudo-label-box\\\">\\n            <div class=\\\"col-5\\\">\\n                <label for=\\\"section-allow-late-submission\\\">\"\n    + escapeExpression((helper = helpers.__ || (depth0 && depth0.__),options={hash:{},data:data},helper ? helper.call(depth0, \"Late submission allowed\", options) : helperMissing.call(depth0, \"__\", \"Late submission allowed\", options)))\n    + \"</label>\\n            </div>\\n            <div class=\\\"col-6\\\">\\n                <label>\\n                    <input type=\\\"checkbox\\\" name=\\\"section-allow-late-submission\\\" value=\\\"true\\\" data-bind=\\\"timeLimits.allowLateSubmission\\\" data-bind-encoder=\\\"boolean\\\" />\\n                    <span class=\\\"icon-checkbox\\\"></span>\\n                </label>\\n            </div>\\n            <div class=\\\"col-1 help\\\">\\n                <span class=\\\"icon-help\\\" data-tooltip=\\\"~ .tooltip-content\\\" data-tooltip-theme=\\\"info\\\"></span>\\n                <div class=\\\"tooltip-content\\\">\\n                \"\n    + escapeExpression((helper = helpers.__ || (depth0 && depth0.__),options={hash:{},data:data},helper ? helper.call(depth0, \"Whether a candidate's response that is beyond the maximum duration of the section should still be accepted.\", options) : helperMissing.call(depth0, \"__\", \"Whether a candidate's response that is beyond the maximum duration of the section should still be accepted.\", options)))\n    + \"\\n                </div>\\n            </div>\\n        </div>\\n    </div>\\n</div>\\n\";\n  return buffer;\n  });\n});\n\n","\ndefine('tpl!taoQtiTest/controller/creator/templates/itemref-props', ['handlebars'], function(hb){ \nreturn hb.template(function (Handlebars,depth0,helpers,partials,data) {\n  this.compilerInfo = [4,'>= 1.0.0'];\nhelpers = this.merge(helpers, Handlebars.helpers); data = data || {};\n  var buffer = \"\", stack1, helper, options, functionType=\"function\", escapeExpression=this.escapeExpression, helperMissing=helpers.helperMissing;\n\n\n  buffer += \"<div id=\\\"itemref-props-\";\n  if (helper = helpers.identifier) { stack1 = helper.call(depth0, {hash:{},data:data}); }\n  else { helper = (depth0 && depth0.identifier); stack1 = typeof helper === functionType ? helper.call(depth0, {hash:{},data:data}) : helper; }\n  buffer += escapeExpression(stack1)\n    + \"\\\" class=\\\"itemref-props props clearfix\\\">\\n\\n    <h3>\";\n  if (helper = helpers.label) { stack1 = helper.call(depth0, {hash:{},data:data}); }\n  else { helper = (depth0 && depth0.label); stack1 = typeof helper === functionType ? helper.call(depth0, {hash:{},data:data}) : helper; }\n  buffer += escapeExpression(stack1)\n    + \"</h3>\\n\\n<!-- assessmentTest/testPart/assessmentSection/sectionPart/identifier -->\\n    <div class=\\\"grid-row\\\">\\n        <div class=\\\"col-5\\\">\\n            <label for=\\\"itemref-identifier\\\">\"\n    + escapeExpression((helper = helpers.__ || (depth0 && depth0.__),options={hash:{},data:data},helper ? helper.call(depth0, \"Identifier\", options) : helperMissing.call(depth0, \"__\", \"Identifier\", options)))\n    + \" <abbr title=\\\"\"\n    + escapeExpression((helper = helpers.__ || (depth0 && depth0.__),options={hash:{},data:data},helper ? helper.call(depth0, \"Required field\", options) : helperMissing.call(depth0, \"__\", \"Required field\", options)))\n    + \"\\\">*</abbr></label>\\n        </div>\\n        <div class=\\\"col-6\\\">\\n            <input type=\\\"text\\\" name=\\\"itemref-identifier\\\" data-bind=\\\"identifier\\\" data-validate=\\\"$notEmpty; $testIdFormat; $testIdAvailable(original=\";\n  if (helper = helpers.identifier) { stack1 = helper.call(depth0, {hash:{},data:data}); }\n  else { helper = (depth0 && depth0.identifier); stack1 = typeof helper === functionType ? helper.call(depth0, {hash:{},data:data}) : helper; }\n  buffer += escapeExpression(stack1)\n    + \");\\\" />\\n        </div>\\n        <div class=\\\"col-1 help\\\">\\n            <span class=\\\"icon-help\\\" data-tooltip=\\\"~ .tooltip-content\\\" data-tooltip-theme=\\\"info\\\"></span>\\n            <div class=\\\"tooltip-content\\\">\\n            \"\n    + escapeExpression((helper = helpers.__ || (depth0 && depth0.__),options={hash:{},data:data},helper ? helper.call(depth0, \"The identifier of the item reference.\", options) : helperMissing.call(depth0, \"__\", \"The identifier of the item reference.\", options)))\n    + \"\\n            </div>\\n        </div>\\n    </div>\\n\\n<!-- assessmentTest/testPart/assessmentSection/sectionPart/href -->\\n    <div class=\\\"grid-row\\\">\\n        <div class=\\\"col-5\\\">\\n            <label for=\\\"itemref-href\\\">\"\n    + escapeExpression((helper = helpers.__ || (depth0 && depth0.__),options={hash:{},data:data},helper ? helper.call(depth0, \"Reference\", options) : helperMissing.call(depth0, \"__\", \"Reference\", options)))\n    + \" <abbr title=\\\"\"\n    + escapeExpression((helper = helpers.__ || (depth0 && depth0.__),options={hash:{},data:data},helper ? helper.call(depth0, \"Required field\", options) : helperMissing.call(depth0, \"__\", \"Required field\", options)))\n    + \"\\\">*</abbr></label>\\n        </div>\\n        <div class=\\\"col-6\\\">\\n            <input type=\\\"text\\\" name=\\\"itemref-href\\\" data-bind=\\\"href\\\" readonly=\\\"readonly\\\" />\\n        </div>\\n        <div class=\\\"col-1 help\\\">\\n            <span class=\\\"icon-help\\\" data-tooltip=\\\"~ .tooltip-content\\\" data-tooltip-theme=\\\"info\\\"></span>\\n            <div class=\\\"tooltip-content\\\">\\n            \"\n    + escapeExpression((helper = helpers.__ || (depth0 && depth0.__),options={hash:{},data:data},helper ? helper.call(depth0, \"The reference.\", options) : helperMissing.call(depth0, \"__\", \"The reference.\", options)))\n    + \"\\n            </div>\\n        </div>\\n    </div>\\n\\n<!-- assessmentTest/testPart/assessmentSection/sectionPart/category -->\\n    <div class=\\\"grid-row\\\">\\n        <div class=\\\"col-5\\\">\\n            <label for=\\\"itemref-category\\\">\"\n    + escapeExpression((helper = helpers.__ || (depth0 && depth0.__),options={hash:{},data:data},helper ? helper.call(depth0, \"Categories\", options) : helperMissing.call(depth0, \"__\", \"Categories\", options)))\n    + \"</label>\\n        </div>\\n        <div class=\\\"col-6\\\">\\n            <input type=\\\"text\\\" name=\\\"itemref-category\\\" data-bind=\\\"categories\\\" data-bind-encoder=\\\"str2array\\\" />\\n        </div>\\n        <div class=\\\"col-1 help\\\">\\n            <span class=\\\"icon-help\\\" data-tooltip=\\\"~ .tooltip-content\\\" data-tooltip-theme=\\\"info\\\"></span>\\n            <div class=\\\"tooltip-content\\\">\\n            \"\n    + escapeExpression((helper = helpers.__ || (depth0 && depth0.__),options={hash:{},data:data},helper ? helper.call(depth0, \"Items can optionally be assigned to one or more categories.\", options) : helperMissing.call(depth0, \"__\", \"Items can optionally be assigned to one or more categories.\", options)))\n    + \"\\n            </div>\\n        </div>\\n    </div>\\n\\n<!-- assessmentTest/testPart/assessmentSection/sectionPart/required -->\\n    <div class=\\\"grid-row pseudo-label-box\\\">\\n        <div class=\\\"col-5\\\">\\n            <label for=\\\"itemref-required\\\">\"\n    + escapeExpression((helper = helpers.__ || (depth0 && depth0.__),options={hash:{},data:data},helper ? helper.call(depth0, \"Required\", options) : helperMissing.call(depth0, \"__\", \"Required\", options)))\n    + \"</label>\\n        </div>\\n        <div class=\\\"col-6\\\">\\n            <label>\\n                <input type=\\\"checkbox\\\" name=\\\"itemref-required\\\" value=\\\"true\\\" data-bind=\\\"required\\\" data-bind-encoder=\\\"boolean\\\" />\\n                <span class=\\\"icon-checkbox\\\"></span>\\n            </label>\\n        </div>\\n        <div class=\\\"col-1 help\\\">\\n            <span class=\\\"icon-help\\\" data-tooltip=\\\"~ .tooltip-content\\\" data-tooltip-theme=\\\"info\\\"></span>\\n            <div class=\\\"tooltip-content\\\">\\n            \"\n    + escapeExpression((helper = helpers.__ || (depth0 && depth0.__),options={hash:{},data:data},helper ? helper.call(depth0, \"If required it must appear (at least once) in the selection.\", options) : helperMissing.call(depth0, \"__\", \"If required it must appear (at least once) in the selection.\", options)))\n    + \"\\n            </div>\\n        </div>\\n    </div>\\n\\n<!-- assessmentTest/testPart/assessmentSection/sectionPart/fixed -->\\n    <div class=\\\"grid-row pseudo-label-box\\\">\\n        <div class=\\\"col-5\\\">\\n            <label for=\\\"itemref-fixed\\\">\"\n    + escapeExpression((helper = helpers.__ || (depth0 && depth0.__),options={hash:{},data:data},helper ? helper.call(depth0, \"Fixed\", options) : helperMissing.call(depth0, \"__\", \"Fixed\", options)))\n    + \"</label>\\n        </div>\\n        <div class=\\\"col-6\\\">\\n            <label>\\n                <input type=\\\"checkbox\\\" name=\\\"itemref-fixed\\\" value=\\\"true\\\" data-bind=\\\"fixed\\\" data-bind-encoder=\\\"boolean\\\" />\\n                <span class=\\\"icon-checkbox\\\"></span>\\n            </label>\\n        </div>\\n        <div class=\\\"col-1 help\\\">\\n            <span class=\\\"icon-help\\\" data-tooltip=\\\"~ .tooltip-content\\\" data-tooltip-theme=\\\"info\\\"></span>\\n            <div class=\\\"tooltip-content\\\">\\n            \"\n    + escapeExpression((helper = helpers.__ || (depth0 && depth0.__),options={hash:{},data:data},helper ? helper.call(depth0, \"Not shuffled, the position remains fixed.\", options) : helperMissing.call(depth0, \"__\", \"Not shuffled, the position remains fixed.\", options)))\n    + \"\\n            </div>\\n        </div>\\n    </div>\\n\\n    <h4 class=\\\"toggler closed\\\" data-toggle=\\\"~ .itemref-weights\\\">\"\n    + escapeExpression((helper = helpers.__ || (depth0 && depth0.__),options={hash:{},data:data},helper ? helper.call(depth0, \"Weights\", options) : helperMissing.call(depth0, \"__\", \"Weights\", options)))\n    + \"</h4>\\n\\n    <div class=\\\"itemref-weights toggled\\\">\\n        <div class=\\\"grid-row \\\">\\n            <div class=\\\"col-9\\\">\\n                <strong>\"\n    + escapeExpression((helper = helpers.__ || (depth0 && depth0.__),options={hash:{},data:data},helper ? helper.call(depth0, \"Identifier\", options) : helperMissing.call(depth0, \"__\", \"Identifier\", options)))\n    + \"</strong>\\n            </div>\\n            <div class=\\\"col-2\\\">\\n                <strong>\"\n    + escapeExpression((helper = helpers.__ || (depth0 && depth0.__),options={hash:{},data:data},helper ? helper.call(depth0, \"Value\", options) : helperMissing.call(depth0, \"__\", \"Value\", options)))\n    + \"</strong>\\n            </div>\\n            <div class=\\\"col-1 help\\\">\\n                <span class=\\\"icon-help\\\" data-tooltip=\\\"~ .tooltip-content\\\" data-tooltip-theme=\\\"info\\\"></span>\\n                <div class=\\\"tooltip-content\\\">\\n                    \"\n    + escapeExpression((helper = helpers.__ || (depth0 && depth0.__),options={hash:{},data:data},helper ? helper.call(depth0, \"Controls the contribution of an individual item score to the overall test score.\", options) : helperMissing.call(depth0, \"__\", \"Controls the contribution of an individual item score to the overall test score.\", options)))\n    + \"\\n                </div>\\n            </div>\\n        </div>\\n<!-- assessmentTest/testPart/assessmentSection/sectionPart/weights -->\\n        <div data-bind-each=\\\"weights\\\" data-bind-tmpl=\\\"itemrefweight\\\"></div>\\n        <div class=\\\"grid-row\\\">\\n            <div class=\\\"col-12\\\">\\n                <a class=\\\"itemref-weight-add\\\"><span class=\\\"icon-add\\\"></span> \"\n    + escapeExpression((helper = helpers.__ || (depth0 && depth0.__),options={hash:{},data:data},helper ? helper.call(depth0, \"add a new weight\", options) : helperMissing.call(depth0, \"__\", \"add a new weight\", options)))\n    + \"</a>\\n            </div>\\n        </div>\\n    </div>\\n\\n\\n    <h4 class=\\\"toggler closed\\\" data-toggle=\\\"~ .itemref-item-session-control\\\">\"\n    + escapeExpression((helper = helpers.__ || (depth0 && depth0.__),options={hash:{},data:data},helper ? helper.call(depth0, \"Item Session Control\", options) : helperMissing.call(depth0, \"__\", \"Item Session Control\", options)))\n    + \"</h4>\\n\\n<!-- assessmentTest/testPart/assessmentSection/sectionPart/itemSessionControl -->\\n    <div class=\\\"itemref-item-session-control toggled\\\">\\n<!-- assessmentTest/testPart/assessmentSection/sectionPart/itemSessionControl/maxAttempts -->\\n        <div class=\\\"grid-row\\\">\\n            <div class=\\\"col-5\\\">\\n                <label for=\\\"itemref-max-attempts\\\">\"\n    + escapeExpression((helper = helpers.__ || (depth0 && depth0.__),options={hash:{},data:data},helper ? helper.call(depth0, \"Max Attempts\", options) : helperMissing.call(depth0, \"__\", \"Max Attempts\", options)))\n    + \"</label>\\n            </div>\\n            <div class=\\\"col-6\\\">\\n                <input name=\\\"itemref-max-attempts\\\" type=\\\"text\\\" data-increment=\\\"1\\\" data-min=\\\"0\\\" value=\\\"1\\\" data-bind=\\\"itemSessionControl.maxAttempts\\\" data-bind-encoder=\\\"number\\\" />\\n            </div>\\n            <div class=\\\"col-1 help\\\">\\n                <span class=\\\"icon-help\\\" data-tooltip=\\\"~ .tooltip-content\\\" data-tooltip-theme=\\\"info\\\"></span>\\n                <div class=\\\"tooltip-content\\\">\\n                \"\n    + escapeExpression((helper = helpers.__ || (depth0 && depth0.__),options={hash:{},data:data},helper ? helper.call(depth0, \"Controls the maximum number of attempts allowed. 0 means unlimited.\", options) : helperMissing.call(depth0, \"__\", \"Controls the maximum number of attempts allowed. 0 means unlimited.\", options)))\n    + \"\\n                </div>\\n            </div>\\n        </div>\\n\\n<!-- assessmentTest/testPart/assessmentSection/sectionPart/itemSessionControl/showFeedback -->\\n        <div class=\\\"grid-row pseudo-label-box\\\">\\n            <div class=\\\"col-5\\\">\\n                <label for=\\\"itemref-show-feedback\\\">\"\n    + escapeExpression((helper = helpers.__ || (depth0 && depth0.__),options={hash:{},data:data},helper ? helper.call(depth0, \"Show Feedback\", options) : helperMissing.call(depth0, \"__\", \"Show Feedback\", options)))\n    + \"</label>\\n            </div>\\n            <div class=\\\"col-6\\\">\\n                <label>\\n                    <input type=\\\"checkbox\\\" name=\\\"itemref-show-feedback\\\" value=\\\"true\\\" data-bind=\\\"itemSessionControl.showFeedback\\\" data-bind-encoder=\\\"boolean\\\" />\\n                    <span class=\\\"icon-checkbox\\\"></span>\\n                </label>\\n            </div>\\n            <div class=\\\"col-1 help\\\">\\n                <span class=\\\"icon-help\\\" data-tooltip=\\\"~ .tooltip-content\\\" data-tooltip-theme=\\\"info\\\"></span>\\n                <div class=\\\"tooltip-content\\\">\\n                \"\n    + escapeExpression((helper = helpers.__ || (depth0 && depth0.__),options={hash:{},data:data},helper ? helper.call(depth0, \"This constraint affects the visibility of feedback after the end of the last attempt.\", options) : helperMissing.call(depth0, \"__\", \"This constraint affects the visibility of feedback after the end of the last attempt.\", options)))\n    + \"\\n                </div>\\n            </div>\\n        </div>\\n\\n\\n\\n\\n\\n<!-- assessmentTest/testPart/assessmentSection/sectionPart/itemSessionControl/allowComment -->\\n        <div class=\\\"grid-row pseudo-label-box\\\">\\n            <div class=\\\"col-5\\\">\\n                <label for=\\\"itemref-allow-comment\\\">\"\n    + escapeExpression((helper = helpers.__ || (depth0 && depth0.__),options={hash:{},data:data},helper ? helper.call(depth0, \"Allow Comment\", options) : helperMissing.call(depth0, \"__\", \"Allow Comment\", options)))\n    + \"</label>\\n            </div>\\n            <div class=\\\"col-6\\\">\\n                <label>\\n                    <input type=\\\"checkbox\\\" name=\\\"itemref-allow-comment\\\" value=\\\"true\\\"  data-bind=\\\"itemSessionControl.allowComment\\\" data-bind-encoder=\\\"boolean\\\" />\\n                    <span class=\\\"icon-checkbox\\\"></span>\\n                </label>\\n            </div>\\n            <div class=\\\"col-1 help\\\">\\n                <span class=\\\"icon-help\\\" data-tooltip=\\\"~ .tooltip-content\\\" data-tooltip-theme=\\\"info\\\"></span>\\n                <div class=\\\"tooltip-content\\\">\\n                \"\n    + escapeExpression((helper = helpers.__ || (depth0 && depth0.__),options={hash:{},data:data},helper ? helper.call(depth0, \"This constraint controls whether or not the candidate is allowed to provide a comment on the item during the session. Comments are not part of the assessed responses.\", options) : helperMissing.call(depth0, \"__\", \"This constraint controls whether or not the candidate is allowed to provide a comment on the item during the session. Comments are not part of the assessed responses.\", options)))\n    + \"\\n                </div>\\n            </div>\\n        </div>\\n\\n<!-- assessmentTest/testPart/assessmentSection/sectionPart/itemSessionControl/allowSkipping -->\\n        <div class=\\\"grid-row pseudo-label-box\\\">\\n            <div class=\\\"col-5\\\">\\n                <label for=\\\"itemref-allow-skipping\\\">\"\n    + escapeExpression((helper = helpers.__ || (depth0 && depth0.__),options={hash:{},data:data},helper ? helper.call(depth0, \"Allow Skipping\", options) : helperMissing.call(depth0, \"__\", \"Allow Skipping\", options)))\n    + \"</label>\\n            </div>\\n            <div class=\\\"col-6\\\">\\n                <label>\\n                    <input type=\\\"checkbox\\\" name=\\\"itemref-allow-skipping\\\" value=\\\"true\\\" checked=\\\"checked\\\" data-bind=\\\"itemSessionControl.allowSkipping\\\" data-bind-encoder=\\\"boolean\\\" />\\n                    <span class=\\\"icon-checkbox\\\"></span>\\n                </label>\\n            </div>\\n            <div class=\\\"col-1 help\\\">\\n                <span class=\\\"icon-help\\\" data-tooltip=\\\"~ .tooltip-content\\\" data-tooltip-theme=\\\"info\\\"></span>\\n                <div class=\\\"tooltip-content\\\">\\n                \"\n    + escapeExpression((helper = helpers.__ || (depth0 && depth0.__),options={hash:{},data:data},helper ? helper.call(depth0, \"If the candidate can skip the item, without submitting a response.\", options) : helperMissing.call(depth0, \"__\", \"If the candidate can skip the item, without submitting a response.\", options)))\n    + \"\\n                </div>\\n            </div>\\n        </div>\\n\\n\\n    </div>\\n\\n    <h4 class=\\\"toggler closed\\\" data-toggle=\\\"~ .itemref-time-limits\\\">\"\n    + escapeExpression((helper = helpers.__ || (depth0 && depth0.__),options={hash:{},data:data},helper ? helper.call(depth0, \"Time Limits\", options) : helperMissing.call(depth0, \"__\", \"Time Limits\", options)))\n    + \"</h4>\\n\\n<!-- assessmentTest/timeLimits -->\\n    <div class=\\\"itemref-time-limits toggled\\\">\\n\\n\\n\\n\\n<!-- assessmentTest/testPart/assessmentSection/sectionPart/timeLimits/maxTime -->\\n        <div class=\\\"grid-row\\\">\\n            <div class=\\\"col-5\\\">\\n                <label for=\\\"itemref-max-time\\\">\"\n    + escapeExpression((helper = helpers.__ || (depth0 && depth0.__),options={hash:{},data:data},helper ? helper.call(depth0, \"Maximum Duration\", options) : helperMissing.call(depth0, \"__\", \"Maximum Duration\", options)))\n    + \"</label>\\n            </div>\\n            <div class=\\\"col-6\\\">\\n                <input type=\\\"text\\\" name=\\\"max-time\\\" value=\\\"00:00:00\\\" data-duration=\\\"HH:mm:ss\\\" data-bind=\\\"timeLimits.maxTime\\\" data-bind-encoder=\\\"time\\\" />\\n            </div>\\n            <div class=\\\"col-1 help\\\">\\n                <span class=\\\"icon-help\\\" data-tooltip=\\\"~ .tooltip-content\\\" data-tooltip-theme=\\\"info\\\"></span>\\n                <div class=\\\"tooltip-content\\\">\\n                \"\n    + escapeExpression((helper = helpers.__ || (depth0 && depth0.__),options={hash:{},data:data},helper ? helper.call(depth0, \"Maximum duration for this item.\", options) : helperMissing.call(depth0, \"__\", \"Maximum duration for this item.\", options)))\n    + \"\\n                </div>\\n            </div>\\n        </div>\\n\\n<!-- assessmentTest/testPart/assessmentSection/sectionPart/timeLimits/allowLateSubmission -->\\n        <div class=\\\"grid-row pseudo-label-box\\\">\\n            <div class=\\\"col-5\\\">\\n                <label for=\\\"itemref-allow-late-submission\\\">\"\n    + escapeExpression((helper = helpers.__ || (depth0 && depth0.__),options={hash:{},data:data},helper ? helper.call(depth0, \"Late submission allowed\", options) : helperMissing.call(depth0, \"__\", \"Late submission allowed\", options)))\n    + \"</label>\\n            </div>\\n            <div class=\\\"col-6\\\">\\n                <label>\\n                    <input type=\\\"checkbox\\\" name=\\\"itemref-allow-late-submission\\\" value=\\\"true\\\" data-bind=\\\"timeLimits.allowLateSubmission\\\" data-bind-encoder=\\\"boolean\\\" />\\n                    <span class=\\\"icon-checkbox\\\"></span>\\n                </label>\\n            </div>\\n            <div class=\\\"col-1 help\\\">\\n                <span class=\\\"icon-help\\\" data-tooltip=\\\"~ .tooltip-content\\\" data-tooltip-theme=\\\"info\\\"></span>\\n                <div class=\\\"tooltip-content\\\">\\n                \"\n    + escapeExpression((helper = helpers.__ || (depth0 && depth0.__),options={hash:{},data:data},helper ? helper.call(depth0, \"Whether a candidate's response that is beyond the maximum duration of the item should still be accepted.\", options) : helperMissing.call(depth0, \"__\", \"Whether a candidate's response that is beyond the maximum duration of the item should still be accepted.\", options)))\n    + \"\\n                </div>\\n            </div>\\n        </div>\\n    </div>\\n</div>\\n\";\n  return buffer;\n  });\n});\n\n","\ndefine('tpl!taoQtiTest/controller/creator/templates/itemref-props-weight', ['handlebars'], function(hb){ \nreturn hb.template(function (Handlebars,depth0,helpers,partials,data) {\n  this.compilerInfo = [4,'>= 1.0.0'];\nhelpers = this.merge(helpers, Handlebars.helpers); data = data || {};\n  var buffer = \"\", stack1, helper, functionType=\"function\", escapeExpression=this.escapeExpression;\n\n\n  buffer += \"<div class=\\\"grid-row itemref-weight\\\">\\n    <div class=\\\"col-9\\\">\\n        <input data-bind=\\\"identifier\\\" data-validate=\\\"$notEmpty; $testIdFormat; $testIdAvailable(original=\";\n  if (helper = helpers.identifier) { stack1 = helper.call(depth0, {hash:{},data:data}); }\n  else { helper = (depth0 && depth0.identifier); stack1 = typeof helper === functionType ? helper.call(depth0, {hash:{},data:data}) : helper; }\n  buffer += escapeExpression(stack1)\n    + \");\\\" type=\\\"text\\\" value=\\\"\";\n  if (helper = helpers.identifier) { stack1 = helper.call(depth0, {hash:{},data:data}); }\n  else { helper = (depth0 && depth0.identifier); stack1 = typeof helper === functionType ? helper.call(depth0, {hash:{},data:data}) : helper; }\n  buffer += escapeExpression(stack1)\n    + \"\\\" />\\n    </div>\\n    <div class=\\\"col-2\\\">\\n        <input data-bind=\\\"value\\\" data-validate=\\\"$notEmpty; $numeric;\\\" type=\\\"text\\\" value=\\\"\";\n  if (helper = helpers.value) { stack1 = helper.call(depth0, {hash:{},data:data}); }\n  else { helper = (depth0 && depth0.value); stack1 = typeof helper === functionType ? helper.call(depth0, {hash:{},data:data}) : helper; }\n  buffer += escapeExpression(stack1)\n    + \"\\\" data-bind-encoder=\\\"float\\\" />\\n    </div>\\n    <div class=\\\"col-1\\\">\\n        <a class=\\\"itemref-weight-remove\\\" data-delete=\\\":parent .itemref-weight\\\">\\n            <span class=\\\"icon-bin\\\"></span>\\n        </a>\\n    </div>\\n</div>\";\n  return buffer;\n  });\n});\n\n","\ndefine('tpl!taoQtiTest/controller/creator/templates/rubricblock-props', ['handlebars'], function(hb){ \nreturn hb.template(function (Handlebars,depth0,helpers,partials,data) {\n  this.compilerInfo = [4,'>= 1.0.0'];\nhelpers = this.merge(helpers, Handlebars.helpers); data = data || {};\n  var buffer = \"\", stack1, helper, options, helperMissing=helpers.helperMissing, escapeExpression=this.escapeExpression, functionType=\"function\";\n\n\n  buffer += \"<div class=\\\"rubricblock-props props clearfix\\\">\\n\\n    <h3>\"\n    + escapeExpression((helper = helpers.__ || (depth0 && depth0.__),options={hash:{},data:data},helper ? helper.call(depth0, \"Rubric Block\", options) : helperMissing.call(depth0, \"__\", \"Rubric Block\", options)))\n    + \": \";\n  if (helper = helpers.index) { stack1 = helper.call(depth0, {hash:{},data:data}); }\n  else { helper = (depth0 && depth0.index); stack1 = typeof helper === functionType ? helper.call(depth0, {hash:{},data:data}) : helper; }\n  buffer += escapeExpression(stack1)\n    + \"</h3>\\n\\n <!--assessmentTest/testPart/assessmentSection/sectionPart/rubrickBlocK/views -->\\n    <div class=\\\"grid-row\\\">\\n        <div class=\\\"col-5\\\">\\n            <label for=\\\"itemref-identifier\\\">\"\n    + escapeExpression((helper = helpers.__ || (depth0 && depth0.__),options={hash:{},data:data},helper ? helper.call(depth0, \"Views\", options) : helperMissing.call(depth0, \"__\", \"Views\", options)))\n    + \" <abbr title=\\\"\"\n    + escapeExpression((helper = helpers.__ || (depth0 && depth0.__),options={hash:{},data:data},helper ? helper.call(depth0, \"Required field\", options) : helperMissing.call(depth0, \"__\", \"Required field\", options)))\n    + \"\\\">*</abbr></label>\\n        </div>\\n        <div class=\\\"col-6\\\">\\n            <select name=\\\"view\\\" multiple=\\\"multiple\\\" data-bind=\\\"views\\\">\\n                <option value=\\\"author\\\">\"\n    + escapeExpression((helper = helpers.__ || (depth0 && depth0.__),options={hash:{},data:data},helper ? helper.call(depth0, \"Author\", options) : helperMissing.call(depth0, \"__\", \"Author\", options)))\n    + \"</option>\\n                <option value=\\\"candidate\\\">\"\n    + escapeExpression((helper = helpers.__ || (depth0 && depth0.__),options={hash:{},data:data},helper ? helper.call(depth0, \"Candidate\", options) : helperMissing.call(depth0, \"__\", \"Candidate\", options)))\n    + \"</option>\\n                <option value=\\\"proctor\\\">\"\n    + escapeExpression((helper = helpers.__ || (depth0 && depth0.__),options={hash:{},data:data},helper ? helper.call(depth0, \"Proctor\", options) : helperMissing.call(depth0, \"__\", \"Proctor\", options)))\n    + \"</option>\\n                <option value=\\\"scorer\\\">\"\n    + escapeExpression((helper = helpers.__ || (depth0 && depth0.__),options={hash:{},data:data},helper ? helper.call(depth0, \"Scorer\", options) : helperMissing.call(depth0, \"__\", \"Scorer\", options)))\n    + \"</option>\\n                <option value=\\\"testConstructor\\\">\"\n    + escapeExpression((helper = helpers.__ || (depth0 && depth0.__),options={hash:{},data:data},helper ? helper.call(depth0, \"Test constructor\", options) : helperMissing.call(depth0, \"__\", \"Test constructor\", options)))\n    + \"</option>\\n                <option value=\\\"tutor\\\">\"\n    + escapeExpression((helper = helpers.__ || (depth0 && depth0.__),options={hash:{},data:data},helper ? helper.call(depth0, \"Tutor\", options) : helperMissing.call(depth0, \"__\", \"Tutor\", options)))\n    + \"</option>\\n            </select>\\n        </div>\\n        <div class=\\\"col-1 help\\\">\\n            <span class=\\\"icon-help\\\" data-tooltip=\\\"~ .tooltip-content\\\" data-tooltip-theme=\\\"info\\\"></span> \\n            <div class=\\\"tooltip-content\\\">\\n            \"\n    + escapeExpression((helper = helpers.__ || (depth0 && depth0.__),options={hash:{},data:data},helper ? helper.call(depth0, \"Who can view the rubric block during the delivery.\", options) : helperMissing.call(depth0, \"__\", \"Who can view the rubric block during the delivery.\", options)))\n    + \"\\n            </div>\\n        </div>\\n    </div>\\n\\n</div>\\n\";\n  return buffer;\n  });\n});\n\n","define('taoQtiTest/controller/creator/templates/index',[\n    'tpl!taoQtiTest/controller/creator/templates/testpart',\n    'tpl!taoQtiTest/controller/creator/templates/section',\n    'tpl!taoQtiTest/controller/creator/templates/rubricblock',\n    'tpl!taoQtiTest/controller/creator/templates/itemref',\n    'tpl!taoQtiTest/controller/creator/templates/item',\n    'tpl!taoQtiTest/controller/creator/templates/test-props',\n    'tpl!taoQtiTest/controller/creator/templates/testpart-props',\n    'tpl!taoQtiTest/controller/creator/templates/section-props',\n    'tpl!taoQtiTest/controller/creator/templates/itemref-props',\n    'tpl!taoQtiTest/controller/creator/templates/itemref-props-weight',\n    'tpl!taoQtiTest/controller/creator/templates/rubricblock-props'\n],\nfunction(\n    testPart,\n    section,\n    rubricBlock,\n    itemRef,\n    item,\n    testProps,\n    testPartProps,\n    sectionProps,\n    itemRefProps,\n    itemRefPropsWeight,\n    rubricBlockProps\n){\n    'use strict';\n\n    /**\n     * Expose all the templates used by the test creator\n     * @exports taoQtiTest/controller/creator/templates/index\n     */\n    return {\n        'testpart'      : testPart,\n        'section'       : section,\n        'itemref'       : itemRef,\n        'item'          : item,\n        'rubricblock'   : rubricBlock,\n        'properties'    : {\n            'test'      : testProps,\n            'testpart'  : testPartProps,\n            'section'   : sectionProps,\n            'itemref'   : itemRefProps,\n            'itemrefweight': itemRefPropsWeight,\n            'rubricblock'   : rubricBlockProps\n        }\n    };\n});\n\n","/**\n * This program is free software; you can redistribute it and/or\n * modify it under the terms of the GNU General Public License\n * as published by the Free Software Foundation; under version 2\n * of the License (non-upgradable).\n *\n * This program is distributed in the hope that it will be useful,\n * but WITHOUT ANY WARRANTY; without even the implied warranty of\n * MERCHANTABILITY or FITNESS FOR A PARTICULAR PURPOSE.  See the\n * GNU General Public License for more details.\n *\n * You should have received a copy of the GNU General Public License\n * along with this program; if not, write to the Free Software\n * Foundation, Inc., 51 Franklin Street, Fifth Floor, Boston, MA  02110-1301, USA.\n *\n * Copyright (c) 2014 (original work) Open Assessment Technologies SA (under the project TAO-PRODUCT);\n */\n\n/**\n * @author Bertrand Chevrier <bertrand@taotesting.com>\n */\ndefine('taoQtiTest/controller/creator/views/item',[\n    'jquery',\n    'lodash',\n    'taoQtiTest/controller/creator/templates/index'\n], function($, _, templates){\n    'use strict';\n\n    var itemTemplate = templates.item;\n\n\n\n   /**\n     * The ItemView setup items related components\n     * @exports taoQtiTest/controller/creator/views/item\n     * @param {Function} loadItems - the function used to get items from the server\n     * @param {Function} getCategories - the function used to get items' categories\n     */\n    var itemView =  function(loadItems, getCategories){\n\n        var $panel     = $('.test-creator-items .item-selection');\n        var $search    = $('#item-filter');\n        var $itemBox   = $('.item-box', $panel);\n\n        var getItems = function getItems(pattern){\n            return loadItems(pattern).then(function(items){\n                if(!items || !items.length){\n                    return update();\n                }\n                return getCategories(_.pluck(items, 'uri')).then(function(categories){\n                    update(_.map(items, function(item){\n                        item.categories = _.isArray(categories[item.uri]) ? categories[item.uri] : [];\n                        return item;\n                    }));\n                });\n            });\n        };\n\n        getItems().then(setUpLiveSearch);\n\n        /**\n         * Set up the search behavior: once 3 chars are enters into the field,\n         * we load the items that matches the given search pattern.\n         * @private\n         */\n        function setUpLiveSearch (){\n            var timeout;\n\n            var liveSearch = function(){\n                var pattern = $search.val();\n                if(pattern.length > 1 || pattern.length === 0){\n                    clearTimeout(timeout);\n                    timeout = setTimeout(function(){\n                        getItems(pattern);\n                    }, 300);\n                }\n            };\n\n            //trigger the search on keyp and on the magnifer button click\n            $search.keyup(liveSearch)\n                     .siblings('.ctrl').click(liveSearch);\n        }\n\n        /**\n         * Update the items list\n         * @private\n         * @param {Array} items - the new items\n         */\n        function update (items){\n            disableSelection();\n            $itemBox.empty().append(itemTemplate(items));\n            enableSelection();\n        }\n\n        /**\n         * Disable the selectable component\n         * @private\n         * @param {Array} items - the new items\n         */\n        function disableSelection (){\n            if($panel.data('selectable')){\n                $panel.selectable('disable');\n            }\n        }\n\n        /**\n         * Enable to select items to be added to sections\n         * using the jquery-ui selectable.\n         * @private\n         */\n        function enableSelection (){\n\n            if($panel.data('selectable')){\n                $panel.selectable('enable');\n            } else {\n                $panel.selectable({\n                    filter: 'li',\n                    selected: function( event, ui ) {\n                        $(ui.selected).addClass('selected');\n                    },\n                    unselected: function( event, ui ) {\n                        $(ui.unselected).removeClass('selected');\n                    },\n                    stop: function(){\n                        $(this).trigger('itemselect.creator', $('.selected'));\n                    }\n                });\n            }\n        }\n    };\n\n    return itemView;\n});\n\n","/**\n * This program is free software; you can redistribute it and/or\n * modify it under the terms of the GNU General Public License\n * as published by the Free Software Foundation; under version 2\n * of the License (non-upgradable).\n *\n * This program is distributed in the hope that it will be useful,\n * but WITHOUT ANY WARRANTY; without even the implied warranty of\n * MERCHANTABILITY or FITNESS FOR A PARTICULAR PURPOSE.  See the\n * GNU General Public License for more details.\n *\n * You should have received a copy of the GNU General Public License\n * along with this program; if not, write to the Free Software\n * Foundation, Inc., 51 Franklin Street, Fifth Floor, Boston, MA  02110-1301, USA.\n *\n * Copyright (c) 2014 (original work) Open Assessment Technologies SA (under the project TAO-PRODUCT);\n */\n\n/**\n * @author Bertrand Chevrier <bertrand@taotesting.com>\n */\ndefine('taoQtiTest/controller/creator/views/property',[\n    'jquery',\n    'ui',\n    'core/databinder',\n    'taoQtiTest/controller/creator/templates/index'\n],\nfunction($, ui, DataBinder, templates){\n    'use strict';\n\n    /**\n     * @callback PropertyViewCallback\n     * @param {propertyView} propertyView - the view object\n     */\n\n    /**\n     * The PropertyView setup the property panel component\n     *\n     * @exports taoQtiTest/controller/creator/views/property\n     */\n    var propView = function propView(tmplName, model){\n        var $container = $('.test-creator-props');\n        var template = templates.properties[tmplName];\n        var $view;\n\n        /**\n         * Opens the view for the 1st time\n         */\n        var open = function propOpen(){\n            var databinder,\n                binderOptions = {\n                    templates: templates.properties\n                };\n            $container.children('.props').hide().trigger('propclose.propview');\n            $view = $(template(model)).appendTo($container).filter('.props');\n\n            //start listening for DOM compoenents inside the view\n            ui.startDomComponent($view);\n\n            //start the data binding\n            databinder = new DataBinder($view, model, binderOptions);\n            databinder.bind();\n\n            propValidation();\n\n            $view.trigger('propopen.propview');\n        };\n\n       /**\n        * Get the view container element\n        * @returns {jQueryElement}\n        */\n        var getView = function propGetView(){\n            return $view;\n        };\n\n       /**\n        * Check wheter the view is displayed\n        * @returns {boolean} true id opened\n        */\n        var isOpen = function propIsOpen(){\n            return $view.css('display') !== 'none';\n        };\n\n       /**\n        * Bind a callback on view open\n        * @param {PropertyViewCallback} cb\n        */\n        var onOpen = function propOnOpen(cb){\n            $view.on('propopen.propview', function(e){\n                e.stopPropagation();\n                cb();\n            });\n        };\n\n\n        /**\n         * Bind a callback on view close\n         * @param {PropertyViewCallback} cb\n         */\n        var onClose = function propOnClose(cb){\n            $view.on('propclose.propview', function(e){\n                e.stopPropagation();\n                cb();\n            });\n        };\n\n        /**\n         * Removes the property view\n         */\n        var destroy = function propDestroy(){\n            $view.remove();\n        };\n\n        /**\n         * Toggles the property view display\n         */\n        var toggle = function propToggle(){\n            $container.children('.props').not($view).hide().trigger('propclose.propview');\n            if(isOpen()){\n                $view.hide().trigger('propclose.propview');\n            } else {\n                $view.show().trigger('propopen.propview');\n            }\n        };\n\n       /**\n        * Set up the validation on the property view\n        * @private\n        */\n        function propValidation() {\n            $view.on('validated.group', function(e, isValid){\n                if(e.namespace === 'group'){\n                    var $togglers = $('#test-creator .property-toggler, #saver');\n                    if(isValid === true){\n                        $togglers.removeClass('disabled');\n                    } else {\n                        $togglers.addClass('disabled');\n                    }\n                }\n            });\n            $view.groupValidator();\n         }\n\n        return {\n            open : open,\n            getView : getView,\n            isOpen : isOpen,\n            onOpen : onOpen,\n            onClose : onClose,\n            destroy : destroy,\n            toggle : toggle\n        };\n    };\n\n   return propView;\n});\n\n","/**\n * This program is free software; you can redistribute it and/or\n * modify it under the terms of the GNU General Public License\n * as published by the Free Software Foundation; under version 2\n * of the License (non-upgradable).\n *\n * This program is distributed in the hope that it will be useful,\n * but WITHOUT ANY WARRANTY; without even the implied warranty of\n * MERCHANTABILITY or FITNESS FOR A PARTICULAR PURPOSE.  See the\n * GNU General Public License for more details.\n *\n * You should have received a copy of the GNU General Public License\n * along with this program; if not, write to the Free Software\n * Foundation, Inc., 51 Franklin Street, Fifth Floor, Boston, MA  02110-1301, USA.\n *\n * Copyright (c) 2014 (original work) Open Assessment Technologies SA (under the project TAO-PRODUCT);\n */\n\n/**\n * @author Bertrand Chevrier <bertrand@taotesting.com>\n */\ndefine('taoQtiTest/controller/creator/views/actions',[\n'jquery',\n'taoQtiTest/controller/creator/views/property'],\nfunction($, propertyView){\n    'use strict';\n\n    var disabledClass = 'disabled';\n    var activeClass = 'active';\n    var btnOnClass = 'tlb-button-on';\n\n    /**\n     * Set up the property view for an element\n     * @param {jQueryElement} $container - that contains the property opener\n     * @param {String} template - the name of the template to give to the propertyView\n     * @param {Object} model - the model to bind\n     * @param {PropertyViewCallback} cb - execute at view setup phase\n     */\n    function properties ($container, template, model, cb) {\n        var propView = null;\n        $container.find('.property-toggler').on('click', function(e){\n            e.preventDefault();\n            var $elt = $(this);\n            if(!$(this).hasClass(disabledClass)){\n\n                $elt.blur(); //to remove the focus\n\n                if(propView === null){\n\n                    $container.addClass(activeClass);\n                    $elt.addClass(btnOnClass);\n\n                    propView = propertyView(template, model);\n                    propView.open();\n\n                    propView.onOpen(function(){\n                        $container.addClass(activeClass);\n                        $elt.addClass(btnOnClass);\n                    });\n                    propView.onClose(function(){\n                        $container.removeClass(activeClass);\n                        $elt.removeClass(btnOnClass);\n                    });\n\n                    if(typeof cb === 'function'){\n                        cb(propView);\n                    }\n                } else {\n                    propView.toggle();\n                }\n            }\n        });\n    }\n\n\n    /**\n     * Enable to move an element\n     * @param {jQueryElement} $actionContainer - where the mover is\n     * @param {String} containerClass - the cssClass of the element container\n     * @param {String} elementClass - the cssClass to identify elements\n     */\n    function move ($actionContainer, containerClass, elementClass) {\n        var $element = $actionContainer.parents('.' + elementClass);\n        var $container = $element.parents('.' + containerClass );\n\n        //move up an element\n        $('.move-up', $actionContainer).click(function(e){\n            var $elements, index;\n\n            //prevent default and click during animation\n            e.preventDefault();\n            if($element.is(':animated')){\n                return false;\n            }\n\n            //get the position\n            $elements = $('.' + elementClass, $container);\n            index = $elements.index($element);\n            if (index > 0) {\n                $element.fadeOut(200, function(){\n                    $element\n                        .insertBefore($('.' + elementClass + ' :eq(' + (index - 1) + ')', $container))\n                        .fadeIn(400, function(){\n                            $container.trigger('change');\n                        });\n                });\n            }\n        });\n\n        //move down an element\n        $('.move-down', $actionContainer).click(function(e){\n            var $elements, index;\n\n            //prevent default and click during animation\n            e.preventDefault();\n            if($element.is(':animated')){\n                return false;\n            }\n\n            //get the position\n            $elements = $('.' + elementClass, $container);\n            index = $elements.index($element);\n            if (index < ($elements.length - 1) && $elements.length > 1) {\n                $element.fadeOut(200, function(){\n                    $element\n                        .insertAfter($('.' + elementClass + ' :eq(' + (index + 1) + ')', $container))\n                        .fadeIn(400, function(){\n                            $container.trigger('change');\n                        });\n                });\n            }\n        });\n    }\n\n    /**\n     * Update the movable state of an element\n     * @param {jQueryElement} $container - the movable elements (scopped)\n     * @param {String} elementClass - the cssClass to identify elements\n     * @param {String} actionContainerElt - the element name that contains the actions\n     */\n    function movable ($container, elementClass, actionContainerElt){\n        $container.each(function(){\n            var $elt = $(this);\n            var $actionContainer = $(actionContainerElt, $elt);\n\n            var index = $container.index($elt);\n            var $moveUp = $('.move-up', $actionContainer);\n            var $moveDown = $('.move-down', $actionContainer);\n\n            //only one test part, no moving\n            if( $container.length === 1 ){\n                $moveUp.addClass(disabledClass);\n                $moveDown.addClass(disabledClass);\n\n            //testpart is the first, only moving down\n            } else if(index === 0) {\n                $moveUp.addClass(disabledClass);\n                $moveDown.removeClass(disabledClass);\n\n            //testpart is the lasst, only moving up\n            } else if ( index >= ($container.length - 1) ) {\n                $moveDown.addClass(disabledClass);\n                $moveUp.removeClass(disabledClass);\n\n            //or enable moving top/bottom\n            } else {\n                $moveUp.removeClass(disabledClass);\n                $moveDown.removeClass(disabledClass);\n            }\n         });\n    }\n\n    /**\n     * Update the removable state of an element\n     * @param {jQueryElement} $container - that contains the removable action\n     * @param {String} actionContainerElt - the element name that contains the actions\n     */\n    function removable ($container, actionContainerElt){\n        $container.each(function(){\n            var $elt = $(this);\n            var $actionContainer = $(actionContainerElt, $elt);\n            var $delete = $('[data-delete]', $actionContainer);\n\n            if($container.length <= 1){\n                $delete.addClass(disabledClass);\n            } else {\n                $delete.removeClass(disabledClass);\n            }\n        });\n    }\n\n    /**\n     * Disable all the actions of the target\n     * @param {jQueryElement} $container - that contains the the actions\n     * @param {String} actionContainerElt - the element name that contains the actions\n     */\n    function disable($container, actionContainerElt){\n        $container.find(actionContainerElt).find('[data-delete],.move-up,.move-down').addClass(disabledClass);\n    }\n\n    /**\n     * Enable all the actions of the target\n     * @param {jQueryElement} $container - that contains the the actions\n     * @param {String} actionContainerElt - the element name that contains the actions\n     */\n    function enable($container, actionContainerElt){\n        $container.find(actionContainerElt).find('[data-delete],.move-up,.move-down').removeClass(disabledClass);\n    }\n\n    /**\n     * The actions gives you shared behavior for some actions.\n     *\n     * @exports taoQtiTest/controller/creator/views/actions\n     */\n    return {\n        properties  : properties,\n        move        : move,\n        removable   : removable,\n        movable     : movable,\n        disable     : disable,\n        enable      : enable\n    };\n});\n\n","/**\n * This program is free software; you can redistribute it and/or\n * modify it under the terms of the GNU General Public License\n * as published by the Free Software Foundation; under version 2\n * of the License (non-upgradable).\n *\n * This program is distributed in the hope that it will be useful,\n * but WITHOUT ANY WARRANTY; without even the implied warranty of\n * MERCHANTABILITY or FITNESS FOR A PARTICULAR PURPOSE.  See the\n * GNU General Public License for more details.\n *\n * You should have received a copy of the GNU General Public License\n * along with this program; if not, write to the Free Software\n * Foundation, Inc., 51 Franklin Street, Fifth Floor, Boston, MA  02110-1301, USA.\n *\n * Copyright (c) 2015 (original work) Open Assessment Technologies SA;\n */\ndefine('taoQtiTest/controller/creator/helpers/sectionCategory',[\n    'lodash',\n    'i18n',\n    'core/errorHandler'\n], function (_, __, errorHandler){\n\n    'use strict';\n\n    var _ns = '.sectionCategory';\n\n    /**\n     * Check if the given object is a valid assessmentSection model object\n     *\n     * @param {object} model\n     * @returns {boolean}\n     */\n    function isValidSectionModel(model){\n        return (_.isObject(model) && model['qti-type'] === 'assessmentSection' && _.isArray(model.sectionParts));\n    }\n\n    /**\n     * Set an array of categories to the section model (affect the childen itemRef)\n     *\n     * @param {object} model\n     * @param {array} categories\n     * @returns {undefined}\n     */\n    function setCategories(model, categories){\n\n        var oldCategories = getCategories(model);\n\n        //the categories that are no longer in the new list of categories should be removed\n        var removed = _.difference(oldCategories.all, categories);\n\n        //the categories that are not in the old categories collection should be added to the children\n        var propagated = _.difference(categories, oldCategories.all);\n\n        //process the modification\n        addCategories(model, propagated);\n        removeCategories(model, removed);\n    }\n\n    /**\n     * Get the categories assign to the section model, infered by its interal itemRefs\n     *\n     * @param {object} model\n     * @returns {object}\n     */\n    function getCategories(model){\n\n        if(isValidSectionModel(model)){\n            var categories = _.map(model.sectionParts, function (itemRef){\n                if(itemRef['qti-type'] === 'assessmentItemRef' && _.isArray(itemRef.categories)){\n                    return _.compact(itemRef.categories);\n                }\n            });\n            //array of categories\n            var arrays = _.values(categories);\n            var union = _.union.apply(null, arrays);\n\n            //categories that are common to all itemRef\n            var propagated = _.intersection.apply(null, arrays);\n\n            //the categories that are only partially covered on the section level : complementary of \"propagated\"\n            var partial = _.difference(union, propagated);\n\n            return {\n                all : union.sort(),\n                propagated : propagated.sort(),\n                partial : partial.sort()\n            };\n        }else{\n            errorHandler.throw(_ns, 'invalid tool config format');\n        }\n    }\n\n    /**\n     * Add an array of categories to a section model (affect the childen itemRef)\n     *\n     * @param {object} model\n     * @param {array} categories\n     * @returns {undefined}\n     */\n    function addCategories(model, categories){\n        if(isValidSectionModel(model)){\n            _.each(model.sectionParts, function (itemRef){\n                if(itemRef['qti-type'] === 'assessmentItemRef'){\n                    if(!_.isArray(itemRef.categories)){\n                        itemRef.categories = [];\n                    }\n                    itemRef.categories = _.union(itemRef.categories, categories);\n                }\n            });\n        }else{\n            errorHandler.throw(_ns, 'invalid tool config format');\n        }\n    }\n\n    /**\n     * Remove an array of categories from a section model (affect the childen itemRef)\n     *\n     * @param {object} model\n     * @param {array} categories\n     * @returns {undefined}\n     */\n    function removeCategories(model, categories){\n        if(isValidSectionModel(model)){\n            _.each(model.sectionParts, function (itemRef){\n                if(itemRef['qti-type'] === 'assessmentItemRef' && _.isArray(itemRef.categories)){\n                    itemRef.categories = _.difference(itemRef.categories, categories);\n                }\n            });\n        }else{\n            errorHandler.throw(_ns, 'invalid tool config format');\n        }\n    }\n\n    /**\n     * Give the list of tao pre-defined test option categories\n     * Useful to have this list somewhere in the code.\n     *\n     * @returns {array}\n     */\n    function getTaoOptionCategories(){\n        return [\n            {\n                name : 'x-tao-option-endTestWarning',\n                description : __('displays a warning before the user finishes the test')\n            },\n            {\n                name : 'x-tao-option-unansweredWarning',\n                description : __('displays a warning before the user finishes the test, only if there are unanswered/marked for review items')\n            },\n            {\n                name : 'x-tao-option-nextSectionWarning',\n                description : __('displays a next section button that warns the user that they will not be able to return to the section')\n            },\n            {\n                name : 'x-tao-option-nextSection',\n                description : __('displays a next section button')\n            },\n            {\n                name : 'x-tao-option-noExitTimedSectionWarning',\n                description : __('disable the warning automatically displayed upon exiting a timed section')\n            },\n            {\n                name : 'x-tao-option-exit',\n                description : __('displays an exit button')\n            },\n            {\n                name : 'x-tao-option-markReview',\n                description : __('displays a mark for review button. This option requires requires the x-tao-option-reviewScreen option')\n            },\n            {\n                name : 'x-tao-option-reviewScreen',\n                description : __('displays the review screen / navigator')\n            },\n            {\n                name : 'x-tao-option-calculator',\n                description : __('enable calculator')\n            },\n            {\n                name : 'x-tao-itemusage-informational',\n                description : __('describe the item as informational')\n            }\n        ];\n    }\n\n    return {\n        isValidSectionModel : isValidSectionModel,\n        setCategories : setCategories,\n        getCategories : getCategories,\n        addCategories : addCategories,\n        removeCategories : removeCategories,\n        getTaoOptionCategories : getTaoOptionCategories\n    };\n});\n\n","/**\n * This program is free software; you can redistribute it and/or\n * modify it under the terms of the GNU General Public License\n * as published by the Free Software Foundation; under version 2\n * of the License (non-upgradable).\n *\n * This program is distributed in the hope that it will be useful,\n * but WITHOUT ANY WARRANTY; without even the implied warranty of\n * MERCHANTABILITY or FITNESS FOR A PARTICULAR PURPOSE.  See the\n * GNU General Public License for more details.\n *\n * You should have received a copy of the GNU General Public License\n * along with this program; if not, write to the Free Software\n * Foundation, Inc., 51 Franklin Street, Fifth Floor, Boston, MA  02110-1301, USA.\n *\n * Copyright (c) 2015 (original work) Open Assessment Technologies SA ;\n */\n\n/**\n * @author Bertrand Chevrier <bertrand@taotesting.com>\n */\ndefine('taoQtiTest/controller/creator/helpers/qtiTest',['lodash', 'i18n'], function(_, __){\n    'use strict';\n\n    /**\n     * Utils to manage the QTI Test model\n     * @exports taoQtiTest/controller/creator/qtiTestHelper\n     */\n    var qtiTestHelper = {\n\n        /**\n         * Extract qti identifiers from a model\n         * @param {Object} obj - the model to extract id from\n         * @returns {Array} the extracted identifiers\n         */\n        extractIdentifiers : function extractIdentifiers(obj){\n            var self = this;\n            var identifiers = [];\n            if(_.has(obj, 'identifier')){\n                identifiers = identifiers.concat(obj.identifier.toLowerCase());\n            }\n            _.flatten(_.forEach(obj, function(value) {\n                identifiers = identifiers.concat(typeof value === \"object\" ? self.extractIdentifiers(value) : []);\n            }), true);\n            return identifiers;\n        },\n\n        /**\n         * Get a valid and avialable qti identifier\n         * @param {String} qtiType - the type of element you want an id for\n         * @param {Array} lockedIdentifiers - the list of identifiers you cannot use anymore\n         * @returns {String} the identifier\n         */\n        getIdentifier : function getIdentifier(qtiType, lockedIdentifiers){\n            var index = 1;\n            var suggestion;\n            var glue =  '-';\n\n            do {\n                suggestion = qtiType +  glue + (index++);\n            } while(_.contains(lockedIdentifiers, suggestion.toLowerCase()));\n\n            lockedIdentifiers.push(suggestion.toLowerCase());\n\n            return suggestion;\n        },\n\n        /**\n         * Gives you a validator that check QTI id format\n         * @returns {Object} the validator\n         */\n        idFormatValidator : function idFormatValidator(){\n            var qtiIdPattern = /^[_a-zA-Z]{1}[a-zA-Z0-9\\-._]{0,31}$/i;\n            return {\n                name : 'idFormat',\n                message : __('is not a valid identifier (alphanum, underscore, dash and dots)'),\n                validate : function(value, callback){\n                    if(typeof callback === 'function'){\n                        callback(qtiIdPattern.test(value));\n                    }\n                }\n            };\n        },\n\n        /**\n         * Gives you a validator that check QTI id format of the test (it is different from the others...)\n         * @returns {Object} the validator\n         */\n        testidFormatValidator : function testidFormatValidator(){\n            var qtiTestIdPattern = /^\\S+$/;\n            return {\n                name : 'testIdFormat',\n                message : __('is not a valid identifier (everything except spaces)'),\n                validate : function(value, callback){\n                    if(typeof callback === 'function'){\n                        callback(qtiTestIdPattern.test(value));\n                    }\n                }\n            };\n        },\n\n        /**\n         * Gives you a validator that check if a QTI id is available\n         * @param {Array} lockedIdentifiers - the list of identifiers you cannot use anymore\n         * @returns {Object} the validator\n         */\n        idAvailableValidator : function idAvailableValidator(lockedIdentifiers){\n            return {\n                name : 'testIdAvailable',\n                message : __('is already used in the test.'),\n                validate : function(value, callback, options){\n                    if(typeof callback === 'function'){\n                        callback(!_.contains(_.values(lockedIdentifiers), value.toLowerCase()) || (options.original && value === options.original));\n                    }\n                }\n            };\n        },\n\n        /**\n         * Does the value contains the type type\n         * @param {Object} value\n         * @param {string} type\n         * @returns {boolean}\n         */\n        filterQtiType : function filterQtiType (value, type){\n            return value['qti-type'] && value['qti-type'] === type;\n        },\n\n        /**\n         * Add the 'qti-type' properties to object that miss it, using the parent key name\n         * @param {Object|Array} collection\n         * @param {string} parentType\n         */\n        addMissingQtiType : function addMissingQtiType(collection, parentType) {\n            var self = this;\n            _.forEach(collection, function(value, key) {\n                if (_.isObject(value) && !_.isArray(value) && !_.has(value, 'qti-type')) {\n                    if (_.isNumber(key)) {\n                        if (parentType) {\n                            value['qti-type'] = parentType;\n                        }\n                    } else {\n                        value['qti-type'] = key;\n                    }\n                }\n                if (_.isArray(value)) {\n                    self.addMissingQtiType(value, key.replace(/s$/, ''));\n                } else if (_.isObject(value)) {\n                    self.addMissingQtiType(value);\n                }\n            });\n        },\n\n        /**\n         * Applies consolidation rules to the model\n         * @param {Object} model\n         * @returns {Object}\n         */\n        consolidateModel : function consolidateModel(model){\n            if(model && model.testParts && _.isArray(model.testParts)){\n\n                _.forEach(model.testParts, function(testPart) {\n\n                    if(testPart.assessmentSections && _.isArray(testPart.assessmentSections)){\n\n                        _.forEach(testPart.assessmentSections, function(assessmentSection) {\n\n                            //remove ordering is shuffle is false\n                            if(assessmentSection.ordering &&\n                                assessmentSection.ordering.shuffle !== undefined && assessmentSection.ordering.shuffle === false){\n                                delete assessmentSection.ordering;\n                            }\n\n                            // clean categories (QTI identifier can't be empty string)\n                            if(assessmentSection.sectionParts && _.isArray(assessmentSection.sectionParts)) {\n                                _.forEach(assessmentSection.sectionParts, function(part) {\n                                    if(part.categories && _.isArray(part.categories) && (part.categories.length === 0 || part.categories[0].length === 0)) {\n                                        part.categories = [];\n                                    }\n                                });\n                            }\n\n                            if(assessmentSection.rubricBlocks && _.isArray(assessmentSection.rubricBlocks)) {\n\n                                //remove rubrick blocks if empty\n                                if (assessmentSection.rubricBlocks.length === 0 ||\n                                    (assessmentSection.rubricBlocks.length === 1 && assessmentSection.rubricBlocks[0].content.length === 0) ) {\n\n                                    delete assessmentSection.rubricBlocks;\n                                }\n                                //ensure the view attribute is present\n                                else if(assessmentSection.rubricBlocks.length > 0){\n                                    _.forEach(assessmentSection.rubricBlocks, function(rubricBlock){\n                                        rubricBlock.views = ['candidate'];\n                                        //change once views are supported\n                                        //if(rubricBlock && rubricBlock.content && (!rubricBlock.views || (_.isArray(rubricBlock.views) && rubricBlock.views.length === 0))){\n                                        //rubricBlock.views = ['candidate'];\n                                        //}\n                                    });\n                                }\n                            }\n                        });\n                    }\n                });\n            }\n            return model;\n        }\n    };\n\n    return  qtiTestHelper;\n});\n\n\n","/**\n * This program is free software; you can redistribute it and/or\n * modify it under the terms of the GNU General Public License\n * as published by the Free Software Foundation; under version 2\n * of the License (non-upgradable).\n *\n * This program is distributed in the hope that it will be useful,\n * but WITHOUT ANY WARRANTY; without even the implied warranty of\n * MERCHANTABILITY or FITNESS FOR A PARTICULAR PURPOSE.  See the\n * GNU General Public License for more details.\n *\n * You should have received a copy of the GNU General Public License\n * along with this program; if not, write to the Free Software\n * Foundation, Inc., 51 Franklin Street, Fifth Floor, Boston, MA  02110-1301, USA.\n *\n * Copyright (c) 2014 (original work) Open Assessment Technologies SA (under the project TAO-PRODUCT);\n */\n\n/**\n * @author Bertrand Chevrier <bertrand@taotesting.com>\n */\ndefine('taoQtiTest/controller/creator/views/itemref',[\n    'jquery',\n    'lodash',\n    'i18n',\n    'taoQtiTest/controller/creator/views/actions',\n    'taoQtiTest/controller/creator/helpers/sectionCategory',\n    'taoQtiTest/controller/creator/helpers/qtiTest',\n    'tpl!taoQtiTest/controller/creator/templates/itemref-props-weight'\n],\nfunction(\n    $,\n    _,\n    __,\n    actions,\n    sectionCategory,\n    qtiTestHelper,\n    weightTpl\n){\n    'use strict';\n\n    /**\n     * We need to resize the itemref in case of long labels\n     */\n    var resize = _.throttle(function resize(){\n        var $refs = $('.itemrefs').first();\n        var $actions = $('.itemref .actions').first();\n        var width = $refs.innerWidth() - $actions.outerWidth();\n        $('.itemref > .title').width(width);\n    }, 100);\n\n    /**\n     * Set up an item ref: init action behaviors. Called for each one.\n     *\n     * @param {jQueryElement} $itemRef - the itemRef element to set up\n     * @param {Object} model - the data model to bind to the ref\n     */\n    var setUp =  function setUp ($itemRef, model){\n\n        var $actionContainer = $('.actions', $itemRef);\n\n        actions.properties($actionContainer, 'itemref', model, propHandler);\n        actions.move($actionContainer, 'itemrefs', 'itemref');\n\n        resize();\n\n        /**\n         * Perform some binding once the property view is create\n         * @private\n         * @param {propView} propView - the view object\n         */\n        function propHandler (propView) {\n\n            categoriesProperty(propView.getView());\n            weightsProperty(propView);\n\n            $itemRef.parents('.testpart').on('delete', removePropHandler);\n            $itemRef.parents('.section').on('delete', removePropHandler);\n            $itemRef.on('delete', removePropHandler);\n\n            function removePropHandler(){\n                if(propView !== null){\n                    propView.destroy();\n                }\n            }\n        }\n\n        /**\n         * Set up the category property\n         * @private\n         * @param {jQueryElement} $view - the $view object containing the $select\n         */\n        function categoriesProperty($view){\n            var $select = $view.find('[name=itemref-category]');\n            $select.select2({\n                width: '100%',\n                tags : _.pluck(sectionCategory.getTaoOptionCategories(), 'name'),\n                multiple : true,\n                tokenSeparators: [\",\", \" \", \";\"],\n                formatNoMatches : function(){\n                    return __('Enter a category');\n                },\n                maximumInputLength : 32\n            });\n\n            initCategories();\n            $view.on('propopen.propview', function(){\n                initCategories();\n            });\n\n            /**\n             * save the categories into the model\n             * @private\n             */\n            function initCategories(){\n                $select.select2('val', model.categories);\n            }\n        }\n\n\n        /**\n         * Setup the weights properties\n         */\n        function weightsProperty(propView) {\n            var $view = propView.getView(),\n                $weightList = $view.find('[data-bind-each=\"weights\"]');\n\n            $view.find('.itemref-weight-add').on('click', function(e) {\n                var defaultData = {\n                    value: 1,\n                    identifier: (model.weights.length === 0)\n                        ? 'WEIGHT'\n                        : qtiTestHelper.getIdentifier('WEIGHT', qtiTestHelper.extractIdentifiers(model))\n                };\n                e.preventDefault();\n\n                $weightList.append(weightTpl(defaultData));\n                $weightList.trigger('add.internalbinder'); // trigger model update\n\n                $view.groupValidator();\n            });\n        }\n    };\n\n    /**\n     * Listen for state changes to enable/disable . Called globally.\n     */\n    var listenActionState =  function listenActionState (){\n\n        $('.itemrefs').each(function(){\n            actions.movable($('.itemref', $(this)), 'itemref', '.actions');\n        });\n\n        $(document)\n        .on('delete', function(e){\n            var $parent;\n            var $target = $(e.target);\n            if($target.hasClass('itemref')){\n                $parent = $target.parents('.itemrefs');\n                actions.disable($parent.find('.itemref'), '.actions');\n            }\n        })\n        .on('add change undo.deleter deleted.deleter', '.itemrefs',  function(e){\n            var $parent;\n            var $target = $(e.target);\n            if($target.hasClass('itemref') || $target.hasClass('itemrefs')){\n                $parent = $('.itemref', $target.hasClass('itemrefs') ? $target : $target.parents('.itemrefs'));\n                actions.enable($parent, '.actions');\n                actions.movable($parent, 'itemref', '.actions');\n            }\n        });\n    };\n\n    /**\n     * The itemrefView setup itemref related components and beahvior\n     *\n     * @exports taoQtiTest/controller/creator/views/itemref\n     */\n    return {\n        setUp : setUp,\n        listenActionState: listenActionState,\n        resize : resize\n    };\n\n});\n\n","/**\n * This program is free software; you can redistribute it and/or\n * modify it under the terms of the GNU General Public License\n * as published by the Free Software Foundation; under version 2\n * of the License (non-upgradable).\n *\n * This program is distributed in the hope that it will be useful,\n * but WITHOUT ANY WARRANTY; without even the implied warranty of\n * MERCHANTABILITY or FITNESS FOR A PARTICULAR PURPOSE.  See the\n * GNU General Public License for more details.\n *\n * You should have received a copy of the GNU General Public License\n * along with this program; if not, write to the Free Software\n * Foundation, Inc., 51 Franklin Street, Fifth Floor, Boston, MA  02110-1301, USA.\n *\n * Copyright (c) 2015 (original work) Open Assessment Technologies SA ;\n */\n/**\n * @author Jean-Sébastien Conan <jean-sebastien.conan@vesperiagroup.com>\n */\ndefine('taoQtiTest/controller/creator/helpers/ckConfigurator',['ui/ckeditor/ckConfigurator', 'mathJax'], function(ckConfigurator, mathJax) {\n    'use strict';\n\n    /**\n     * Generate a configuration object for CKEDITOR\n     *\n     * @param editor instance of ckeditor\n     * @param toolbarType block | inline | flow | qtiBlock | qtiInline | qtiFlow | reset to get back to normal\n     * @param {Object} [options] - is based on the CKEDITOR config object with some additional sugar\n     *        Note that it's here you need to add parameters for the resource manager.\n     *        Some options are not covered in http://docs.ckeditor.com/#!/api/CKEDITOR.config\n     * @param [options.dtdOverrides] - @see dtdOverrides which pre-defines them\n     * @param {Object} [options.positionedPlugins] - @see ckConfig.positionedPlugins\n     * @param {Boolean} [options.qtiImage] - enables the qtiImage plugin\n     * @param {Boolean} [options.qtiInclude] - enables the qtiInclude plugin\n     * @param {Boolean} [options.underline] - enables the underline plugin\n     * @param {Boolean} [options.mathJax] - enables the mathJax plugin\n     *\n     * @see http://docs.ckeditor.com/#!/api/CKEDITOR.config\n     */\n    var getConfig = function(editor, toolbarType, options){\n        options = options || {};\n\n        options.underline = true;\n\n        return ckConfigurator.getConfig(editor, toolbarType, options);\n    };\n\n    return {\n        getConfig : getConfig\n    };\n});\n\n","/**\n * This program is free software; you can redistribute it and/or\n * modify it under the terms of the GNU General Public License\n * as published by the Free Software Foundation; under version 2\n * of the License (non-upgradable).\n *\n * This program is distributed in the hope that it will be useful,\n * but WITHOUT ANY WARRANTY; without even the implied warranty of\n * MERCHANTABILITY or FITNESS FOR A PARTICULAR PURPOSE.  See the\n * GNU General Public License for more details.\n *\n * You should have received a copy of the GNU General Public License\n * along with this program; if not, write to the Free Software\n * Foundation, Inc., 51 Franklin Street, Fifth Floor, Boston, MA  02110-1301, USA.\n *\n * Copyright (c) 2014 (original work) Open Assessment Technologies SA (under the project TAO-PRODUCT);\n */\n\n/**\n * @author Bertrand Chevrier <bertrand@taotesting.com>\n */\ndefine('taoQtiTest/controller/creator/views/rubricblock',[\n    'jquery',\n    'lodash',\n    'taoQtiTest/controller/creator/views/actions',\n    'helpers',\n    'ckeditor',\n    'taoQtiTest/controller/creator/helpers/ckConfigurator'\n], function($, _, actions, helpers, ckeditor, ckConfigurator){ // qtiClasses, creatorRenderer, XmlRenderer, simpleParser){\n    'use strict';\n\n    //compute ckeditor config only once\n    var ckConfig = ckConfigurator.getConfig(ckeditor, 'qtiBlock');\n\n    var filterPlugin = function filterPlugin(plugin){\n        return _.contains(['taoqtiimage', 'taoqtimedia','taoqtimaths', 'taoqtiinclude'], plugin);\n    };\n    ckConfig.plugins = _.reject(ckConfig.plugins.split(','), filterPlugin).join(',');\n    ckConfig.extraPlugins = _.reject(ckConfig.extraPlugins.split(','), filterPlugin).join(',');\n\n    /**\n     * Set up a rubric block: init action beahviors. Called for each one.\n     *\n     * @param {jQueryElement} $rubricBlock - the rubricblock to set up\n     */\n    var setUp = function setUp($rubricBlock, model, data){\n\n        actions.properties($rubricBlock, 'rubricblock', model, propHandler);\n        setUpEditor();\n\n        /**\n         * Perform some binding once the property view is create\n         * @private\n         * @param {propView} propView - the view object\n         */\n        function propHandler(propView){\n\n            rbViews(propView.getView());\n\n            $rubricBlock.parents('.testpart').on('delete', removePropHandler);\n            $rubricBlock.parents('.section').on('delete', removePropHandler);\n            $rubricBlock.on('delete', removePropHandler);\n\n            function removePropHandler(e){\n                if(propView !== null){\n                    propView.destroy();\n                }\n            }\n        }\n\n        /**\n         * Set up the views select box\n         * @private\n         * @param {jQuerElement} $propContainer - the element container\n         */\n        function rbViews($propContainer){\n            var $select = $('select', $propContainer);\n\n            $select.select2({\n                'width' : '100%'\n            }).on(\"select2-removed\", function(e){\n                if($select.select2('val').length === 0){\n                    $select.select2('val', [1]);\n                }\n            });\n\n            if($select.select2('val').length === 0){\n                $select.select2('val', [1]);\n            }\n        }\n\n        /**\n         * Set up ck editor\n         * @private\n         */\n        function setUpEditor(){\n            var editor;\n\n            //we need to synchronize the ck elt with an hidden elt that has data-binding\n            var $rubricBlockBinding = $('.rubricblock-binding', $rubricBlock);\n            var $rubricBlockContent = $('.rubricblock-content', $rubricBlock);\n            var syncRubricBlockContent = _.throttle(function(){\n                 $rubricBlockBinding\n                    .html($rubricBlockContent.html())\n                    .trigger('change');\n            }, 100);\n\n            $rubricBlockContent.empty().html($rubricBlockBinding.html());\n\n            editor = ckeditor.inline($rubricBlockContent[0], ckConfig);\n            editor.on('change', function(e) {\n                syncRubricBlockContent();\n            });\n        }\n    };\n\n    /**\n     * The rubriclockView setup RB related components and beahvior\n     *\n     * @exports taoQtiTest/controller/creator/views/rubricblock\n     */\n    return {\n        setUp : setUp\n    };\n\n});\n\n","/**\n * This program is free software; you can redistribute it and/or\n * modify it under the terms of the GNU General Public License\n * as published by the Free Software Foundation; under version 2\n * of the License (non-upgradable).\n *\n * This program is distributed in the hope that it will be useful,\n * but WITHOUT ANY WARRANTY; without even the implied warranty of\n * MERCHANTABILITY or FITNESS FOR A PARTICULAR PURPOSE.  See the\n * GNU General Public License for more details.\n *\n * You should have received a copy of the GNU General Public License\n * along with this program; if not, write to the Free Software\n * Foundation, Inc., 51 Franklin Street, Fifth Floor, Boston, MA  02110-1301, USA.\n *\n * Copyright (c) 2016 (original work) Open Assessment Technologies SA;\n */\ndefine('taoQtiTest/controller/creator/helpers/sectionBlueprints',[\n    'lodash',\n    'i18n',\n    'core/errorHandler'\n], function (_, __, errorHandler){\n\n    'use strict';\n\n    var _ns = '.sectionBlueprint';\n\n\n    /**\n     * Set an array of categories to the section model (affect the childen itemRef)\n     *\n     * @param {object} model\n     * @param {string} blueprint\n     * @returns {undefined}\n     */\n    function setBlueprint(model, blueprint){\n        model.blueprint = blueprint;\n    }\n\n    /**\n     * Get the categories assign to the section model, infered by its interal itemRefs\n     *\n     * @param {string} getUrl\n     * @param {object} model\n     * @returns {object}\n     */\n    function getBlueprint(getUrl, model){\n\n        return $.ajax({\n            url: getUrl,\n            type: 'GET',\n            data: {\n                section: model.identifier\n            },\n            dataType: 'json'\n\n        })\n        .fail(function () {\n            errorHandler.throw(_ns, 'invalid tool config format');\n        });\n\n    }\n\n    return {\n        setBlueprint : setBlueprint,\n        getBlueprint : getBlueprint\n    };\n});\n\n","/**\n * This program is free software; you can redistribute it and/or\n * modify it under the terms of the GNU General Public License\n * as published by the Free Software Foundation; under version 2\n * of the License (non-upgradable).\n *\n * This program is distributed in the hope that it will be useful,\n * but WITHOUT ANY WARRANTY; without even the implied warranty of\n * MERCHANTABILITY or FITNESS FOR A PARTICULAR PURPOSE.  See the\n * GNU General Public License for more details.\n *\n * You should have received a copy of the GNU General Public License\n * along with this program; if not, write to the Free Software\n * Foundation, Inc., 51 Franklin Street, Fifth Floor, Boston, MA  02110-1301, USA.\n *\n * Copyright (c) 2014 (original work) Open Assessment Technologies SA (under the project TAO-PRODUCT);\n */\n\n/**\n * @author Bertrand Chevrier <bertrand@taotesting.com>\n */\ndefine('taoQtiTest/controller/creator/views/section',[\n    'jquery',\n    'lodash',\n    'uri',\n    'i18n',\n    'taoQtiTest/controller/creator/views/actions',\n    'taoQtiTest/controller/creator/views/itemref',\n    'taoQtiTest/controller/creator/views/rubricblock',\n    'taoQtiTest/controller/creator/templates/index',\n    'taoQtiTest/controller/creator/helpers/qtiTest',\n    'taoQtiTest/controller/creator/helpers/sectionCategory',\n    'taoQtiTest/controller/creator/helpers/sectionBlueprints'\n],\nfunction($, _, uri, __, actions, itemRefView, rubricBlockView, templates, qtiTestHelper, sectionCategory, sectionBlueprint){\n    'use strict';\n\n    /**\n     * Set up a section: init action beahviors. Called for each section.\n     *\n     * @param {jQueryElement} $sectuin - the section to set up\n     * @param {Object} model - the data model to bind to the test part\n     * @param {Object} [data] - additionnal data used by the setup\n     * @param {Array} [data.identifiers] - the locked identifiers\n     */\n    var setUp = function setUp ($section, model, data){\n\n        var $actionContainer = $('h2', $section);\n\n        if(!_.isEmpty(data.routes.blueprintsById)){\n            model.hasBlueprint = true;\n        }\n        actions.properties($actionContainer, 'section', model, propHandler);\n        actions.move($actionContainer, 'sections', 'section');\n        itemRefs();\n        acceptItemRefs();\n        rubricBlocks();\n        addRubricBlock();\n\n        //trigger for the case the section is added an a selection is ongoing\n\n\n        /**\n         *  Perform some binding once the property view is create\n         *  @param {propView} propView - the view object\n         */\n        function propHandler (propView) {\n\n            var $title;\n            var $view = propView.getView();\n\n            //enable/disable selection\n            var $selectionSwitcher = $('[name=section-enable-selection]', $view);\n            var $selectionSelect = $('[name=section-select]', $view);\n            var $selectionWithRep = $('[name=section-with-replacement]', $view);\n\n            var switchSelection = function switchSelection(){\n                if($selectionSwitcher.prop('checked') === true){\n                    $selectionSelect.incrementer('enable');\n                    $selectionWithRep.removeClass('disabled');\n                } else {\n                    $selectionSelect.incrementer('disable');\n                    $selectionWithRep.addClass('disabled');\n                }\n            };\n            $selectionSwitcher.on('change', switchSelection);\n            $selectionSwitcher.on('change', function updateModel(){\n                if(!$selectionSwitcher.prop('checked')){\n                    $selectionSelect.val(0);\n                    $selectionWithRep.prop('checked', false);\n                    delete model.selection;\n                }\n            });\n\n            $selectionSwitcher.prop('checked', !!model.selection).trigger('change');\n\n            //listen for databinder change to update the test part title\n            $title =  $('[data-bind=title]', $section);\n            $view.on('change.binder', function(e){\n                if(e.namespace === 'binder' && model['qti-type'] === 'assessmentSection'){\n                    $title.text(model.title);\n                }\n            });\n\n            $section.parents('.testpart').on('deleted.deleter', removePropHandler);\n            $section.on('deleted.deleter', removePropHandler);\n\n            //section level category configuration\n            categoriesProperty($view);\n            \n            if(model.hasBlueprint !== undefined){\n                blueprintProperty($view);\n            }\n\n            function removePropHandler(){\n                if(propView !== null){\n                    propView.destroy();\n                }\n            }\n        }\n\n        /**\n         * Set up the item refs that already belongs to the section\n         * @private\n         */\n        function itemRefs(){\n\n            if(!model.sectionParts){\n                model.sectionParts = [];\n            }\n            $('.itemref', $section).each(function(){\n                var $itemRef = $(this);\n                var index = $itemRef.data('bind-index');\n                if(!model.sectionParts[index]){\n                    model.sectionParts[index] = {};\n                }\n\n                itemRefView.setUp($itemRef, model.sectionParts[index]);\n                $itemRef.find('.title').text(\n                    data.labels[uri.encode($itemRef.data('uri'))]\n                );\n            });\n        }\n\n        /**\n         * Make the section to accept the selected items\n         * @private\n         */\n        function acceptItemRefs(){\n            var $selected;\n            var $items     = $('.test-creator-items');\n\n            //the item selector trigger a select event\n            $items.on('itemselect.creator', function(){\n                var selection = Array.prototype.slice.call(arguments, 1);\n                var $placeholder = $('.itemref-placeholder', $section);\n                var $placeholders = $('.itemref-placeholder');\n\n                if(selection.length > 0){\n                    $placeholder.show().off('click').on('click', function(){\n\n                        //prepare the item data\n                        var categories,\n                            defaultItemData = {};\n\n                        if(model.itemSessionControl && !_.isUndefined(model.itemSessionControl.maxAttempts)){\n\n                            //for a matter of consistency, the itemRef will \"inherit\" the itemSessionControl configuration from its parent section\n                            defaultItemData.itemSessionControl = _.clone(model.itemSessionControl);\n                        }\n\n                        //the itemRef should also \"inherit\" the categories set at the item level\n                        categories = sectionCategory.getCategories(model);\n                        defaultItemData.categories = _.clone(categories.propagated);\n\n                        _.forEach(selection, function(item){\n                            var $item = $(item);\n                            var itemCategories = $item.data('categories');\n                            var itemData = _.defaults({\n                                href        : uri.decode($item.data('uri')),\n                                label       : $.trim($item.clone().children().remove().end().text()),\n                                'qti-type'  : 'assessmentItemRef'\n                            }, defaultItemData);\n                            if(!_.isEmpty(itemCategories)){\n                                itemData.categories = _.merge( itemData.categories, itemCategories.trim().split(',') );\n                            }\n\n                            addItemRef($('.itemrefs', $section), undefined, itemData);\n                        });\n\n                        //reset the current selection\n                        $('.ui-selected', $items).removeClass('ui-selected').removeClass('selected');\n                        $placeholders.hide().off('click');\n                    });\n                } else {\n                    $placeholders.hide().off('click');\n                }\n            });\n\n\n            //we listen the event not from the adder but  from the data binder to be sure the model is up to date\n            $(document)\n              .off('add.binder', '#' + $section.attr('id') + ' .itemrefs')\n              .on('add.binder', '#' + $section.attr('id') + ' .itemrefs', function(e, $itemRef){\n                  var index;\n                  if(e.namespace === 'binder' && $itemRef.hasClass('itemref')){\n                      index = $itemRef.data('bind-index');\n\n                      //initialize the new item ref\n                      itemRefView.setUp($itemRef, model.sectionParts[index]);\n                  }\n              });\n\n            //on set up, if there is a selection ongoing, we trigger the event\n            $selected = $('.selected', $items);\n            if($selected.length > 0){\n                $items.trigger('itemselect.creator', $selected);\n            }\n\n        }\n\n        /**\n         * Add a new item ref to the section\n         * @param {jQueryElement} $refList - the element to add the item to\n         * @param {Number} [index] - the position of the item to add\n         * @param {Object} [itemData] - the data to bind to the new item ref\n         */\n        function addItemRef($refList, index, itemData){\n            var $itemRef;\n            var $items = $refList.children('li');\n            index = index || $items.length;\n            itemData.identifier = qtiTestHelper.getIdentifier('item', data.identifiers);\n            itemData.index = index + 1;\n            $itemRef = $(templates.itemref(itemData));\n            if(index > 0){\n                $itemRef.insertAfter($items.eq(index - 1));\n            } else {\n                $itemRef.appendTo($refList);\n            }\n            $refList.trigger('add', [$itemRef, itemData]);\n        }\n\n\n        /**\n         * Set up the rubric blocks that already belongs to the section\n         * @private\n         */\n        function rubricBlocks () {\n            if(!model.rubricBlocks){\n                model.rubricBlocks = [];\n            }\n            $('.rubricblock', $section).each(function(){\n                var $rubricBlock = $(this);\n                var index = $rubricBlock.data('bind-index');\n                if(!model.rubricBlocks[index]){\n                    model.rubricBlocks[index] = {};\n                }\n\n                rubricBlockView.setUp($rubricBlock, model.rubricBlocks[index], data);\n            });\n\n            //opens the rubric blocks section if they are there.\n            if(model.rubricBlocks.length > 0){\n                $('.rub-toggler', $section).trigger('click');\n            }\n        }\n\n        /**\n         * Enable to add new rubrick block\n         * @private\n         */\n        function addRubricBlock () {\n\n            $('.rublock-adder', $section).adder({\n                target: $('.rubricblocks', $section),\n                content : templates.rubricblock,\n                templateData : function(cb){\n                    cb({\n                        'qti-type' : 'rubricBlock',\n                        index  : $('.rubricblock', $section).length,\n                        content : [],\n                        views : [1]\n                    });\n                }\n            });\n\n            //we listen the event not from the adder but  from the data binder to be sure the model is up to date\n            $(document).on('add.binder', '#' + $section.attr('id') + ' .rubricblocks', function(e, $rubricBlock){\n                var index;\n                if(e.namespace === 'binder' && $rubricBlock.hasClass('rubricblock')){\n                    index = $rubricBlock.data('bind-index');\n                    $('.rubricblock-binding', $rubricBlock).html('<p>&nbsp;</p>');\n                    rubricBlockView.setUp($rubricBlock, model.rubricBlocks[index], data);\n                }\n            });\n        }\n\n        /**\n         * Set up the category property\n         * @private\n         * @param {jQueryElement} $view - the $view object containing the $select\n         */\n        function categoriesProperty($view){\n            var $select = $('[name=section-category]', $view);\n            $select.select2({\n                width: '100%',\n                tags : _.pluck(sectionCategory.getTaoOptionCategories(), 'name'),\n                multiple : true,\n                tokenSeparators: [\",\", \" \", \";\"],\n                formatNoMatches : function(){\n                    return __('Enter a category');\n                },\n                maximumInputLength : 32\n            }).on('change', function(e){\n                setCategories(e.val);\n            });\n\n            initCategories();\n            $view.on('propopen.propview', function(){\n                initCategories();\n            });\n\n            /**\n             * Start the categories editing\n             * @private\n             */\n            function initCategories(){\n\n                var categories = sectionCategory.getCategories(model);\n\n                //set categories found in the model in the select2 input\n                $select.select2('val', categories.all);\n\n                //color partial categories\n                $select.siblings('.select2-container').find('.select2-search-choice').each(function(){\n                    var $li = $(this);\n                    var content = $li.find('div').text();\n                    if(_.indexOf(categories.partial, content) >= 0){\n                        $li.addClass('partial');\n                    }\n                });\n            }\n\n            /**\n             * save the categories into the model\n             * @private\n             */\n            function setCategories(categories){\n                sectionCategory.setCategories(model, categories);\n            }\n\n        }\n\n        /**\n         * Set up the Blueprint property\n         * @private\n         * @param {jQueryElement} $view - the $view object containing the $select\n         */\n        function blueprintProperty($view){\n            var $select = $('[name=section-blueprint]', $view);\n            $select.select2({\n                ajax:{\n                    url: data.routes.blueprintsById,\n                    dataType: 'json',\n                    delay: 350,\n                    method: 'POST',\n                    data: function (params) {\n                        return {\n                            identifier: params // search term\n                        };\n                    },\n                    results: function (data) {\n                        return data;\n                    }\n                },\n                minimumInputLength: 3,\n                width: '100%',\n                multiple : false,\n                formatNoMatches : function(){\n                    return __('Enter a blueprint');\n                },\n                maximumInputLength : 32\n            }).on('change', function(e){\n                setBlueprint(e.val);\n            });\n\n            initBlueprint();\n            $view.on('propopen.propview', function(){\n                initBlueprint();\n            });\n\n            /**\n             * Start the blueprint editing\n             * @private\n             */\n            function initBlueprint(){\n\n                if(model.blueprint === undefined){\n                    sectionBlueprint\n                        .getBlueprint(data.routes.blueprintByTestSection, model)\n                        .success(function(data){\n                            if(!_.isEmpty(data)){\n                                if(model.blueprint !== \"\"){\n                                    model.blueprint = data.uri;\n                                    $select.select2('data', {id: data.uri, text: data.text});\n                                    $select.trigger('change');\n                                }\n                            }\n                        });\n                }\n            }\n\n            /**\n             * save the categories into the model\n             * @private\n             */\n            function setBlueprint(blueprint){\n                sectionBlueprint.setBlueprint(model, blueprint);\n            }\n\n        }\n    };\n\n   /**\n    * Listen for state changes to enable/disable . Called globally.\n    */\n    var listenActionState =  function listenActionState (){\n\n        var $sections;\n\n        $('.sections').each(function(){\n            $sections = $('.section', $(this));\n\n            actions.removable($sections, 'h2');\n            actions.movable($sections, 'section', 'h2');\n        });\n\n        $(document)\n        .on('delete', function(e){\n            var $parent;\n            var $target = $(e.target);\n            if($target.hasClass('section')){\n                $parent = $target.parents('.sections');\n                actions.disable($parent.find('.section'), 'h2');\n            }\n        })\n        .on('add change undo.deleter deleted.deleter', function(e){\n            var $target = $(e.target);\n            if($target.hasClass('section') || $target.hasClass('sections')){\n                $sections = $('.section', $target.hasClass('sections') ? $target : $target.parents('.sections'));\n                actions.removable($sections, 'h2');\n                actions.movable($sections, 'section', 'h2');\n            }\n        })\n        .on('open.toggler', '.rub-toggler', function(e){\n            if(e.namespace === 'toggler'){\n                $(this).parents('h2').addClass('active');\n            }\n        })\n        .on('close.toggler', '.rub-toggler', function(e){\n            if(e.namespace === 'toggler'){\n                $(this).parents('h2').removeClass('active');\n            }\n        });\n    };\n\n\n   /**\n     * The sectionView setup section related components and beahvior\n     *\n     * @exports taoQtiTest/controller/creator/views/section\n     */\n    return {\n        setUp : setUp,\n        listenActionState: listenActionState\n    };\n});\n\n","/**\n * This program is free software; you can redistribute it and/or\n * modify it under the terms of the GNU General Public License\n * as published by the Free Software Foundation; under version 2\n * of the License (non-upgradable).\n *\n * This program is distributed in the hope that it will be useful,\n * but WITHOUT ANY WARRANTY; without even the implied warranty of\n * MERCHANTABILITY or FITNESS FOR A PARTICULAR PURPOSE.  See the\n * GNU General Public License for more details.\n *\n * You should have received a copy of the GNU General Public License\n * along with this program; if not, write to the Free Software\n * Foundation, Inc., 51 Franklin Street, Fifth Floor, Boston, MA  02110-1301, USA.\n *\n * Copyright (c) 2014 (original work) Open Assessment Technologies SA (under the project TAO-PRODUCT);\n */\n\n/**\n * @author Bertrand Chevrier <bertrand@taotesting.com>\n */\ndefine('taoQtiTest/controller/creator/views/testpart',[\n'jquery', 'lodash', \n'taoQtiTest/controller/creator/views/actions', \n'taoQtiTest/controller/creator/views/section',\n'taoQtiTest/controller/creator/templates/index', \n'taoQtiTest/controller/creator/helpers/qtiTest'],\nfunction($, _, actions, sectionView, templates, qtiTestHelper){\n    'use strict';\n\n   /**\n    * Set up a test part: init action beahviors. Called for each test part.\n    *\n    * @param {jQueryElement} $testPart - the testpart to set up\n    * @param {Object} model - the data model to bind to the test part\n    * @param {Object} [data] - additionnal data used by the setup\n    * @param {Array} [data.identifiers] - the locked identifiers\n    */\n   var setUp =  function setUp ($testPart, model, data){\n\n        var $actionContainer = $('h1', $testPart);\n\n        //run setup methods\n        actions.properties($actionContainer, 'testpart', model, propHandler);\n        actions.move($actionContainer, 'testparts', 'testpart');\n        sections();\n        addSection();\n\n        /**\n         * Perform some binding once the property view is created\n         * @private\n         * @param {propView} propView - the view object\n         */\n        function propHandler (propView) {\n            \n           var $view = propView.getView();\n\n            //listen for databinder change to update the test part title\n           var $identifier =  $('[data-bind=identifier]', $testPart);\n           $view.on('change.binder', function(e, model){\n                if(e.namespace === 'binder' && model['qti-type'] === 'testPart'){\n                    $identifier.text(model.identifier);\n                }\n            });\n\n            //destroy it when it's testpart is removed\n            $testPart.on('delete', function(e){\n                if(propView !== null){\n                    propView.destroy();\n                }\n            });\n        }\n\n        /**\n         * Set up sections that already belongs to the test part\n         * @private\n         */\n        function sections(){\n            if(!model.assessmentSections){\n                model.assessmentSections = [];\n            }                   \n            $('.section', $testPart).each(function(){\n                var $section = $(this);\n                var index = $section.data('bind-index');\n                if(!model.assessmentSections[index]){\n                    model.assessmentSections[index] = {};\n                }\n\n                sectionView.setUp($section, model.assessmentSections[index], data);\n            });\n        }\n\n        /**\n         * Enable to add new sections\n         * @private\n         */\n        function addSection(){\n            $('.section-adder', $testPart).adder({\n                target: $('.sections', $testPart),\n                content : templates.section,\n                templateData : function(cb){\n\n                    //create a new section model object to be bound to the template\n                    var sectionIndex = $('.section', $testPart).length;\n                    cb({\n                        'qti-type' : 'assessmentSection',\n                        identifier : qtiTestHelper.getIdentifier('assessmentSection',  data.identifiers),\n                        title : 'Section ' + (sectionIndex + 1),\n                        index : 0,\n                        sectionParts : []             \n                    });\n                }\n            });\n            \n                   \n \n            //we listen the event not from the adder but  from the data binder to be sure the model is up to date\n            $(document)\n              .off('add.binder', '#' + $testPart.attr('id') + ' .sections')\n              .on ('add.binder', '#' + $testPart.attr('id') + ' .sections', function(e, $section){\n                if(e.namespace === 'binder' && $section.hasClass('section')){\n                    var index = $section.data('bind-index'); \n                    //initialize the new test part\n                    sectionView.setUp($section, model.assessmentSections[index], data);\n                }\n            });\n        }\n\n   };\n   \n   /**\n    * Listen for state changes to enable/disable . Called globally.\n    */\n   var listenActionState =  function listenActionState (){\n\n        var $testParts = $('.testpart');\n        \n        actions.removable($testParts, 'h1');\n        actions.movable($testParts, 'testpart', 'h1');\n\n        $('.testparts')\n        .on('delete', function(e){\n            var $target = $(e.target);\n            if($target.hasClass('testpart')){\n                actions.disable($('.testpart'), 'h1');\n           }\n        })\n        .on('add change undo.deleter deleted.deleter', function(e){\n            var $target = $(e.target);\n\n            if($target.hasClass('testpart') || $target.hasClass('testparts')){\n                \n                //refresh\n                $testParts = $('.testpart');\n\n                //check state\n                actions.removable($testParts, 'h1');\n                actions.movable($testParts, 'testpart', 'h1');\n            }\n        });\n   };\n \n    /**\n     * The testPartView setup testpart related components and beahvior\n     * \n     * @exports taoQtiTest/controller/creator/views/testpart\n     */\n    return {\n        setUp : setUp,\n        listenActionState: listenActionState\n   }; \n});\n\n","/**\n * This program is free software; you can redistribute it and/or\n * modify it under the terms of the GNU General Public License\n * as published by the Free Software Foundation; under version 2\n * of the License (non-upgradable).\n *\n * This program is distributed in the hope that it will be useful,\n * but WITHOUT ANY WARRANTY; without even the implied warranty of\n * MERCHANTABILITY or FITNESS FOR A PARTICULAR PURPOSE.  See the\n * GNU General Public License for more details.\n *\n * You should have received a copy of the GNU General Public License\n * along with this program; if not, write to the Free Software\n * Foundation, Inc., 51 Franklin Street, Fifth Floor, Boston, MA  02110-1301, USA.\n *\n * Copyright (c) 2014 (original work) Open Assessment Technologies SA (under the project TAO-PRODUCT);\n */\n/**\n * @author Bertrand Chevrier <bertrand@taotesting.com>\n */\ndefine('taoQtiTest/controller/creator/views/test',[\n'jquery', 'lodash', 'ui/hider',\n'taoQtiTest/controller/creator/views/actions',\n'taoQtiTest/controller/creator/views/testpart',\n'taoQtiTest/controller/creator/templates/index',\n'taoQtiTest/controller/creator/helpers/qtiTest'\n],\nfunction($, _, hider, actions, testPartView, templates, qtiTestHelper){\n    'use strict';\n\n   /**\n     * The TestView setup test related components and beahvior\n     *\n     * @exports taoQtiTest/controller/creator/views/test\n     * @param {Object} model - the data model to bind to the test\n     * @param {Object} [data] - additionnal data used by the setup\n     * @param {Array} [data.identifiers] - the locked identifiers\n     */\n   var testView = function testView (model, data) {\n\n        actions.properties($('.test-creator-test > h1'), 'test', model, propHandler);\n        testParts();\n        addTestPart();\n\n        /**\n         * set up the exisiting test part views\n         * @private\n         */\n        function testParts () {\n            if(!model.testParts){\n                model.testParts = [];\n            }\n            $('.testpart').each(function(){\n                var $testPart = $(this);\n                var index = $testPart.data('bind-index');\n                if(!model.testParts[index]){\n                    model.testParts[index] = {};\n                }\n\n                testPartView.setUp($testPart, model.testParts[index], data);\n            });\n        }\n\n        /**\n         * Perform some binding once the property view is created\n         * @private\n         * @param {propView} propView - the view object\n         */\n        function propHandler(propView) {\n\n            var $view = propView.getView();\n            var $cutScoreLine = $('.test-cut-score', $view);\n            var $weightIdentifierLine = $('.test-weight-identifier', $view);\n            var $descriptions = $('.test-outcome-processing-description', $view);\n            var $title = $('.test-creator-test > h1 [data-bind=title]');\n\n            function changeScoring(scoring) {\n                hider.toggle($cutScoreLine, !!scoring && scoring.outcomeProcessing === 'cut');\n                hider.toggle($weightIdentifierLine, !!scoring && ['none', 'custom'].indexOf(scoring.outcomeProcessing) === -1);\n                hider.hide($descriptions);\n                hider.show($descriptions.filter('[data-key=\"' + scoring.outcomeProcessing + '\"]'));\n            }\n\n            $view.on('change.binder', function (e, model) {\n                if (e.namespace === 'binder' && model['qti-type'] === 'assessmentTest') {\n                    changeScoring(model.scoring);\n\n                    //update the test part title when the databinder has changed it\n                    $title.text(model.title);\n                }\n            });\n            changeScoring(model.scoring);\n        }\n\n        /**\n         * Enable to add new test parts\n         * @private\n         */\n        function addTestPart () {\n\n            $('.testpart-adder').adder({\n                target: $('.testparts'),\n                content : templates.testpart,\n                templateData : function(cb){\n\n                    //create an new testPart model object to be bound to the template\n                    var testPartIndex = $('.testpart').length;\n                    cb({\n                        'qti-type' : 'testPart',\n                        identifier : qtiTestHelper.getIdentifier('testPart', data.identifiers),\n                        index  : testPartIndex,\n                        navigationMode : 0,\n                        submissionMode : 0,\n                        assessmentSections : [{\n                            'qti-type' : 'assessmentSection',\n                            identifier : qtiTestHelper.getIdentifier('assessmentSection',  data.identifiers),\n                            title : 'Section 1',\n                            index : 0,\n                            sectionParts : []\n                        }]\n                    });\n                }\n            });\n\n            //we listen the event not from the adder but  from the data binder to be sure the model is up to date\n            $(document)\n              .off('add.binder', '.testparts')\n              .on ('add.binder', '.testparts', function(e, $testPart, added){\n                if(e.namespace === 'binder' && $testPart.hasClass('testpart')){\n                    //initialize the new test part\n                    testPartView.setUp($testPart, model.testParts[added.index], data);\n                }\n            });\n        }\n    };\n\n    return testView;\n});\n\n","/**\n * This program is free software; you can redistribute it and/or\n * modify it under the terms of the GNU General Public License\n * as published by the Free Software Foundation; under version 2\n * of the License (non-upgradable).\n *\n * This program is distributed in the hope that it will be useful,\n * but WITHOUT ANY WARRANTY; without even the implied warranty of\n * MERCHANTABILITY or FITNESS FOR A PARTICULAR PURPOSE.  See the\n * GNU General Public License for more details.\n *\n * You should have received a copy of the GNU General Public License\n * along with this program; if not, write to the Free Software\n * Foundation, Inc., 51 Franklin Street, Fifth Floor, Boston, MA  02110-1301, USA.\n *\n * Copyright (c) 2014 (original work) Open Assessment Technologies SA (under the project TAO-PRODUCT);\n */\n\n/**\n * @author Bertrand Chevrier <bertrand@taotesting.com>\n */\ndefine('taoQtiTest/controller/creator/encoders/dom2qti',['jquery', 'lodash'], function($, _){\n    'use strict';\n\n   /**\n    * Get the list of objects attributes to encode\n    * @param {Object} object\n    * @returns {Array}\n    */\n   var getAttributes = function getAttributes(object){\n        return _.omit(object, [\n           'qti-type',\n           'content',\n           'xmlBase',\n           'lang',\n           'label'\n        ]);\n   };\n\n   /**\n    * Encode object's properties to xml/html string attributes\n    * @param {Object} attributes\n    * @returns {string}\n    */\n   var attrToStr = function attrToStr(attributes){\n     return _.reduce(attributes, function(acc, value, key){\n         if(_.isNumber(value) || (_.isString(value) && !_.isEmpty(value)) ){\n             return acc + ' ' + key + '=\"'+ value + '\" ';\n         }\n         return acc;\n     }, '');\n   };\n\n   /**\n    * This encoder is used to transform DOM to JSON QTI and JSON QTI to DOM.\n    * It works now for the rubricBlocks components.\n    * @exports creator/encoders/dom2qti\n    */\n   var Dom2QtiEncoder = {\n\n       /**\n        * Encode an object to a dom string\n        * @param {Object} modelValue\n        * @returns {string}\n        */\n       encode : function(modelValue){\n           var self = this;\n\n           if(_.isArray(modelValue)){\n               return _.reduce(modelValue, function(result, value){\n                   return result + self.encode(value);\n               }, '');\n           } else if(_.isObject(modelValue) && modelValue['qti-type']){\n                if(modelValue['qti-type'] === 'textRun'){\n                    return modelValue.content;\n                }\n                var startTag = '<' + modelValue['qti-type'] + attrToStr(getAttributes(modelValue));\n                if(modelValue.content){\n                    return  startTag + '>' + self.encode(modelValue.content) + '</' + modelValue['qti-type'] + '>';\n                } else {\n                    return startTag + '/>';\n                }\n           }\n           return modelValue;\n       },\n\n       /**\n        * Decode a string that represents a DOM to a QTI formated object\n        * @param {string} nodeValue\n        * @returns {Array}\n        */\n       decode : function(nodeValue){\n           var self = this;\n           var $nodeValue = (nodeValue instanceof $) ? nodeValue : $(nodeValue);\n           var result = [];\n\n           _.forEach($nodeValue, function(elt){\n               var object;\n                if (elt.nodeType === 3) {\n                    if (!_.isEmpty($.trim(elt.nodeValue))) {\n                        result.push({\n                            'qti-type': 'textRun',\n                            'content': elt.nodeValue,\n                            \"xmlBase\": \"\"\n                        });\n                    }\n                } else if (elt.nodeType === 1){\n                    object = _.merge({\n                            'qti-type': elt.nodeName.toLowerCase(),\n                            'id' : '',\n                            'class' : '',\n                            'xmlBase' : '',\n                            'lang' : '',\n                            'label' : ''\n                        },\n                        _.transform(elt.attributes, function(acc, value) {\n                            if(value.nodeName){\n                                acc[value.nodeName] = value.nodeValue;\n                            }\n                        })\n                    );\n                    if (elt.childNodes.length > 0) {\n                        object.content = self.decode(elt.childNodes);\n                    }\n                    result.push(object);\n                }\n            });\n           return result;\n       }\n   };\n\n   return Dom2QtiEncoder;\n});\n\n\n\n","/**\n * This program is free software; you can redistribute it and/or\n * modify it under the terms of the GNU General Public License\n * as published by the Free Software Foundation; under version 2\n * of the License (non-upgradable).\n *\n * This program is distributed in the hope that it will be useful,\n * but WITHOUT ANY WARRANTY; without even the implied warranty of\n * MERCHANTABILITY or FITNESS FOR A PARTICULAR PURPOSE.  See the\n * GNU General Public License for more details.\n *\n * You should have received a copy of the GNU General Public License\n * along with this program; if not, write to the Free Software\n * Foundation, Inc., 51 Franklin Street, Fifth Floor, Boston, MA  02110-1301, USA.\n *\n * Copyright (c) 2017 (original work) Open Assessment Technologies SA ;\n */\n/**\n * The BaseType enumeration (port of \\qtism\\common\\enums\\BaseType).\n *\n * From IMS QTI:\n *\n * A base-type is simply a description of a set of atomic values (atomic to this specification).\n * Note that several of the baseTypes used to define the runtime data model have identical\n * definitions to those of the basic data types used to define the values for attributes\n * in the specification itself. The use of an enumeration to define the set of baseTypes\n * used in the runtime model, as opposed to the use of classes with similar names, is\n * designed to help distinguish between these two distinct levels of modelling.\n *\n * @author Jérôme Bogaerts <jerome@taotesting.com>\n * @author Jean-Sébastien Conan <jean-sebastien@taotesting.com>\n */\ndefine('taoQtiTest/controller/creator/helpers/baseType',[\n    'lodash'\n], function (_) {\n    'use strict';\n\n    /**\n     * The list of QTI base types\n     * @type {Object}\n     */\n    var baseTypeEnum = {\n        /**\n         * From IMS QTI:\n         *\n         * The set of identifier values is the same as the set of values\n         * defined by the identifier class.\n         *\n         * @type {Number}\n         */\n        IDENTIFIER: 0,\n\n        /**\n         * From IMS QTI:\n         *\n         * The set of boolean values is the same as the set of values defined\n         * by the boolean class.\n         *\n         * @type {Number}\n         */\n        BOOLEAN: 1,\n\n        /**\n         * From IMS QTI:\n         *\n         * The set of integer values is the same as the set of values defined\n         * by the integer class.\n         *\n         * @type {Number}\n         */\n        INTEGER: 2,\n\n        /**\n         * From IMS QTI:\n         *\n         * The set of float values is the same as the set of values defined by the\n         * float class.\n         *\n         * @type {Number}\n         */\n        FLOAT: 3,\n\n        /**\n         * From IMS QTI:\n         *\n         * The set of string values is the same as the set of values defined by the\n         * string class.\n         *\n         * @type {Number}\n         */\n        STRING: 4,\n\n        /**\n         * From IMS QTI:\n         *\n         * A point value represents an integer tuple corresponding to a graphic point.\n         * The two integers correspond to the horizontal (x-axis) and vertical (y-axis)\n         * positions respectively. The up/down and left/right senses of the axes are\n         * context dependent.\n         *\n         * @type {Number}\n         */\n        POINT: 5,\n\n        /**\n         * From IMS QTI:\n         *\n         * A pair value represents a pair of identifiers corresponding to an association\n         * between two objects. The association is undirected so (A,B) and (B,A) are equivalent.\n         *\n         * @type {Number}\n         */\n        PAIR: 6,\n\n        /**\n         * From IMS QTI:\n         *\n         * A directedPair value represents a pair of identifiers corresponding to a directed\n         * association between two objects. The two identifiers correspond to the source\n         * and destination objects.\n         *\n         * @type {Number}\n         */\n        DIRECTED_PAIR: 7,\n\n        /**\n         * From IMS QTI:\n         *\n         * A duration value specifies a distance (in time) between two time points.\n         * In other words, a time period as defined by [ISO8601], but represented as\n         * a single float that records time in seconds. Durations may have a fractional\n         * part. Durations are represented using the xsd:double datatype rather than\n         * xsd:dateTime for convenience and backward compatibility.\n         *\n         * @type {Number}\n         */\n        DURATION: 8,\n\n        /**\n         * From IMS QTI:\n         *\n         * A file value is any sequence of octets (bytes) qualified by a content-type and an\n         * optional filename given to the file (for example, by the candidate when uploading\n         * it as part of an interaction). The content type of the file is one of the MIME\n         * types defined by [RFC2045].\n         *\n         * @type {Number}\n         */\n        FILE: 9,\n\n        /**\n         * From IMS QTI:\n         *\n         * A URI value is a Uniform Resource Identifier as defined by [URI].\n         *\n         * @type {Number}\n         */\n        URI: 10,\n\n        /**\n         * From IMS QTI:\n         *\n         * An intOrIdentifier value is the union of the integer baseType and\n         * the identifier baseType.\n         *\n         * @type {Number}\n         */\n        INT_OR_IDENTIFIER: 11,\n\n        /**\n         * In qtism, we consider an extra 'coords' baseType.\n         *\n         * @type {Number}\n         */\n        COORDS: 12\n    };\n\n    var baseTypeHelper = _({\n        /**\n         * Gets the the list of QTI base types\n         * @returns {Object}\n         */\n        asArray: function asArray() {\n            return baseTypeEnum;\n        },\n\n        /**\n         * Gets a valid type or the default\n         * @param {String|Number} type\n         * @param {String|Number} [defaultType]\n         * @returns {*}\n         */\n        getValid: function getValid(type, defaultType) {\n            if (_.isFinite(type)) {\n                if (!baseTypeHelper.getNameByConstant(type)) {\n                    type = false;\n                }\n            } else {\n                type = baseTypeHelper.getConstantByName(type);\n            }\n\n            if (false === type) {\n                if (!_.isUndefined(defaultType) && defaultType !== -1) {\n                    type = baseTypeHelper.getValid(defaultType, -1);\n                } else {\n                    type = -1;\n                }\n            }\n\n            return type;\n        },\n\n        /**\n         * Get a constant value from the BaseType enumeration by baseType name.\n         *\n         * * 'identifier' -> baseTypes.IDENTIFIER\n         * * 'boolean' -> baseTypes.BOOLEAN\n         * * 'integer' -> baseTypes.INTEGER\n         * * 'float' -> baseTypes.FLOAT\n         * * 'string' -> baseTypes.STRING\n         * * 'point' -> baseTypes.POINT\n         * * 'pair' -> baseTypes.PAIR\n         * * 'directedPair' -> baseTypes.DIRECTED_PAIR\n         * * 'duration' -> baseTypes.DURATION\n         * * 'file' -> baseTypes.FILE\n         * * 'uri' -> baseTypes.URI\n         * * 'intOrIdentifier' -> baseTypes.INT_OR_IDENTIFIER\n         * * extra 'coords' -> baseTypes.COORDS\n         *\n         * @param {String} name The baseType name.\n         * @return {Number|Boolean} The related enumeration value or `false` if the name could not be resolved.\n         */\n        getConstantByName: function getConstantByName(name) {\n            switch (String(name).trim().toLowerCase()) {\n                case 'identifier':\n                    return baseTypeEnum.IDENTIFIER;\n\n                case 'boolean':\n                    return baseTypeEnum.BOOLEAN;\n\n                case 'integer':\n                    return baseTypeEnum.INTEGER;\n\n                case 'float':\n                    return baseTypeEnum.FLOAT;\n\n                case 'string':\n                    return baseTypeEnum.STRING;\n\n                case 'point':\n                    return baseTypeEnum.POINT;\n\n                case 'pair':\n                    return baseTypeEnum.PAIR;\n\n                case 'directedpair':\n                    return baseTypeEnum.DIRECTED_PAIR;\n\n                case 'duration':\n                    return baseTypeEnum.DURATION;\n\n                case 'file':\n                    return baseTypeEnum.FILE;\n\n                case 'uri':\n                    return baseTypeEnum.URI;\n\n                case 'intoridentifier':\n                    return baseTypeEnum.INT_OR_IDENTIFIER;\n\n                case 'coords':\n                    return baseTypeEnum.COORDS;\n\n                default:\n                    return false;\n            }\n        },\n\n        /**\n         * Get the QTI name of a BaseType.\n         *\n         * @param {Number} constant A constant value from the BaseType enumeration.\n         * @return {String|Boolean} The QTI name or false if not match.\n         */\n        getNameByConstant: function getNameByConstant(constant) {\n            switch (constant) {\n                case baseTypeEnum.IDENTIFIER:\n                    return 'identifier';\n\n                case baseTypeEnum.BOOLEAN:\n                    return 'boolean';\n\n                case baseTypeEnum.INTEGER:\n                    return 'integer';\n\n                case baseTypeEnum.FLOAT:\n                    return 'float';\n\n                case baseTypeEnum.STRING:\n                    return 'string';\n\n                case baseTypeEnum.POINT:\n                    return 'point';\n\n                case baseTypeEnum.PAIR:\n                    return 'pair';\n\n                case baseTypeEnum.DIRECTED_PAIR:\n                    return 'directedPair';\n\n                case baseTypeEnum.DURATION:\n                    return 'duration';\n\n                case baseTypeEnum.FILE:\n                    return 'file';\n\n                case baseTypeEnum.URI:\n                    return 'uri';\n\n                case baseTypeEnum.INT_OR_IDENTIFIER:\n                    return 'intOrIdentifier';\n\n                case baseTypeEnum.COORDS:\n                    return 'coords';\n\n                default:\n                    return false;\n            }\n        }\n    }).assign(baseTypeEnum).value();\n\n    return baseTypeHelper;\n});\n\n","/**\n * This program is free software; you can redistribute it and/or\n * modify it under the terms of the GNU General Public License\n * as published by the Free Software Foundation; under version 2\n * of the License (non-upgradable).\n *\n * This program is distributed in the hope that it will be useful,\n * but WITHOUT ANY WARRANTY; without even the implied warranty of\n * MERCHANTABILITY or FITNESS FOR A PARTICULAR PURPOSE.  See the\n * GNU General Public License for more details.\n *\n * You should have received a copy of the GNU General Public License\n * along with this program; if not, write to the Free Software\n * Foundation, Inc., 51 Franklin Street, Fifth Floor, Boston, MA  02110-1301, USA.\n *\n * Copyright (c) 2017 (original work) Open Assessment Technologies SA ;\n */\n/**\n * The Cardinality enumeration (port of \\qtism\\common\\enums\\Cardinality).\n *\n * From IMS QTI:\n *\n * An expression or itemVariable can either be single-valued or multi-valued. A multi-valued\n * expression (or variable) is called a container. A container contains a list of values,\n * this list may be empty in which case it is treated as NULL. All the values in a multiple\n * or ordered container are drawn from the same value set, however, containers may contain\n * multiple occurrences of the same value. In other words, [A,B,B,C] is an acceptable value\n * for a container. A container with cardinality multiple and value [A,B,C] is equivalent\n * to a similar one with value [C,B,A] whereas these two values would be considered distinct\n * for containers with cardinality ordered. When used as the value of a response variable\n * this distinction is typified by the difference between selecting choices in a multi-response\n * multi-choice task and ranking choices in an order objects task. In the language of [ISO11404]\n * a container with multiple cardinality is a \"bag-type\", a container with ordered cardinality\n * is a \"sequence-type\" and a container with record cardinality is a \"record-type\".\n *\n * The record container type is a special container that contains a set of independent values\n * each identified by its own identifier and having its own base-type. This specification\n * does not make use of the record type directly however it is provided to enable\n * customInteractions to manipulate more complex responses and customOperators to\n * return more complex values, in addition to the use for detailed information about\n * numeric responses described in the stringInteraction abstract class.\n *\n * @author Jérôme Bogaerts <jerome@taotesting.com>\n * @author Jean-Sébastien Conan <jean-sebastien@taotesting.com>\n */\ndefine('taoQtiTest/controller/creator/helpers/cardinality',[\n    'lodash'\n], function (_) {\n    'use strict';\n\n    /**\n     * The list of QTI cardinalities\n     * @type {Object}\n     */\n    var cardinalityEnum = {\n        /**\n         * Single term cardinality\n         *\n         * @type {Number}\n         */\n        SINGLE: 0,\n\n        /**\n         * Multiple terms cardinality\n         *\n         * @type {Number}\n         */\n        MULTIPLE: 1,\n\n        /**\n         * Ordered terms cardinality\n         *\n         * @type {Number}\n         */\n        ORDERED: 2,\n\n        /**\n         * Record term cardinality\n         *\n         * @type {Number}\n         */\n        RECORD: 3\n    };\n\n    var cardinalityHelper = _({\n        /**\n         * Gets the the list of QTI cardinalities\n         * @returns {Object}\n         */\n        asArray: function asArray() {\n            return cardinalityEnum;\n        },\n\n        /**\n         * Gets a valid cardinality or the default\n         * @param {String|Number} cardinality\n         * @param {String|Number} [defaultCardinality]\n         * @returns {*}\n         */\n        getValid: function getValid(cardinality, defaultCardinality) {\n            if (_.isFinite(cardinality)) {\n                if (!cardinalityHelper.getNameByConstant(cardinality)) {\n                    cardinality = false;\n                }\n            } else {\n                cardinality = cardinalityHelper.getConstantByName(cardinality);\n            }\n\n            if (false === cardinality) {\n                if (!_.isUndefined(defaultCardinality) && defaultCardinality !== cardinalityEnum.SINGLE) {\n                    cardinality = cardinalityHelper.getValid(defaultCardinality, cardinalityEnum.SINGLE);\n                } else {\n                    cardinality = cardinalityEnum.SINGLE;\n                }\n            }\n\n            return cardinality;\n        },\n\n        /**\n         * Get a constant value from its name.\n         *\n         * @param {String} name The name of the constant, as per QTI spec.\n         * @return {Number|Boolean} The constant value or `false` if not found.\n         */\n        getConstantByName: function getConstantByName(name) {\n            switch (String(name).trim().toLowerCase()) {\n                case 'single':\n                    return cardinalityEnum.SINGLE;\n\n                case 'multiple':\n                    return cardinalityEnum.MULTIPLE;\n\n                case 'ordered':\n                    return cardinalityEnum.ORDERED;\n\n                case 'record':\n                    return cardinalityEnum.RECORD;\n\n                default:\n                    return false;\n            }\n        },\n\n        /**\n         * Get the name of a constant from its value.\n         *\n         * @param {Number} constant The constant value to search the name for.\n         * @return {String|Boolean} The name of the constant or false if not found.\n         */\n        getNameByConstant: function getNameByConstant(constant) {\n            switch (constant) {\n                case cardinalityEnum.SINGLE:\n                    return 'single';\n\n                case cardinalityEnum.MULTIPLE:\n                    return 'multiple';\n\n                case cardinalityEnum.ORDERED:\n                    return 'ordered';\n\n                case cardinalityEnum.RECORD:\n                    return 'record';\n\n                default:\n                    return false;\n            }\n        }\n    }).assign(cardinalityEnum).value();\n\n    return cardinalityHelper;\n});\n\n","/**\n * This program is free software; you can redistribute it and/or\n * modify it under the terms of the GNU General Public License\n * as published by the Free Software Foundation; under version 2\n * of the License (non-upgradable).\n *\n * This program is distributed in the hope that it will be useful,\n * but WITHOUT ANY WARRANTY; without even the implied warranty of\n * MERCHANTABILITY or FITNESS FOR A PARTICULAR PURPOSE.  See the\n * GNU General Public License for more details.\n *\n * You should have received a copy of the GNU General Public License\n * along with this program; if not, write to the Free Software\n * Foundation, Inc., 51 Franklin Street, Fifth Floor, Boston, MA  02110-1301, USA.\n *\n * Copyright (c) 2017 (original work) Open Assessment Technologies SA ;\n */\n/**\n * Basic helper that is intended to manage outcomes inside a test model.\n *\n * @author Jean-Sébastien Conan <jean-sebastien@taotesting.com>\n */\ndefine('taoQtiTest/controller/creator/helpers/outcome',[\n    'lodash',\n    'taoQtiTest/controller/creator/helpers/baseType',\n    'taoQtiTest/controller/creator/helpers/cardinality'\n], function (_, baseTypeHelper, cardinalityHelper) {\n    'use strict';\n\n    var outcomeHelper = {\n        /**\n         * Finds a QTI element in an expression, by its type.\n         * An expression is either an object or a list of objects.\n         * Does not browse any sub-expressions.\n         * @param {Array|Object} expression\n         * @param {String} type\n         * @returns {Object}\n         */\n        findQtiType: function findQtiType(expression, type) {\n            var found = null;\n\n            function checkType(qti) {\n                if (qti['qti-type'] === type) {\n                    found = qti;\n                    return false;\n                }\n            }\n\n            if (_.isArray(expression)) {\n                _.forEach(expression, checkType);\n            } else if (expression) {\n                checkType(expression);\n            }\n\n            return found;\n        },\n\n        /**\n         * Gets a property from an outcome rule expression.\n         * The path to the property is based on QTI types.\n         * @param {Object} outcomeRule - The outcome rule from which get the property\n         * @param {String|String[]} path - The path to the property, with QTI types separated by dot, like: \"setOutcomeValue.gte.baseValue\"\n         * @returns {*}\n         */\n        getProcessingRuleExpression: function getProcessingRuleExpression(outcomeRule, path) {\n            var steps = _.isArray(path) ? path : path.split('.');\n            var len = steps.length;\n            var expression = outcomeRule;\n            var i = 0;\n\n            while (expression && i < len) {\n                expression = outcomeHelper.findQtiType(expression, steps[i++]);\n                if (expression && i < len) {\n                    expression = expression.expression || expression.expressions;\n                }\n            }\n\n            return expression || null;\n        },\n\n        /**\n         * Gets a property from an outcome rule expression.\n         * The path to the property is based on QTI types.\n         * @param {Object} outcomeRule - The outcome rule from which get the property\n         * @param {String|String[]} path - The path to the property, with QTI types separated by dot, like: \"setOutcomeValue.gte.baseValue.value\"\n         * @returns {*}\n         */\n        getProcessingRuleProperty: function getProcessingRuleProperty(outcomeRule, path) {\n            var result = null;\n            var steps = _.isArray(path) ? path : path.split('.');\n            var property = steps.pop();\n            var expression = outcomeHelper.getProcessingRuleExpression(outcomeRule, steps);\n\n            if (expression && expression[property]) {\n                result = expression[property];\n            }\n\n            return result;\n        },\n\n        /**\n         * Gets the identifier of an outcome\n         * @param {Object|String} outcome\n         * @returns {String}\n         */\n        getOutcomeIdentifier: function getOutcomeIdentifier(outcome) {\n            return String(_.isObject(outcome) ? outcome.identifier : outcome);\n        },\n\n        /**\n         * Gets the list of outcome declarations\n         * @param {Object} testModel\n         * @returns {Array}\n         */\n        getOutcomeDeclarations: function getOutcomeDeclarations(testModel) {\n            return testModel && testModel.outcomeDeclarations;\n        },\n\n        /**\n         * Gets the list of outcome processing rules\n         * @param {Object} testModel\n         * @returns {Array}\n         */\n        getOutcomeProcessingRules: function getOutcomeProcessingRules(testModel) {\n            return testModel && testModel.outcomeProcessing && testModel.outcomeProcessing.outcomeRules;\n        },\n\n        /**\n         * Applies a function on each outcome declarations\n         * @param {Object} testModel\n         * @param {Function} cb\n         */\n        eachOutcomeDeclarations: function eachOutcomeDeclarations(testModel, cb) {\n            _.forEach(outcomeHelper.getOutcomeDeclarations(testModel), cb);\n        },\n\n        /**\n         * Applies a function on each outcome processing rules. Does not take care of sub-expressions.\n         * @param {Object} testModel\n         * @param {Function} cb\n         */\n        eachOutcomeProcessingRules: function eachOutcomeProcessingRules(testModel, cb) {\n            _.forEach(outcomeHelper.getOutcomeProcessingRules(testModel), cb);\n        },\n\n        /**\n         * Applies a function on each outcome processing rules, take care of each sub expression.\n         * @param {Object} testModel\n         * @param {Function} cb\n         */\n        eachOutcomeProcessingRuleExpressions: function eachOutcomeProcessingRuleExpressions(testModel, cb) {\n            function browseExpressions(processingRule) {\n                if (_.isArray(processingRule)) {\n                    _.forEach(processingRule, browseExpressions);\n                } else if (processingRule) {\n                    cb(processingRule);\n\n                    if (processingRule.expression) {\n                        browseExpressions(processingRule.expression);\n                    } else if (processingRule.expressions) {\n                        browseExpressions(processingRule.expressions);\n                    }\n                }\n            }\n\n            browseExpressions(outcomeHelper.getOutcomeProcessingRules(testModel));\n        },\n\n        /**\n         * Lists all outcomes identifiers. An optional callback allows to filter the list\n         * @param {Object} testModel\n         * @param {Function} [cb]\n         * @returns {Array}\n         */\n        listOutcomes: function listOutcomes(testModel, cb) {\n            var outcomes = [];\n            if (!_.isFunction(cb)) {\n                cb = null;\n            }\n            outcomeHelper.eachOutcomeDeclarations(testModel, function (outcome) {\n                if (!cb || cb(outcome)) {\n                    outcomes.push(outcomeHelper.getOutcomeIdentifier(outcome));\n                }\n            });\n            return outcomes;\n        },\n\n        /**\n         * Removes the spefified outcomes from the provided test model\n         * @param {Object} testModel\n         * @param {String[]} outcomes\n         */\n        removeOutcomes: function removeOutcomes(testModel, outcomes) {\n            var declarations = outcomeHelper.getOutcomeDeclarations(testModel);\n            var rules = outcomeHelper.getOutcomeProcessingRules(testModel);\n\n            outcomes = _.indexBy(_.isArray(outcomes) ? outcomes : [outcomes], function (outcome) {\n                return outcome;\n            });\n\n            if (declarations) {\n                _.remove(declarations, function (outcomeDeclaration) {\n                    return !!outcomes[outcomeHelper.getOutcomeIdentifier(outcomeDeclaration)];\n                });\n            }\n\n            if (rules) {\n                _.remove(rules, function (outcomeRule) {\n                    return !!outcomes[outcomeHelper.getOutcomeIdentifier(outcomeRule)];\n                });\n            }\n        },\n\n        /**\n         * Creates an outcome declaration\n         * @param {String} identifier\n         * @param {String|Number|Boolean} [type] - The data type of the outcome, FLOAT by default\n         * @param {Number} [cardinality] - The variable cardinality, default 0\n         * @returns {Object}\n         * @throws {TypeError} if the identifier is empty or is not a string\n         */\n        createOutcome: function createOutcome(identifier, type, cardinality) {\n\n            if (!validateIdentifier(identifier)) {\n                throw new TypeError('You must provide a valid identifier!');\n            }\n\n            return {\n                'qti-type': 'outcomeDeclaration',\n                views: [],\n                interpretation: '',\n                longInterpretation: '',\n                normalMaximum: false,\n                normalMinimum: false,\n                masteryValue: false,\n                identifier: identifier,\n                cardinality: cardinalityHelper.getValid(cardinality, cardinalityHelper.SINGLE),\n                baseType: baseTypeHelper.getValid(type, baseTypeHelper.FLOAT)\n            };\n        },\n\n        /**\n         * Adds a processing rule into the test model\n         *\n         * @param {Object} testModel\n         * @param {Object} processingRule\n         * @returns {Object}\n         * @throws {TypeError} if the processing rule is not valid\n         */\n        addOutcomeProcessing: function createOutcomeProcessing(testModel, processingRule) {\n            var outcomeProcessing = testModel.outcomeProcessing;\n\n            if (!processingRule || !processingRule['qti-type'] || !_.isString(processingRule['qti-type'])) {\n                throw new TypeError('You must provide a valid outcome processing rule!');\n            }\n\n            if (!outcomeProcessing) {\n                outcomeProcessing = {\n                    'qti-type': 'outcomeProcessing',\n                    outcomeRules: []\n                };\n                testModel.outcomeProcessing = outcomeProcessing;\n            } else if (!outcomeProcessing.outcomeRules) {\n                outcomeProcessing.outcomeRules = [];\n            }\n\n            outcomeProcessing.outcomeRules.push(processingRule);\n            return processingRule;\n        },\n\n        /**\n         * Creates an outcome and adds it to the declarations\n         * @param {Object} testModel\n         * @param {Object} outcome - The outcome to add\n         * @param {Object} [processingRule] - The processing rule attached to the outcome\n         * @returns {Object}\n         * @throws {TypeError} if one of the outcome or the processing rule is not valid\n         */\n        addOutcome: function addOutcome(testModel, outcome, processingRule) {\n            var declarations = testModel.outcomeDeclarations;\n\n            if (!outcome || outcome['qti-type'] !== 'outcomeDeclaration' || !validateIdentifier(outcome.identifier)) {\n                throw new TypeError('You must provide a valid outcome!');\n            }\n\n            if (processingRule) {\n                if (!validateIdentifier(processingRule.identifier) || processingRule.identifier !== outcome.identifier) {\n                    throw new TypeError('You must provide a valid outcome processing rule!');\n                }\n\n                outcomeHelper.addOutcomeProcessing(testModel, processingRule);\n            }\n\n            if (!declarations) {\n                declarations = [];\n                testModel.outcomeDeclarations = declarations;\n            }\n\n            declarations.push(outcome);\n            return outcome;\n        }\n    };\n\n    var identifierValidator = /^[a-zA-Z_][a-zA-Z0-9_\\.-]*$/;\n\n    /**\n     * Checks the validity of an identifier\n     * @param {String} identifier\n     * @returns {Boolean}\n     */\n    function validateIdentifier(identifier) {\n        return identifier && _.isString(identifier) && identifierValidator.test(identifier);\n    }\n\n    return outcomeHelper;\n});\n\n","/**\n * This program is free software; you can redistribute it and/or\n * modify it under the terms of the GNU General Public License\n * as published by the Free Software Foundation; under version 2\n * of the License (non-upgradable).\n *\n * This program is distributed in the hope that it will be useful,\n * but WITHOUT ANY WARRANTY; without even the implied warranty of\n * MERCHANTABILITY or FITNESS FOR A PARTICULAR PURPOSE.  See the\n * GNU General Public License for more details.\n *\n * You should have received a copy of the GNU General Public License\n * along with this program; if not, write to the Free Software\n * Foundation, Inc., 51 Franklin Street, Fifth Floor, Boston, MA  02110-1301, USA.\n *\n * Copyright (c) 2017 (original work) Open Assessment Technologies SA ;\n */\n/**\n * Basic helper that is intended to generate outcomes processing rules for a test model.\n *\n * @author Jean-Sébastien Conan <jean-sebastien@taotesting.com>\n */\ndefine('taoQtiTest/controller/creator/helpers/processingRule',[\n    'lodash',\n    'taoQtiTest/controller/creator/helpers/baseType',\n    'taoQtiTest/controller/creator/helpers/cardinality'\n], function (_, baseTypeHelper, cardinalityHelper) {\n    'use strict';\n\n    var processingRuleHelper = {\n        /**\n         * Creates a basic processing rule\n         * @param {String} type\n         * @param {String} [identifier]\n         * @param {Array|Object} [expression]\n         * @returns {Object}\n         * @throws {TypeError} if the type is empty or is not a string\n         * @throws {TypeError} if the identifier is not a string\n         */\n        create: function create(type, identifier, expression) {\n            var processingRule = {\n                'qti-type': type\n            };\n\n            if (!type || !_.isString(type)) {\n                throw new TypeError('You must provide a valid processing type!');\n            }\n\n            if (identifier) {\n                if (!validateIdentifier(identifier)) {\n                    throw new TypeError('You must provide a valid identifier!');\n                }\n                processingRule.identifier = identifier;\n            }\n\n            if (expression) {\n                processingRuleHelper.setExpression(processingRule, expression);\n            }\n\n            return processingRule;\n        },\n\n        /**\n         * Sets an expression to a processing rule\n         * @param {Object} processingRule\n         * @param {Object|Array} expression\n         */\n        setExpression: function setExpression(processingRule, expression) {\n            if (processingRule) {\n                if (_.isArray(expression)) {\n                    if (processingRule.expression) {\n                        processingRule.expression = null;\n                    }\n                    processingRule.expressions = expression;\n                } else {\n                    if (processingRule.expressions) {\n                        processingRule.expressions = null;\n                    }\n                    if (expression) {\n                        processingRule.expression = expression;\n                    }\n                }\n            }\n        },\n\n        /**\n         * Adds an expression to a processing rule\n         * @param {Object} processingRule\n         * @param {Object|Array} expression\n         */\n        addExpression: function addExpression(processingRule, expression) {\n            if (processingRule && expression) {\n                if (processingRule.expression) {\n                    processingRule.expressions = forceArray(processingRule.expression);\n                    processingRule.expression = null;\n                }\n\n                if (_.isArray(expression)) {\n                    processingRule.expressions = forceArray(processingRule.expressions).concat(expression);\n                } else {\n                    if (processingRule.expressions) {\n                        processingRule.expressions.push(expression);\n                    } else {\n                        processingRule.expression = expression;\n                    }\n                }\n            }\n        },\n\n        /**\n         * Creates a `setOutcomeValue` rule\n         * @param {String} identifier\n         * @param {Object|Array} [expression]\n         * @returns {Object}\n         * @throws {TypeError} if the identifier is empty or is not a string\n         */\n        setOutcomeValue: function setOutcomeValue(identifier, expression) {\n            if (!validateIdentifier(identifier)) {\n                throw new TypeError('You must provide a valid identifier!');\n            }\n            return processingRuleHelper.create('setOutcomeValue', identifier, expression);\n        },\n\n        /**\n         * Creates a `gte` rule\n         * @param {Object|Array} left - the left operand\n         * @param {Object|Array} right - the right operand\n         * @returns {Object}\n         */\n        gte: function gte(left, right) {\n            return binaryOperator('gte', left, right);\n        },\n\n        /**\n         * Creates a `lte` rule\n         * @param {Object|Array} left - the left operand\n         * @param {Object|Array} right - the right operand\n         * @returns {Object}\n         */\n        lte: function lte(left, right) {\n            return binaryOperator('lte', left, right);\n        },\n\n        /**\n         * Creates a `divide` rule\n         * @param {Object|Array} left - the left operand\n         * @param {Object|Array} right - the right operand\n         * @returns {Object}\n         */\n        divide: function divide(left, right) {\n            return binaryOperator('divide', left, right);\n        },\n\n        /**\n         * Creates a `sum` rule\n         * @param {Object|Array} terms\n         * @returns {Object}\n         */\n        sum: function sum(terms) {\n            var processingRule = processingRuleHelper.create('sum', null, forceArray(terms));\n\n            processingRule.minOperands = 1;\n            processingRule.maxOperands = -1;\n            processingRule.acceptedCardinalities = [cardinalityHelper.SINGLE, cardinalityHelper.MULTIPLE, cardinalityHelper.ORDERED];\n            processingRule.acceptedBaseTypes = [baseTypeHelper.INTEGER, baseTypeHelper.FLOAT];\n\n            return processingRule;\n        },\n\n        /**\n         * Creates a `testVariables` rule\n         * @param {String} identifier\n         * @param {String|Number} [type]\n         * @param {String} weight\n         * @param {String|String[]} [includeCategories]\n         * @param {String|String[]} [excludeCategories]\n         * @returns {Object}\n         * @throws {TypeError} if the identifier is empty or is not a string\n         */\n        testVariables: function testVariables(identifier, type, weight, includeCategories, excludeCategories) {\n            var processingRule = processingRuleHelper.create('testVariables');\n\n            if (!validateIdentifier(identifier)) {\n                throw new TypeError('You must provide a valid identifier!');\n            }\n            processingRule.variableIdentifier = identifier;\n\n            if (weight) {\n                if (!validateIdentifier(weight)) {\n                    throw new TypeError('You must provide a valid weight identifier!');\n                }\n                processingRule.weightIdentifier = weight;\n            } else {\n                processingRule.weightIdentifier = '';\n            }\n\n            processingRule.baseType = baseTypeHelper.getValid(type);\n            processingRule.sectionIdentifier = '';\n            processingRule.includeCategories = forceArray(includeCategories);\n            processingRule.excludeCategories = forceArray(excludeCategories);\n\n            return processingRule;\n        },\n\n        /**\n         * Creates a `numberPresented` rule\n         * @param {String|String[]} [includeCategories]\n         * @param {String|String[]} [excludeCategories]\n         * @returns {Object}\n         */\n        numberPresented: function numberPresented(includeCategories, excludeCategories) {\n            var processingRule = processingRuleHelper.create('numberPresented');\n\n            processingRule.sectionIdentifier = '';\n            processingRule.includeCategories = forceArray(includeCategories);\n            processingRule.excludeCategories = forceArray(excludeCategories);\n\n            return processingRule;\n        },\n\n        /**\n         * Creates a `baseValue` rule\n         * @param {*} [value]\n         * @param {String|Number} [type]\n         * @returns {Object}\n         */\n        baseValue: function baseValue(value, type) {\n            var processingRule = processingRuleHelper.create('baseValue');\n\n            processingRule.baseType = baseTypeHelper.getValid(type, baseTypeHelper.FLOAT);\n            processingRule.value = parseFloat(value) || 0;\n\n            return processingRule;\n        }\n\n    };\n\n    var identifierValidator = /^[a-zA-Z_][a-zA-Z0-9_\\.-]*$/;\n\n    /**\n     * Checks the validity of an identifier\n     * @param {String} identifier\n     * @returns {Boolean}\n     */\n    function validateIdentifier(identifier) {\n        return identifier &&_.isString(identifier) && identifierValidator.test(identifier);\n    }\n\n    /**\n     * Creates a binary operator rule\n     * @param {String} type - The rule type\n     * @param {Object|Array} left - The left operand\n     * @param {Object|Array} right - The right operand\n     * @returns {Object}\n     * @throws {TypeError} if the type is empty or is not a string\n     */\n    function binaryOperator(type, left, right) {\n        var processingRule = processingRuleHelper.create(type, null, [left, right]);\n\n        processingRule.minOperands = 2;\n        processingRule.maxOperands = 2;\n        processingRule.acceptedCardinalities = [cardinalityHelper.SINGLE];\n        processingRule.acceptedBaseTypes = [baseTypeHelper.INTEGER, baseTypeHelper.FLOAT];\n\n        return processingRule;\n    }\n\n    /**\n     * Ensures a value is an array\n     * @param {*} value\n     * @returns {Array}\n     */\n    function forceArray(value) {\n        if (!value) {\n            value = [];\n        }\n        if (!_.isArray(value)) {\n            value = [value];\n        }\n        return value;\n    }\n\n    return processingRuleHelper;\n});\n\n","/**\n * This program is free software; you can redistribute it and/or\n * modify it under the terms of the GNU General Public License\n * as published by the Free Software Foundation; under version 2\n * of the License (non-upgradable).\n *\n * This program is distributed in the hope that it will be useful,\n * but WITHOUT ANY WARRANTY; without even the implied warranty of\n * MERCHANTABILITY or FITNESS FOR A PARTICULAR PURPOSE.  See the\n * GNU General Public License for more details.\n *\n * You should have received a copy of the GNU General Public License\n * along with this program; if not, write to the Free Software\n * Foundation, Inc., 51 Franklin Street, Fifth Floor, Boston, MA  02110-1301, USA.\n *\n * Copyright (c) 2017 (original work) Open Assessment Technologies SA ;\n */\n/**\n * Helper that provides a way to browse all categories attached to a test model at the item level.\n *\n * @author Jean-Sébastien Conan <jean-sebastien@taotesting.com>\n */\ndefine('taoQtiTest/controller/creator/helpers/category',[\n    'lodash'\n], function (_) {\n    'use strict';\n\n    /**\n     * Checks if a category is an option\n     *\n     * @param {String} category\n     * @returns {Boolean}\n     */\n    function isCategoryOption(category) {\n        return category && category.indexOf('x-tao-') === 0;\n    }\n\n    /**\n     * Calls a function for each category in the test model\n     * @param {Object} testModel\n     * @param {Function} cb\n     */\n    function eachCategories(testModel, cb) {\n        _.forEach(testModel.testParts, function (testPart) {\n            _.forEach(testPart.assessmentSections, function (assessmentSection) {\n                _.forEach(assessmentSection.sectionParts, function (itemRef) {\n                    _.forEach(itemRef.categories, function(category) {\n                        cb(category, itemRef);\n                    });\n                });\n            });\n        });\n    }\n\n    return {\n        /**\n         * Calls a function for each category in the test model\n         * @function eachCategories\n         * @param {Object} testModel\n         * @param {Function} cb\n         */\n        eachCategories: eachCategories,\n\n        /**\n         * Gets the list of categories assigned to the items.\n         * Discards special purpose categories like 'x-tao-...'\n         *\n         * @param {Object} testModel\n         * @returns {Array}\n         */\n        listCategories: function listCategories(testModel) {\n            var categories = {};\n            eachCategories(testModel, function(category) {\n                if (!isCategoryOption(category)) {\n                    categories[category] = true;\n                }\n            });\n            return _.keys(categories);\n        },\n\n        /**\n         * Gets the list of options assigned to the items (special purpose categories like 'x-tao-...').\n         *\n         * @param {Object} testModel\n         * @returns {Array}\n         */\n        listOptions: function listOptions(testModel) {\n            var options = {};\n            eachCategories(testModel, function(category) {\n                if (isCategoryOption(category)) {\n                    options[category] = true;\n                }\n            });\n            return _.keys(options);\n        }\n    };\n});\n\n","/**\n * This program is free software; you can redistribute it and/or\n * modify it under the terms of the GNU General Public License\n * as published by the Free Software Foundation; under version 2\n * of the License (non-upgradable).\n *\n * This program is distributed in the hope that it will be useful,\n * but WITHOUT ANY WARRANTY; without even the implied warranty of\n * MERCHANTABILITY or FITNESS FOR A PARTICULAR PURPOSE.  See the\n * GNU General Public License for more details.\n *\n * You should have received a copy of the GNU General Public License\n * along with this program; if not, write to the Free Software\n * Foundation, Inc., 51 Franklin Street, Fifth Floor, Boston, MA  02110-1301, USA.\n *\n * Copyright (c) 2017 (original work) Open Assessment Technologies SA ;\n */\n/**\n * Basic helper that is intended to manage the score processing declaration in a test model.\n *\n * @author Jean-Sébastien Conan <jean-sebastien@taotesting.com>\n */\ndefine('taoQtiTest/controller/creator/helpers/scoring',[\n    'lodash',\n    'i18n',\n    'taoQtiTest/controller/creator/helpers/baseType',\n    'taoQtiTest/controller/creator/helpers/outcome',\n    'taoQtiTest/controller/creator/helpers/processingRule',\n    'taoQtiTest/controller/creator/helpers/category'\n], function (_, __, baseTypeHelper, outcomeHelper, processingRuleHelper, categoryHelper) {\n    'use strict';\n\n    /**\n     * The default cut score\n     * @todo Move this to a config file\n     * @type {Number}\n     */\n    var defaultCutScore = 0.5;\n\n    /**\n     * The list of supported processing modes, indexed by mode identifier\n     * @type {Object}\n     */\n    var processingModes = {\n        none: {\n            key: 'none',\n            label: __('None'),\n            description: __('No outcome processing. Erase the existing rules, if any.')\n        },\n        custom: {\n            key: 'custom',\n            label: __('Custom'),\n            description: __('Custom outcome processing. No changes will be made to the existing rules.')\n        },\n        total: {\n            key: 'total',\n            label: __('Total score'),\n            outcome: 'SCORE_TOTAL',\n            type: baseTypeHelper.FLOAT,\n            description: __('The score will be processed for the entire test. A sum of all SCORE outcomes will be computed, the result will take place in the SCORE_TOTAL outcome.')\n        },\n        category: {\n            key: 'category',\n            label: __('Category score'),\n            prefix: 'SCORE_',\n            type: baseTypeHelper.FLOAT,\n            description: __('The score will be processed per categories. A sum of all SCORE outcomes will be computed for each defined categories, the result will take place in the SCORE_xxx outcome, where xxx is the name of the category.')\n        },\n        cut: {\n            key: 'cut',\n            label: __('Cut score'),\n            prefix: 'PASS_',\n            type: baseTypeHelper.BOOLEAN,\n            description: __('The score will be processed per categories. An average of all SCORE outcomes will be computed for each defined categories, the result will be compared to the cut score, then the PASS_xxx outcome will be set accordingly, where xxx is the name of the category.')\n        }\n    };\n\n    /**\n     * List of writers that provides the outcomes for each score processing modes.\n     * The writers are separated from the list of supported modes, as this list is forwarded to the UI templates,\n     * and only data must be provided to templates.\n     * @type {Object}\n     */\n    var processingModeWriters = {\n        /**\n         * Writes the outcomes in the scoring mode \"None\"\n         * @param {Object} model\n         */\n        none: function processingModeWriterNone(model) {\n            // as no rules must be defined, just erase existing ones\n            removeScoring(model);\n        },\n\n        /**\n         * Writes the outcomes in the scoring mode \"Custom\"\n         * @param {Object} model\n         */\n        custom: function processingModeWriterCustom() {\n            // just does nothing as we only need to keep intact the existing rules, if any\n        },\n\n        /**\n         * Writes the outcomes in the scoring mode \"Total score\"\n         * @param {Object} model\n         */\n        total: function processingModeWriterTotal(model) {\n            var processingMode = processingModes.total;\n            var outcome, processingRule;\n\n            // erase the existing rules, they will be replaced by those that are defined here\n            removeScoring(model);\n\n            // create the outcome and the rule that process the overall score\n            outcome = outcomeHelper.createOutcome(processingMode.outcome, processingMode.type);\n            processingRule = processingRuleHelper.setOutcomeValue(processingMode.outcome,\n                processingRuleHelper.sum(\n                    processingRuleHelper.testVariables(model.scoring.scoreIdentifier, -1, model.scoring.weightIdentifier)\n                )\n            );\n\n            outcomeHelper.addOutcome(model, outcome, processingRule);\n        },\n\n        /**\n         * Writes the outcomes in the scoring mode \"Category score\"\n         * @param {Object} model\n         */\n        category: function processingModeWriterCategory(model) {\n            var processingMode = processingModes.category;\n\n            // erase the existing rules, they will be replaced by those that are defined here\n            removeScoring(model);\n\n            // create an outcome per category\n            _.forEach(categoryHelper.listCategories(model), function (category) {\n                var outcome, processingRule;\n                var identifier = processingMode.prefix + category.toUpperCase();\n\n                // create the outcome and the rule that process the category score\n                outcome = outcomeHelper.createOutcome(identifier, processingMode.type);\n                processingRule = processingRuleHelper.setOutcomeValue(identifier,\n                    processingRuleHelper.sum(\n                        processingRuleHelper.testVariables(model.scoring.scoreIdentifier, -1, model.scoring.weightIdentifier, category)\n                    )\n                );\n\n                outcomeHelper.addOutcome(model, outcome, processingRule);\n            });\n        },\n\n        /**\n         * Writes the outcomes in the scoring mode \"Cut score\"\n         * @param {Object} model\n         */\n        cut: function processingModeWriterCut(model) {\n            var processingMode = processingModes.cut;\n\n            // erase the existing rules, they will be replaced by those that are defined here\n            removeScoring(model);\n\n            // create an outcome per category\n            _.forEach(categoryHelper.listCategories(model), function (category) {\n                var outcome, processingRule;\n                var identifier = processingMode.prefix + category.toUpperCase();\n\n                // create the outcome and the rule that process the category score\n                outcome = outcomeHelper.createOutcome(identifier, processingMode.type);\n                processingRule = processingRuleHelper.setOutcomeValue(identifier,\n                    processingRuleHelper.gte(\n                        processingRuleHelper.divide(\n                            processingRuleHelper.sum(\n                                processingRuleHelper.testVariables(model.scoring.scoreIdentifier, -1, model.scoring.weightIdentifier, category)\n                            ),\n                            processingRuleHelper.numberPresented(category)\n                        ),\n                        processingRuleHelper.baseValue(model.scoring.cutScore, baseTypeHelper.FLOAT)\n                    )\n                );\n\n                outcomeHelper.addOutcome(model, outcome, processingRule);\n            });\n        }\n    };\n\n    /**\n     * Checks if an outcome is related to the outcome processing,\n     * then returns the processing mode descriptor.\n     * @param {Object|String} outcome\n     * @returns {Object}\n     */\n    function getScoringMode(outcome) {\n        var identifier = outcomeHelper.getOutcomeIdentifier(outcome);\n        var mode = null;\n        _.forEach(processingModes, function (processingMode) {\n            if (processingMode.outcome === identifier || identifier.indexOf(processingMode.prefix) === 0) {\n                mode = processingMode;\n                return false;\n            }\n        });\n        return mode;\n    }\n\n    /**\n     * Checks if an outcome is related to the outcome processing\n     * @param {Object|String} outcome\n     * @returns {Boolean}\n     */\n    function isScoringOutcome(outcome) {\n        return !!getScoringMode(outcome);\n    }\n\n    /**\n     * Gets the score processing modes from a list of outcomes\n     * @param {Array} outcomes\n     * @returns {Array}\n     */\n    function listScoringModes(outcomes) {\n        var modes = {};\n        _.forEach(outcomes, function (outcomeDeclaration) {\n            var mode = getScoringMode(outcomeDeclaration);\n            if (mode) {\n                modes[mode.key] = true;\n            }\n        });\n        return _.keys(modes);\n    }\n\n    /**\n     * Gets the defined cut score from the outcome rules\n     * @param {Object} model\n     * @returns {Number}\n     */\n    function getCutScore(model) {\n        var values = _(outcomeHelper.getOutcomeProcessingRules(model)).map(function (outcome) {\n            return outcomeHelper.getProcessingRuleProperty(outcome, 'setOutcomeValue.gte.baseValue.value');\n        }).compact().uniq().value();\n        if (_.isEmpty(values)) {\n            values = [defaultCutScore];\n        }\n        return Math.max(0, _.max(values));\n    }\n\n    /**\n     * Gets the defined weight identifier from the outcome rules\n     * @param {Object} model\n     * @returns {String}\n     */\n    function getWeightIdentifier(model) {\n        var values = [];\n        outcomeHelper.eachOutcomeProcessingRuleExpressions(model, function (processingRule) {\n            if (processingRule['qti-type'] === 'testVariables' && processingRule.weightIdentifier) {\n                values.push(processingRule.weightIdentifier);\n            }\n        });\n        values = _(values).compact().uniq().value();\n\n        return values.length ? values[0] : '';\n    }\n\n    /**\n     * Detects the outcome processing mode of the scoring\n     * @param {Object} model\n     */\n    function detectScoring(model) {\n        var outcomeDeclarations = outcomeHelper.getOutcomeDeclarations(model);\n        var outcomeRules = outcomeHelper.getOutcomeProcessingRules(model);\n\n        // walk through each outcome declaration, and tries to identify the score processing mode\n        var declarations = listScoringModes(outcomeDeclarations);\n        var processing = listScoringModes(outcomeRules);\n        var diff = _.difference(declarations, processing);\n        var count = _.size(declarations);\n\n        // default fallback, applied when several modes are detected at the same time\n        var outcomeProcessing = 'custom';\n\n        // set the score processing mode with respect to the found outcomes\n        if (count === _.size(processing)) {\n            if (!count) {\n                // no mode detected, set the mode to none\n                outcomeProcessing = 'none';\n            } else if (count === 1 && _.isEmpty(diff)) {\n                // single mode detected, keep the last got key\n                outcomeProcessing = processing[0];\n            }\n        }\n\n        model.scoring = {\n            modes: processingModes,\n            scoreIdentifier: 'SCORE',\n            weightIdentifier: getWeightIdentifier(model),\n            cutScore: getCutScore(model),\n            outcomeProcessing: outcomeProcessing\n        };\n    }\n\n    /**\n     * Removes all outcome processing outcome variables\n     * @param {Object} model\n     */\n    function removeScoring(model) {\n        var scoringOutcomes = outcomeHelper.listOutcomes(model, isScoringOutcome);\n        outcomeHelper.removeOutcomes(model, scoringOutcomes);\n    }\n\n    /**\n     * Set the outcome processing outcome variables according to the chosen score processing mode\n     * @param {Object} model\n     */\n    function setScoring(model) {\n        var processingModeWriter;\n        var scoring = model.scoring;\n\n        // write the outcomes only if the mode has been set\n        if (scoring) {\n            processingModeWriter = processingModeWriters[scoring.outcomeProcessing];\n\n            if (processingModeWriter) {\n                processingModeWriter(model);\n            } else {\n                throw new Error('Unknown score processing mode: ' + scoring.outcomeProcessing);\n            }\n        }\n    }\n\n    return {\n        /**\n         * Checks the test model against outcome processing mode.\n         * Initializes the scoring property accordingly.\n         *\n         * @param {Object} model\n         */\n        read: function read(model) {\n            // detect the score processing mode and build the descriptor used to manage the UI\n            detectScoring(model);\n        },\n\n        /**\n         * If the processing mode has been set, generates the outcomes that define the scoring.\n         *\n         * @param {Object} model\n         */\n        write: function write(model) {\n            // write the score processing mode by generating the outcomes variables\n            setScoring(model);\n        }\n    };\n});\n\n","/**\n * This program is free software; you can redistribute it and/or\n * modify it under the terms of the GNU General Public License\n * as published by the Free Software Foundation; under version 2\n * of the License (non-upgradable).\n *\n * This program is distributed in the hope that it will be useful,\n * but WITHOUT ANY WARRANTY; without even the implied warranty of\n * MERCHANTABILITY or FITNESS FOR A PARTICULAR PURPOSE.  See the\n * GNU General Public License for more details.\n *\n * You should have received a copy of the GNU General Public License\n * along with this program; if not, write to the Free Software\n * Foundation, Inc., 51 Franklin Street, Fifth Floor, Boston, MA  02110-1301, USA.\n *\n * Copyright (c) 2014 (original work) Open Assessment Technologies SA (under the project TAO-PRODUCT);\n */\n/**\n * @author Bertrand Chevrier <bertrand@taotesting.com>\n */\ndefine('taoQtiTest/controller/creator/creator',[\n    'module',\n    'jquery',\n    'lodash',\n    'helpers',\n    'i18n',\n    'html5-history-api',\n    'ui/feedback',\n    'core/databindcontroller',\n    'taoQtiTest/controller/creator/views/item',\n    'taoQtiTest/controller/creator/views/test',\n    'taoQtiTest/controller/creator/views/testpart',\n    'taoQtiTest/controller/creator/views/section',\n    'taoQtiTest/controller/creator/views/itemref',\n    'taoQtiTest/controller/creator/encoders/dom2qti',\n    'taoQtiTest/controller/creator/templates/index',\n    'taoQtiTest/controller/creator/helpers/qtiTest',\n    'taoQtiTest/controller/creator/helpers/scoring',\n    'core/validator/validators',\n    'core/promise'\n], function(\n    module,\n    $,\n    _,\n    helpers,\n    __,\n    history,\n    feedback,\n    DataBindController,\n    itemView, testView,\n    testPartView,\n    sectionView,\n    itemrefView,\n    Dom2QtiEncoder,\n    templates,\n    qtiTestHelper,\n    scoringHelper,\n    validators,\n    Promise\n    ){\n\n    'use strict';\n\n    /**\n     * Call the server to get the list of items\n     * @param {string} url\n     * @param {string} search - a posix pattern to filter items\n     * @returns {Promise}\n     */\n    var loadItems = function loadItems(url, search){\n        return new Promise( function(resolve, reject){\n            $.getJSON(url, {pattern : search, notempty : 'true'})\n                .done(resolve)\n                .fail(function(xhr){\n                    return reject(new Error(xhr.status + ' : ' + xhr.statusText));\n                });\n        });\n    };\n\n    /**\n     * Call the server to get the items categories\n     * @param {String} url - the endpoint\n     * @param {String[]} items - the list of items URIs\n     * @returns {Promise}\n     */\n    var getCategories = function getCategories(url, items){\n        return new Promise( function(resolve, reject){\n            if(items && items.length){\n                $.getJSON(url, { uris : items })\n                    .done(resolve)\n                    .fail(function(xhr){\n                        return reject(new Error(xhr.status + ' : ' + xhr.statusText));\n                    });\n            }\n        });\n    };\n\n    /**\n     * The test creator controller is the main entry point\n     * and orchestrates data retrieval and view/components loading.\n     * @exports creator/controller\n     */\n    var Controller = {\n\n        routes : {},\n\n        identifiers: [],\n\n         /**\n          * Start the controller, main entry method.\n          * @public\n          * @param {Object} options\n          * @param {Object} options.labels - the list of item's labels to give to the ItemView\n          * @param {Object} options.routes - action's urls\n          */\n        start : function(options){\n            var self = this;\n            var $container = $('#test-creator');\n            var $saver = $('#saver');\n            var binder, binderOptions;\n\n            self.identifiers = [];\n\n            options = _.merge(module.config(), options || {});\n            options.routes = options.routes || {};\n            options.labels = options.labels || {};\n\n\n            //back button\n            $('#authoringBack').on('click', function(e){\n                e.preventDefault();\n\n                if (history) {\n                    history.back();\n                }\n            });\n\n            //set up the ItemView, give it a configured loadItems ref\n            itemView(\n                _.partial(loadItems, options.routes.items),\n                _.partial(getCategories, options.routes.categories)\n            );\n\n            //Print data binder chandes for DEBUGGING ONLY\n            //$container.on('change.binder', function(e, model){\n                //if(e.namespace === 'binder'){\n                    //console.log(model);\n                //}\n            //});\n\n            //Data Binding options\n            binderOptions = _.merge(options.routes, {\n                filters : {\n                    'isItemRef' : function(value){\n                        return qtiTestHelper.filterQtiType(value, 'assessmentItemRef');\n                    },\n                    'isSection' : function(value){\n                        return qtiTestHelper.filterQtiType(value, 'assessmentSection');\n                    }\n                },\n                encoders : {\n                    'dom2qti' : Dom2QtiEncoder\n                },\n                templates : templates,\n                beforeSave : function(model){\n                    //generate the outcomes that define the scoring\n                    scoringHelper.write(model);\n\n                    //ensure the qti-type is present\n                    qtiTestHelper.addMissingQtiType(model);\n\n                    //apply consolidation rules\n                    qtiTestHelper.consolidateModel(model);\n                    return true;\n                }\n            });\n\n            //set up the databinder\n            binder = DataBindController\n                .takeControl($container, binderOptions)\n                .get(function(model){\n                    //detect the scoring mode\n                    scoringHelper.read(model);\n\n                    //extract ids\n                    self.identifiers = qtiTestHelper.extractIdentifiers(model);\n\n                    //register validators\n                    validators.register('idFormat', qtiTestHelper.idFormatValidator());\n                    validators.register('testIdFormat', qtiTestHelper.testidFormatValidator());\n                    validators.register('testIdAvailable', qtiTestHelper.idAvailableValidator(self.identifiers), true);\n\n                    //once model is loaded, we set up the test view\n                    testView(model, {\n                        uri : options.uri,\n                        identifiers : self.identifiers,\n                        labels : options.labels,\n                        routes : options.routes\n                    });\n\n                    //listen for changes to update available actions\n                    testPartView.listenActionState();\n                    sectionView.listenActionState();\n                    itemrefView.listenActionState();\n                    itemrefView.resize();\n\n                    $(window)\n                      .off('resize.qti-test-creator')\n                      .on('resize.qti-test-creator', function(){\n                          itemrefView.resize();\n                      });\n                });\n\n            //the save button triggers binder's save action.\n            $saver.on('click', function(event){\n                event.preventDefault();\n\n                if(!$saver.hasClass('disabled')){\n                    $saver.attr('disabled', true).addClass('disabled');\n                    binder.save(function(){\n\n                        $saver.attr('disabled', false).removeClass('disabled');\n\n                        feedback().success(__('Test Saved'));\n\n                    }, function(){\n\n                        $saver.attr('disabled', false).removeClass('disabled');\n                    });\n                }\n            });\n        }\n    };\n\n    return Controller;\n});\n\n","/*\n * This program is free software; you can redistribute it and/or\n * modify it under the terms of the GNU General Public License\n * as published by the Free Software Foundation; under version 2\n * of the License (non-upgradable).\n *\n * This program is distributed in the hope that it will be useful,\n * but WITHOUT ANY WARRANTY; without even the implied warranty of\n * MERCHANTABILITY or FITNESS FOR A PARTICULAR PURPOSE.  See the\n * GNU General Public License for more details.\n *\n * You should have received a copy of the GNU General Public License\n * along with this program; if not, write to the Free Software\n * Foundation, Inc., 51 Franklin Street, Fifth Floor, Boston, MA  02110-1301, USA.\n *\n * Copyright (c) 2015 (original work) Open Assessment Technologies SA ;\n *\n */\n\n/**\n * This module allows adding extra buttons in the action bar of the test runner\n *\n */\ndefine('taoQtiTest/testRunner/actionBarHook',[\n    'jquery',\n    'lodash',\n    'core/errorHandler',\n    'core/promise'\n], function ($, _, errorHandler, Promise) {\n\n    'use strict';\n\n    /**\n     * Events namespace\n     * @type {String}\n     * @private\n     */\n    var _ns = '.actionBarHook';\n\n    /**\n     * We need to access the root document to listen for some events\n     * @type {jQuery}\n     * @private\n     */\n    var $doc = $(document);\n\n    /**\n     * List of loaded and visible hooks\n     * @type {Object}\n     * @private\n     */\n    var tools = {};\n\n    /**\n     * Flag set to true when the item is loaded\n     * @type {Boolean}\n     * @private\n     */\n    var itemIsLoaded = false;\n\n    // catch the item loaded event\n    $doc.off(_ns).on('serviceloaded' + _ns, function() {\n        itemIsLoaded = true;\n        _.forEach(tools, function(tool) {\n            triggerItemLoaded(tool);\n        });\n    });\n\n    /**\n     * Check that the toolConfig is correct\n     *\n     * @param {Object} toolconfig\n     * @param {String} toolconfig.hook - the amd module to be loaded to initialize the button\n     * @param {String} [toolconfig.label] - the label to be displayed in the button\n     * @param {String} [toolconfig.icon] - the icon to be displayed in the button\n     * @param {String} [toolconfig.title] - the title to be displayed in the button\n     * @param {Array} [toolconfig.items] - an optional list of menu items\n     * @returns {Boolean}\n     */\n    function isValidConfig(toolconfig) {\n        return !!(_.isObject(toolconfig) && toolconfig.hook);\n    }\n\n    /**\n     * Triggers the itemLoaded event inside the provided actionBar hook\n     * @param {Object} tool\n     */\n    function triggerItemLoaded(tool) {\n        if (tool && tool.itemLoaded) {\n            tool.itemLoaded();\n        }\n    }\n\n    /**\n     * Init a test runner button from its config\n     *\n     * @param {String} id\n     * @param {Object|String} toolconfig\n     * @param {String} toolconfig.hook - the amd module to be loaded to initialize the button\n     * @param {String} [toolconfig.label] - the label to be displayed in the button\n     * @param {String} [toolconfig.icon] - the icon to be displayed in the button\n     * @param {String} [toolconfig.title] - the title to be displayed in the button\n     * @param {Array} [toolconfig.items] - an optional list of menu items\n     * @param {Object} testContext - the complete state of the test\n     * @param {Object} testRunner - the test runner instance\n     * @fires ready.actionBarHook when the hook has been initialized\n     * @returns {Promise}\n     */\n    function initQtiTool($toolsContainer, id, toolconfig, testContext, testRunner) {\n\n        // the tool is always initialized before the item is loaded, so we can safely false the flag\n        itemIsLoaded = false;\n        tools[id] = null;\n\n        if (_.isString(toolconfig)) {\n            toolconfig = {\n                hook: toolconfig\n            };\n        }\n\n        return new Promise(function(resolve) {\n            if (isValidConfig(toolconfig)) {\n\n                require([toolconfig.hook], function (hook) {\n\n                    var $button;\n                    var $existingBtn;\n\n                    if (isValidHook(hook)) {\n                        //init the control\n                        hook.init(id, toolconfig, testContext, testRunner);\n\n                        //if an instance of the tool is already attached, remove it:\n                        $existingBtn = $toolsContainer.children('[data-control=\"' + id + '\"]');\n                        if ($existingBtn.length) {\n                            hook.clear($existingBtn);\n                            $existingBtn.remove();\n                        }\n\n                        //check if the tool is to be available\n                        if (hook.isVisible()) {\n                            //keep access to the tool\n                            tools[id] = hook;\n\n                            // renders the button from the config\n                            $button = hook.render();\n\n                            //only attach the button to the dom when everything is ready\n                            _appendInOrder($toolsContainer, $button);\n\n                            //ready !\n                            $button.trigger('ready' + _ns, [hook]);\n\n                            //fires the itemLoaded event if the item has already been loaded\n                            if (itemIsLoaded) {\n                                triggerItemLoaded(hook);\n                            }\n                        }\n\n                        resolve(hook);\n                    } else {\n                        errorHandler.throw(_ns, 'invalid hook format');\n                        resolve(null);\n                    }\n\n                }, function (e) {\n                    errorHandler.throw(_ns, 'the hook amd module cannot be found');\n                    resolve(null);\n                });\n\n            } else {\n                errorHandler.throw(_ns, 'invalid tool config format');\n                resolve(null);\n            }\n        });\n    }\n\n    /**\n     * Append a dom element $button to a $container in a specific order\n     * The orders are provided by data-order attribute set to the $button\n     *\n     * @param {JQuery} $container\n     * @param {JQuery} $button\n     */\n    function _appendInOrder($container, $button) {\n\n        var $after, $before;\n        var order = $button.data('order');\n\n        if ('last' === order) {\n\n            $container.append($button);\n\n        } else if ('first' === order) {\n\n            $container.prepend($button);\n\n        } else {\n\n            order = _.parseInt(order);\n            if (!_.isNaN(order)) {\n\n                $container.children('.action').each(function () {\n\n                    var $btn = $(this),\n                        _order = $btn.data('order');\n\n                    if ('last' === _order) {\n\n                        $before = $btn;\n                        $after = null;\n\n                    } else if ('first' === _order) {\n\n                        $before = null;\n                        $after = $btn;\n\n                    } else {\n\n                        _order = _.parseInt(_order);\n\n                        if (_.isNaN(_order) || _order > order) {\n                            $before = $btn;\n                            $after = null;\n                            //stops here because $container children returns the dom elements in the dom order\n                            return false;\n                        } else if (_order === order) {\n                            $after = $btn;\n                        } else if (_order < order) {\n                            $after = $btn;\n                            $before = null;\n                        }\n\n                    }\n\n                });\n\n                if ($after) {\n                    $after.after($button);\n                } else if ($before) {\n                    $before.before($button);\n                } else {\n                    $container.append($button);\n                }\n\n            } else {\n                //unordered buttons are append at the end (including when order equals 0)\n                $container.append($button);\n            }\n        }\n    }\n\n    /**\n     * Check if the hook object is valid\n     *\n     * @param {Object} hook\n     * @param {Function} hook.init\n     * @param {Function} hook.clear\n     * @param {Function} hook.isVisible\n     * @returns {Boolean}\n     */\n    function isValidHook(hook) {\n        return (_.isObject(hook) && _(['init', 'render', 'clear', 'isVisible']).reduce(function (result, method) {\n            return result && _.isFunction(hook[method]);\n        }, true));\n    }\n\n    return {\n        isValid: isValidConfig,\n        initQtiTool: initQtiTool\n    };\n});\n\n","/**\n * This program is free software; you can redistribute it and/or\n * modify it under the terms of the GNU General Public License\n * as published by the Free Software Foundation; under version 2\n * of the License (non-upgradable).\n *\n * This program is distributed in the hope that it will be useful,\n * but WITHOUT ANY WARRANTY; without even the implied warranty of\n * MERCHANTABILITY or FITNESS FOR A PARTICULAR PURPOSE.  See the\n * GNU General Public License for more details.\n *\n * You should have received a copy of the GNU General Public License\n * along with this program; if not, write to the Free Software\n * Foundation, Inc., 51 Franklin Street, Fifth Floor, Boston, MA  02110-1301, USA.\n *\n * Copyright (c) 2015 (original work) Open Assessment Technologies SA ;\n */\n/**\n * @author Jean-Sébastien Conan <jean-sebastien.conan@vesperiagroup.com>\n */\ndefine('taoQtiTest/testRunner/actionBarTools',[\n    'jquery',\n    'lodash',\n    'core/eventifier',\n    'core/promise',\n    'taoQtiTest/testRunner/actionBarHook'\n], function ($, _, eventifier, Promise, actionBarHook) {\n    'use strict';\n\n    /**\n     * The list of registered actionBar tools\n     * @type {Object}\n     */\n    var registeredQtiTools;\n\n    /**\n     * The list of actionBar tools instances\n     * @type {Object}\n     */\n    var qtiTools;\n\n    /**\n     * Manages the actionBar tools\n     * @type {Object}\n     */\n    var actionBarTools = {\n        /**\n         * Registers the actionBar tools\n         * @param {Object} tools\n         */\n        register : function register(tools) {\n            var registerTools = tools || {};\n\n            /**\n             * @event actionBarTools#beforeregister\n             * @param {Object} tools\n             * @param {actionBarTools} this\n             */\n            this.trigger('beforeregister', registerTools, this);\n\n            registeredQtiTools = registerTools;\n\n            /**\n             * @event actionBarTools#afterregister\n             * @param {Object} tools\n             * @param {actionBarTools} this\n             */\n            this.trigger('afterregister', registerTools, this);\n        },\n\n        /**\n         * Gets the list of registered tools\n         * @returns {Object}\n         */\n        getRegisteredTools : function getRegisteredTools() {\n            return registeredQtiTools || {};\n        },\n\n        /**\n         * Gets a particular tool config\n         * @param {String} id\n         * @returns {Object}\n         */\n        getRegistered : function getRegistered(id) {\n            return registeredQtiTools && registeredQtiTools[id];\n        },\n\n        /**\n         * Checks if a particular tool is registered\n         * @param {String} id\n         * @returns {Boolean}\n         */\n        isRegistered : function isRegistered(id) {\n            return !!(registeredQtiTools && registeredQtiTools[id]);\n        },\n\n        /**\n         * Gets a particular tool\n         * @param {String} id\n         * @returns {Object}\n         */\n        get : function get(id) {\n            return qtiTools && qtiTools[id];\n        },\n\n        /**\n         * Gets the list of tools instances\n         * @returns {Array}\n         */\n        list : function list() {\n            return _.values(qtiTools || {});\n        },\n\n        /**\n         * Renders the actionBar\n         * @param {String|jQuery|HTMLElement} container - The container in which renders the tools\n         * @param {Object} testContext - The assessment test context\n         * @param {Object} testRunner - The assessment test runner\n         * @param {Function} [callback] - An optional callback fired when all tools have been rendered\n         */\n        render : function render(container, testContext, testRunner, callback) {\n            var self = this;\n            var $container = $(container);\n            var promises = [];\n\n            /**\n             * @event actionBarTools#beforerender\n             * @param {jQuery} $container\n             * @param {Object} testContext\n             * @param {Object} testRunner\n             * @param {actionBarTools} this\n             */\n            this.trigger('beforerender', $container, testContext, testRunner, this);\n\n            _.forIn(this.getRegisteredTools(), function(toolconfig, id){\n                promises.push(actionBarHook.initQtiTool($container, id, toolconfig, testContext, testRunner));\n            });\n\n            Promise.all(promises).then(function(values) {\n                var tools = [];\n                qtiTools = {};\n\n                _.forEach(values, function(tool) {\n                    if (tool) {\n                        tools.push(tool);\n                        qtiTools[tool.getId()] = tool;\n                    }\n                });\n\n                if (_.isFunction(callback)) {\n                    callback.call(self, tools, $container, testContext, testRunner, self);\n                }\n\n                /**\n                 * @event actionBarTools#afterrender\n                 * @param {Array} tools\n                 * @param {jQuery} $container\n                 * @param {Object} testContext\n                 * @param {Object} testRunner\n                 * @param {actionBarTools} this\n                 */\n                self.trigger('afterrender', tools, $container, testContext, testRunner, self);\n            });\n        }\n    };\n\n    return eventifier(actionBarTools);\n});\n\n","\ndefine('tpl!taoQtiTest/testRunner/tpl/navigator', ['handlebars'], function(hb){ \nreturn hb.template(function (Handlebars,depth0,helpers,partials,data) {\n  this.compilerInfo = [4,'>= 1.0.0'];\nhelpers = this.merge(helpers, Handlebars.helpers); data = data || {};\n  var buffer = \"\", stack1, helper, options, functionType=\"function\", escapeExpression=this.escapeExpression, self=this, helperMissing=helpers.helperMissing;\n\nfunction program1(depth0,data) {\n  \n  \n  return \" hidden\";\n  }\n\n  buffer += \"        <aside class=\\\"test-sidebar test-sidebar-\";\n  if (helper = helpers.region) { stack1 = helper.call(depth0, {hash:{},data:data}); }\n  else { helper = (depth0 && depth0.region); stack1 = typeof helper === functionType ? helper.call(depth0, {hash:{},data:data}) : helper; }\n  buffer += escapeExpression(stack1)\n    + \" flex-container-navi qti-navigator\";\n  stack1 = helpers['if'].call(depth0, (depth0 && depth0.hidden), {hash:{},inverse:self.noop,fn:self.program(1, program1, data),data:data});\n  if(stack1 || stack1 === 0) { buffer += stack1; }\n  buffer += \"\\\">\\n            <div class=\\\"qti-navigator-collapsible\\\">\\n                <span class=\\\"qti-navigator-collapse icon icon-left\\\" title=\\\"\"\n    + escapeExpression((helper = helpers.__ || (depth0 && depth0.__),options={hash:{},data:data},helper ? helper.call(depth0, \"Collapse the review panel\", options) : helperMissing.call(depth0, \"__\", \"Collapse the review panel\", options)))\n    + \"\\\"></span>\\n                <span class=\\\"qti-navigator-expand icon icon-right\\\" title=\\\"\"\n    + escapeExpression((helper = helpers.__ || (depth0 && depth0.__),options={hash:{},data:data},helper ? helper.call(depth0, \"Expand the review panel\", options) : helperMissing.call(depth0, \"__\", \"Expand the review panel\", options)))\n    + \"\\\"></span>\\n            </div>\\n\\n            <div class=\\\"qti-navigator-info collapsible\\\">\\n                <span class=\\\"qti-navigator-label\\\">\\n                    <span class=\\\"qti-navigator-text\\\">\"\n    + escapeExpression((helper = helpers.__ || (depth0 && depth0.__),options={hash:{},data:data},helper ? helper.call(depth0, \"Test status\", options) : helperMissing.call(depth0, \"__\", \"Test status\", options)))\n    + \"</span>\\n                    <span class=\\\"icon-up\\\"></span>\\n                    <span class=\\\"icon-down\\\"></span>\\n                </span>\\n                <ul class=\\\"collapsible-panel plain\\\">\\n                    <li class=\\\"qti-navigator-viewed\\\" title=\\\"\"\n    + escapeExpression((helper = helpers.__ || (depth0 && depth0.__),options={hash:{},data:data},helper ? helper.call(depth0, \"Viewed items\", options) : helperMissing.call(depth0, \"__\", \"Viewed items\", options)))\n    + \"\\\">\\n                        <span class=\\\"qti-navigator-label\\\">\\n                            <span class=\\\"qti-navigator-icon icon-viewed\\\"></span>\\n                            <span class=\\\"qti-navigator-text\\\">\"\n    + escapeExpression((helper = helpers.__ || (depth0 && depth0.__),options={hash:{},data:data},helper ? helper.call(depth0, \"Viewed\", options) : helperMissing.call(depth0, \"__\", \"Viewed\", options)))\n    + \"</span>\\n                            <span class=\\\"qti-navigator-counter\\\">-/-</span>\\n                        </span>\\n                    </li>\\n                    <li class=\\\"qti-navigator-answered\\\" title=\\\"\"\n    + escapeExpression((helper = helpers.__ || (depth0 && depth0.__),options={hash:{},data:data},helper ? helper.call(depth0, \"Completed items\", options) : helperMissing.call(depth0, \"__\", \"Completed items\", options)))\n    + \"\\\">\\n                        <span class=\\\"qti-navigator-label\\\">\\n                            <span class=\\\"qti-navigator-icon icon-answered\\\"></span>\\n                            <span class=\\\"qti-navigator-text\\\">\"\n    + escapeExpression((helper = helpers.__ || (depth0 && depth0.__),options={hash:{},data:data},helper ? helper.call(depth0, \"Answered\", options) : helperMissing.call(depth0, \"__\", \"Answered\", options)))\n    + \"</span>\\n                            <span class=\\\"qti-navigator-counter\\\">-/-</span>\\n                        </span>\\n                    </li>\\n                    <li class=\\\"qti-navigator-unanswered\\\" title=\\\"\"\n    + escapeExpression((helper = helpers.__ || (depth0 && depth0.__),options={hash:{},data:data},helper ? helper.call(depth0, \"Unanswered items\", options) : helperMissing.call(depth0, \"__\", \"Unanswered items\", options)))\n    + \"\\\">\\n                        <span class=\\\"qti-navigator-label\\\">\\n                            <span class=\\\"qti-navigator-icon icon-unanswered\\\"></span>\\n                            <span class=\\\"qti-navigator-text\\\">\"\n    + escapeExpression((helper = helpers.__ || (depth0 && depth0.__),options={hash:{},data:data},helper ? helper.call(depth0, \"Unanswered\", options) : helperMissing.call(depth0, \"__\", \"Unanswered\", options)))\n    + \"</span>\\n                            <span class=\\\"qti-navigator-counter\\\">-/-</span>\\n                        </span>\\n                    </li>\\n                    <li class=\\\"qti-navigator-flagged\\\" title=\\\"\"\n    + escapeExpression((helper = helpers.__ || (depth0 && depth0.__),options={hash:{},data:data},helper ? helper.call(depth0, \"Items marked for later review\", options) : helperMissing.call(depth0, \"__\", \"Items marked for later review\", options)))\n    + \"\\\">\\n                        <span class=\\\"qti-navigator-label\\\">\\n                            <span class=\\\"qti-navigator-icon icon-flagged\\\"></span>\\n                            <span class=\\\"qti-navigator-text\\\">\"\n    + escapeExpression((helper = helpers.__ || (depth0 && depth0.__),options={hash:{},data:data},helper ? helper.call(depth0, \"Flagged\", options) : helperMissing.call(depth0, \"__\", \"Flagged\", options)))\n    + \"</span>\\n                            <span class=\\\"qti-navigator-counter\\\">-/-</span>\\n                        </span>\\n                    </li>\\n                </ul>\\n            </div>\\n\\n            <div class=\\\"qti-navigator-filters\\\">\\n                <ul class=\\\"plain clearfix\\\">\\n                    <li class=\\\"qti-navigator-filter active\\\" data-mode=\\\"all\\\">\\n                        <span title=\\\"\"\n    + escapeExpression((helper = helpers.__ || (depth0 && depth0.__),options={hash:{},data:data},helper ? helper.call(depth0, \"Reset filters\", options) : helperMissing.call(depth0, \"__\", \"Reset filters\", options)))\n    + \"\\\" class=\\\"qti-navigator-tab\\\">\"\n    + escapeExpression((helper = helpers.__ || (depth0 && depth0.__),options={hash:{},data:data},helper ? helper.call(depth0, \"All\", options) : helperMissing.call(depth0, \"__\", \"All\", options)))\n    + \"</span>\\n                    </li>\\n                    <li class=\\\"qti-navigator-filter\\\" data-mode=\\\"unanswered\\\">\\n                        <span class=\\\"icon-unanswered qti-navigator-tab\\\" title=\\\"\"\n    + escapeExpression((helper = helpers.__ || (depth0 && depth0.__),options={hash:{},data:data},helper ? helper.call(depth0, \"Only display the unanswered items\", options) : helperMissing.call(depth0, \"__\", \"Only display the unanswered items\", options)))\n    + \"\\\"></span>\\n                    </li>\\n                    <li class=\\\"qti-navigator-filter\\\" data-mode=\\\"flagged\\\">\\n                        <span class=\\\"icon-flagged qti-navigator-tab\\\" title=\\\"\"\n    + escapeExpression((helper = helpers.__ || (depth0 && depth0.__),options={hash:{},data:data},helper ? helper.call(depth0, \"Only display the items marked for review\", options) : helperMissing.call(depth0, \"__\", \"Only display the items marked for review\", options)))\n    + \"\\\"></span>\\n                    </li>\\n                </ul>\\n            </div>\\n\\n            <nav class=\\\"qti-navigator-tree\\\">\\n            </nav>\\n\\n            <div id=\\\"qti-navigator-linear\\\" class=\\\"qti-navigator-linear\\\">\\n                <span class=\\\"icon icon-info\\\" title=\\\"\"\n    + escapeExpression((helper = helpers.__ || (depth0 && depth0.__),options={hash:{},data:data},helper ? helper.call(depth0, \"In this part of the test navigation is not allowed.\", options) : helperMissing.call(depth0, \"__\", \"In this part of the test navigation is not allowed.\", options)))\n    + \"\\\"></span>\\n                <p class=\\\"qti-navigator-message\\\">\\n                    \"\n    + escapeExpression((helper = helpers.__ || (depth0 && depth0.__),options={hash:{},data:data},helper ? helper.call(depth0, \"In this part of the test navigation is not allowed.\", options) : helperMissing.call(depth0, \"__\", \"In this part of the test navigation is not allowed.\", options)))\n    + \"\\n                </p>\\n            </div>\\n        </aside>\\n\";\n  return buffer;\n  });\n});\n\n","\ndefine('tpl!taoQtiTest/testRunner/tpl/navigatorTree', ['handlebars'], function(hb){ \nreturn hb.template(function (Handlebars,depth0,helpers,partials,data) {\n  this.compilerInfo = [4,'>= 1.0.0'];\nhelpers = this.merge(helpers, Handlebars.helpers); data = data || {};\n  var buffer = \"\", stack1, self=this, functionType=\"function\", escapeExpression=this.escapeExpression, helperMissing=helpers.helperMissing;\n\nfunction program1(depth0,data) {\n  \n  var buffer = \"\", stack1, helper;\n  buffer += \"\\n                    <li class=\\\"qti-navigator-part collapsible \";\n  stack1 = helpers['if'].call(depth0, (depth0 && depth0.active), {hash:{},inverse:self.program(4, program4, data),fn:self.program(2, program2, data),data:data});\n  if(stack1 || stack1 === 0) { buffer += stack1; }\n  buffer += \"\\\" data-id=\\\"\";\n  if (helper = helpers.id) { stack1 = helper.call(depth0, {hash:{},data:data}); }\n  else { helper = (depth0 && depth0.id); stack1 = typeof helper === functionType ? helper.call(depth0, {hash:{},data:data}) : helper; }\n  buffer += escapeExpression(stack1)\n    + \"\\\">\\n                        <span class=\\\"qti-navigator-label\\\" title=\\\"\";\n  if (helper = helpers.label) { stack1 = helper.call(depth0, {hash:{},data:data}); }\n  else { helper = (depth0 && depth0.label); stack1 = typeof helper === functionType ? helper.call(depth0, {hash:{},data:data}) : helper; }\n  buffer += escapeExpression(stack1)\n    + \"\\\">\\n                            <span class=\\\"qti-navigator-text\\\">\";\n  if (helper = helpers.label) { stack1 = helper.call(depth0, {hash:{},data:data}); }\n  else { helper = (depth0 && depth0.label); stack1 = typeof helper === functionType ? helper.call(depth0, {hash:{},data:data}) : helper; }\n  buffer += escapeExpression(stack1)\n    + \"</span>\\n                            <span class=\\\"icon-up\\\"></span>\\n                            <span class=\\\"icon-down\\\"></span>\\n                        </span>\\n                        \";\n  stack1 = helpers['if'].call(depth0, ((stack1 = (depth0 && depth0.sections)),stack1 == null || stack1 === false ? stack1 : stack1.length), {hash:{},inverse:self.program(29, program29, data),fn:self.program(6, program6, data),data:data});\n  if(stack1 || stack1 === 0) { buffer += stack1; }\n  buffer += \"\\n                    </li>\\n                    \";\n  return buffer;\n  }\nfunction program2(depth0,data) {\n  \n  \n  return \"active\";\n  }\n\nfunction program4(depth0,data) {\n  \n  \n  return \"collapsed\";\n  }\n\nfunction program6(depth0,data) {\n  \n  var buffer = \"\", stack1;\n  buffer += \"\\n                        <ul class=\\\"qti-navigator-sections collapsible-panel plain\\\">\\n                            \";\n  stack1 = helpers.each.call(depth0, (depth0 && depth0.sections), {hash:{},inverse:self.noop,fn:self.program(7, program7, data),data:data});\n  if(stack1 || stack1 === 0) { buffer += stack1; }\n  buffer += \"\\n                        </ul>\\n                        \";\n  return buffer;\n  }\nfunction program7(depth0,data) {\n  \n  var buffer = \"\", stack1, helper;\n  buffer += \"\\n                            <li class=\\\"qti-navigator-section collapsible \";\n  stack1 = helpers['if'].call(depth0, (depth0 && depth0.active), {hash:{},inverse:self.program(4, program4, data),fn:self.program(2, program2, data),data:data});\n  if(stack1 || stack1 === 0) { buffer += stack1; }\n  buffer += \"\\\" data-id=\\\"\";\n  if (helper = helpers.id) { stack1 = helper.call(depth0, {hash:{},data:data}); }\n  else { helper = (depth0 && depth0.id); stack1 = typeof helper === functionType ? helper.call(depth0, {hash:{},data:data}) : helper; }\n  buffer += escapeExpression(stack1)\n    + \"\\\">\\n                                <span class=\\\"qti-navigator-label\\\" title=\\\"\";\n  if (helper = helpers.label) { stack1 = helper.call(depth0, {hash:{},data:data}); }\n  else { helper = (depth0 && depth0.label); stack1 = typeof helper === functionType ? helper.call(depth0, {hash:{},data:data}) : helper; }\n  buffer += escapeExpression(stack1)\n    + \"\\\">\\n                                    <span class=\\\"qti-navigator-text\\\">\";\n  if (helper = helpers.label) { stack1 = helper.call(depth0, {hash:{},data:data}); }\n  else { helper = (depth0 && depth0.label); stack1 = typeof helper === functionType ? helper.call(depth0, {hash:{},data:data}) : helper; }\n  buffer += escapeExpression(stack1)\n    + \"</span>\\n                                    <span class=\\\"qti-navigator-counter\\\">\";\n  if (helper = helpers.answered) { stack1 = helper.call(depth0, {hash:{},data:data}); }\n  else { helper = (depth0 && depth0.answered); stack1 = typeof helper === functionType ? helper.call(depth0, {hash:{},data:data}) : helper; }\n  buffer += escapeExpression(stack1)\n    + \"/\"\n    + escapeExpression(((stack1 = ((stack1 = (depth0 && depth0.items)),stack1 == null || stack1 === false ? stack1 : stack1.length)),typeof stack1 === functionType ? stack1.apply(depth0) : stack1))\n    + \"</span>\\n                                </span>\\n                                <ul class=\\\"qti-navigator-items collapsible-panel plain\\\">\\n                                    \";\n  stack1 = helpers.each.call(depth0, (depth0 && depth0.items), {hash:{},inverse:self.noop,fn:self.program(8, program8, data),data:data});\n  if(stack1 || stack1 === 0) { buffer += stack1; }\n  buffer += \"\\n                                </ul>\\n                            </li>\\n                            \";\n  return buffer;\n  }\nfunction program8(depth0,data) {\n  \n  var buffer = \"\", stack1, helper;\n  buffer += \"\\n                                    <li class=\\\"qti-navigator-item\";\n  stack1 = helpers['if'].call(depth0, (depth0 && depth0.active), {hash:{},inverse:self.noop,fn:self.program(9, program9, data),data:data});\n  if(stack1 || stack1 === 0) { buffer += stack1; }\n  stack1 = helpers['if'].call(depth0, (depth0 && depth0.flagged), {hash:{},inverse:self.noop,fn:self.program(11, program11, data),data:data});\n  if(stack1 || stack1 === 0) { buffer += stack1; }\n  stack1 = helpers['if'].call(depth0, (depth0 && depth0.answered), {hash:{},inverse:self.noop,fn:self.program(13, program13, data),data:data});\n  if(stack1 || stack1 === 0) { buffer += stack1; }\n  stack1 = helpers['if'].call(depth0, (depth0 && depth0.viewed), {hash:{},inverse:self.program(17, program17, data),fn:self.program(15, program15, data),data:data});\n  if(stack1 || stack1 === 0) { buffer += stack1; }\n  buffer += \"\\\" data-id=\\\"\";\n  if (helper = helpers.id) { stack1 = helper.call(depth0, {hash:{},data:data}); }\n  else { helper = (depth0 && depth0.id); stack1 = typeof helper === functionType ? helper.call(depth0, {hash:{},data:data}) : helper; }\n  buffer += escapeExpression(stack1)\n    + \"\\\" data-position=\\\"\";\n  if (helper = helpers.position) { stack1 = helper.call(depth0, {hash:{},data:data}); }\n  else { helper = (depth0 && depth0.position); stack1 = typeof helper === functionType ? helper.call(depth0, {hash:{},data:data}) : helper; }\n  buffer += escapeExpression(stack1)\n    + \"\\\">\\n                                        <span class=\\\"qti-navigator-label truncate\\\" title=\\\"\";\n  if (helper = helpers.label) { stack1 = helper.call(depth0, {hash:{},data:data}); }\n  else { helper = (depth0 && depth0.label); stack1 = typeof helper === functionType ? helper.call(depth0, {hash:{},data:data}) : helper; }\n  buffer += escapeExpression(stack1)\n    + \"\\\">\\n                                            <span class=\\\"qti-navigator-icon icon-\";\n  stack1 = helpers['if'].call(depth0, (depth0 && depth0.flagged), {hash:{},inverse:self.program(21, program21, data),fn:self.program(19, program19, data),data:data});\n  if(stack1 || stack1 === 0) { buffer += stack1; }\n  buffer += \"\\\"></span>\\n                                            <span class=\\\"qti-navigator-number\\\">\"\n    + escapeExpression(((stack1 = (data == null || data === false ? data : data.index)),typeof stack1 === functionType ? stack1.apply(depth0) : stack1))\n    + \"</span>\\n                                            \";\n  if (helper = helpers.label) { stack1 = helper.call(depth0, {hash:{},data:data}); }\n  else { helper = (depth0 && depth0.label); stack1 = typeof helper === functionType ? helper.call(depth0, {hash:{},data:data}) : helper; }\n  buffer += escapeExpression(stack1)\n    + \"\\n                                        </span>\\n                                    </li>\\n                                    \";\n  return buffer;\n  }\nfunction program9(depth0,data) {\n  \n  \n  return \" active\";\n  }\n\nfunction program11(depth0,data) {\n  \n  \n  return \" flagged\";\n  }\n\nfunction program13(depth0,data) {\n  \n  \n  return \" answered\";\n  }\n\nfunction program15(depth0,data) {\n  \n  \n  return \" viewed\";\n  }\n\nfunction program17(depth0,data) {\n  \n  \n  return \" unseen\";\n  }\n\nfunction program19(depth0,data) {\n  \n  \n  return \"flagged\";\n  }\n\nfunction program21(depth0,data) {\n  \n  var stack1;\n  stack1 = helpers['if'].call(depth0, (depth0 && depth0.answered), {hash:{},inverse:self.program(24, program24, data),fn:self.program(22, program22, data),data:data});\n  if(stack1 || stack1 === 0) { return stack1; }\n  else { return ''; }\n  }\nfunction program22(depth0,data) {\n  \n  \n  return \"answered\";\n  }\n\nfunction program24(depth0,data) {\n  \n  var stack1;\n  stack1 = helpers['if'].call(depth0, (depth0 && depth0.viewed), {hash:{},inverse:self.program(27, program27, data),fn:self.program(25, program25, data),data:data});\n  if(stack1 || stack1 === 0) { return stack1; }\n  else { return ''; }\n  }\nfunction program25(depth0,data) {\n  \n  \n  return \"viewed\";\n  }\n\nfunction program27(depth0,data) {\n  \n  \n  return \"unseen\";\n  }\n\nfunction program29(depth0,data) {\n  \n  var buffer = \"\", stack1, helper, options;\n  buffer += \"\\n                        <div class=\\\"qti-navigator-linear-part collapsible-panel\\\">\\n                            <span class=\\\"icon icon-info\\\" title=\\\"\"\n    + escapeExpression((helper = helpers.__ || (depth0 && depth0.__),options={hash:{},data:data},helper ? helper.call(depth0, \"In this part of the test navigation is not allowed.\", options) : helperMissing.call(depth0, \"__\", \"In this part of the test navigation is not allowed.\", options)))\n    + \"\\\"></span>\\n                            <p class=\\\"qti-navigator-message\\\">\\n                                \"\n    + escapeExpression((helper = helpers.__ || (depth0 && depth0.__),options={hash:{},data:data},helper ? helper.call(depth0, \"In this part of the test navigation is not allowed.\", options) : helperMissing.call(depth0, \"__\", \"In this part of the test navigation is not allowed.\", options)))\n    + \"\\n                            </p>\\n                            <p class=\\\"qti-navigator-actions\\\">\\n                                <button class=\\\"btn-info small\\\" data-id=\\\"\";\n  if (helper = helpers.itemId) { stack1 = helper.call(depth0, {hash:{},data:data}); }\n  else { helper = (depth0 && depth0.itemId); stack1 = typeof helper === functionType ? helper.call(depth0, {hash:{},data:data}) : helper; }\n  buffer += escapeExpression(stack1)\n    + \"\\\" data-position=\\\"\";\n  if (helper = helpers.position) { stack1 = helper.call(depth0, {hash:{},data:data}); }\n  else { helper = (depth0 && depth0.position); stack1 = typeof helper === functionType ? helper.call(depth0, {hash:{},data:data}) : helper; }\n  buffer += escapeExpression(stack1)\n    + \"\\\" title=\\\"\"\n    + escapeExpression((helper = helpers.__ || (depth0 && depth0.__),options={hash:{},data:data},helper ? helper.call(depth0, \"Start Test-part\", options) : helperMissing.call(depth0, \"__\", \"Start Test-part\", options)))\n    + \"\\\">\\n                                    <span class=\\\"qti-navigator-text\\\">\"\n    + escapeExpression((helper = helpers.__ || (depth0 && depth0.__),options={hash:{},data:data},helper ? helper.call(depth0, \"Start Test-part\", options) : helperMissing.call(depth0, \"__\", \"Start Test-part\", options)))\n    + \"</span>\\n                                    <span class=\\\"icon-play r\\\"></span>\\n                                </button>\\n                            </p>\\n                        </div>\\n                        \";\n  return buffer;\n  }\n\n  buffer += \"                <ul class=\\\"qti-navigator-parts plain\\\">\\n                    \";\n  stack1 = helpers.each.call(depth0, (depth0 && depth0.parts), {hash:{},inverse:self.noop,fn:self.program(1, program1, data),data:data});\n  if(stack1 || stack1 === 0) { buffer += stack1; }\n  buffer += \"\\n                </ul>\\n\";\n  return buffer;\n  });\n});\n\n","/**\n * This program is free software; you can redistribute it and/or\n * modify it under the terms of the GNU General Public License\n * as published by the Free Software Foundation; under version 2\n * of the License (non-upgradable).\n *\n * This program is distributed in the hope that it will be useful,\n * but WITHOUT ANY WARRANTY; without even the implied warranty of\n * MERCHANTABILITY or FITNESS FOR A PARTICULAR PURPOSE.  See the\n * GNU General Public License for more details.\n *\n * You should have received a copy of the GNU General Public License\n * along with this program; if not, write to the Free Software\n * Foundation, Inc., 51 Franklin Street, Fifth Floor, Boston, MA  02110-1301, USA.\n *\n * Copyright (c) 2015 (original work) Open Assessment Technologies SA ;\n */\n/**\n * @author Jean-Sébastien Conan <jean-sebastien.conan@vesperiagroup.com>\n */\ndefine('taoQtiTest/testRunner/testReview',[\n    'jquery',\n    'lodash',\n    'i18n',\n    'tpl!taoQtiTest/testRunner/tpl/navigator',\n    'tpl!taoQtiTest/testRunner/tpl/navigatorTree',\n    'util/capitalize'\n], function ($, _, __, navigatorTpl, navigatorTreeTpl, capitalize) {\n    'use strict';\n\n    /**\n     * List of CSS classes\n     * @type {Object}\n     * @private\n     */\n    var _cssCls = {\n        active : 'active',\n        collapsed : 'collapsed',\n        collapsible : 'collapsible',\n        hidden : 'hidden',\n        disabled : 'disabled',\n        flagged : 'flagged',\n        answered : 'answered',\n        viewed : 'viewed',\n        unseen : 'unseen',\n        icon : 'qti-navigator-icon',\n        scope : {\n            test : 'scope-test',\n            testPart : 'scope-test-part',\n            testSection : 'scope-test-section'\n        }\n    };\n\n    /**\n     * List of common CSS selectors\n     * @type {Object}\n     * @private\n     */\n    var _selectors = {\n        component : '.qti-navigator',\n        filterBar : '.qti-navigator-filters',\n        tree : '.qti-navigator-tree',\n        collapseHandle : '.qti-navigator-collapsible',\n        linearState : '.qti-navigator-linear',\n        infoAnswered : '.qti-navigator-answered .qti-navigator-counter',\n        infoViewed : '.qti-navigator-viewed .qti-navigator-counter',\n        infoUnanswered : '.qti-navigator-unanswered .qti-navigator-counter',\n        infoFlagged : '.qti-navigator-flagged .qti-navigator-counter',\n        infoPanel : '.qti-navigator-info',\n        infoPanelLabels : '.qti-navigator-info > .qti-navigator-label',\n        parts : '.qti-navigator-part',\n        partLabels : '.qti-navigator-part > .qti-navigator-label',\n        sections : '.qti-navigator-section',\n        sectionLabels : '.qti-navigator-section > .qti-navigator-label',\n        items : '.qti-navigator-item',\n        itemLabels : '.qti-navigator-item > .qti-navigator-label',\n        itemIcons : '.qti-navigator-item > .qti-navigator-icon',\n        icons : '.qti-navigator-icon',\n        linearStart : '.qti-navigator-linear-part button',\n        counters : '.qti-navigator-counter',\n        actives : '.active',\n        collapsible : '.collapsible',\n        collapsiblePanels : '.collapsible-panel',\n        unseen : '.unseen',\n        answered : '.answered',\n        flagged : '.flagged',\n        notFlagged : ':not(.flagged)',\n        notAnswered : ':not(.answered)',\n        hidden : '.hidden'\n    };\n\n    /**\n     * Maps the filter mode to filter criteria.\n     * Each filter criteria is a CSS selector used to find and mask the items to be discarded by the filter.\n     * @type {Object}\n     * @private\n     */\n    var _filterMap = {\n        all : \"\",\n        unanswered : _selectors.answered,\n        flagged : _selectors.notFlagged,\n        answered : _selectors.notAnswered,\n        filtered : _selectors.hidden\n    };\n\n    /**\n     * Maps of config options translated from the context object to the local options\n     * @type {Object}\n     * @private\n     */\n    var _optionsMap = {\n        'reviewScope' : 'reviewScope',\n        'reviewPreventsUnseen' : 'preventsUnseen',\n        'canCollapse' : 'canCollapse'\n    };\n\n    /**\n     * Maps the handled review scopes\n     * @type {Object}\n     * @private\n     */\n    var _reviewScopes = {\n        test : 'test',\n        testPart : 'testPart',\n        testSection : 'testSection'\n    };\n\n    /**\n     * Provides a test review manager\n     * @type {Object}\n     */\n    var testReview = {\n        /**\n         * Initializes the component\n         * @param {String|jQuery|HTMLElement} element The element on which install the component\n         * @param {Object} [options] A list of extra options\n         * @param {String} [options.region] The region on which put the component: left or right\n         * @param {String} [options.reviewScope] Limit the review screen to a particular scope:\n         * the whole test, the current test part or the current test section)\n         * @param {Boolean} [options.preventsUnseen] Prevents the test taker to access unseen items\n         * @returns {testReview}\n         */\n        init: function init(element, options) {\n            var initOptions = _.isObject(options) && options || {};\n            var putOnRight = 'right' === initOptions.region;\n            var insertMethod = putOnRight ? 'append' : 'prepend';\n\n            this.options = initOptions;\n            this.disabled = false;\n            this.hidden = !!initOptions.hidden;\n            this.currentFilter = 'all';\n\n            // clean the DOM if the init method is called after initialisation\n            if (this.$component) {\n                this.$component.remove();\n            }\n\n            // build the component structure and inject it into the DOM\n            this.$container = $(element);\n            insertMethod = this.$container[insertMethod];\n            if (insertMethod) {\n                insertMethod.call(this.$container, navigatorTpl({\n                    region: putOnRight ? 'right' : 'left',\n                    hidden: this.hidden\n                }));\n            } else {\n                throw new Error(\"Unable to inject the component structure into the DOM\");\n            }\n\n            // install the component behaviour\n            this._loadDOM();\n            this._initEvents();\n            this._updateDisplayOptions();\n\n            return this;\n        },\n\n        /**\n         * Links the component to the underlying DOM elements\n         * @private\n         */\n        _loadDOM: function() {\n            this.$component = this.$container.find(_selectors.component);\n\n            // access to info panel displaying counters\n            this.$infoAnswered = this.$component.find(_selectors.infoAnswered);\n            this.$infoViewed = this.$component.find(_selectors.infoViewed);\n            this.$infoUnanswered = this.$component.find(_selectors.infoUnanswered);\n            this.$infoFlagged = this.$component.find(_selectors.infoFlagged);\n\n            // access to filter switches\n            this.$filterBar = this.$component.find(_selectors.filterBar);\n            this.$filters = this.$filterBar.find('li');\n\n            // access to the tree of parts/sections/items\n            this.$tree = this.$component.find(_selectors.tree);\n\n            // access to the panel displayed when a linear part is reached\n            this.$linearState = this.$component.find(_selectors.linearState);\n        },\n\n        /**\n         * Installs the event handlers on the underlying DOM elements\n         * @private\n         */\n        _initEvents: function() {\n            var self = this;\n\n            // click on the collapse handle: collapse/expand the review panel\n            this.$component.on('click' + _selectors.component, _selectors.collapseHandle, function() {\n                if (self.disabled) {\n                    return;\n                }\n\n                self.$component.toggleClass(_cssCls.collapsed);\n                if (self.$component.hasClass(_cssCls.collapsed)) {\n                    self._openSelected();\n                }\n            });\n\n            // click on the info panel title: toggle the related panel\n            this.$component.on('click' + _selectors.component, _selectors.infoPanelLabels, function() {\n                if (self.disabled) {\n                    return;\n                }\n\n                var $panel = $(this).closest(_selectors.infoPanel);\n                self._togglePanel($panel, _selectors.infoPanel);\n            });\n\n            // click on a part title: toggle the related panel\n            this.$tree.on('click' + _selectors.component, _selectors.partLabels, function() {\n                if (self.disabled) {\n                    return;\n                }\n\n                var $panel = $(this).closest(_selectors.parts);\n                var open = self._togglePanel($panel, _selectors.parts);\n\n                if (open) {\n                    if ($panel.hasClass(_cssCls.active)) {\n                        self._openSelected();\n                    } else {\n                        self._openOnly($panel.find(_selectors.sections).first(), $panel);\n                    }\n                }\n            });\n\n            // click on a section title: toggle the related panel\n            this.$tree.on('click' + _selectors.component, _selectors.sectionLabels, function() {\n                if (self.disabled) {\n                    return;\n                }\n\n                var $panel = $(this).closest(_selectors.sections);\n\n                self._togglePanel($panel, _selectors.sections);\n            });\n\n            // click on an item: jump to the position\n            this.$tree.on('click' + _selectors.component, _selectors.itemLabels, function(event) {\n                if (self.disabled) {\n                    return;\n                }\n\n                var $item = $(this).closest(_selectors.items);\n                var $target;\n\n                if (!$item.hasClass(_cssCls.disabled)) {\n                    $target = $(event.target);\n                    if ($target.is(_selectors.icons) && !self.$component.hasClass(_cssCls.collapsed)) {\n                        if (!$item.hasClass(_cssCls.unseen)) {\n                            self._mark($item);\n                        }\n                    } else {\n                        self._select($item);\n                        self._jump($item);\n                    }\n                }\n            });\n\n            // click on the start button inside a linear part: jump to the position\n            this.$tree.on('click' + _selectors.component, _selectors.linearStart, function() {\n                if (self.disabled) {\n                    return;\n                }\n\n                var $btn = $(this);\n\n                if (!$btn.hasClass(_cssCls.disabled)) {\n                    $btn.addClass(_cssCls.disabled);\n                    self._jump($btn);\n                }\n            });\n\n            // click on a filter button\n            this.$filterBar.on('click' + _selectors.component, 'li', function() {\n                if (self.disabled) {\n                    return;\n                }\n\n                var $btn = $(this);\n                var mode = $btn.data('mode');\n\n                self.$filters.removeClass(_cssCls.active);\n                self.$component.removeClass(_cssCls.collapsed);\n                $btn.addClass(_cssCls.active);\n\n                self._filter(mode);\n            });\n        },\n\n        /**\n         * Filters the items by a criteria\n         * @param {String} criteria\n         * @private\n         */\n        _filter: function(criteria) {\n            var $items = this.$tree.find(_selectors.items).removeClass(_cssCls.hidden);\n            var filter = _filterMap[criteria];\n            if (filter) {\n                $items.filter(filter).addClass(_cssCls.hidden);\n            }\n            this._updateSectionCounters(!!filter);\n            this.currentFilter = criteria;\n        },\n\n        /**\n         * Selects an item\n         * @param {String|jQuery} position The item's position\n         * @param {Boolean} [open] Forces the tree to be opened on the selected item\n         * @returns {jQuery} Returns the selected item\n         * @private\n         */\n        _select: function(position, open) {\n            // find the item to select and extract its hierarchy\n            var selected = position && position.jquery ? position : this.$tree.find('[data-position=' + position + ']');\n            var hierarchy = selected.parentsUntil(this.$tree);\n\n            // collapse the full tree and open only the hierarchy of the selected item\n            if (open) {\n                this._openOnly(hierarchy);\n            }\n\n            // select the item\n            this.$tree.find(_selectors.actives).removeClass(_cssCls.active);\n            hierarchy.add(selected).addClass(_cssCls.active);\n            return selected;\n        },\n\n        /**\n         * Opens the tree on the selected item only\n         * @returns {jQuery} Returns the selected item\n         * @private\n         */\n        _openSelected: function() {\n            // find the selected item and extract its hierarchy\n            var selected = this.$tree.find(_selectors.items + _selectors.actives);\n            var hierarchy = selected.parentsUntil(this.$tree);\n\n            // collapse the full tree and open only the hierarchy of the selected item\n            this._openOnly(hierarchy);\n\n            return selected;\n        },\n\n        /**\n         * Collapses the full tree and opens only the provided branch\n         * @param {jQuery} opened The element to be opened\n         * @param {jQuery} [root] The root element from which collapse the panels\n         * @private\n         */\n        _openOnly: function(opened, root) {\n            (root || this.$tree).find(_selectors.collapsible).addClass(_cssCls.collapsed);\n            opened.removeClass(_cssCls.collapsed);\n        },\n\n        /**\n         * Toggles a panel\n         * @param {jQuery} panel The panel to toggle\n         * @param {String} [collapseSelector] Selector of panels to collapse\n         * @returns {Boolean} Returns `true` if the panel just expanded now\n         */\n        _togglePanel: function(panel, collapseSelector) {\n            var collapsed = panel.hasClass(_cssCls.collapsed);\n\n            if (collapseSelector) {\n                this.$tree.find(collapseSelector).addClass(_cssCls.collapsed);\n            }\n\n            if (collapsed) {\n                panel.removeClass(_cssCls.collapsed);\n            } else {\n                panel.addClass(_cssCls.collapsed);\n            }\n            return collapsed;\n        },\n\n        /**\n         * Sets the icon of a particular item\n         * @param {jQuery} $item\n         * @param {String} icon\n         * @private\n         */\n        _setItemIcon: function($item, icon) {\n            $item.find(_selectors.icons).attr('class', _cssCls.icon + ' icon-' + icon);\n        },\n\n        /**\n         * Sets the icon of a particular item according to its state\n         * @param {jQuery} $item\n         * @private\n         */\n        _adjustItemIcon: function($item) {\n            var icon = null;\n            var defaultIcon = _cssCls.unseen;\n            var iconCls = [\n                _cssCls.flagged,\n                _cssCls.answered,\n                _cssCls.viewed\n            ];\n\n            _.forEach(iconCls, function(cls) {\n                if ($item.hasClass(cls)) {\n                    icon = cls;\n                    return false;\n                }\n            });\n\n            this._setItemIcon($item, icon || defaultIcon);\n        },\n\n        /**\n         * Toggle the marked state of an item\n         * @param {jQuery} $item\n         * @param {Boolean} [flag]\n         * @private\n         */\n        _toggleFlag: function($item, flag) {\n            $item.toggleClass(_cssCls.flagged, flag);\n            this._adjustItemIcon($item);\n        },\n\n        /**\n         * Marks an item for later review\n         * @param {jQuery} $item\n         * @private\n         */\n        _mark: function($item) {\n            var itemId = $item.data('id');\n            var itemPosition = $item.data('position');\n            var flag = !$item.hasClass(_cssCls.flagged);\n\n            this._toggleFlag($item);\n\n            /**\n             * A storage of the flag is required\n             * @event testReview#mark\n             * @param {Boolean} flag - Tells whether the item is marked for review or not\n             * @param {Number} position - The item position on which jump\n             * @param {String} itemId - The identifier of the target item\n             * @param {testReview} testReview - The client testReview component\n             */\n            this.trigger('mark', [flag, itemPosition, itemId]);\n        },\n\n        /**\n         * Jumps to an item\n         * @param {jQuery} $item\n         * @private\n         */\n        _jump: function($item) {\n            var itemId = $item.data('id');\n            var itemPosition = $item.data('position');\n\n            /**\n             * A jump to a particular item is required\n             * @event testReview#jump\n             * @param {Number} position - The item position on which jump\n             * @param {String} itemId - The identifier of the target item\n             * @param {testReview} testReview - The client testReview component\n             */\n            this.trigger('jump', [itemPosition, itemId]);\n        },\n\n        /**\n         * Updates the sections related items counters\n         * @param {Boolean} filtered\n         */\n        _updateSectionCounters: function(filtered) {\n            var self = this;\n            var filter = _filterMap[filtered ? 'filtered' : 'answered'];\n            this.$tree.find(_selectors.sections).each(function() {\n                var $section = $(this);\n                var $items = $section.find(_selectors.items);\n                var $filtered = $items.filter(filter);\n                var total = $items.length;\n                var nb = total - $filtered.length;\n                self._writeCount($section.find(_selectors.counters), nb, total);\n            });\n        },\n\n        /**\n         * Updates the display according to options\n         * @private\n         */\n        _updateDisplayOptions: function() {\n            var reviewScope = _reviewScopes[this.options.reviewScope] || 'test';\n            var scopeClass = _cssCls.scope[reviewScope];\n            var $root = this.$component;\n            _.forEach(_cssCls.scope, function(cls) {\n                $root.removeClass(cls);\n            });\n            if (scopeClass) {\n                $root.addClass(scopeClass);\n            }\n            $root.toggleClass(_cssCls.collapsible, this.options.canCollapse);\n        },\n\n        /**\n         * Updates the local options from the provided context\n         * @param {Object} testContext The progression context\n         * @private\n         */\n        _updateOptions: function(testContext) {\n            var options = this.options;\n            _.forEach(_optionsMap, function(optionKey, contextKey) {\n                if (undefined !== testContext[contextKey]) {\n                    options[optionKey] = testContext[contextKey];\n                }\n            });\n        },\n\n        /**\n         * Updates the info panel\n         */\n        _updateInfos: function() {\n            var progression = this.progression,\n                unanswered = Number(progression.total) - Number(progression.answered);\n\n            // update the info panel\n            this._writeCount(this.$infoAnswered, progression.answered, progression.total);\n            this._writeCount(this.$infoUnanswered, unanswered, progression.total);\n            this._writeCount(this.$infoViewed, progression.viewed, progression.total);\n            this._writeCount(this.$infoFlagged, progression.flagged, progression.total);\n        },\n\n        /**\n         * Updates a counter\n         * @param {jQuery} $place\n         * @param {Number} count\n         * @param {Number} total\n         * @private\n         */\n        _writeCount: function($place, count, total) {\n            $place.text(count + '/' + total);\n        },\n\n        /**\n         * Gets the progression stats for the whole test\n         * @param {Object} testContext The progression context\n         * @returns {{total: (Number), answered: (Number), viewed: (Number), flagged: (Number)}}\n         * @private\n         */\n        _getProgressionOfTest: function(testContext) {\n            return {\n                total : testContext.numberItems || 0,\n                answered : testContext.numberCompleted || 0,\n                viewed : testContext.numberPresented || 0,\n                flagged : testContext.numberFlagged || 0\n            };\n        },\n\n        /**\n         * Gets the progression stats for the current test part\n         * @param {Object} testContext The progression context\n         * @returns {{total: (Number), answered: (Number), viewed: (Number), flagged: (Number)}}\n         * @private\n         */\n        _getProgressionOfTestPart: function(testContext) {\n            return {\n                total : testContext.numberItemsPart || 0,\n                answered : testContext.numberCompletedPart || 0,\n                viewed : testContext.numberPresentedPart || 0,\n                flagged : testContext.numberFlaggedPart || 0\n            };\n        },\n\n        /**\n         * Gets the progression stats for the current test section\n         * @param {Object} testContext The progression context\n         * @returns {{total: (Number), answered: (Number), viewed: (Number), flagged: (Number)}}\n         * @private\n         */\n        _getProgressionOfTestSection: function(testContext) {\n            return {\n                total : testContext.numberItemsSection || 0,\n                answered : testContext.numberCompletedSection || 0,\n                viewed : testContext.numberPresentedSection || 0,\n                flagged : testContext.numberFlaggedSection || 0\n            };\n        },\n\n        /**\n         * Updates the navigation tre\n         * @param {Object} testContext The progression context\n         */\n        _updateTree: function(testContext) {\n            var navigatorMap = testContext.navigatorMap;\n            var reviewScope = this.options.reviewScope;\n            var reviewScopePart = reviewScope === 'testPart';\n            var reviewScopeSection = reviewScope === 'testSection';\n            var _partsFilter = function(part) {\n                if (reviewScopeSection && part.sections) {\n                    part.sections = _.filter(part.sections, _partsFilter);\n                }\n                return part.active;\n            };\n\n            // rebuild the tree\n            if (navigatorMap) {\n                if (reviewScopePart || reviewScopeSection) {\n                    // display only the current section\n                    navigatorMap = _.filter(navigatorMap, _partsFilter);\n                }\n\n                this.$filterBar.show();\n                this.$linearState.hide();\n                this.$tree.html(navigatorTreeTpl({\n                    parts: navigatorMap\n                }));\n\n                if (this.options.preventsUnseen) {\n                    // disables all unseen items to prevent the test taker has access to.\n                    this.$tree.find(_selectors.unseen).addClass(_cssCls.disabled);\n                }\n            } else {\n                this.$filterBar.hide();\n                this.$linearState.show();\n                this.$tree.empty();\n            }\n\n            // apply again the current filter\n            this._filter(this.$filters.filter(_selectors.actives).data('mode'));\n        },\n\n        /**\n         * Set the marked state of an item\n         * @param {Number|String|jQuery} position\n         * @param {Boolean} flag\n         */\n        setItemFlag: function setItemFlag(position, flag) {\n            var $item = position && position.jquery ? position : this.$tree.find('[data-position=' + position + ']');\n            var progression = this.progression;\n\n            // update the item flag\n            this._toggleFlag($item, flag);\n\n            // update the info panel\n            progression.flagged = this.$tree.find(_selectors.flagged).length;\n            this._writeCount(this.$infoFlagged, progression.flagged, progression.total);\n            this._filter(this.currentFilter);\n        },\n\n        /**\n         * Update the number of flagged items in the test context\n         * @param {Object} testContext The test context\n         * @param {Number} position The position of the flagged item\n         * @param {Boolean} flag The flag state\n         */\n        updateNumberFlagged: function(testContext, position, flag) {\n            var fields = ['numberFlagged'];\n            var currentPosition = testContext.itemPosition;\n            var currentFound = false, currentSection = null, currentPart = null;\n            var itemFound = false, itemSection = null, itemPart = null;\n\n            if (testContext.navigatorMap) {\n                // find the current item and the marked item inside the navigator map\n                // check if the marked item is in the current section\n                _.forEach(testContext.navigatorMap, function(part) {\n                    _.forEach(part && part.sections, function(section) {\n                        _.forEach(section && section.items, function(item) {\n                            if (item) {\n                                if (item.position === position) {\n                                    itemPart = part;\n                                    itemSection = section;\n                                    itemFound = true;\n                                }\n                                if (item.position === currentPosition) {\n                                    currentPart = part;\n                                    currentSection = section;\n                                    currentFound = true;\n\n                                }\n                                if (itemFound && currentFound) {\n                                    return false;\n                                }\n                            }\n                        });\n\n                        if (itemFound && currentFound) {\n                            return false;\n                        }\n                    });\n\n                    if (itemFound && currentFound) {\n                        return false;\n                    }\n                });\n\n                // select the context to update\n                if (itemFound && currentPart === itemPart) {\n                    fields.push('numberFlaggedPart');\n                }\n                if (itemFound && currentSection === itemSection) {\n                    fields.push('numberFlaggedSection');\n                }\n            } else {\n                // no navigator map, the current the marked item is in the current section\n                fields.push('numberFlaggedPart');\n                fields.push('numberFlaggedSection');\n            }\n\n            _.forEach(fields, function(field) {\n                if (field in testContext) {\n                    testContext[field] += flag ? 1 : -1;\n                }\n            });\n        },\n\n        /**\n         * Get progression\n         * @param {Object} testContext The progression context\n         * @returns {object} progression\n         */\n        getProgression: function getProgression(testContext) {\n            var reviewScope = _reviewScopes[this.options.reviewScope] || 'test',\n                progressInfoMethod = '_getProgressionOf' + capitalize(reviewScope),\n                getProgression = this[progressInfoMethod] || this._getProgressionOfTest,\n                progression = getProgression && getProgression(testContext) || {};\n\n            return progression;\n        },\n\n        /**\n         * Updates the review screen\n         * @param {Object} testContext The progression context\n         * @returns {testReview}\n         */\n        update: function update(testContext) {\n            this.progression = this.getProgression(testContext);\n            this._updateOptions(testContext);\n            this._updateInfos(testContext);\n            this._updateTree(testContext);\n            this._updateDisplayOptions(testContext);\n            return this;\n        },\n\n        /**\n         * Disables the component\n         * @returns {testReview}\n         */\n        disable: function disable() {\n            this.disabled = true;\n            this.$component.addClass(_cssCls.disabled);\n            return this;\n        },\n\n        /**\n         * Enables the component\n         * @returns {testReview}\n         */\n        enable: function enable() {\n            this.disabled = false;\n            this.$component.removeClass(_cssCls.disabled);\n            return this;\n        },\n\n        /**\n         * Hides the component\n         * @returns {testReview}\n         */\n        hide: function hide() {\n            this.disabled = true;\n            this.hidden = true;\n            this.$component.addClass(_cssCls.hidden);\n            return this;\n        },\n\n        /**\n         * Shows the component\n         * @returns {testReview}\n         */\n        show: function show() {\n            this.disabled = false;\n            this.hidden = false;\n            this.$component.removeClass(_cssCls.hidden);\n            return this;\n        },\n\n        /**\n         * Toggles the display state of the component\n         * @param {Boolean} [show] External condition that's tells if the component must be shown or hidden\n         * @returns {testReview}\n         */\n        toggle: function toggle(show) {\n            if (undefined === show) {\n                show = this.hidden;\n            }\n\n            if (show) {\n                this.show();\n            } else {\n                this.hide();\n            }\n\n            return this;\n        },\n\n        /**\n         * Install an event handler on the underlying DOM element\n         * @param {String} eventName\n         * @returns {testReview}\n         */\n        on: function on(eventName) {\n            var dom = this.$component;\n            if (dom) {\n                dom.on.apply(dom, arguments);\n            }\n\n            return this;\n        },\n\n        /**\n         * Uninstall an event handler from the underlying DOM element\n         * @param {String} eventName\n         * @returns {testReview}\n         */\n        off: function off(eventName) {\n            var dom = this.$component;\n            if (dom) {\n                dom.off.apply(dom, arguments);\n            }\n\n            return this;\n        },\n\n        /**\n         * Triggers an event on the underlying DOM element\n         * @param {String} eventName\n         * @param {Array|Object} extraParameters\n         * @returns {testReview}\n         */\n        trigger : function trigger(eventName, extraParameters) {\n            var dom = this.$component;\n\n            if (undefined === extraParameters) {\n                extraParameters = [];\n            }\n            if (!_.isArray(extraParameters)) {\n                extraParameters = [extraParameters];\n            }\n\n            extraParameters.push(this);\n\n            if (dom) {\n                dom.trigger(eventName, extraParameters);\n            }\n\n            return this;\n        }\n    };\n\n    /**\n     * Builds an instance of testReview\n     * @param {String|jQuery|HTMLElement} element The element on which install the component\n     * @param {Object} [options] A list of extra options\n     * @param {String} [options.region] The region on which put the component: left or right\n     * @param {String} [options.reviewScope] Limit the review screen to a particular scope:\n     * the whole test, the current test part or the current test section)\n     * @param {Boolean} [options.preventsUnseen] Prevents the test taker to access unseen items\n     * @returns {testReview}\n     */\n    var testReviewFactory = function(element, options) {\n        var component = _.clone(testReview, true);\n        return component.init(element, options);\n    };\n\n    return testReviewFactory;\n});\n\n","/**\n * This program is free software; you can redistribute it and/or\n * modify it under the terms of the GNU General Public License\n * as published by the Free Software Foundation; under version 2\n * of the License (non-upgradable).\n *\n * This program is distributed in the hope that it will be useful,\n * but WITHOUT ANY WARRANTY; without even the implied warranty of\n * MERCHANTABILITY or FITNESS FOR A PARTICULAR PURPOSE.  See the\n * GNU General Public License for more details.\n *\n * You should have received a copy of the GNU General Public License\n * along with this program; if not, write to the Free Software\n * Foundation, Inc., 51 Franklin Street, Fifth Floor, Boston, MA  02110-1301, USA.\n *\n * Copyright (c) 2015 (original work) Open Assessment Technologies SA ;\n */\n/**\n * @author Jean-Sébastien Conan <jean-sebastien.conan@vesperiagroup.com>\n */\ndefine('taoQtiTest/testRunner/progressUpdater',[\n    'jquery',\n    'lodash',\n    'i18n',\n    'ui/progressbar'\n], function ($, _, __) {\n    'use strict';\n\n    /**\n     * Provides a versatile progress bar updater\n     * @type {{init: Function, update: Function}}\n     */\n    var progressUpdaters = {\n        /**\n         * Initializes the progress updater\n         *\n         * @param {String|jQuery|HTMLElement} progressBar The element on which put the progress bar\n         * @param {String|jQuery|HTMLElement} progressLabel The element on which put the progress label\n         * @returns {progressUpdaters}\n         */\n        init: function(progressBar, progressLabel) {\n            this.progressBar = $(progressBar).progressbar();\n            this.progressLabel = $(progressLabel);\n            return this;\n        },\n\n        /**\n         * Writes the progress label and update the progress by ratio\n         * @param {String} label\n         * @param {Number} ratio\n         * @returns {progressUpdaters}\n         */\n        write: function(label, ratio) {\n            this.progressLabel.text(label);\n            this.progressBar.progressbar('value', ratio);\n            return this;\n        },\n\n        /**\n         * Updates the progress bar\n         * @param {Object} testContext The progression context\n         * @returns {{ratio: number, label: string}}\n         */\n        update: function(testContext) {\n            var progressIndicator = testContext.progressIndicator || 'percentage';\n            var progressIndicatorMethod = progressIndicator + 'Progression';\n            var getProgression = this[progressIndicatorMethod] || this.percentageProgression;\n            var progression = getProgression && getProgression(testContext) || {};\n\n            this.write(progression.label, progression.ratio);\n            return progression;\n        },\n\n        /**\n         * Updates the progress bar displaying the percentage\n         * @param {Object} testContext The progression context\n         * @returns {{ratio: number, label: string}}\n         */\n        percentageProgression: function(testContext) {\n            var total = Math.max(1, testContext.numberItems);\n            var ratio = Math.floor(testContext.numberCompleted / total * 100);\n            return {\n                ratio : ratio,\n                label : ratio + '%'\n            };\n        },\n\n        /**\n         * Updates the progress bar displaying the position\n         * @param {Object} testContext The progression context\n         * @returns {{ratio: number, label: string}}\n         */\n        positionProgression: function(testContext) {\n            var progressScope = testContext.progressIndicatorScope;\n            var progressScopeCounter = {\n                test : {\n                    total : 'numberItems',\n                    position : 'itemPosition'\n                },\n                testPart : {\n                    total : 'numberItemsPart',\n                    position : 'itemPositionPart'\n                },\n                testSection : {\n                    total : 'numberItemsSection',\n                    position : 'itemPositionSection'\n                }\n            };\n            var counter = progressScopeCounter[progressScope] || progressScopeCounter.test;\n            var total = Math.max(1, testContext[counter.total]);\n            var position = testContext[counter.position] + 1;\n            return {\n                ratio : Math.floor(position / total * 100),\n                label : __('Item %d of %d', position, total)\n            };\n        }\n    };\n\n    /**\n     * Builds an instance of progressUpdaters\n     * @param {String|jQuery|HTMLElement} progressBar The element on which put the progress bar\n     * @param {String|jQuery|HTMLElement} progressLabel The element on which put the progress label\n     * @returns {progressUpdaters}\n     */\n    var progressUpdaterFactory = function(progressBar, progressLabel) {\n        var updater = _.clone(progressUpdaters, true);\n        return updater.init(progressBar, progressLabel);\n    };\n\n    return progressUpdaterFactory;\n});\n\n","/**\n * This program is free software; you can redistribute it and/or\n * modify it under the terms of the GNU General Public License\n * as published by the Free Software Foundation; under version 2\n * of the License (non-upgradable).\n *\n * This program is distributed in the hope that it will be useful,\n * but WITHOUT ANY WARRANTY; without even the implied warranty of\n * MERCHANTABILITY or FITNESS FOR A PARTICULAR PURPOSE.  See the\n * GNU General Public License for more details.\n *\n * You should have received a copy of the GNU General Public License\n * along with this program; if not, write to the Free Software\n * Foundation, Inc., 51 Franklin Street, Fifth Floor, Boston, MA  02110-1301, USA.\n *\n * Copyright (c) 2015 (original work) Open Assessment Technologies SA;\n *\n */\n\n/**\n * Metadata to be sent to the server. Will be saved in result storage as a trace variable.\n * Usage example:\n * <pre>\n * var testMetaData = testMetaDataFactory({\n *   testServiceCallId : this.itemServiceApi.serviceCallId\n * });\n *\n * testMetaData.setData({\n *   'TEST' : {\n *      'TEST_EXIT_CODE' : 'T'\n *   },\n *   'SECTION' : {\n *      'SECTION_EXIT_CODE' : 704\n *   }\n * });\n *\n * testMetaData.addData({'ITEM' : {\n *      'ITEM_START_TIME_CLIENT' : 1443596730143,\n *      'ITEM_END_TIME_CLIENT' : 1443596731301\n *    }\n * });\n * </pre>\n *\n * Data for each service call id will be stored in local storage to be able get data\n * after reloading the page or resuming the test session.\n *\n * To clear all data related to current test_call_id used <i>clearData</i> method.\n */\ndefine('taoQtiTest/testRunner/testMetaData',[\n    'lodash'\n], function (_) {\n    'use strict';\n\n    /**\n     * @param {Object} options\n     * @param {string} options.testServiceCallId - test call id.\n     */\n     var testMetaDataFactory = function testMetaDataFactory(options) {\n        var _testServiceCallId,\n            _storageKeyPrefix = 'testMetaData_',\n            _data = {};\n\n        if (!options || options.testServiceCallId === undefined) {\n            throw new TypeError(\"testServiceCallId option is required\");\n        }\n\n        var testMetaData = {\n            SECTION_EXIT_CODE : {\n                'COMPLETED_NORMALLY': 700,\n                'QUIT': 701,\n                'COMPLETE_TIMEOUT': 703,\n                'TIMEOUT': 704,\n                'FORCE_QUIT': 705,\n                'IN_PROGRESS': 706,\n                'ERROR': 300\n            },\n            TEST_EXIT_CODE : {\n                'COMPLETE': 'C',\n                'TERMINATED': 'T',\n                'INCOMPLETE': 'IC',\n                'INCOMPLETE_QUIT': 'IQ',\n                'INACTIVE': 'IA',\n                'CANDIDATE_DISAGREED_WITH_NDA': 'DA'\n            },\n            /**\n             * Return test call id.\n             * @returns {string}- Test call id\n             */\n            getTestServiceCallId : function getTestServiceCallId () {\n                return _testServiceCallId;\n            },\n\n            /**\n             * Set test call id.\n             * @param {string} value\n             */\n            setTestServiceCallId : function setTestServiceCallId (value) {\n                _testServiceCallId = value;\n            },\n\n            /**\n             * Set meta data. Current data object will be overwritten.\n             * @param {Object} data - metadata object\n             */\n            setData : function setData(data) {\n                _data = data;\n                setLocalStorageData(JSON.stringify(_data));\n            },\n\n            /**\n             * Add data.\n             * @param {Object} data - metadata object\n             * @param {Boolean} overwrite - whether the same data should be overwritten. Default - <i>false</i>\n             */\n            addData : function addData(data, overwrite) {\n                data = _.clone(data);\n                if (overwrite === undefined) {\n                    overwrite = false;\n                }\n\n                if (overwrite) {\n                    _.merge(_data, data);\n                } else {\n                    _data = _.merge(data, _data);\n                }\n                setLocalStorageData(JSON.stringify(_data));\n            },\n\n            /**\n             * Get the saved data.\n             * The cloned object will be returned to avoid unwanted affecting of the original data.\n             * @returns {Object} - metadata object.\n             */\n            getData : function getData() {\n                return _.clone(_data);\n            },\n\n            /**\n             * Clear all data saved in current object and in local storage related to current test call id.\n             * @returns {Object} - metadata object.\n             */\n            clearData : function clearData() {\n                _data = {};\n                window.localStorage.removeItem(testMetaData.getLocalStorageKey());\n            },\n\n            getLocalStorageKey : function getLocalStorageKey () {\n                return _storageKeyPrefix + _testServiceCallId;\n            }\n        };\n\n        /**\n         * Initialize test meta data manager\n         */\n        function init() {\n            _testServiceCallId = options.testServiceCallId;\n            testMetaData.setData(getLocalStorageData());\n        }\n\n        /**\n         * Set data to local storage\n         * @param {string} val - data to be stored.\n         */\n        function setLocalStorageData(val) {\n            var currentKey = testMetaData.getLocalStorageKey();\n            try {\n                window.localStorage.setItem(currentKey, val);\n            } catch(domException) {\n                if (domException.name === 'QuotaExceededError' ||\n                    domException.name === 'NS_ERROR_DOM_QUOTA_REACHED') {\n                    var removed = 0,\n                        i = window.localStorage.length,\n                        key;\n                    while (i--) {\n                        key  = localStorage.key(i);\n                        if (/^testMetaData_.*/.test(key) && key !== currentKey) {\n                            window.localStorage.removeItem(key);\n                            removed++;\n                        }\n                    }\n                    if (removed) {\n                        setLocalStorageData(val);\n                    } else {\n                        throw domException;\n                    }\n                } else {\n                    throw domException;\n                }\n            }\n        }\n\n        /**\n         * Get data from local storage stored for current call id\n         * @returns {*} saved data or empty object\n         */\n        function getLocalStorageData() {\n            var data = window.localStorage.getItem(testMetaData.getLocalStorageKey()),\n                result = JSON.parse(data) || {};\n\n            return result;\n        }\n\n        init();\n\n        return testMetaData;\n    };\n\n    return testMetaDataFactory;\n});\n","/**\n * This program is free software; you can redistribute it and/or\n * modify it under the terms of the GNU General Public License\n * as published by the Free Software Foundation; under version 2\n * of the License (non-upgradable).\n *\n * This program is distributed in the hope that it will be useful,\n * but WITHOUT ANY WARRANTY; without even the implied warranty of\n * MERCHANTABILITY or FITNESS FOR A PARTICULAR PURPOSE.  See the\n * GNU General Public License for more details.\n *\n * You should have received a copy of the GNU General Public License\n * along with this program; if not, write to the Free Software\n * Foundation, Inc., 51 Franklin Street, Fifth Floor, Boston, MA  02110-1301, USA.\n *\n * Copyright (c) 2014 (original work) Open Assessment Technologies SA (under the project TAO-PRODUCT);\n */\ndefine('serviceApi/ServiceApi',['jquery', 'urlParser'], function($, UrlParser){\n    'use strict';\n\n    /**\n     * @constructor\n     */\n    function ServiceApi(baseUrl, parameters, serviceCallId, stateStorage, userService, paused){\n        this.baseUrl = baseUrl;\n        this.parameters = parameters;\n        this.connected = false;\n\n        this.serviceCallId = serviceCallId;\n        this.state = stateStorage;\n        this.userService = userService;\n        this.hasBeenPaused = paused;\n    }\n\n    ServiceApi.SIG_SUCCESS = 0;\n    ServiceApi.SIG_ERROR = 1;\n\n    ServiceApi.prototype.loadInto = function(frame, connected){\n        var self = this;\n        var $frame = $(frame);\n        var callUrl = this.getCallUrl();\n        var isCORSAllowed = new UrlParser(callUrl).checkCORS();\n\n        $frame.on('load', function(e){\n             //if we are  in the same domain, we add a variable\n             //to the frame window, so the frame knows it can communicate\n             //with the parent\n            $(document).on('serviceready', function(){\n                self.connect(frame, function(){\n                    $(document).off('serviceready');\n                    if(typeof connected === 'function'){\n                        connected();\n                    }\n                });\n            });\n             if(isCORSAllowed === true){\n                 frame.contentWindow.__knownParent__ = true;\n             }\n         });\n\n        $frame.attr('src', callUrl);\n    };\n\n    ServiceApi.prototype.connect = function(frame, connected){\n        if(this.connected === false && frame.contentWindow){\n            //frame.contentWindow.serviceApi = this;\n            if (typeof(frame.contentWindow.onServiceApiReady) === \"function\") {\n                frame.contentWindow.onServiceApiReady(this);\n                this.connected = true;\n                if(typeof connected === 'function'){\n                    connected();\n                }\n            }\n        }\n    };\n\n    /**\n     * Get the service call URL\n     * @returns {String} the URI\n     */\n    ServiceApi.prototype.getCallUrl = function(){\n        var params = this.parameters || {};\n        params.serviceCallId = this.serviceCallId;\n        return this.baseUrl + '?' + $.param(params);\n    };\n\n    ServiceApi.prototype.getUserPropertyValues = function(property, callback){\n    \tthis.userService.get(property, callback);\n    };\n\n    //Context\n    ServiceApi.prototype.getServiceCallId = function(){\n        return this.serviceCallId;\n    };\n\n    //Context\n    ServiceApi.prototype.getState = function(){\n        return this.state.get();\n    };\n\n    ServiceApi.prototype.setState = function(state, callback){\n        return this.state.set(state, callback);\n    };\n\n    //Context\n    ServiceApi.prototype.getHasBeenPaused = function(){\n        return this.hasBeenPaused;\n    };\n\n    ServiceApi.prototype.setHasBeenPaused = function(paused){\n        this.hasBeenPaused = paused;\n    };\n\n    // Variables\n    ServiceApi.prototype.getParameter = function(identifier){\n        if (typeof(this.parameters[identifier]) !== \"undefined\") {\n            return this.parameters[identifier];\n        } else {\n            return null;\n        }\n    };\n\n    /**\n     * Sets a callback on the finish action\n     * @param {Function} callback\n     * @returns {ServiceApi}\n     */\n    ServiceApi.prototype.onFinish = function(callback) {\n        this.onFinishCallback = callback;\n        return this;\n    };\n\n    /**\n     * Sets a callback on the kill action\n     * @param {Function} callback\n     * @returns {ServiceApi}\n     */\n    ServiceApi.prototype.onKill = function(callback) {\n        this.onKillCallback = callback;\n        return this;\n    };\n\n    /**\n     * Sets a callback on the exit action\n     * @param {Function} callback\n     * @returns {ServiceApi}\n     */\n    ServiceApi.prototype.onExit = function(callback) {\n        this.onExitCallback = callback;\n        return this;\n    };\n\n    /**\n     * @param {Function} callback - Function called if no dedicated callback is found\n     */\n    ServiceApi.prototype.kill = function(callback) {\n    \tif (typeof this.onKillCallback === 'function') {\n    \t\tthis.onKillCallback(callback);\n    \t} else {\n    \t\tcallback(0);\n    \t}\n    };\n\n    /**\n     * Exits the flow\n     * @param {Function} callback - Function called if no dedicated callback is found\n     */\n    ServiceApi.prototype.exit = function(callback) {\n    \tif (typeof this.onExitCallback === 'function') {\n    \t\tthis.onExitCallback(callback);\n    \t} else {\n    \t\tcallback(0);\n    \t}\n    };\n\n    /**\n     * Finishes the flow\n     * @param valueArray - return parameters of the service.\n     */\n    ServiceApi.prototype.finish = function(valueArray) {\n        //return execution to service caller\n        if (typeof this.onFinishCallback === 'function') {\n                this.onFinishCallback(valueArray);\n        }\n    };\n\n    return ServiceApi;\n\n});\n\n","define('serviceApi/UserInfoService',['jquery'], function($){\n    \n    function UserInfoService(requestUrl, data) {\n        this.data = data;\n        this.requestUrl = requestUrl;\n    }\n\n    UserInfoService.prototype.get = function(property, callback){\n        if (this.data.hasOwnProperty(property)) {\n            if (typeof callback === \"function\") {\n                    callback(this.data[property]);\n            }\n        } else {\n            $.ajax({\n                url : this.requestUrl,\n                data \t\t: {\n                    'property' : property\n                },\n                type        : 'post',\n                dataType\t: 'json',\n                success     : (function(service, callback) {return function(r) {\n            \t\tfor (key in r.data) {\n            \t\t\tservice.data[key] = r.data[key];\n            \t\t}\n                    if (typeof callback === \"function\") {\n                        callback(service.data[property]);\n                    }\n\n                }})(this, callback)\n                /*\t\n            \tfunction(r){\n                    if(r.success){\n                    \tconsole.log(this.data);\n                    \tthis.data[property] = r.values;\n                    \t//console.log(this.data);\n\t                    if (typeof callback === \"function\") {\n\t                        callback(this.data[property]);\n\t                    }\n                    }\n                }\n                */\n                \n                \n            });\n        }\n    };\n\n    return UserInfoService;\n});\n","/**\n * This program is free software; you can redistribute it and/or\n * modify it under the terms of the GNU General Public License\n * as published by the Free Software Foundation; under version 2\n * of the License (non-upgradable).\n *\n * This program is distributed in the hope that it will be useful,\n * but WITHOUT ANY WARRANTY; without even the implied warranty of\n * MERCHANTABILITY or FITNESS FOR A PARTICULAR PURPOSE.  See the\n * GNU General Public License for more details.\n *\n * You should have received a copy of the GNU General Public License\n * along with this program; if not, write to the Free Software\n * Foundation, Inc., 51 Franklin Street, Fifth Floor, Boston, MA  02110-1301, USA.\n *\n * Copyright (c) 2013 (original work) Open Assessment Technologies SA ;\n */\ndefine('serviceApi/StateStorage',['jquery'], function($){\n    'use strict';\n    \n    function StateStorage(state, submitUrl) {\n        this.state = state;\n        this.submitUrl = submitUrl;\n    }\n\n    StateStorage.prototype.get = function(callback){\n        if (typeof callback === 'function') {\n                callback(this.state);\n        }\n        return this.state;\n    };\n\n    StateStorage.prototype.set = function(state, callback){\n\n        if (state === this.state) {\n            if (typeof callback === \"function\") {\n                    callback();\n            }\n        } else {\n            this.state = state;\n            $.ajax({\n                url : this.submitUrl,\n                data \t\t: {\n                    'state' : state\n                },\n                type        : 'post',\n                dataType\t: 'json',\n                success     : typeof callback === \"function\" ? callback : null\n            });\n        }\n    };\n\n    return StateStorage;\n});\n","/*\n * This program is free software; you can redistribute it and/or\n * modify it under the terms of the GNU General Public License\n * as published by the Free Software Foundation; under version 2\n * of the License (non-upgradable).\n *\n * This program is distributed in the hope that it will be useful,\n * but WITHOUT ANY WARRANTY; without even the implied warranty of\n * MERCHANTABILITY or FITNESS FOR A PARTICULAR PURPOSE.  See the\n * GNU General Public License for more details.\n *\n * You should have received a copy of the GNU General Public License\n * along with this program; if not, write to the Free Software\n * Foundation, Inc., 51 Franklin Street, Fifth Floor, Boston, MA  02110-1301, USA.\n *\n * Copyright (c) 2015 (original work) Open Assessment Technologies SA;\n *\n */\n\ndefine('taoQtiTest/controller/runtime/testRunner',[\n    'jquery',\n    'lodash',\n    'i18n',\n    'module',\n    'taoQtiTest/testRunner/actionBarTools',\n    'taoQtiTest/testRunner/testReview',\n    'taoQtiTest/testRunner/progressUpdater',\n    'taoQtiTest/testRunner/testMetaData',\n    'serviceApi/ServiceApi',\n    'serviceApi/UserInfoService',\n    'serviceApi/StateStorage',\n    'iframeNotifier',\n    'mathJax',\n    'ui/feedback',\n    'ui/deleter',\n    'moment',\n    'ui/modal',\n    'ui/progressbar'\n],\nfunction (\n    $,\n    _,\n    __,\n    module,\n    actionBarTools,\n    testReview,\n    progressUpdater,\n    testMetaDataFactory,\n    ServiceApi,\n    UserInfoService,\n    StateStorage,\n    iframeNotifier,\n    MathJax,\n    feedback,\n    deleter,\n    moment,\n    modal\n) {\n\n    'use strict';\n\n    var timerIds = [],\n        currentTimes = [],\n        lastDates = [],\n        timeDiffs = [],\n        waitingTime = 0,\n        $timers,\n        $controls,\n        timerIndex,\n        testMetaData,\n        sessionStateService,\n        $doc = $(document),\n        optionNextSection = 'x-tao-option-nextSection',\n        optionNextSectionWarning = 'x-tao-option-nextSectionWarning',\n        optionReviewScreen = 'x-tao-option-reviewScreen',\n        optionEndTestWarning = 'x-tao-option-endTestWarning',\n        optionNoExitTimedSectionWarning = 'x-tao-option-noExitTimedSectionWarning',\n        TestRunner = {\n            // Constants\n            'TEST_STATE_INITIAL': 0,\n            'TEST_STATE_INTERACTING': 1,\n            'TEST_STATE_MODAL_FEEDBACK': 2,\n            'TEST_STATE_SUSPENDED': 3,\n            'TEST_STATE_CLOSED': 4,\n            'TEST_NAVIGATION_LINEAR': 0,\n            'TEST_NAVIGATION_NONLINEAR': 1,\n            'TEST_ITEM_STATE_INTERACTING': 1,\n\n            /**\n             * Prepare a transition to another item\n             * @param {Function} [callback]\n             */\n            beforeTransition: function (callback) {\n                // Ask the top window to start the loader.\n                iframeNotifier.parent('loading');\n\n                // Disable buttons.\n                this.disableGui();\n\n                $controls.$itemFrame.hide();\n                $controls.$rubricBlocks.hide();\n                $controls.$timerWrapper.hide();\n\n                // Wait at least waitingTime ms for a better user experience.\n                if (typeof callback === 'function') {\n                    setTimeout(callback, waitingTime);\n                }\n            },\n\n            /**\n             * Complete a transition to another item\n             */\n            afterTransition: function () {\n                this.enableGui();\n\n                //ask the top window to stop the loader\n                iframeNotifier.parent('unloading');\n                testMetaData.addData({\n                    'ITEM' : {'ITEM_START_TIME_CLIENT' : Date.now() / 1000}\n                });\n            },\n\n            /**\n             * Jumps to a particular item in the test\n             * @param {Number} position The position of the item within the test\n             */\n            jump: function(position) {\n                var self = this,\n                    action = 'jump',\n                    params = {position: position};\n                this.disableGui();\n\n                if( this.isJumpOutOfSection(position)  && this.isCurrentItemActive() && this.isTimedSection() ){\n                    this.exitTimedSection(action, params);\n                } else {\n                    this.killItemSession(function() {\n                        self.actionCall(action, params);\n                    });\n                }\n            },\n\n            /**\n             * Push to server how long user seen that item before to track duration\n             * @param {Number} duration\n             */\n            keepItemTimed: function(duration){\n                if (duration) {\n                    var self = this,\n                        action = 'keepItemTimed',\n                        params = {duration: duration};\n                    self.actionCall(action, params);\n                }\n            },\n\n            /**\n             * Marks an item for later review\n             * @param {Boolean} flag The state of the flag\n             * @param {Number} position The position of the item within the test\n             */\n            markForReview: function(flag, position) {\n                var self = this;\n\n                // Ask the top window to start the loader.\n                iframeNotifier.parent('loading');\n\n                // Disable buttons.\n                this.disableGui();\n\n                $.ajax({\n                    url: self.testContext.markForReviewUrl,\n                    cache: false,\n                    async: true,\n                    type: 'POST',\n                    dataType: 'json',\n                    data: {\n                        flag: flag,\n                        position: position\n                    },\n                    success: function(data) {\n                        // update the item flagged state\n                        if (self.testReview) {\n                            self.testReview.setItemFlag(position, flag);\n                            self.testReview.updateNumberFlagged(self.testContext, position, flag);\n                            if (self.testContext.itemPosition === position) {\n                                self.testContext.itemFlagged = flag;\n                            }\n                            self.updateTools(self.testContext);\n                        }\n\n                        // Enable buttons.\n                        self.enableGui();\n\n                        //ask the top window to stop the loader\n                        iframeNotifier.parent('unloading');\n                    }\n                });\n            },\n\n            /**\n             * Move to the next available item\n             */\n            moveForward: function () {\n                var self = this,\n                    action = 'moveForward';\n\n                function doExitSection() {\n                    if( self.isTimedSection() && !self.testContext.isTimeout){\n                        self.exitTimedSection(action);\n                    } else {\n                        self.exitSection(action);\n                    }\n                }\n\n                this.disableGui();\n\n                if( (( this.testContext.numberItemsSection - this.testContext.itemPositionSection - 1) == 0) && this.isCurrentItemActive()){\n                    if (this.shouldDisplayEndTestWarning()) {\n                        this.displayEndTestWarning(doExitSection);\n                        this.enableGui();\n                    } else {\n                        doExitSection();\n                    }\n\n                } else {\n                    this.killItemSession(function () {\n                        self.actionCall(action);\n                    });\n                }\n            },\n\n            /**\n             * Check if necessary to display an end test warning\n             */\n            shouldDisplayEndTestWarning: function(){\n                return (this.testContext.isLast === true && this.hasOption(optionEndTestWarning));\n            },\n\n            /**\n             * Warns upon exiting test\n             */\n            displayEndTestWarning: function(nextAction){\n                var options = {\n                    confirmLabel: __('OK'),\n                    cancelLabel: __('Cancel'),\n                    showItemCount: false\n                };\n\n                this.displayExitMessage(\n                    __('You are about to submit the test. You will not be able to access this test once submitted. Click OK to continue and submit the test.'),\n                    nextAction,\n                    options\n                );\n            },\n\n            /**\n             * Move to the previous available item\n             */\n            moveBackward: function () {\n                var self = this,\n                    action = 'moveBackward';\n\n                this.disableGui();\n\n                if( (this.testContext.itemPositionSection == 0) && this.isCurrentItemActive() && this.isTimedSection() ){\n                    this.exitTimedSection(action);\n                } else {\n                this.killItemSession(function () {\n                        self.actionCall(action);\n                    });\n                }\n            },\n\n            /**\n             * Checks if a position is out of the current section\n             * @param {Number} jumpPosition\n             * @returns {Boolean}\n             */\n            isJumpOutOfSection: function(jumpPosition){\n                var items = this.getCurrentSectionItems(),\n                    isJumpToOtherSection = true,\n                    isValidPosition = (jumpPosition >= 0) && ( jumpPosition < this.testContext.numberItems );\n\n                if( isValidPosition){\n                    for(var i in items ) {\n                        if (!items.hasOwnProperty(i)) {\n                            continue;\n                        }\n                        if( items[i].position == jumpPosition ){\n                            isJumpToOtherSection = false;\n                            break;\n                        }\n                    }\n                } else {\n                    isJumpToOtherSection = false;\n                }\n\n                return isJumpToOtherSection;\n            },\n\n            /**\n             * Exit from the current section. Set the exit code.de\n             * @param {String} action\n             * @param {Object} params\n             * @param {Number} [exitCode]\n             */\n            exitSection: function(action, params, exitCode){\n                var self = this;\n\n                testMetaData.addData({\"SECTION\" : {\"SECTION_EXIT_CODE\" : exitCode || testMetaData.SECTION_EXIT_CODE.COMPLETED_NORMALLY}});\n                self.killItemSession(function () {\n                    self.actionCall(action, params);\n                });\n            },\n\n            /**\n             * Tries to exit a timed section. Display a confirm message.\n             * @param {String} action\n             * @param {Object} params\n             */\n            exitTimedSection: function(action, params){\n                var self = this,\n                    qtiRunner = this.getQtiRunner(),\n                    doExitTimedSection = function() {\n                        if (qtiRunner) {\n                            qtiRunner.updateItemApi();\n                        }\n                        self.exitSection(action, params);\n                    };\n\n                if ((action === 'moveForward' && this.shouldDisplayEndTestWarning())    // prevent duplicate warning\n                    || this.hasOption(optionNoExitTimedSectionWarning)                  // check if warning is disabled\n                    || this.testContext.keepTimerUpToTimeout                            // no need to display the message as we may be able to go back\n                ) {\n                    doExitTimedSection();\n                } else {\n                    this.displayExitMessage(\n                        __('After you complete the section it would be impossible to return to this section to make changes. Are you sure you want to end the section?'),\n                        doExitTimedSection,\n                        { scope: 'testSection' }\n                    );\n                }\n\n                this.enableGui();\n            },\n\n            /**\n             * Tries to leave the current section and go to the next\n             */\n            nextSection: function(){\n                var self = this;\n                var qtiRunner = this.getQtiRunner();\n                var doNextSection = function() {\n                    self.exitSection('nextSection', null, testMetaData.SECTION_EXIT_CODE.QUIT);\n                };\n\n                if (qtiRunner) {\n                    qtiRunner.updateItemApi();\n                }\n\n                if (this.hasOption(optionNextSectionWarning)) {\n                    this.displayExitMessage(\n                        __('After you complete the section it would be impossible to return to this section to make changes. Are you sure you want to end the section?'),\n                        doNextSection,\n                        { scope: 'testSection' }\n                    );\n                } else {\n                    doNextSection();\n                }\n\n                this.enableGui();\n            },\n\n            /**\n             * Gets the current progression within a particular scope\n             * @param {String} [scope]\n             * @returns {Object}\n             */\n            getProgression: function(scope) {\n                var scopeSuffixMap = {\n                    test : '',\n                    testPart : 'Part',\n                    testSection : 'Section'\n                };\n                var scopeSuffix = scope && scopeSuffixMap[scope] || '';\n\n                return {\n                    total : this.testContext['numberItems' + scopeSuffix] || 0,\n                    answered : this.testContext['numberCompleted' + scopeSuffix] || 0,\n                    viewed : this.testContext['numberPresented' + scopeSuffix] || 0,\n                    flagged : this.testContext['numberFlagged' + scopeSuffix] || 0\n                };\n            },\n\n            /**\n             * Displays an exit message for a particular scope\n             * @param {String} message\n             * @param {Function} [action]\n             * @param {Object} [options]\n             * @param {String} [options.scope]\n             * @param {String} [options.confirmLabel] - label of confirm button\n             * @param {String} [options.cancelLabel] - label of cancel button\n             * @param {Boolean} [options.showItemCount] - display the number of unanswered / flagged items in modal\n             * @returns {jQuery} Returns the message box\n             */\n            displayExitMessage: function(message, action, options) {\n                var self = this,\n                    options = options || {},\n                    scope = options.scope,\n                    confirmLabel = options.confirmLabel || __('Yes'),\n                    cancelLabel = options.cancelLabel || __('No'),\n                    showItemCount = typeof options.showItemCount !== 'undefined' ? options.showItemCount : true;\n\n                var $confirmBox = $('.exit-modal-feedback');\n                var progression = this.getProgression(scope);\n                var unansweredCount = (progression.total - progression.answered);\n                var flaggedCount = progression.flagged;\n\n                if (showItemCount) {\n                    if (unansweredCount && this.isCurrentItemAnswered()) {\n                        unansweredCount--;\n                    }\n\n                    if (flaggedCount && unansweredCount) {\n                        message = __('You have %s unanswered question(s) and have %s item(s) marked for review.',\n                                unansweredCount.toString(),\n                                flaggedCount.toString()\n                            ) + ' ' + message;\n                    } else {\n                        if (flaggedCount) {\n                            message = __('You have %s item(s) marked for review.', flaggedCount.toString()) + ' ' + message;\n                        }\n\n                        if (unansweredCount) {\n                            message = __('You have %s unanswered question(s).', unansweredCount.toString()) + ' ' + message;\n                        }\n                    }\n                }\n\n                $confirmBox.find('.message').html(message);\n                $confirmBox.find('.js-exit-confirm').html(confirmLabel);\n                $confirmBox.find('.js-exit-cancel').html(cancelLabel);\n                $confirmBox.modal({ width: 500 });\n\n                $confirmBox.find('.js-exit-cancel, .modal-close').off('click').on('click', function () {\n                    $confirmBox.modal('close');\n                });\n\n                $confirmBox.find('.js-exit-confirm').off('click').on('click', function () {\n                    $confirmBox.modal('close');\n                    if (_.isFunction(action)) {\n                        action.call(self);\n                    }\n                });\n\n                return $confirmBox;\n            },\n\n            /**\n             * Kill current item section and execute callback function given as first parameter.\n             * Item end execution time will be stored in metadata object to be sent to the server.\n             * @param {function} callback\n             */\n            killItemSession : function (callback) {\n                testMetaData.addData({\n                    'ITEM' : {\n                        'ITEM_END_TIME_CLIENT' : Date.now() / 1000,\n                        'ITEM_TIMEZONE' : moment().utcOffset(moment().utcOffset()).format('Z')\n                    }\n                });\n                if (typeof callback !== 'function') {\n                    callback = _.noop;\n                }\n                this.itemServiceApi.kill(callback);\n            },\n\n            /**\n             * Checks if the current item is active\n             * @returns {Boolean}\n             */\n            isCurrentItemActive: function(){\n                return (this.testContext.itemSessionState !=4);\n            },\n\n            /**\n             * Tells is the current item has been answered or not\n             * The item is considered answered when at least one response has been set to not empty {base : null}\n             *\n             * @returns {Boolean}\n             */\n            isCurrentItemAnswered: function(){\n                var answered = false;\n                _.each(this.getCurrentItemState(), function(state){\n                    if(state && _.isObject(state.response) && state.response.base !== null){\n                        answered = true;//at least one response is not null so consider the item answered\n                        return false;\n                    }\n                });\n                return answered;\n            },\n\n            /**\n             * Checks if a particular option is enabled for the current item\n             * @param {String} option\n             * @returns {Boolean}\n             */\n            hasOption: function(option) {\n                return _.indexOf(this.testContext.categories, option) >= 0;\n            },\n\n            /**\n             * Gets access to the qtiRunner instance\n             * @returns {Object}\n             */\n            getQtiRunner: function(){\n                var itemFrame = document.getElementById('qti-item');\n                var itemWindow = itemFrame && itemFrame.contentWindow;\n                var itemContainerFrame = itemWindow && itemWindow.document.getElementById('item-container');\n                var itemContainerWindow = itemContainerFrame && itemContainerFrame.contentWindow;\n                return itemContainerWindow && itemContainerWindow.qtiRunner;\n            },\n\n            /**\n             * Checks if the current section is timed\n             * @returns {Boolean}\n             */\n            isTimedSection: function(){\n                var timeConstraints = this.testContext.timeConstraints,\n                    isTimedSection = false;\n                for( var index in timeConstraints ){\n                    if(timeConstraints.hasOwnProperty(index) &&\n                        timeConstraints[index].qtiClassName === 'assessmentSection' ){\n                        isTimedSection = true;\n                    }\n                }\n\n                return isTimedSection;\n            },\n\n            /**\n             * Gets the list of items owned by the current section\n             * @returns {Array}\n             */\n            getCurrentSectionItems: function(){\n                var partId  = this.testContext.testPartId,\n                    navMap  = this.testContext.navigatorMap,\n                    sectionItems;\n\n                for( var partIndex in navMap ){\n                    if( !navMap.hasOwnProperty(partIndex)){\n                        continue;\n                    }\n                    if( navMap[partIndex].id !== partId ){\n                        continue;\n                    }\n\n                    for(var sectionIndex in navMap[partIndex].sections){\n                        if( !navMap[partIndex].sections.hasOwnProperty(sectionIndex)){\n                            continue;\n                        }\n                        if( navMap[partIndex].sections[sectionIndex].active === true ){\n                            sectionItems = navMap[partIndex].sections[sectionIndex].items;\n                            break;\n                        }\n                    }\n                }\n\n                return sectionItems;\n            },\n\n            /**\n             * Skips the current item\n             */\n            skip: function () {\n                var self = this,\n                    doSkip = function() {\n                        self.disableGui();\n                        self.actionCall('skip');\n                    };\n\n                if (this.shouldDisplayEndTestWarning()) {\n                    this.displayEndTestWarning(doSkip);\n                } else {\n                    doSkip();\n                }\n            },\n\n            /**\n             * Handles the timeout state\n             */\n            timeout: function () {\n                var self = this;\n                this.disableGui();\n                this.testContext.isTimeout = true;\n                this.updateTimer();\n\n                this.killItemSession(function () {\n                    var confirmBox = $('.timeout-modal-feedback'),\n                        testContext = self.testContext,\n                        confirmBtn = confirmBox.find('.js-timeout-confirm, .modal-close');\n\n                    if (testContext.numberCompletedSection === testContext.numberItemsSection) {\n                        testMetaData.addData({\"SECTION\" : {\"SECTION_EXIT_CODE\" : testMetaData.SECTION_EXIT_CODE.COMPLETE_TIMEOUT}});\n                    } else {\n                        testMetaData.addData({\"SECTION\" : {\"SECTION_EXIT_CODE\" : testMetaData.SECTION_EXIT_CODE.TIMEOUT}});\n                    }\n\n                    self.enableGui();\n                    confirmBox.modal({width: 500});\n                    confirmBtn.off('click').on('click', function () {\n                        confirmBox.modal('close');\n                        self.actionCall('timeout');\n                    });\n                });\n            },\n\n            /**\n             * Sets the assessment test context object\n             * @param {Object} testContext\n             */\n            setTestContext: function(testContext) {\n                this.testContext = testContext;\n                this.itemServiceApi = eval(testContext.itemServiceApiCall);\n                this.itemServiceApi.setHasBeenPaused(testContext.hasBeenPaused);\n            },\n\n\n            /**\n             * Handles Metadata initialization\n             */\n            initMetadata: function (){\n                testMetaData = testMetaDataFactory({\n                    testServiceCallId: this.itemServiceApi.serviceCallId\n                });\n            },\n\n            /**\n             * Retrieve service responsible for broken session tracking\n             * @returns {*}\n             */\n            getSessionStateService: function () {\n                if (!sessionStateService) {\n                    sessionStateService = this.testContext.sessionStateService({accuracy: 1000});\n                }\n                return sessionStateService;\n            },\n\n            /**\n             * Updates the GUI\n             * @param {Object} testContext\n             */\n            update: function (testContext) {\n                var self = this;\n                $controls.$itemFrame.remove();\n\n                var $runner = $('#runner');\n                $runner.css('height', 'auto');\n\n                this.getSessionStateService().restart();\n\n                this.setTestContext(testContext);\n                this.updateContext();\n                this.updateProgress();\n                this.updateNavigation();\n                this.updateTestReview();\n                this.updateInformation();\n                this.updateRubrics();\n                this.updateTools(testContext);\n                this.updateTimer();\n                this.updateExitButton();\n                this.resetCurrentItemState();\n                this.initMetadata();\n\n                $controls.$itemFrame = $('<iframe id=\"qti-item\" frameborder=\"0\" scrollbars=\"no\"/>');\n                $controls.$itemFrame.appendTo($controls.$contentBox);\n\n                if (this.testContext.itemSessionState === this.TEST_ITEM_STATE_INTERACTING && self.testContext.isTimeout === false) {\n                    $doc.off('.testRunner').on('serviceloaded.testRunner', function () {\n                        self.afterTransition();\n                        self.adjustFrame();\n                        $controls.$itemFrame.css({visibility: 'visible'});\n                    });\n\n                    // Inject API into the frame.\n                    this.itemServiceApi.loadInto($controls.$itemFrame[0], function () {\n                        // We now rely on the 'serviceloaded' event.\n                    });\n                }\n                else {\n                    // e.g. no more attempts or timeout! Simply consider the transition is finished,\n                    // but do not load the item.\n                    self.afterTransition();\n                }\n            },\n\n            /**\n             * Displays feedback on the current state of the test\n             */\n            updateInformation: function () {\n\n                if (this.testContext.isTimeout === true) {\n                    feedback().error(__('Time limit reached for item \"%s\".', this.testContext.itemIdentifier));\n                }\n                else if (this.testContext.itemSessionState !== this.TEST_ITEM_STATE_INTERACTING) {\n                    feedback().error(__('No more attempts allowed for item \"%s\".', this.testContext.itemIdentifier));\n                }\n            },\n\n            /**\n             * Updates the displayed tools\n             * @param {Object} testContext\n             */\n            updateTools: function updateTools(testContext) {\n                var showSkip = false;\n                var showSkipEnd = false;\n                var showNextSection = !!testContext.nextSection && (this.hasOption(optionNextSection) || this.hasOption(optionNextSectionWarning));\n\n                if (this.testContext.allowSkipping === true) {\n                    if (this.testContext.isLast === false) {\n                        showSkip = true;\n                    } else {\n                        showSkipEnd = true;\n                    }\n                }\n\n                $controls.$skip.toggle(showSkip);\n                $controls.$skipEnd.toggle(showSkipEnd);\n                $controls.$nextSection.toggle(showNextSection);\n\n                actionBarTools.render('.tools-box-list', testContext, TestRunner);\n            },\n\n            /**\n             * Displays a timer\n             * @param {Object} cst\n             * @returns {*|jQuery|HTMLElement}\n             */\n            createTimer: function(cst) {\n                var $timer = $('<div>', {'class': 'qti-timer qti-timer__type-' + cst.qtiClassName }),\n                    $label = $('<div>', {'class': 'qti-timer_label truncate', text: cst.label }),\n                    $time  = $('<div>', {'class': 'qti-timer_time', text: this.formatTime(cst.seconds) });\n\n                $timer.append($label);\n                $timer.append($time);\n                return $timer;\n            },\n\n            /**\n             * Updates the timers\n             */\n            updateTimer: function () {\n                var self = this;\n                var hasTimers;\n                $controls.$timerWrapper.empty();\n\n                for (var i = 0; i < timerIds.length; i++) {\n                    clearTimeout(timerIds[i]);\n                }\n\n                timerIds = [];\n                currentTimes = [];\n                lastDates = [];\n                timeDiffs = [];\n\n                if (self.testContext.isTimeout === false &&\n                    self.testContext.itemSessionState === self.TEST_ITEM_STATE_INTERACTING) {\n\n                    hasTimers = !!this.testContext.timeConstraints.length;\n                    $controls.$topActionBar.toggleClass('has-timers', hasTimers);\n\n                    if (hasTimers) {\n\n                        // Insert QTI Timers container.\n                        // self.formatTime(cst.seconds)\n                        for (i = 0; i < this.testContext.timeConstraints.length; i++) {\n\n                            var cst = this.testContext.timeConstraints[i];\n\n                            if (cst.allowLateSubmission === false) {\n\n                                // Set up a timer for this constraint\n                                $controls.$timerWrapper.append(self.createTimer(cst));\n\n                                // Set up a timer and update it with setInterval.\n                                currentTimes[i] = cst.seconds;\n                                lastDates[i] = new Date();\n                                timeDiffs[i] = 0;\n                                timerIndex = i;\n\n                                if (self.testContext.timerWarning && self.testContext.timerWarning[cst.qtiClassName]) {\n                                    cst.warnings = {};\n                                    _(self.testContext.timerWarning[cst.qtiClassName]).forEach(function (value, key) {\n                                        if (_.contains(['info', 'warning', 'danger'], value)) {\n                                            cst.warnings[key] = {\n                                                type: value,\n                                                showed: cst.seconds <= key,\n                                                point: parseInt(key, 10)\n                                            };\n                                        }\n                                    });\n                                    var closestPreviousWarning = _.find(cst.warnings, { showed: true });\n                                    if (!_.isEmpty(closestPreviousWarning) && closestPreviousWarning.point) {\n                                        cst.warnings[closestPreviousWarning.point].showed = false;\n                                    }\n                                }\n\n                                (function (timerIndex, cst) {\n                                    timerIds[timerIndex] = setInterval(function () {\n\n                                        timeDiffs[timerIndex] += (new Date()).getTime() - lastDates[timerIndex].getTime();\n\n                                        if (timeDiffs[timerIndex] >= 1000) {\n                                            var seconds = timeDiffs[timerIndex] / 1000;\n                                            currentTimes[timerIndex] -= seconds;\n                                            timeDiffs[timerIndex] = 0;\n                                        }\n\n                                        $timers.eq(timerIndex)\n                                            .html(self.formatTime(Math.round(currentTimes[timerIndex])));\n\n                                        if (currentTimes[timerIndex] <= 0) {\n                                            // The timer expired...\n                                            currentTimes[timerIndex] = 0;\n                                            clearInterval(timerIds[timerIndex]);\n\n                                            // Hide item to prevent any further interaction with the candidate.\n                                            $controls.$itemFrame.hide();\n                                            self.timeout();\n                                        } else {\n                                            lastDates[timerIndex] = new Date();\n                                        }\n\n                                        var warning = _.findLast(cst.warnings, { showed: false });\n\n                                        if (!_.isEmpty(warning) && _.isFinite(warning.point) && currentTimes[timerIndex] <= warning.point) {\n                                            self.timeWarning(cst, warning);\n                                        }\n\n                                    }, 1000);\n                                }(timerIndex, cst));\n                            }\n                        }\n\n                        $timers = $controls.$timerWrapper.find('.qti-timer .qti-timer_time');\n                        $controls.$timerWrapper.show();\n                    }\n                }\n            },\n\n            /**\n             * Mark appropriate timer by warning colors and show feedback message\n             *\n             * @param {object} cst - Time constraint\n             * @param {integer} cst.warningTime - Warning time in seconds.\n             * @param {integer} cst.qtiClassName - Class name of qti instance for which the timer is set (assessmentItemRef | assessmentSection | testPart | assessmentTest).\n             * @param {integer} cst.seconds - Initial timer value.\n             * @param {object} warning - Current actual warning\n             * @param {integer} warning.point - Warning time point in seconds, when show message\n             * @param {boolean} warning.showed - boolean flag for mark already showed warnings\n             * @param {string} warning.type - type of warning (from config), can be info, warning or error\n             *\n             * @returns {undefined}\n             */\n            timeWarning: function (cst, warning) {\n                var message = '',\n                    remaining,\n                    $timer = $controls.$timerWrapper.find('.qti-timer__type-' + cst.qtiClassName),\n                    $time = $timer.find('.qti-timer_time');\n\n                $time.removeClass('txt-info txt-warning txt-danger').addClass('txt-' + warning.type);\n\n                remaining = moment.duration(warning.point, \"seconds\").humanize();\n\n                switch (cst.qtiClassName) {\n                    case 'assessmentItemRef':\n                        message = __(\"Warning – You have %s remaining to complete this item.\", remaining);\n                        break;\n                    case 'assessmentSection':\n                        message = __(\"Warning – You have %s remaining to complete this section.\", remaining);\n                        break;\n                    case 'testPart':\n                        message = __(\"Warning – You have %s remaining to complete this test part.\", remaining);\n                        break;\n                    case 'assessmentTest':\n                        message = __(\"Warning – You have %s remaining to complete the test.\", remaining);\n                        break;\n                }\n\n                feedback()[warning.type](message);\n\n                cst.warnings[warning.point].showed = true;\n            },\n\n            /**\n             * Displays or hides the rubric block\n             */\n            updateRubrics: function () {\n                $controls.$rubricBlocks.remove();\n\n                if (this.testContext.rubrics.length > 0) {\n\n                    $controls.$rubricBlocks = $('<div id=\"qti-rubrics\"/>');\n\n                    for (var i = 0; i < this.testContext.rubrics.length; i++) {\n                        $controls.$rubricBlocks.append(this.testContext.rubrics[i]);\n                    }\n\n                    // modify the <a> tags in order to be sure it\n                    // opens in another window.\n                    $controls.$rubricBlocks.find('a').bind('click keypress', function () {\n                        window.open(this.href);\n                        return false;\n                    });\n\n                    $controls.$rubricBlocks.prependTo($controls.$contentBox);\n\n                    if (MathJax) {\n                        MathJax.Hub.Queue([\"Typeset\", MathJax.Hub], $controls.$rubricBlocks[0]);\n                    }\n\n                }\n            },\n\n            /**\n             * Updates the list of navigation buttons (previous, next, skip, etc.)\n             */\n            updateNavigation: function () {\n                $controls.$exit.show();\n\n                if(this.testContext.isLast === true) {\n                    $controls.$moveForward.hide();\n                    $controls.$moveEnd.show();\n                }\n                else {\n                    $controls.$moveForward.show();\n                    $controls.$moveEnd.hide();\n                }\n                if (this.testContext.navigationMode === this.TEST_NAVIGATION_LINEAR) {\n                    // LINEAR\n                    $controls.$moveBackward.hide();\n                }\n                else {\n                    // NONLINEAR\n                    $controls.$controls.show();\n                    if(this.testContext.canMoveBackward === true) {\n                        $controls.$moveBackward.show();\n                    }\n                    else {\n                        $controls.$moveBackward.hide();\n                    }\n                }\n            },\n\n            /**\n             * Updates the test taker review screen\n             */\n            updateTestReview: function() {\n                var considerProgress = this.testContext.considerProgress === true;\n\n                if (this.testReview) {\n                    this.testReview.toggle(considerProgress && this.hasOption(optionReviewScreen));\n                    this.testReview.update(this.testContext);\n                }\n            },\n\n            /**\n             * Updates the progress bar\n             */\n            updateProgress: function () {\n                var considerProgress = this.testContext.considerProgress === true;\n\n                $controls.$progressBox.css('visibility', considerProgress ? 'visible' : 'hidden');\n\n                if (considerProgress) {\n                    this.progressUpdater.update(this.testContext);\n                }\n            },\n\n            /**\n             * Updates the test informations\n             */\n            updateContext: function () {\n\n                $controls.$title.text(this.testContext.testTitle);\n\n                // Visibility of section?\n                var sectionText = (this.testContext.isDeepestSectionVisible === true) ? (' - ' + this.testContext.sectionTitle) : '';\n\n                $controls.$position.text(sectionText);\n                $controls.$titleGroup.show();\n            },\n\n            /**\n             * Displays the right exit button\n             */\n            updateExitButton : function(){\n\n                $controls.$logout.toggleClass('hidden', !this.testContext.logoutButton);\n                $controls.$exit.toggleClass('hidden', !this.testContext.exitButton);\n            },\n\n            /**\n             * Ensures the frame has the right size\n             */\n            adjustFrame: function () {\n                var rubricHeight = $controls.$rubricBlocks.outerHeight(true) || 0;\n                var frameContentHeight;\n                var finalHeight = $(window).innerHeight() - $controls.$topActionBar.outerHeight() - $controls.$bottomActionBar.outerHeight();\n                var itemFrame = $controls.$itemFrame.get(0);\n                $controls.$contentBox.height(finalHeight);\n                if($controls.$sideBars.length){\n                    $controls.$sideBars.each(function() {\n                        var $sideBar = $(this);\n                        $sideBar.height(finalHeight - $sideBar.outerHeight() + $sideBar.height());\n                    });\n                }\n\n                if(itemFrame && itemFrame.contentWindow){\n                    frameContentHeight = $controls.$itemFrame.contents().outerHeight(true);\n\n                    if (frameContentHeight < finalHeight) {\n                        if (rubricHeight) {\n                            frameContentHeight = Math.max(frameContentHeight, finalHeight - rubricHeight);\n                        } else {\n                            frameContentHeight = finalHeight;\n                        }\n                    }\n                    if (itemFrame.contentWindow.$) {\n                        itemFrame.contentWindow.$('body').trigger('setheight', [frameContentHeight]);\n                    }\n                    $controls.$itemFrame.height(frameContentHeight);\n                }\n            },\n\n            /**\n             * Locks the GUI\n             */\n            disableGui: function () {\n                $controls.$naviButtons.addClass('disabled');\n                if (this.testReview) {\n                    this.testReview.disable();\n                }\n            },\n\n            /**\n             * Unlocks the GUI\n             */\n            enableGui: function () {\n                $controls.$naviButtons.removeClass('disabled');\n                if (this.testReview) {\n                    this.testReview.enable();\n                }\n            },\n\n            /**\n             * Hides the GUI\n             */\n            hideGui: function () {\n                $controls.$naviButtons.addClass('hidden');\n                if (this.testReview) {\n                    this.testReview.hide();\n                }\n            },\n\n            /**\n             * Shows the GUI\n             */\n            showGui: function () {\n                $controls.$naviButtons.removeClass('hidden');\n                if (this.testReview) {\n                    this.testReview.show();\n                }\n            },\n\n            /**\n             * Formats a timer\n             * @param {Number} totalSeconds\n             * @returns {String}\n             */\n            formatTime: function (totalSeconds) {\n                var sec_num = totalSeconds;\n                var hours = Math.floor(sec_num / 3600);\n                var minutes = Math.floor((sec_num - (hours * 3600)) / 60);\n                var seconds = sec_num - (hours * 3600) - (minutes * 60);\n\n                if (hours < 10) {\n                    hours = \"0\" + hours;\n                }\n                if (minutes < 10) {\n                    minutes = \"0\" + minutes;\n                }\n                if (seconds < 10) {\n                    seconds = \"0\" + seconds;\n                }\n\n                var time = hours + ':' + minutes + ':' + seconds;\n\n                return time;\n            },\n\n            /**\n             * Processes an error\n             * @param {Object} error\n             */\n            processError : function processError(error) {\n                var self = this;\n\n                // keep disabled\n                this.hideGui();\n                this.beforeTransition();\n\n                // ask the parent to display a message\n                iframeNotifier.parent('messagealert', {\n                    message : error.message,\n                    action : function() {\n                        if (testMetaData) {\n                            testMetaData.clearData();\n                        }\n                        if (error.state === self.TEST_STATE_CLOSED) {\n                            // test is closed, finish it\n                            self.serviceApi.finish();\n                        } else {\n                            // test is still open, just exit to the index\n                            self.serviceApi.exit();\n                        }\n                    }\n                });\n            },\n\n            /**\n             * Call action specified in testContext. A postfix <i>Url</i> will be added to the action name.\n             * To specify actions see {@link https://github.com/oat-sa/extension-tao-testqti/blob/master/helpers/class.TestRunnerUtils.php}\n             * @param {String} action - Action name\n             * @param {Object} [extraParams] - Additional parameters to be sent to the server\n             * @returns {undefined}\n             */\n            actionCall: function (action, extraParams) {\n                var self = this,\n                    params = {metaData: testMetaData ? testMetaData.getData() : {}};\n\n                if (extraParams) {\n                    params = _.assign(params, extraParams);\n                }\n                this.beforeTransition(function () {\n                    $.ajax({\n                        url: self.testContext[action + 'Url'],\n                        cache: false,\n                        data: params,\n                        async: true,\n                        dataType: 'json',\n                        success: function (testContext) {\n                            testMetaData.clearData();\n\n                            if (!testContext.success) {\n                                self.processError(testContext);\n                            }\n                            else if (testContext.state === self.TEST_STATE_CLOSED) {\n                                self.serviceApi.finish();\n                            }\n                            else {\n                                self.update(testContext);\n                            }\n                        }\n                    });\n                });\n            },\n\n            /**\n             * Exit from test (after confirmation). All answered questions will be submitted.\n             *\n             * @returns {undefined}\n             */\n            exit: function () {\n                var self = this;\n                testMetaData.addData({\n                    \"TEST\" : {\"TEST_EXIT_CODE\" : testMetaData.TEST_EXIT_CODE.INCOMPLETE},\n                    \"SECTION\" : {\"SECTION_EXIT_CODE\" : testMetaData.SECTION_EXIT_CODE.QUIT}\n                });\n                this.displayExitMessage(\n                    __('Are you sure you want to end the test?'),\n                    function() {\n                    self.killItemSession(function () {\n                        self.actionCall('endTestSession');\n                        testMetaData.clearData();\n                    });\n                    },\n                    { scope: this.testReview ? this.testContext.reviewScope : null }\n                );\n            },\n\n            /**\n             * Set the state of the current item in the test runner\n             *\n             * @param {string} id\n             * @param {object} state\n             */\n            setCurrentItemState : function(id, state){\n                if(id){\n                    this.currentItemState[id] = state;\n                }\n            },\n\n            /**\n             * Reset the state of the current item in the test runner\n             */\n            resetCurrentItemState : function(){\n                this.currentItemState = {};\n            },\n\n            /**\n             * Get the state of the current item as stored in the test runner\n             * @returns {Object}\n             */\n            getCurrentItemState : function(){\n                return this.currentItemState;\n            }\n        };\n\n        var config = module.config();\n        if (config) {\n            actionBarTools.register(config.qtiTools);\n        }\n\n        return {\n            start: function (testContext) {\n\n                $controls = {\n                    // navigation\n                    $moveForward: $('[data-control=\"move-forward\"]'),\n                    $moveEnd: $('[data-control=\"move-end\"]'),\n                    $moveBackward: $('[data-control=\"move-backward\"]'),\n                    $nextSection: $('[data-control=\"next-section\"]'),\n                    $skip: $('[data-control=\"skip\"]'),\n                    $skipEnd: $('[data-control=\"skip-end\"]'),\n                    $exit: $(window.parent.document).find('[data-control=\"exit\"]'),\n                    $logout: $(window.parent.document).find('[data-control=\"logout\"]'),\n                    $naviButtons: $('.bottom-action-bar .action'),\n                    $skipButtons: $('.navi-box .skip'),\n                    $forwardButtons: $('.navi-box .forward'),\n\n                    // progress bar\n                    $progressBar: $('[data-control=\"progress-bar\"]'),\n                    $progressLabel: $('[data-control=\"progress-label\"]'),\n                    $progressBox: $('.progress-box'),\n\n                    // title\n                    $title:  $('[data-control=\"qti-test-title\"]'),\n                    $position:  $('[data-control=\"qti-test-position\"]'),\n\n                    // timers\n                    $timerWrapper:  $('[data-control=\"qti-timers\"]'),\n\n                    // other zones\n                    $contentPanel: $('.content-panel'),\n                    $controls: $('.qti-controls'),\n                    $itemFrame: $('#qti-item'),\n                    $rubricBlocks: $('#qti-rubrics'),\n                    $contentBox: $('#qti-content'),\n                    $sideBars: $('.test-sidebar'),\n                    $topActionBar: $('.horizontal-action-bar.top-action-bar'),\n                    $bottomActionBar: $('.horizontal-action-bar.bottom-action-bar')\n                };\n\n                // title\n                $controls.$titleGroup = $controls.$title.add($controls.$position);\n\n                $doc.ajaxError(function (event, jqxhr) {\n                    if (jqxhr.status === 403) {\n                        iframeNotifier.parent('serviceforbidden');\n                    }\n                });\n\n                window.onServiceApiReady = function onServiceApiReady(serviceApi) {\n                    TestRunner.serviceApi = serviceApi;\n\n                    if (!testContext.success) {\n                        TestRunner.processError(testContext);\n                    }\n\n                    // If the assessment test session is in CLOSED state,\n                    // we give the control to the delivery engine by calling finish.\n                    else if (testContext.state === TestRunner.TEST_STATE_CLOSED) {\n                        serviceApi.finish();\n                        testMetaData.clearData();\n                    }\n                    else {\n\n                        if (TestRunner.getSessionStateService().getDuration()) {\n                            TestRunner.setTestContext(testContext);\n                            TestRunner.initMetadata();\n\n                            TestRunner.keepItemTimed(TestRunner.getSessionStateService().getDuration());\n                            TestRunner.getSessionStateService().restart();\n                        } else {\n                            TestRunner.update(testContext);\n                        }\n                    }\n                };\n\n                TestRunner.beforeTransition();\n                TestRunner.testContext = testContext;\n\n                $controls.$skipButtons.click(function () {\n                    if (!$(this).hasClass('disabled')) {\n                        TestRunner.skip();\n                    }\n                });\n\n                $controls.$forwardButtons.click(function () {\n                    if (!$(this).hasClass('disabled')) {\n                        TestRunner.moveForward();\n                    }\n                });\n\n                $controls.$moveBackward.click(function () {\n                    if (!$(this).hasClass('disabled')) {\n                        TestRunner.moveBackward();\n                    }\n                });\n\n                $controls.$nextSection.click(function () {\n                    if (!$(this).hasClass('disabled')) {\n                        TestRunner.nextSection();\n                    }\n                });\n\n                $controls.$exit.click(function (e) {\n                    e.preventDefault();\n                    TestRunner.exit();\n                });\n\n                $(window).on('resize', _.throttle(function () {\n                    TestRunner.adjustFrame();\n                    $controls.$titleGroup.show();\n                }, 250));\n\n                $doc.on('loading', function () {\n                    iframeNotifier.parent('loading');\n                });\n\n\n                $doc.on('unloading', function () {\n                    iframeNotifier.parent('unloading');\n                });\n\n                TestRunner.progressUpdater = progressUpdater($controls.$progressBar, $controls.$progressLabel);\n\n                if (testContext.reviewScreen) {\n                    TestRunner.testReview = testReview($controls.$contentPanel, {\n                        region: testContext.reviewRegion || 'left',\n                        hidden: !TestRunner.hasOption(optionReviewScreen),\n                        reviewScope: testContext.reviewScope,\n                        preventsUnseen: !!testContext.reviewPreventsUnseen,\n                        canCollapse: !!testContext.reviewCanCollapse\n                    }).on('jump', function(event, position) {\n                        TestRunner.jump(position);\n                    }).on('mark', function(event, flag, position) {\n                        TestRunner.markForReview(flag, position);\n                    });\n                    $controls.$sideBars = $('.test-sidebar');\n                }\n\n                TestRunner.updateProgress();\n                TestRunner.updateTestReview();\n\n                iframeNotifier.parent('serviceready');\n\n\n                TestRunner.adjustFrame();\n\n                $controls.$topActionBar.add($controls.$bottomActionBar).animate({ opacity: 1 }, 600);\n\n                deleter($('#feedback-box'));\n                modal($('body'));\n\n                //listen to state change in the current item\n                $(document).on('responsechange', function(e, responseId, response){\n                    if(responseId && response){\n                        TestRunner.setCurrentItemState(responseId, {response:response});\n                    }\n                }).on('stateready', function(e, id, state){\n                    if(id && state){\n                        TestRunner.setCurrentItemState(id, state);\n                    }\n                }).on('heightchange', function(e, height) {\n                    $controls.$itemFrame.height(height);\n                });\n\n            }\n        };\n    });\n\n"]}